!function(b,f,_){"use strict";function Q(k,H){if("function"!=typeof H&&null!==H)throw new TypeError("Super expression must either be null or a function");k.prototype=f.create(H&&H.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),H&&_l(k,H)}function g(n){var w=f.prototype.toString.call(n);return"Array]"===w.substring(w.length-6)}function z(e,G,d,u,H,s){G=G||[],d=d||[],u=u||[];try{G.push(e);var K=Function.apply(0,G);return d[d.length]="return "+K,Function.apply(0,d).apply(0,u)}catch(I){return s&&s(I),H}}function J(t){var N={};return{get:function(R){if(N[R]!==_)return N[R];var Y;switch(R){case"WEBGL_depth_texture":Y=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":Y=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":Y=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":Y=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":Y=t.getExtension("WEBGL_compressed_texture_etc1");break;default:Y=t.getExtension(R)}return N[R]=Y,Y}}}function G(g,D,P){function W(){if(v!==_)return v;var P=D.get("EXT_texture_filter_anisotropic");return v=null!==P?g.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function Y(Z){if("highp"===Z){if(g.getShaderPrecisionFormat(g.VERTEX_SHADER,g.HIGH_FLOAT).precision>0&&g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.HIGH_FLOAT).precision>0)return"highp";Z="mediump"}return"mediump"===Z&&g.getShaderPrecisionFormat(g.VERTEX_SHADER,g.MEDIUM_FLOAT).precision>0&&g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var v;P=P||{};var w="undefined"!=typeof WebGL2RenderingContext&&g instanceof WebGL2RenderingContext,f=P.precision!==_?P.precision:"highp",N=Y(f);N!==f&&(console.warn("WebGL:",f,"not supported, using",N,"instead."),f=N);var G=P.logarithmicDepthBuffer===!0,H=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS),C=g.getParameter(g.MAX_VERTEX_TEXTURE_IMAGE_UNITS),q=g.getParameter(g.MAX_TEXTURE_SIZE),y=g.getParameter(g.MAX_CUBE_MAP_TEXTURE_SIZE),j=g.getParameter(g.MAX_VERTEX_ATTRIBS),t=g.getParameter(g.MAX_VERTEX_UNIFORM_VECTORS),u=g.getParameter(g.MAX_VARYING_VECTORS),h=g.getParameter(g.MAX_FRAGMENT_UNIFORM_VECTORS),T=C>0,F=w||!!D.get("OES_texture_float"),i=(w||!!D.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,o=T&&F,d=w?g.getParameter(g.MAX_SAMPLES):0;return{getMaxAnisotropy:W,getMaxPrecision:Y,precision:f,logarithmicDepthBuffer:G,maxTextures:H,maxVertexTextures:C,maxTextureSize:q,maxCubemapSize:y,maxAttributes:j,maxVertexUniforms:t,maxVaryings:u,maxFragmentUniforms:h,vertexTextures:T,floatFragmentTextures:F,elementTypeUint:i,floatVertexTextures:o,maxSamples:d}}function M(N,l){return N.z!==l.z?l.z-N.z:N.id-l.id}var X="ht";if(!b[X]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),b.performance&&b.performance.now||function(){var y=Date.now();b.performance||(b.performance={}),b.performance.now=function(){return Date.now()-y}}();for(var e=Date.now(),y=16,M=["ms","moz","webkit","o"],k=0;k<M.length&&!b.requestAnimationFrame;++k)b.requestAnimationFrame=b[M[k]+"RequestAnimationFrame"],b.cancelAnimationFrame=b[M[k]+"CancelAnimationFrame"]||b[M[k]+"CancelRequestAnimationFrame"];b.requestAnimationFrame||(b.requestAnimationFrame=function(p){var O=Date.now(),Y=y+e-O;return 0>Y&&(Y=0),e=O,b.setTimeout(function(){e=Date.now(),p(performance.now())},Y)}),b.cancelAnimationFrame||(b.cancelAnimationFrame=function(n){return b.clearTimeout(n)}),f.assign===_&&(f.assign=function(G){if(G===_||null===G)throw new TypeError("Cannot convert undefined or null to object");for(var v=f(G),i=1;i<arguments.length;i++){var e=arguments[i];if(e!==_&&null!==e)for(var I in e)f.prototype.hasOwnProperty.call(e,I)&&(v[I]=e[I])}return v}),b.btoa===_&&(b.btoa=function(Z){for(var u,m,O=String(Z),Q=0,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",U="";O.charAt(0|Q)||(r="=",Q%1);U+=r.charAt(63&u>>8-8*(Q%1))){if(m=O.charCodeAt(Q+=.75),m>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");u=u<<8|m}return U})}();var O,n,Z,j,R=b.location,v=R&&b.document,F=null,N=_,V=b[X]={},l=b[X+"config"],C=V.Default=l&&l.Default||{},W=V.Style=l&&l.Style||{},h=V.Attr=l&&l.Attr||{},I=function(){return!0},y=function(){return!1},$=function(z){return z},p=function($){return!$},S=V.Color=l&&l.Color||{},e=V.IsGetter=l&&l.IsGetter||{};!function(){var $=!1;try{var G=f.defineProperty({},"passive",{get:function(){return $=!0,_}});R&&(Z=O=R)&&b.addEventListener("test",G,G),R&&(j=n=R)&&b.removeEventListener("test",G,G)}catch(J){$=!1}C.passiveSupported=$}();var t,a,K,r,k=C.passiveSupported,w=C.eventListenerOptionsFalse=k?{passive:!1,capture:!1}:!1,o=C.eventListenerOptionsTrue=k?{passive:!1,capture:!0}:!0,x=function(z,g,q,t){z.addEventListener(g,q,t?o:w)},d=function(E,P,r,Y){E.removeEventListener(P,r,Y?o:w)},H=Math,U=H.round,P=H.floor,c=H.ceil,A=H.sqrt,i=H.max,B=H.min,D=H.abs,L=H.cos,q=H.acos,u=H.sin,m=H.pow,T=H.asin,s=H.exp,Y=H.PI,E=2*Y,$k=Y/2,ar=H.tan,ub=H.atan2,Vo=H.random,In=H.log,fo=m(2,1),zo=!1,Pq=b.parseInt||global.parseInt,xm="2021-9-28",So=R&&(b.navigator?b.navigator.platform.indexOf("Win")>-1:!1),Ej=function(Q){return Q*Q},gr=R&&b.setTimeout,Iq=R&&b.clearTimeout,Kf=R&&(b.navigator?b.navigator.userAgent.toLowerCase():""),lq=function(E){return E.test(Kf)},qb=lq(/msie/),Ic=lq(/msie/)||lq(/trident/),Zo=lq(/msie 10/),bj=lq(/edge/),cf=lq(/firefox/),Yo=lq(/mac/),Mk=lq(/mscAndroid/),Zk=C.isTouchable===_?So?!1:v?"ontouchend"in v:!1:C.isTouchable,gq="default",Qj="single",Xl="multiple",Br="front",Ie="back",aq="left",zc="right",Ob="top",fe="bottom",Pd="center",im="eye",Jf="middle",Df="east",Nd="west",Le="north",Xd="none",ke="px",$b="absolute",ii="border",$g="triangle",pi="rect",ef="circle",ur="cylinder",eg="shape",eh="items",Dl="normal",xs="remove",eo="clear",ye="width",je="height",$d="ingroup",wc="check",$q="uncheck",Sb="radio",lp="radioOn",Yp="radioOff",Gf="points",Qc="values",Kl="series",Qf="body",Mi="label",Nb="label2",Jm="note",Eq="note2",me="icons",lc="labelFont",Eg="labelColor",ji="labelSelectColor",nh="note.expanded",Op="note2.expanded",Ue="edge.expanded",rn="edge.points",ss="edge.type",qh="rotation",td="hidden",zn="visible",Rb="tuv",Di="no",op="draw",kl="select",bp="currentSubGraph",Ek="selectBackground",_c="autoMakeVisible",Wl="autoHideScrollBar",Mn="scrollBarColor",pe="scrollBarSize",Bh="indent",Id="rowHeight",ml="columnLineColor",Tj="rowLineColor",lb="columnLineVisible",Gi="rowLineVisible",Yd="visibleFunc",dh="expandIcon",$o="collapseIcon",Ve="checkMode",tm="sortFunc",ms="editable",Oj="batchEditable",Xc="tristate",Kh="asc",Ug="desc",qp="position",As="__",Aj="elevation",_o="children",Ec="translateX",ln="translateY",rd="dataModel",Fd="maxSize",ze="enc",Xg="state",Hm=ze+"o"+"de",Vm="shape3d",Il="shape3d.resolution",Ur="shape3d.visible",fm="shape3d.from.visible",bn="shape3d.to.visible",ai="shape3d.top.visible",jb="shape3d.bottom.visible",or="repeat.uv.length",Gh="serializeValue",id="deserializeValue",sq="centerUniform",hh="uniform",vg="rgba(255,255,255,0)",xp="style",Ad="attr",fp="field",Yf="string",Qe="boolean",Kn="color",Vc="int",Lh="number",ek="ew-resize",sb="ns-resize",sj="pointer",ah="auto",jf="mousedown",$p="mousemove",Sn="mouseup",hk="mouseout",Ym="touchstart",df="touchmove",Gd="touchend",dk="keydown",Sp="keyup",Lo=["DOMMouseScroll","mousewheel"],Hr=cf?Lo[0]:Lo[1],tq=As+X+As+Hm,Ag=[Ym,df,Gd],hn=[jf,$p,Sn,hk,Hr,"wheel","mouseenter","mouseleave","mouseover"],Xr=[dk,Sp,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],Rf=Zk?Ag.concat(Xr):hn.concat(Xr),nb=F,Uc=F,Rn=F,Er=F,Lp=!0,vk=Sn.length,wh=function(){Rn&&(Iq(Rn.timeout),Rn=F)},ch=function(){Rn&&Ui(Rn.e,Rn.info)};b.addEventListener&&(N=R)&&(Zk||(x(b,hk,function(){wh()}),x(b,Hr,function(){qn()})),x(b,Sp,function(c){91===c.keyCode?Wc={}:delete Wc[c.keyCode]},!0),x(b,dk,function(y){Wc[y.keyCode]=!0},!0),x(b,"blur",function(){Wc={}}));var Zp,El,bl,Wn=0,Ip=F,wk=function(p,X){var U=gr(function(){delete Ip[U],Xn(Ip)&&(Ip=F),p()},X);return U},hq=F,Pp=F,Hi={},pr={},zf={},ep={},Mo={},Wc={},fi={},aj={},Ng={},nd={},Mr=/.json$/,zm=/\.(json|bin)$/,tj=/^data:image\/svg\+xml/,Uh={},Me=[],Rm={},nn=F,em=F,yh=function(){},sf=function(){throw"Oops!"},Wq=[0,0,0],wq={x:0,y:0,width:0,height:0},Sh=F,Hb=F,Nl=F,mb=function(f,S){pr[f]=S,S&&S.comps&&!S.uuid&&(S.uuid=V.Math.generateUUID()),Cf[f]&&(S.cacheRule=Cf[f],delete Cf[f])},lj=function(e){Hb&&!e._72O&&(Nl||(Nl={}),Nl[e._72O=Ch()]=e),Zp!=F?Xb()<.05&&r&&!El&&(Gc=wh):Gc=yb},cc=function(d,w,M,p){Hb||(Hb={});var P=Hb[d];if(P){if(P.url===w)return;P.image?(P.image.onload=yh,P.image.onerror=yh):P.request&&(P.request.onload=yh,P.request.onerror=yh)}if(Mr.test(w)){var T=new zi;if(Hb[d]={request:T,url:w},w=C.beforeLoadURL(w,d),w.data){var h=C.parse(w.data);sc(d,h),C.handleImageLoaded(d,h)}else{T.onload=function(){if(200===this.status||0===this.status){var e=C.parse(T.getResponseText());sc(d,e),C.handleImageLoaded(d,e)}else sc(d,C.handleUnfoundImage(d,w)||F)},T.onerror=function(){sc(d,C.handleUnfoundImage(d,w)||F)};var U={};U.url=encodeURI(w),U.sync=!1,T.send(U)}}else{var h=new Image;Hb[d]={image:h,url:w},/^data:image/.test(w)||(w=C.beforeLoadURL(w,d),w=C.appendTimeStamp(w),w=encodeURI(w),h.crossOrigin=C.crossOrigin),C.convertImageSrc(w,function(V){Ic&&(w.toLowerCase().indexOf(".svg")>0||tj.test(w))?(v.body.appendChild(h),h.style.visibility="hidden",h.onload=function(){gr(function(){if(M&&(h.width=M),p&&(h.height=p),!h.width||!h.height){var T=h.width||h.clientWidth,g=h.height||h.clientHeight;h.width=T,h.height=g}C.handleImageLoaded(d,h),sc(d,h),v.body.removeChild(h),h.style.visibility=""},180)},h.onerror=function(){sc(d,C.handleUnfoundImage(d,w)||F),v.body.removeChild(h),h.style.visibility=""}):(h.onload=function(){M&&(h.width=M),p&&(h.height=p),C.handleImageLoaded(d,h),sc(d,h)},h.onerror=function(){sc(d,C.handleUnfoundImage(d,w)||F)}),h.src=V})}},sc=function(k,q){if(mb(k,q),delete Hb[k],Xn(Hb)&&(Hb=F,Nl)){for(var g in Nl){var L=Nl[g];L._2O&&L._2O[k]&&(L.deleteTexture(k),delete L._2O[k]),L.invalidateAll&&L.invalidateAll(_,"imageLoaded",k),L.redraw&&L.redraw(),L.iv(),q&&q.layoutAttach&&ne(L.dm)&&L.dm().updateLayoutAttach(k),delete L._72O}Nl=F}if(q&&Nl)for(var g in Nl){var L=Nl[g];L.invalidateAll&&L.invalidateAll(_,"imageLoading",k),L.redraw&&L.redraw(),L.iv(),q.layoutAttach&&ne(L.dm)&&L.dm().updateLayoutAttach(k)}},Ln=function(){return In=H&&Date,function(){return b.performance&&b.performance.now?b.performance.now():Date.now()}}(),$m=function(g,m,H){return{width:g,height:m,comps:mh(H)?H:[H]}},Qk=function(S,$){return{type:ef,rect:[S,$,1.6,1.6],borderWidth:1,borderColor:Bd,gradient:te,gradientColor:Om,background:Bd}},Od=function($,d){return $m(16,16,{type:$g,rect:[4,4,10,8],background:$,rotation:d?1.57:3.14})},yg=function(N,e){return $m(16,16,{type:$g,rect:[4,4,8,7],background:N,rotation:e?3.14:0})},Hn=function(P){var b=P._orientation;return"horizontal"===b||"h"===b},xd=function(f,w){var D=F||4,k=F||1,G=F||1;0>D?D=0:D>.25&&(D=.25);var K,X,x,I,l,v,M,h=.5,n=[],O=[],s=[],r=E/G,C=E/k,R=h-D;for(X=0;k>=X;X++)for(I=-Y+X*C,v=L(I),l=u(I),K=0;G>=K;K++)x=K*r,M=R+D*v,n.push(L(x)*M,l*D,-u(x)*M),(a=[f,w])&&O.push(K/G,1-X/k);for(X=0;k>X;X++){var g=X*(G+1),m=(X+1)*(G+1);for(K=0;G>K;K++)s.push(g+K,m+K+1,m+K,g+K,g+K+1,m+K+1),Dm.z=bq.z=[f,w]}},nc=function(h){var R=2,g=0;for(var O in h)O.length===R&&Pq(O,32)===gk&&(nn=em=h[O]),g++;return g},ac=function(Y,c,B,x){return B||(B=Zk?5:3,B/=x||1),{x:Y-B,y:c-B,width:2*B,height:2*B}},uq=function(P,J,_,p){var t=this;J||(J=Zk?5:3,_=20,p=20);var i={x:P,y:J,width:_,height:p};if(_)for(var L=0;_>L;L++)if(3===_)p=20;else for(var R=0;p>R;R++)t=b?b:_;var U={x:Y,y:2*Y};if(Hd(i,U)){var K=je[0]+Ob[0]+eo[1]+Kh.length,A=td[0]+Xc[0]+eo[1]+Qf.length;Jb[im]=[t[K],t[A]],t[K]=Ro[im],t[A]=Ro[Vm]}},Tp=function(l){return(/ble$/.test(l)||/ed$/.test(l)||e[l]?"is":"get")+l.charAt(0).toUpperCase()+l.slice(1)},Ro=function(C){return"set"+C.charAt(0).toUpperCase()+C.slice(1)},zq=function(I){return typeof I===Yf||I instanceof String},kd=function(A){return typeof A===Lh},yb=function(q){return typeof q===Qe},Dg=function(G){return G&&"object"==typeof G},ne=function(F){return"function"==typeof F},mh=function(O){return O instanceof Array},Tm=function(j){return j instanceof _n},qd=function(p){return mh(p)?new _n(p):p},be=function(V){return V instanceof Yj},Cm=function(R){return R instanceof Ho},Qb=function(R){return R instanceof fd},pf=function(E,R){if(!(E instanceof V.Group))return!1;if(!R)return E.isExpanded();var $=R.getDataUI(E);return $&&$._88I?!0:!1},Pl=function(t){return t instanceof rs},Xo=function($){return $&&"IFRAME"===$.tagName},Dh=function(h){return h==F||C.numberDigits==F?h:parseFloat(h.toFixed(C.numberDigits))},hj=function(g,m,Z){var Q,u=m.length;if(Z)for(var s=0;Z>s;s++)if(3===u)g.push(m[0]),g.push(m[1]),g.push(m[2]);else for(Q=0;u>Q;Q++)g.push(m[Q]);else if(3===u)g.push(m[0]),g.push(m[1]),g.push(m[2]);else for(Q=0;u>Q;Q++)g.push(m[Q])},Nk=function(Q){return Q?Dg(Q)?Q:{}:!1},Xf=function(I,v,G){var c,X=Dg(I)?I:I.prototype;for(c in v)G&&c in X?X[c]===_&&console.warn("class",X,"has own undefined property",c,", keep exist!"):X[c]=v[c];return I},uo=function(F,w){if(!("wheelDelta"in w)){var K=w.deltaMode;w.wheelDelta=K===w.DOM_DELTA_PIXEL?-w.deltaY:K===w.DOM_DELTA_LINE?40*-w.deltaY:120*-w.deltaY}F.handle_mousewheel(w)},ik=function(j){return String.fromCharCode(j)},bm=function(q){for(var k,v=0,h="";v<q.length;v++)k=q[q.length-1-v],"%"===k?k="'":"a"===k?k='"':"]"===k&&(k="\\"),h+=ik(k.charCodeAt(0)-1);return h},tl=function(E,w,k){E.superClass.constructor.apply(w,k)},Xn=function(i){for(var w in i)return!1;return!0},pq=function(q){return q?0===q.length:!0},wj=function(){var n="";return[$q[0],Tj[0],Mi[0]].forEach(function(o){n+=Ro(o).slice(3)}),hh=v&&v[n]||sq,function(q,l){return q===l?!0:q.x===l.x&&q.y===l.y&&q.width===l.width&&q.height===l.height}}(),ag=function(f,T,v){return T>f?T:f>v?v:f},to=function(t){return 0>t?-1:t>0?1:0},Xb=function(){var l=1e4*u(vk++);return l-P(l)},Io=function(D,y,K){return Qr(D.x,D.y,y.x,y.y,K.x,K.y,K.x+K.width,K.y,!0)||Qr(D.x,D.y,y.x,y.y,K.x+K.width,K.y,K.x+K.width,K.y+K.height,!0)||Qr(D.x,D.y,y.x,y.y,K.x+K.width,K.y+K.height,K.x,K.y+K.height,!0)||Qr(D.x,D.y,y.x,y.y,K.x,K.y+K.height,K.x,K.y,!0)},Qr=function(e,j,v,A,V,w,f,s,J){var Z=(f-V)*(j-w)-(s-w)*(e-V),b=(s-w)*(v-e)-(f-V)*(A-j);if(0!==b){var z=Z/b,g=e+z*(v-e),K=j+z*(A-j);return J&&(g+Lc<B(e,v)||g-Lc>i(e,v)||g+Lc<B(V,f)||g-Lc>i(V,f)||K+Lc<B(j,A)||K-Lc>i(j,A)||K+Lc<B(w,s)||K-Lc>i(w,s))?F:[g,K]}return F},Zh=function(u,U,n){if(u&&n)if(U){if(U===xp)return u.getStyle(n);if(U===Ad)return u.getAttr(n);if(U===fp)return u[n]}else if(n=Tp(n),u[n])return u[n]();return _},Sc=function(Y,z,G,p){if(Y&&G)if(z){if(z===xp)Y.s(G,p);else if(z===Ad)Y.a(G,p);else if(z===fp){var K=Y[G];Y[G]=p,Y.fp("f:"+G,K,p)}}else G=Ro(G),Y[G]&&Y[G](p)},ei=function(z,p){var e,I,E,c=!1;return(Zh(z,xp,"shadow")||p&&"shadow"===Zh(z,xp,"select.type"))&&(e=Zh(z,xp,"shadow.offset.x")||0,I=Zh(z,xp,"shadow.offset.y")||0,E=Zh(z,xp,"shadow.blur")||0,c=!0),!c&&Zh(z,xp,"shadow2")&&(e=Zh(z,xp,"shadow2.offset.x")||0,I=Zh(z,xp,"shadow2.offset.y")||0,E=Zh(z,xp,"shadow2.blur")||0,c=!0),c?1.5*E+Math.max(e,I):0},un=function(c,s,_,l){return l=0===_?0:l||0,s&&"top"!==s?"bottom"===s?{x:c.x-l,y:c.y-l,width:c.width+2*l,height:c.height*_+l}:"right"===s?{x:c.x-l,y:c.y-l,width:c.width*_+l,height:c.height+2*l}:"left"===s?{x:c.x+c.width*(1-_),y:c.y-l,width:c.width*_+l,height:c.height+2*l}:void 0:{x:c.x-l,y:c.y+c.height*(1-_),width:c.width+2*l,height:c.height*_+l}},li=function(l,O,$,z,m){O&&Qm(l,$,z,1,m,O)},dd=function(R,w,P,l){var K=1-R;return K*K*w+2*R*K*P+R*R*l},Dm=function(y,S,m,n,O){var b=1-y;return b*b*b*S+3*b*b*y*m+3*b*y*y*n+y*y*y*O},Pm=function(c){var X,z,W,k,i=0;return c.forEach(function(J){if(X=J.length,X>0)for(z=J[0],k=1;X>k;k++)W=J[k],i+=kj(z,W),z=W}),i},Xp=function(M,z,G){var b="__"+M,R=function(C){("mousedown"===M||"mouseup"===M||"touchstart"===M||"touchend"===M)&&gm(C),G.disabled||G["handle_"+M](C)};G[b]||(G[b]=R,x(z,M,R))},Ll=function(e,C,o){var x="__"+e,t=o[x];t&&(d(C,e,t),delete o[x])},fk=function(f,O){var l="_"+O;f[Tp(O)]=function(){return this[l]},f[Ro(O)]=function(B){var R=this[l];this[l]=B,this.fp(O,R,B)}},Hj=function(g){return f.create(g)},ff=function(A){if(!A.element){var l,W;(l=A.textField)?W=Ud(ft.TextField,l):(l=A.textArea)?W=Ud(ft.TextArea,l):(l=A.button)?W=Ud(ft.Button,l):(l=A.comboBox)?W=Ud(ft.ComboBox,l):(l=A.checkBox)?W=Ud(ft.CheckBox,l):(l=A.radioButton)?W=Ud(ft.RadioButton,l):(l=A.slider)?W=Ud(ft.Slider,l):(l=A.colorPicker)?W=Ud(ft.ColorPicker,l):(l=A.image)&&(W=Ud(ft.Image,l)),W&&(A.element=W)}},oj=function(M,Y){var U=ir(M);return U._ht=Y,U},he=b.top===b?b.top:b||b.document,ir=function(t,y){var r=v.createElement("div"),s=r.style;return r.tabIndex=-1,r.onkeydown=Qq,s.msTouchAction=Xd,Fr(r,F,0),Zk&&s.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",F),t&&(s.overflow=td),y&&of(y,r),r},ys=function(I,t){var O=v.createElement("canvas"),H=O.style;return H.msTouchAction=Xd,t||(H.pointerEvents=Xd),Fr(O,F,0),I&&of(I,O),O},Fr=function(w,c,t){var s=w.style;s.border=c?c+" solid 1px":0,s.outline=0,s.padding=t?"0 "+t+ke:0,qm(w)},qm=function(h){var U=h.style;U.position=$b,U.margin=0,U.setProperty("box-sizing","border-box",F),U.setProperty("-moz-box-sizing","border-box",F)},Db=function(B,l,E,x){x||(x=nj),l!=F&&(B.width=l*x,B.style.width=l+ke),E!=F&&(B.height=E*x,B.style.height=E+ke)},of=function(C,i,L){C.appendChild(i),L&&(i.style.position=$b)},Wp=function(x,Q){Q.split||(Q+="");for(var O,S=Q.split("\n"),k=0,K=S.length,v=0;K>v;v++){var m=Tg(x.font,S[v]);m.width>k&&(k=m.width),O||(O=m.height)}return x.ss=S,{width:k,height:O*K}},yc=function(c,v,N,G,t,H){var C=v.length;if(1===C)tp(c,v[0],N,G,t);else for(var j=N.height/C,S={x:N.x,y:N.y,width:N.width,height:j},o=0;o<v.length;o++)H?Je(c,v[o],G,t,S.x,S.y,S.width,S.height,H):tp(c,v[o],S,G,t),S.y+=j},tp=function(Q,C,m,i,R){Q.font=i?i:di,Q.fillStyle=R?R:rl,Q.textAlign=Pd,Q.textBaseline=Jf;var t,T;m?m.width===_?(t=m.x,T=m.y):(t=m.x+m.width/2,T=m.y+m.height/2):(t=0,T=0),Q.fillText(C,U(t),U(T))},Kk=function(r){r.getView&&(r=r.getView());var f=r.offsetWidth||r.scrollWidth;return!f&&r.style.width&&(f=Pq(r.style.width)),f},Cr=function(H){H.getView&&(H=H.getView());var z=H.offsetHeight||H.scrollHeight;return!z&&H.style.height&&(z=Pq(H.style.height)),z},Rq=function(Z,B,e){var a=B[0].toUpperCase()+B.substring(1,B.length);Z["webkit"+a]=e,Z["moz"+a]=e,Z["ms"+a]=e,Z["o"+a]=e,Z[B]=e},Tn=function(){var $=function(r){Qq(r),r.stopPropagation()},l=function(z){Qq(z)},_=[Ym,dk,jf];return function(U,L){var w=ir(),j=w.style;return j.backgroundColor=C.disabledBackground,U&&(j.backgroundImage="url("+U+")",j.backgroundPosition="50% 50%",j.backgroundRepeat="no-repeat no-repeat"),L===!1?_.forEach(function(j){x(w,j,l)}):_.forEach(function(n){x(w,n,$)}),w}}(),Zq=function(L){var p=L.getContext("2d");return p.save(),p.lineCap=fh,p.lineJoin=Fm,p},Gc=function(j,N,E,C){zg(j,N*nj,E*nj),C*=nj,1!==C&&j.scale(C,C)},zg=function(w,U,z){w.translate(U,z)},_g=function(X,V){V&&X.rotate(V)},qf=function(x,O,k){O===_&&(O=1),k===_&&(k=1),(1!==O||1!==k)&&x.scale(O,k)},qk=!1,s=he[wc[1]+Ec[0]],fj=function(F){var Q=v.activeElement;if(v.activeElement!==F){Q&&Q.forceOnblur&&Q.forceOnblur();for(var E=[],M=F.parentNode;M;)E.push([M,M.scrollLeft,M.scrollTop]),M=M.parentNode;if(!qk){var n=[],f=[];try{for(var s=b.parent,X=b;s!==X;)n.push([s,s.scrollX,s.scrollY]),X=s,s=b.parent;var t=b.frameElement;if(t)for(var K=t.parentNode;K;)f.push([K,K.scrollLeft,K.scrollTop]),K=K.parentNode}catch(I){qk=!0}}if(Zk)F.focus();else{var h=He(),J=h.target;F.focus(),J.scrollLeft=h.left,J.scrollTop=h.top}E.forEach(function(R){R[0].scrollLeft=R[1],R[0].scrollTop=R[2]}),qk||(n.forEach(function(b){b[0].scrollTo(b[1],b[2])}),f.forEach(function(H){H[0].scrollLeft=H[1],H[0].scrollTop=H[2]}))}},Wr=function(U){return U&&U.getView?U.getView():U},mm=function(l,F,h,Y,k){if(2===arguments.length&&(h=F.y,Y=F.width,k=F.height,F=F.x),l.isSelfViewEvent)l.setX(F),l.setY(h),l.setWidth(Y),l.setHeight(k);else{var r=Wr(l),c=r.style;if((v.fullscreenElement||v.mozFullScreenElement||v.webkitFullscreenElement||v.msFullscreenElement)!==r)F!==_&&(c.left=F+ke),h!==_&&(c.top=h+ke),Y!==_&&(c.width=Y+ke),k!==_&&(c.height=k+ke);else{var W=C.getWindowInfo();c.left=(F=W.left)+ke,c.top=(h=W.top)+ke,c.width=(Y=W.width)+ke,c.height=(k=W.height)+ke}l.endEditing&&!Zk&&l.endEditing(),l.redraw&&l.redraw(),l.invalidate&&l.invalidate(),l.onLayouted&&l.onLayouted(F,h,Y,k),l.fireViewEvent&&l.fireViewEvent("layout")}},ab=function(O){if(!O.touches)return O;var n=O.touches[0];return n?n:O.changedTouches[0]},Ah=function(K){return os(K)?ab(K).target:K.target},os=function(U){return U&&"object"==typeof U&&"touches"in U},bi=function(P){C.popup&&C.popup.close(),C.popup=P},Ee=F,zj=function(k){Ee.handleWindowTouchMove(k)},Bl=function(v){Ee.handleWindowTouchEnd(v),d(b,df,zj),d(b,Gd,Bl),Ee=F},Im=function(t){Ee.handleWindowMouseMove(t)},vn=function(X){Ee.handleWindowMouseUp(X),d(b,$p,Im),d(b,Sn,vn),Ee=F},xg=function(c){return 1===_k(c)},Wi=function(B,m){return m?m.keyCode===B:Wc[B]},Oh=function(p){return Ef(p)&&Wi(65,p)},sl=function(l){return Wi(46,l)||Wi(8,l)},Uj=function($){return function(B){return B?B.keyCode===$:Wc[$]}},gk=573,xj=[65,83,68,87,37,38,39,40,32,13,27],pp=Uj(xj[0]),_j=Uj(xj[1]),yq=Uj(xj[2]),Nc=Uj(xj[3]),Re=Uj(xj[4]),Wk=Uj(xj[5]),se=Uj(xj[6]),mo=Uj(xj[7]),pc=Uj(xj[8]),vb=Uj(xj[9]),dp=Uj(xj[10]),Nh={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},lm=[2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,7,7,13,89],dc=F,Wg=F,af=function(C,K){dc||(dc=ys()),Db(dc,C,K,1);var S=Zq(dc);return S.clearRect(0,0,C,K),S},vo=function(I,p,D){if(p&&I){if("override"===D)return p;if("override_rgb"===D){var V=Sj(p);return I=Bm(I),"rgba("+U(255*V[0])+","+U(255*V[1])+","+U(255*V[2])+","+I[3]/255+")"}if("override_a"===D){var V=Sj(p);return I=Bm(I),"rgba("+I[0]+","+I[1]+","+I[2]+","+V[3]+")"}if("multiply_destinationAtop"===D){var P=Hq(Sj(I)),o=P[3],f=Hq(Sj(p)),w=f[3],v=Hq(P),h=v[3],N=P.map(function(Y,X){return Y*f[X]}),x=1-o,l=1-w,J=l*o+w;return P=P.map(function(i,C){return(w*x*f[C]+w*o*N[C]+l*o*i)/J}),o=J,x=1-o,P=P.map(function(C,l){return(h*v[l]*x+o*C*h)/h}),o=h,"rgba("+U(255*P[0])+","+U(255*P[1])+","+U(255*P[2])+","+o+")"}var V=Sj(p);return I=Bm(I),"rgba("+U(I[0]*V[0])+","+U(I[1]*V[1])+","+U(I[2]*V[2])+","+I[3]/255*V[3]+")"}return I},Bm=function(){var c,a={};for(var Z in b){var N=Xl.length;if(Z.length==N&&Z[0]===Xl[2]&&Z[1]===Xd[1]&&Z[4]===Xl[3]&&Z[5]===Xl[4]&&Z.substr(N-2)===Xd[1]+Xd[2]){var V=b[Z];for(var i in V)i.length===N&&i.substr(0,3)===zc[3]+xs[3]+kl[0]&&i.substr(N-2)===Xl[0]+Jm[3]&&(Lo=V[i])}}return function(P){var x,n=a[P];return n||(c||(c=ys(),Db(c,1,1,1)),x=c.getContext("2d"),x.clearRect(0,0,1,1),Qm(x,0,0,1,1,P),n=x.getImageData(0,0,1,1).data,n=a[P]=[n[0],n[1],n[2],n[3]]),n}}(),Sj=function(q){if(!zq(q))return q;var c=Bm(q);return c.CA||(c.CA=[c[0]/255,c[1]/255,c[2]/255,c[3]/255]),c.CA},Oc=function(j,h,e,O,W){var u=ys();u.width=e,u.height=O;var R=u.getContext("2d");R.drawImage(j,0,0,e,O);try{for(var J=R.getImageData(0,0,e,O),t=J.data,E=0,c=t.length;c>E;E+=4){var Z=t[E+0],F=t[E+1],I=t[E+2],w=t[E+3];"override_a"===W?t[E+3]=255*h[3]:"override_rgb"===W?(t[E+0]=255*h[0],t[E+1]=255*h[1],t[E+2]=255*h[2]):"override"===W?(t[E+0]=255*h[0],t[E+1]=255*h[1],t[E+2]=255*h[2],t[E+3]=255*h[3]):(t[E+0]=h[0]*Z,t[E+1]=h[1]*F,t[E+2]=h[2]*I,t[E+3]=h[3]*w)}R.putImageData(J,0,0)}catch(g){return j}return u},Jb=function(z,U,P){return U&&(U="miter"===P?8*U+20:U+1,z&&ps(z,U)),U},ue=function(D,I){if(I){var C=new Ai(I),g=D.width/2,x=D.height/2,B=np([C.tf(-g,-x),C.tf(g,-x),C.tf(g,x),C.tf(-g,x)]);return B.x+=D.x+g,B.y+=D.y+x,B}return D},wn=function(b,j,q,h,g,H,y,P){h*=Math.PI/180;var x={x:Math.cos(h)*(b.x-y.x)/2+Math.sin(h)*(b.y-y.y)/2,y:-Math.sin(h)*(b.x-y.x)/2+Math.cos(h)*(b.y-y.y)/2},N=Math.pow(x.x,2)/Math.pow(j,2)+Math.pow(x.y,2)/Math.pow(q,2);N>1&&(j*=Math.sqrt(N),q*=Math.sqrt(N));var G=(g==H?-1:1)*Math.sqrt((Math.pow(j,2)*Math.pow(q,2)-Math.pow(j,2)*Math.pow(x.y,2)-Math.pow(q,2)*Math.pow(x.x,2))/(Math.pow(j,2)*Math.pow(x.y,2)+Math.pow(q,2)*Math.pow(x.x,2)));isNaN(G)&&(G=0);var c={x:G*j*x.y/q,y:G*-q*x.x/j},v={x:(b.x+y.x)/2+Math.cos(h)*c.x-Math.sin(h)*c.y,y:(b.y+y.y)/2+Math.sin(h)*c.x+Math.cos(h)*c.y},T=function(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2))},u=function(e,x){return(e[0]*x[0]+e[1]*x[1])/(T(e)*T(x))},i=function(Q,Z){return(Q[0]*Z[1]<Q[1]*Z[0]?-1:1)*Math.acos(u(Q,Z))},L=i([1,0],[(x.x-c.x)/j,(x.y-c.y)/q]),R=[(x.x-c.x)/j,(x.y-c.y)/q],S=[(-x.x-c.x)/j,(-x.y-c.y)/q],l=i(R,S);u(R,S)<=-1&&(l=Math.PI),u(R,S)>=1&&(l=0);var u=j>q?j:q,E=j>q?1:j/q,W=j>q?q/j:1;if(null==P){var f={x:0,y:0,width:0,height:0};ps(f,u),f.x*=E,f.width*=E,f.y*=W,f.height*=W;var J=new Ai(h);return f=np([J.tf(f.x,f.y),J.tf(f.x+f.width,f.y),J.tf(f.x+f.width,f.y+f.height),J.tf(f.x,f.y+f.height)]),f.x+=v.x,f.y+=v.y,[{x:f.x,y:f.y},{x:f.x+f.width,y:f.y},{x:f.x+f.width,y:f.y+f.height},{x:f.x,y:f.y+f.height}]}P.translate(v.x,v.y),P.rotate(h),P.scale(E,W),P.arc(0,0,u,L,L+l,1-H),P.scale(1/E,1/W),P.rotate(-h),P.translate(-v.x,-v.y)},Pn=function(G,b){G&&G.beginPath();for(var g,P,D,d=[],c=function(r){for(var F,A=/(\-{0,1}[\d\.]+)/gi,b=[];F=A.exec(r);)b.push(parseFloat(F[0]));return b},j=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,u={x:0,y:0};g=j.exec(b);){var N=g[0],i=N.substr(0,1);if("M"===i||"m"===i){for(var e=c(N),I=0;I<e.length;I+=2){var U=e[I],x=e[I+1];"m"===i&&(U+=u.x,x+=u.y),G&&G.moveTo(U,x),d.push({x:U,y:x}),u.x=U,u.y=x}P=D=null}else if("H"===i||"h"===i){for(var e=c(N),I=0;I<e.length;I+=1){var U=e[I];"h"===i&&(U+=u.x),G&&G.lineTo(U,u.y),d.push({x:U,y:u.y}),u.x=U}P=D=null}else if("C"===i||"c"===i){for(var e=c(N),I=0;I<e.length;I+=6){var z=e[I],H=e[I+1],Z=e[I+2],h=e[I+3],U=e[I+4],x=e[I+5];"c"===i&&(z+=u.x,H+=u.y,Z+=u.x,h+=u.y,U+=u.x,x+=u.y),G&&G.bezierCurveTo(z,H,Z,h,U,x),d.push({x:z,y:H}),d.push({x:Z,y:h}),d.push({x:U,y:x}),u.x=U,u.y=x}P=[z,H,Z,h,U,x],D=null}else if("S"===i||"s"===i){for(var e=c(N),I=0;I<e.length;I+=4){var z,H;P?(z=2*P[4]-P[2],H=2*P[5]-P[3]):(z=u.x,H=u.y);var Z=e[I],h=e[I+1],U=e[I+2],x=e[I+3];"s"===i&&(Z+=u.x,h+=u.y,U+=u.x,x+=u.y),G&&G.bezierCurveTo(z,H,Z,h,U,x),d.push({x:z,y:H}),d.push({x:Z,y:h}),d.push({x:U,y:x}),u.x=U,u.y=x}P=[z,H,Z,h,U,x],D=null}else if("Q"===i||"q"===i){for(var e=c(N),I=0;I<e.length;I+=4){var z=e[I],H=e[I+1],U=e[I+2],x=e[I+3];"q"===i&&(z+=u.x,H+=u.y,U+=u.x,x+=u.y),G&&G.quadraticCurveTo(z,H,U,x),d.push({x:z,y:H}),d.push({x:U,y:x}),u.x=U,u.y=x}P=null,D=[z,H,U,x]}else if("T"===i||"t"===i){for(var e=c(N),I=0;I<e.length;I+=2){var z,H;D?(z=2*D[2]-D[0],H=2*D[3]-D[1]):(z=u.x,H=u.y);var U=e[I],x=e[I+1];"t"===i&&(U+=u.x,x+=u.y),G&&G.quadraticCurveTo(z,H,U,x),d.push({x:z,y:H}),d.push({x:U,y:x}),u.x=U,u.y=x}P=null,D=[z,H,U,x]}else if("V"===i||"v"===i){for(var e=c(N),I=0;I<e.length;I+=1){var x=e[I];"v"===i&&(x+=u.y),G&&G.lineTo(u.x,x),d.push({x:u.x,y:x}),u.y=x}P=D=null}else if("L"===i||"l"===i){for(var e=c(N),I=0;I<e.length;I+=2){var U=e[I],x=e[I+1];"l"===i&&(U+=u.x,x+=u.y),G&&G.lineTo(U,x),d.push({x:U,y:x}),u.x=U,u.y=x}P=D=null}else if("A"===i||"a"===i){for(var e=c(N),I=0;I<e.length;I+=7){var K=e[I],y=e[I+1],O=e[I+2],V=e[I+3],v=e[I+4],U=e[I+5],x=e[I+6];"a"===i&&(U+=u.x,x+=u.y);var l=wn(u,K,y,O,V,v,{x:U,y:x},G);l&&(d=d.concat(l)),u.x=U,u.y=x}P=D=null}var q=N.substr(N.length-1);("z"===q||"Z"===q)&&G&&G.closePath()}return d},Th=function(u,Q,b){var H,_,r="L"===Q[0],i=Q.length;u.save(),r?(u.transform(Q[5],Q[6],Q[7],Q[8],Q[9],Q[10]),H=u.createLinearGradient(Q[1],Q[2],Q[3],Q[4]),_=11):(u.transform(Q[7],Q[8],Q[9],Q[10],Q[11],Q[12]),H=u.createRadialGradient(Q[1],Q[2],Q[3],Q[4],Q[5],Q[6]),_=13);for(var q=u.compGray;i>_;){var M=Q[_+1];M=b(M),H.addColorStop(Q[_],q?C.toGrayColor(M):M),_+=2}return u.fillStyle=H,H},bq=function(w,O){var C=w.s("shape.gradient.pack");if(C){for(var c=C.length,k=new Array(c),y=0;c>y;y++)k[y]=C[y];var K,Q,P,e,B,R,Y,L,r,g,b,W,a,f="L"===k[0];K=f?5:7,Q=k[K],P=k[K+1],e=k[K+2],B=k[K+3],R=k[K+4],Y=k[K+5],L=O[0],r=O[1],g=O[2],b=O[3],W=O[4],a=O[5],k[K]=L*Q+g*P,k[K+1]=r*Q+b*P,k[K+2]=L*e+g*B,k[K+3]=r*e+b*B,k[K+4]=L*R+g*Y+W,k[K+5]=r*R+b*Y+a,w.s("shape.gradient.pack",k)}},Mf=function(b,D,m,z){var h=!1;if(b.beginPath?b.beginPath():h=!0,Tm(D)&&(D=D._as),Tm(m)&&(m=m._as),m&&m.length){for(var t,Z,u,g,V=0,c=0,F=m.length;F>c;c++)t=m[c],1===t?(Z=D[V++],b.moveTo(Z.x,h?-Z.y:Z.y)):2===t?(Z=D[V++],b.lineTo(Z.x,h?-Z.y:Z.y)):3===t?(Z=D[V++],u=D[V++],b.quadraticCurveTo(Z.x,h?-Z.y:Z.y,u.x,h?-u.y:u.y)):4===t?(Z=D[V++],u=D[V++],g=D[V++],b.bezierCurveTo(Z.x,h?-Z.y:Z.y,u.x,h?-u.y:u.y,g.x,h?-g.y:g.y)):5===t&&b.closePath();z&&5!==t&&b.closePath()}else{var P,G,K,Y=D.length;if(Y>0){for(P=D[0],b.moveTo(P.x,h?-P.y:P.y),G=1;Y>G;G++)K=D[G],b.lineTo(K.x,h?-K.y:K.y);z&&b.closePath()}}},tg=function(s,j,N,t){if(Tm(s)&&(s=s._as),Tm(j)&&(j=j._as),j&&j.length){N=N||uk;for(var R,W,B,S,o,h,d,T,c=[],L=F,e=0,P=0,V=j.length;V>P;P++)if(R=j[P],1===R)c.push(L=[]),L.push(s[e++]);else if(2===R)L.push(s[e++]);else if(3===R){for(W=L[L.length-1],B=s[e++],S=s[e++],h=1;N>h;h++)d=dd(h/N,W.x,B.x,S.x),T=dd(h/N,W.y,B.y,S.y),L.push({x:d,y:T,b:!0});L.push(S)}else if(4===R){for(W=L[L.length-1],B=s[e++],S=s[e++],o=s[e++],h=1;N>h;h++)d=Dm(h/N,W.x,B.x,S.x,o.x),T=Dm(h/N,W.y,B.y,S.y,o.y),L.push({x:d,y:T,b:!0});L.push(o)}else 5===R&&L.push(L[0]);return t&&5!==R&&L&&L.length>2&&L.push(L[0]),c}return t&&s.length>2&&(s=s.slice(),s.push(s[0])),s?[s]:[]},kq=function(x,L,K,J,g,N){var X,o,Y,T=Bm(L),m=J,Q=T[0],t=T[1],I=T[2];if(K){var E=Bm(K);X=E[0]-Q,o=E[1]-t,Y=E[2]-I}else X=255-Q,o=255-t,Y=255-I;for(N||(N=J>10?1:.5,N=1>g?B(N/g,2):N),x.save(),x.shadowOffsetX=0,x.shadowOffsetY=0,x.shadowBlur=0,x.shadowColor=0;(J-=N)>0;){var S=1-J/m,$=Q+X*S,f=t+o*S,p=I+Y*S;$=B(c($),255),f=B(c(f),255),p=B(c(p),255),x.strokeStyle="rgb("+$+","+f+","+p+")",x.lineWidth=J,x.stroke()}x.restore()},Oi=function(){if(Lp&&N){var H=N+""||Kh;Mk=H.indexOf(td.substr(0,2))>0&&H.indexOf(Ob+Ob.substr(1,1))>1?!0:!1}var Y={};return function(n,C){var V=n+"-"+C,O=Y[V];if(O)return O;var L,G,Z,x=Bm(n);return 0>C?(C=(100+C)/100,L=c(x[0]*C),G=c(x[1]*C),Z=c(x[2]*C)):(C/=100,L=x[0],G=x[1],Z=x[2],L+=(255-L)*C,G+=(255-G)*C,Z+=(255-Z)*C,L=B(c(L),255),G=B(c(G),255),Z=B(c(Z),255)),Y[V]="rgb("+L+","+G+","+Z+")"}}(),Qm=function(A,c,G,R,y,o){o&&(A.fillStyle=o),A.beginPath(),A.rect(c,G,R,y),A.fill()},Gr=function(B,K,d,C,m,H,f){B.beginPath(),Te[K](B,d.x,d.y,d.width,d.height,C,m,H,f)},Uf=function(W,Z,I,l,B){var z=Te[I];W.fillStyle=z?z(W,Z,l?l:Om,B.x,B.y,B.width,B.height):Z},Mq=function(F,I,W,g,S,b){F.fillStyle=jr(F,I,W,g,S,b)},hs=function(m,M,y,j,n,$){m.strokeStyle=jr(m,M,y,j,n,$)},jr=function(t,S,q,s,L,A){var c;try{if(!S.tagName&&S.comps){S._cacheImage_||(S._cacheImage_={});var v;v="override"===s?"colors_override":"override_rgb"===s?"colors_override_rgb":"override_a"===s?"colors_override_a":"colors",S._cacheImage_[v]||(S._cacheImage_[v]={__count__:0});var u=S._cacheImage_[v][q];u||(S._cacheImage_[v].__count__>C.imageCacheThreshold&&(S._cacheImage_[v]={__count__:0}),u=V.Default.toCanvas(S,ob(S),$n(S),null,L,A,q,null,s),S._cacheImage_[v][q]=u,S._cacheImage_[v].__count__++),S=u}c=t.createPattern(S,"repeat")}catch(D){c="black"}return c},on=function(t){var f,x,h=[],K=0,q=t.length;for(f=0;65>f;f++)h[f]=f;for(f=0;65>f;f++)K=(K+h[f]+t.charCodeAt(f%q))%65,x=h[f],h[f]=h[K],h[K]=x;for(f=0;65>f;f++)h[f]=xi[h[f]];return h.join("")},Lj=function(W){for(var M=8+Jr.randomInt(8),n=xi[8*Jr.randomInt(8)+(M-8)],$="",d=0;M>d;d++)$+=xi[Jr.randomInt(64)];var T=on($+X+As+Hm);return n+$+Pf.encode(W,T)},Ph=function(x){var Q=x[0],J=xi.indexOf(Q);if(0>J)return"";J=8+(7&J);var l=x.slice(1,1+J),T=on(l+X+As+Hm);
return Pf.decode(x,T,1+J)},ns=function(W,B,O,z,J,c,o){W.save(),W.translate(B,O),W.scale(1,o/c),W.arc(0,0,c,z,J),W.restore()},Vr=function(v,C,z,Z,X,H,w,o){var K,e,E,F,k,V,U,N,I,x,h;if(D(X)>2*Y&&(X=2*Y),k=c(D(X)/(Y/4)),K=X/k,e=-K,E=-Z,k>0){V=C+L(Z)*H,U=z+u(-Z)*w,o?v.lineTo(V,U):v.moveTo(V,U);for(var T=0;k>T;T++)E+=e,F=E-e/2,N=C+L(E)*H,I=z+u(E)*w,x=C+L(F)*(H/L(e/2)),h=z+u(F)*(w/L(e/2)),v.quadraticCurveTo(x,h,N,I)}},us=function(k,o,a,f,G,S,X,t,R){6===arguments.length&&(X=S,t=S,R=S);var b=o+f,B=a+G,i=G>f?2*f:2*G;S=i>S?S:i,X=i>X?X:i,t=i>t?t:i,R=i>R?R:i;var w=.29*R,v=.58*R;k.moveTo(b,B-R),k.quadraticCurveTo(b,B-v,b-w,B-w),k.quadraticCurveTo(b-v,B,b-R,B),w=.29*t,v=.58*t,k.lineTo(o+t,B),k.quadraticCurveTo(o+v,B,o+w,B-w),k.quadraticCurveTo(o,B-v,o,B-t),w=.29*S,v=.58*S,k.lineTo(o,a+S),k.quadraticCurveTo(o,a+v,o+w,a+w),k.quadraticCurveTo(o+v,a,o+S,a),w=.29*X,v=.58*X,k.lineTo(b-X,a),k.quadraticCurveTo(b-v,a,b-w,a+w),k.quadraticCurveTo(b,a+v,b,a+X),k.lineTo(b,B-R)},If=function(_,d,N,n,B,K,M){d&&(N=U(N),n=U(n),M||(M=1),_.fillStyle=d,_.beginPath(),_.rect(N,n,M,K),_.rect(N,n,B,M),K-M>0&&_.rect(N,n+K-M,B,M),B-M>0&&_.rect(N+B-M,n,M,K),_.fill())},fs=function(h,W,N,y){var A=y.x,n=y.y,s=y.width,l=y.height;if(!(!W||!N||0>=s||0>=l)){var c,f=zl(W),x=jn(W),z=N>0;1===N||-1===N?(h.fillStyle=z?f:x,h.beginPath(),h.rect(A,n,1,l),h.rect(A,n,s,1),h.fill(),h.fillStyle=z?x:f,h.beginPath(),h.rect(A,n+l-1,s,1),h.rect(A+s-1,n,1,l),h.fill()):(N=B(D(N),B(s/2,l/2)),c=h.createLinearGradient(A,n,A+N,n),c.addColorStop(0,z?f:x),c.addColorStop(1,W),h.fillStyle=c,h.beginPath(),h.moveTo(A,n),h.lineTo(A+N,n+N),h.lineTo(A+N,n+l-N),h.lineTo(A,n+l),h.lineTo(A,n),h.fill(),c=h.createLinearGradient(A,n,A,n+N),c.addColorStop(0,z?f:x),c.addColorStop(1,W),h.fillStyle=c,h.beginPath(),h.moveTo(A,n),h.lineTo(A+N,n+N),h.lineTo(A+s-N,n+N),h.lineTo(A+s,n),h.lineTo(A,n),h.fill(),c=h.createLinearGradient(A,n+l,A,n+l-N),c.addColorStop(0,z?x:f),c.addColorStop(1,W),h.fillStyle=c,h.beginPath(),h.moveTo(A,n+l),h.lineTo(A+N,n+l-N),h.lineTo(A+s-N,n+l-N),h.lineTo(A+s,n+l),h.lineTo(A,n+l),h.fill(),c=h.createLinearGradient(A+s,n,A+s-N,n),c.addColorStop(0,z?x:f),c.addColorStop(1,W),h.fillStyle=c,h.beginPath(),h.moveTo(A+s,n),h.lineTo(A+s-N,n+N),h.lineTo(A+s-N,n+l-N),h.lineTo(A+s,n+l),h.lineTo(A+s,n),h.fill())}},om=function(h,S,W,x,D,M,X){var o=h.createLinearGradient(x,D,M,X);return o.addColorStop(0,W),o.addColorStop(1,S),o},gp=function($,S,K,A,z,Z,V){var g=$.createLinearGradient(A,z,Z,V);return g.addColorStop(0,S),g.addColorStop(.5,K),g.addColorStop(1,S),g},Qh=function(u,g,R,t,Q,N,$){var n=u.createLinearGradient(t,Q,N,$);return n.addColorStop(0,g),n.addColorStop(1/3,R),n.addColorStop(2/3,g),n.addColorStop(1,R),n},Kc=function(Z,P,j,V,u,e,q,r,l){var p=Z.createRadialGradient(V+e*r,u+q*l,B(e,q)/24,V+e/2,u+q/2,i(e,q)/2);return p.addColorStop(0,j),p.addColorStop(1,P),p},qg=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Te={polygon:function(y,b,$,X,U,w){(w==F||3>w)&&(w=6);for(var t,E,I=B(X,U)/2,m=b+X/2,o=$+U/2,H=0,z=2*Y/w,q=0;w>q;q++)t=m+L(H)*I,E=o+u(H)*I,0===q?y.moveTo(t,E):y.lineTo(t,E),H+=z;y.closePath()},arc:function(b,R,U,H,S,P,T,s,G){P==F&&(P=Y),T==F&&(T=E),s==F&&(s=!0);var $=R+H/2,N=U+S/2;s&&b.moveTo($,N),G?ns(b,$,N,P,T,H/2,S/2):b.arc($,N,B(H,S)/2,P,T),s&&b.closePath()},rect:function(y,C,q,x,$){y.rect(C,q,x,$)},circle:function(U,N,c,t,b){U.arc(N+t/2,c+b/2,B(t,b)/2,0,E,!0)},oval:function(Q,O,P,T,u){ns(Q,O+T/2,P+u/2,0,E,T/2,u/2)},roundRect:function(U,c,v,H,P,S){S==F&&(S=B(B(H,P)/4,8)),us(U,c,v,H,P,S)},star:function(h,I,E,K,O){var Z=2*K,M=2*O,N=I+K/2,w=E+O/2;h.moveTo(N-Z/4,w-M/12),h.lineTo(I+.306*K,E+.579*O),h.lineTo(N-Z/6,w+M/4),h.lineTo(I+K/2,E+.733*O),h.lineTo(N+Z/6,w+M/4),h.lineTo(I+.693*K,E+.579*O),h.lineTo(N+Z/4,w-M/12),h.lineTo(I+.611*K,E+.332*O),h.lineTo(N+0,w-M/4),h.lineTo(I+.388*K,E+.332*O),h.closePath()},pentagram:function(B,t,Z,W,q){var C=.5*q,_=t+.5*W,n=Z+C,g=.5257311121191336*W;g>C&&(g=C);var V=qg,Y=0;for(B.moveTo(_+g*V[Y++],n+g*V[Y++]);20>Y;)B.lineTo(_+g*V[Y++],n+g*V[Y++]);B.closePath()},triangle:function(d,W,R,J,E){d.moveTo(W+J/2,R),d.lineTo(W+J,R+E),d.lineTo(W,R+E),d.closePath()},hexagon:function(D,i,F,K,v){D.moveTo(i,F+v/2),D.lineTo(i+K/4,F+v),D.lineTo(i+3*K/4,+F+v),D.lineTo(i+K,F+v/2),D.lineTo(i+3*K/4,F),D.lineTo(i+K/4,F),D.closePath()},pentagon:function(j,y,v,T,Y){var e=2*T,r=2*Y,V=y+T/2,Z=v+Y/2;j.moveTo(V-e/4,Z-r/12),j.lineTo(V-e/6,Z+r/4),j.lineTo(V+e/6,Z+r/4),j.lineTo(V+e/4,Z-r/12),j.lineTo(V+0,Z-r/4),j.closePath()},diamond:function(H,C,F,l,D){H.moveTo(C+l/2,F),H.lineTo(C,F+D/2),H.lineTo(C+l/2,F+D),H.lineTo(C+l,F+D/2),H.closePath()},rightTriangle:function(F,D,$,K,n){F.moveTo(D,$),F.lineTo(D+K,$+n),F.lineTo(D,$+n),F.closePath()},parallelogram:function(x,m,y,E,g){var d=E/4;x.moveTo(m+d,y),x.lineTo(m+E,y),x.lineTo(m+E-d,y+g),x.lineTo(m,y+g),x.closePath()},trapezoid:function(k,F,n,m,i){var K=m/4;k.moveTo(F+K,n),k.lineTo(F+m-K,n),k.lineTo(F+m,n+i),k.lineTo(F,n+i),k.closePath()},"linear.southwest":function(h,f,Z,$,Y,G,V){return om(h,f,Z,$,Y+V,$+G,Y)},"linear.southeast":function(A,I,E,f,l,s,t){return om(A,I,E,f+s,l+t,f,l)},"linear.northwest":function(X,N,k,G,g,p,y){return om(X,N,k,G,g,G+p,g+y)},"linear.northeast":function(w,l,M,o,N,K,e){return om(w,l,M,o+K,N,o,N+e)},"linear.north":function(c,F,y,G,Y,o,E){return om(c,F,y,G,Y,G,Y+E)},"linear.south":function(b,M,$,T,W,F,B){return om(b,M,$,T,W+B,T,W)},"linear.west":function(O,o,I,V,T,Y){return om(O,o,I,V,T,V+Y,T)},"linear.east":function(J,r,U,p,u,d){return om(J,r,U,p+d,u,p,u)},"radial.center":function(T,m,k,U,q,Q,t){return Kc(T,m,k,U,q,Q,t,.5,.5)},"radial.southwest":function(B,f,t,D,O,b,e){return Kc(B,f,t,D,O,b,e,.25,.75)},"radial.southeast":function(m,F,h,M,S,I,x){return Kc(m,F,h,M,S,I,x,.75,.75)},"radial.northwest":function(r,x,S,e,w,F,j){return Kc(r,x,S,e,w,F,j,.25,.25)},"radial.northeast":function(x,K,X,F,V,e,i){return Kc(x,K,X,F,V,e,i,.75,.25)},"radial.north":function(b,A,j,m,W,G,g){return Kc(b,A,j,m,W,G,g,.5,.25)},"radial.south":function(S,o,r,g,$,X,k){return Kc(S,o,r,g,$,X,k,.5,.75)},"radial.west":function(v,H,m,K,p,W,T){return Kc(v,H,m,K,p,W,T,.25,.5)},"radial.east":function(z,Q,m,t,p,v,N){return Kc(z,Q,m,t,p,v,N,.75,.5)},"spread.horizontal":function(g,v,F,M,j,d){return gp(g,v,F,M,j,M+d,j)},"spread.vertical":function(j,m,d,I,N,L,D){return gp(j,m,d,I,N,I,N+D)},"spread.diagonal":function(x,r,n,w,R,c,W){return gp(x,r,n,w+c,R,w,R+W)},"spread.antidiagonal":function(R,s,J,B,V,g,o){return gp(R,s,J,B,V,B+g,V+o)},"spread.north":function(X,I,z,D,B,Y,x){return Qh(X,I,z,D,B-x/4,D,B+x+x/4)},"spread.south":function(p,N,h,a,P,u,X){return Qh(p,h,N,a,P-X/4,a,P+X+X/4)},"spread.west":function(K,J,e,T,$,u){return Qh(K,J,e,T-u/4,$,T+u+u/4,$)},"spread.east":function(n,T,$,J,U,t){return Qh(n,$,T,J-t/4,U,J+t+t/4,U)}},hm=function(k,U,B){return new Ai(k).tf(U,B)},Ce=function($){var e=$.touches[0],z=$.touches[1],X=e.clientX,p=e.clientY,P=z.clientX,L=z.clientY;return A((X-P)*(X-P)+(p-L)*(p-L))},uf=function(d){var $=d.touches[0],K=d.touches[1],j=$.clientX,w=$.clientY,t=K.clientX,p=K.clientY;return{x:(j+t)/2,y:(w+p)/2}},Dc=(function(){for(var C=0,S=Ug.split(""),K=0;K<S.length;K++)C=10*Pq(S[K])+C;return xd(b[gk.toString(8*K)+Mi.substr(K)+3],b[gk.toString(8*K)+Mi.substr(K)+4]),C}(),function(r,G,j){for(var J=0;J<j.size();J++){var B=j.get(J);r.co(B)&&G.add(B)}for(J=0;J<j.size();J++)B=j.get(J),Dc(r,G,B._children)}),Md=function(I,w,c){for(var j=0;j<c.size();j++){var p=c.get(c.size()-1-j);I.co(p)&&w.add(p)}for(j=0;j<c.size();j++)p=c.get(j),Md(I,w,p._children)},wp=function(E,L,g){for(var m=!1,p=0;p<g.size();p++){var z=g.get(p);E.co(z)?m&&L.add(z):m=1}for(p=0;p<g.size();p++)z=g.get(p),wp(E,L,z._children)},Ci=function(K,x,B){for(var c=!1,r=0;r<B.size();r++){var P=B.get(B.size()-1-r);K.co(P)?c&&x.add(P):c=!0}for(r=0;r<B.size();r++)P=B.get(r),Ci(K,x,P._children)},mr=C.moveDatas=function(Q,O,v,Y){var o=Y==F;if(0!==O||0!==v||!o&&0!==Y){var A=!0,g=[];if(Q.forEach(function(c){A&&(c._69O||Qb(c)||Pl(c))&&(A=!1)}),A)g=Q;else{var t={},u={};Q.forEach(function(H){t[H._id]=!0});var $={},w=function(A){var G=A._id;return t[G]?(g.push(A),$[G]=!0):$[G]=!1},q=function(K){var P=K._id;if(u[P])return w(K);var J=$[P];if(J!==_)return J;var j=K._parent;if(j&&(Pl(j)||Qb(j))&&q(j))return $[P]=!0;var C=K._host;return C&&(u[P]=P,J=q(C),u[P]=_,J)?$[P]=!0:w(K)};Q.forEach(function(C){q(C)})}g.forEach(function(d){if(be(d))o?d.translate(O,v):d.translate3d(O,v,Y);else{var g=d.s(rn);if(!g||g.isEmpty())return;var p=new _n;g.each(function(m){m=Hq(m),o?(m.x+=O,m.y+=v):(m.x+=O,m.y+=Y,m.e==F?m.e=v:m.e+=v),p.add(m)}),d.s(rn,p)}})}},Yh=function(){function C($,Y){return Y===$.substring(0,Y.length)?!0:!1}function l(u){return parseFloat(u)||0}function U(N,c){if(c==_&&(c=new bf),C(N,"matrix3d")){var u=N.substring(9,N.length-1).split(",");u=u.map(l),c.fromArray(u)}else if(C(N,"matrix")){var u=N.substring(7,N.length-1).split(",");u=u.map(l),c.el[0]=u[0],c.el[1]=u[1],c.el[2]=0,c.el[3]=0,c.el[4]=u[2],c.el[5]=u[3],c.el[6]=0,c.el[7]=0,c.el[8]=0,c.el[9]=0,c.el[10]=1,c.el[11]=0,c.el[12]=u[4],c.el[13]=u[5],c.el[14]=0,c.el[15]=1}return c}function B(x,z){z==_&&(z=new io);var I=x.split(/\s+/);return I=I.map(l),z.set(I[0]||0,I[1]||0,I[2]||0),z}var a,n,G,h,P,O=function(v,N){a||(a=new bf,n=new io,G=new bf,h=new bf,P=new bf),N==_&&(N=new bf);var R=getComputedStyle(v);R.transform&&"none"!==R.transform&&(U(R.transform,a),B(R.transformOrigin,n),h.setPosition(n),n.negate(),P.setPosition(n),(Ic||"preserve-3d"!==R.transformStyle)&&(a.el[8]=0,a.el[9]=0,a.el[10]=1,a.el[11]=0),N.multiplyMatrices(P,N),N.multiplyMatrices(a,N),N.multiplyMatrices(h,N)),!Ic&&R.perspective&&"none"!==R.perspective&&(G.el[11]=-1/l(R.perspective),B(R.perspectiveOrigin,n),h.setPosition(n),n.negate(),P.setPosition(n),N.multiplyMatrices(P,N),N.multiplyMatrices(G,N),N.multiplyMatrices(h,N));for(var s=v.offsetParent,g=v.offsetLeft,D=v.offsetTop,r=v.parentElement;r&&r!==s;){var F=getComputedStyle(r);if("none"!==F.transform||"none"!==F.perspective)break;r=r.parentElement}return r==_&&v!==v.ownerDocument.documentElement&&"fixed"!==R.position&&(r=v.ownerDocument.documentElement),s!=_&&s!==r&&(g-=r.offsetLeft,D-=r.offsetTop),n.set(g,D,0),h.setPosition(n),N.multiplyMatrices(h,N),r&&O(r,N),N};return function(S,i){var L=S.parentElement;if(L){var q=L.updateAppendMatrix;if(q){delete L.updateAppendMatrix;var m=new bf;O(L,m);var k=new bf;k.getInverse(m),L._matrixAppend=k,L._maxrixPreAppend=m}return i?L._matrixAppend:L._maxrixPreAppend}}}(),yo=function(V,Q){for(;V&&!V.hasOwnProperty(Q);)V=f.getPrototypeOf(V);return V&&f.getOwnPropertyDescriptor(V,Q)},eq=f.getPrototypeOf?function(N,Z,v){var l=yo(Z,v);l&&f.defineProperty(N,v,l)}:function(R,j,n){R[n]=j[n]},xh={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Vf=function(){var q={1:function(z,I){return{x:z.x-I.width/2,y:z.y-I.height/2}},2:function(B,Z){return{x:B.x+Z.width/2,y:B.y-Z.height/2}},3:function(y,N){return{x:y.x+y.width/2,y:y.y-N.height/2}},4:function(W,o){return{x:W.x+W.width-o.width/2,y:W.y-o.height/2}},5:function(Y,V){return{x:Y.x+Y.width+V.width/2,y:Y.y-V.height/2}},6:function(t){return{x:t.x,y:t.y}},7:function(z){return{x:z.x+z.width/2,y:z.y}},8:function(x){return{x:x.x+x.width,y:x.y}},9:function(N,f){return{x:N.x-f.width/2,y:N.y+f.height/2}},10:function(S,h){return{x:S.x+h.width/2,y:S.y+h.height/2}},11:function(b,V){return{x:b.x+b.width/2,y:b.y+V.height/2}},12:function(g,Y){return{x:g.x-Y.width/2+g.width,y:g.y+Y.height/2}},13:function(c,R){return{x:c.x+c.width+R.width/2,y:c.y+R.height/2}},14:function(T,J){return{x:T.x-J.width/2,y:T.y+T.height/2}},15:function(L){return{x:L.x,y:L.y+L.height/2}},16:function(R,W){return{x:R.x+W.width/2,y:R.y+R.height/2}},17:function(M){return{x:M.x+M.width/2,y:M.y+M.height/2}},18:function(h,_){return{x:h.x+h.width-_.width/2,y:h.y+h.height/2}},19:function(J){return{x:J.x+J.width,y:J.y+J.height/2}},20:function(D,F){return{x:D.x+D.width+F.width/2,y:D.y+D.height/2}},21:function(W,y){return{x:W.x-y.width/2,y:W.y+W.height-y.height/2}},22:function(h,R){return{x:h.x+R.width/2,y:h.y+h.height-R.height/2}},23:function(r,Q){return{x:r.x+r.width/2,y:r.y+r.height-Q.height/2}},24:function(J,C){return{x:J.x+J.width-C.width/2,y:J.y+J.height-C.height/2}},25:function(r,X){return{x:r.x+r.width+X.width/2,y:r.y+r.height-X.height/2}},26:function(I){return{x:I.x,y:I.y+I.height}},27:function(s){return{x:s.x+s.width/2,y:s.y+s.height}},28:function(b){return{x:b.x+b.width,y:b.y+b.height}},29:function(Q,E){return{x:Q.x-E.width/2,y:Q.y+Q.height+E.height/2}},30:function(Q,V){return{x:Q.x+V.width/2,y:Q.y+Q.height+V.height/2}},31:function(U,Y){return{x:U.x+U.width/2,y:U.y+U.height+Y.height/2}},32:function(X,l){return{x:X.x+X.width-l.width/2,y:X.y+X.height+l.height/2}},33:function(k,O){return{x:k.x+k.width+O.width/2,y:k.y+k.height+O.height/2}},34:function(n,z){return{x:n.x,y:n.y-z.height/2}},35:function(V,_){return{x:V.x+V.width,y:V.y-_.height/2}},36:function(Y,n){return{x:Y.x,y:Y.y+Y.height+n.height/2}},37:function(A,b){return{x:A.x+A.width,y:A.y+A.height+b.height/2}},38:function(b,S){return{x:b.x+b.width/4,y:b.y-S.height/2}},39:function(k,R){return{x:k.x+3*k.width/4,y:k.y-R.height/2}},40:function(h){return{x:h.x+h.width/4,y:h.y}},41:function(i){return{x:i.x+3*i.width/4,y:i.y}},42:function(T,O){return{x:T.x+T.width/4,y:T.y+O.height/2}},43:function($,N){return{x:$.x+3*$.width/4,y:$.y+N.height/2}},44:function(g,s){return{x:g.x+g.width/2,y:g.y+g.height/2-s.height/2}},45:function(J){return{x:J.x+J.width/4,y:J.y+J.height/2}},46:function(E,H){return{x:E.x+E.width/2-H.width/2,y:E.y+E.height/2}},47:function(b,E){return{x:b.x+b.width/2+E.width/2,y:b.y+b.height/2}},48:function(O){return{x:O.x+3*O.width/4,y:O.y+O.height/2}},49:function(G,c){return{x:G.x+G.width/2,y:G.y+G.height/2+c.height/2}},50:function(l,Z){return{x:l.x+l.width/4,y:l.y+l.height-Z.height/2}},51:function(T,M){return{x:T.x+3*T.width/4,y:T.y+T.height-M.height/2}},52:function(J){return{x:J.x+J.width/4,y:J.y+J.height}},53:function(o){return{x:o.x+3*o.width/4,y:o.y+o.height}},54:function(L,l){return{x:L.x+L.width/4,y:L.y+L.height+l.height/2}},55:function(Q,x){return{x:Q.x+3*Q.width/4,y:Q.y+Q.height+x.height/2}}};return nc(b)?function(X,U,E){return q[X](U,E?E:wq)}:void 0}();Xf(S,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var oo=S.reverse,Qi=S.transparent,Nf=S.rectSelectBackground,lf=S.dash,Vb=S.titleBackground,xn=S.titleIconBackground,Jd=S.headerBackground,qr=S.headerIconBackground,Ff=S.headerSeparator,oh=S.headerLine,jm=S.contentIconBackground,Fq=S.contentLine,Mc=(S.widgetIconHighlight,S.widgetIconBorder),Bd=(S.widgetIconGradient,S.imageBackground),Om=S.imageGradient,vl=S.highlight,hi=S.label,Hh=S.labelSelect;if(xm&&!b.shutAlert1){var wr=new Date,Gp=xm.split("-"),Ap=new Date(wr.getFullYear(),wr.getMonth(),wr.getDate()),xm=new Date(Pq(Gp[0],10),Pq(Gp[1],10)-1,Pq(Gp[2],10)),Cb=Ap.getTime(),Jg=xm.getTime(),Cg=X+"_try",_m=b.alert;try{var Of=b.localStorage;if(Of&&_m)if(Jg>Cb&&1728e6>Jg-Cb){var bo=(Jg-Cb)/864e5;Of&&Of[Cg]!=bo&&(Of[Cg]=bo,b.htWillExpire?_m(b.htWillExpire.replace("{{day}}",bo)):_m("HT for Web free trial license will expire in "+bo+" days, please apply for a new license!"))}else Cb>=Jg&&(b.htExpired?_m(b.htExpired):_m("Your free trial of HT for Web has expired!")),Of&&delete Of[Cg]}catch(Rc){}}Math.sign===_&&(Math.sign=function(M){return 0>M?-1:M>0?1:+M});var xi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Pf={encode:function(n,U){var E,Y,W,m,P,i,C,e="",$=0;for(n=unescape(encodeURIComponent(n));$<n.length;)E=n.charCodeAt($++),Y=n.charCodeAt($++),W=n.charCodeAt($++),m=E>>2,P=(3&E)<<4|Y>>4,i=(15&Y)<<2|W>>6,C=63&W,isNaN(Y)?i=C=64:isNaN(W)&&(C=64),e=e+U.charAt(m)+U.charAt(P)+U.charAt(i)+U.charAt(C);return e},decode:function(A,w,T){for(var y,l,W,G,s,_,m,E="",R=T||0;R<A.length;)G=w.indexOf(A.charAt(R++)),s=w.indexOf(A.charAt(R++)),_=w.indexOf(A.charAt(R++)),m=w.indexOf(A.charAt(R++)),y=G<<2|s>>4,l=(15&s)<<4|_>>2,W=(3&_)<<6|m,E+=String.fromCharCode(y),64!=_&&(E+=String.fromCharCode(l)),64!=m&&(E+=String.fromCharCode(W));return E=decodeURIComponent(escape(E))},_utf8_encode:function(U){U=U.replace(/\r\n/g,"\n");for(var j="",K=0;K<U.length;K++){var c=U.charCodeAt(K);128>c?j+=String.fromCharCode(c):c>127&&2048>c?(j+=String.fromCharCode(192|c>>6),j+=String.fromCharCode(128|63&c)):(j+=String.fromCharCode(224|c>>12),j+=String.fromCharCode(128|63&c>>6),j+=String.fromCharCode(128|63&c))}return j},_utf8_decode:function(I){for(var T="",c=0,h=0,k=0,b=0;c<I.length;)h=I.charCodeAt(c),128>h?(T+=String.fromCharCode(h),c++):h>191&&224>h?(k=I.charCodeAt(c+1),T+=String.fromCharCode((31&h)<<6|63&k),c+=2):(k=I.charCodeAt(c+1),b=I.charCodeAt(c+2),T+=String.fromCharCode((15&h)<<12|(63&k)<<6|63&b),c+=3);return T}},le=[],kr=[],Jr=V.Math={generateUUID:function(){for(var v=[],_=0;256>_;_++)v[_]=(16>_?"0":"")+_.toString(16).toUpperCase();return function(){var I=0|4294967295*Math.random(),O=0|4294967295*Math.random(),f=0|4294967295*Math.random(),j=0|4294967295*Math.random();return v[255&I]+v[255&I>>8]+v[255&I>>16]+v[255&I>>24]+"-"+v[255&O]+v[255&O>>8]+"-"+v[64|15&O>>16]+v[255&O>>24]+"-"+v[128|63&f]+v[255&f>>8]+"-"+v[255&f>>16]+v[255&f>>24]+v[255&j]+v[255&j>>8]+v[255&j>>16]+v[255&j>>24]}}(),clamp:function(c,z,f){return Math.max(z,Math.min(f,c))},generateIncreasingID:function(){var T=0;return function(){return++T}}(),encodeBase64:function(s,d){return Pf.encode(s,d||xi)},decodeBase64:function(q,e){return Pf.decode(q,e||xi)},randomArray:function(P,r){r=r||P.length;for(var Q=r-1;Q>0;Q--){var R=Math.floor(Math.random()*(Q+1)),M=P[Q];P[Q]=P[R],P[R]=M}return P},randomInt:function(R,k){return k===_&&(k=R,R=0),R+Math.floor(Math.random()*(k-R))},isPOT:function(P){return P>0&&0===(P-1&P)},nearestPOT:function(A){if(!A)return 1;var k=A;k--,k|=k>>1,k|=k>>2,k|=k>>4,k|=k>>8,k|=k>>16,k++;var c=k>>1;return A-c>k-A?k:c},requestMatrix4:function(){return le.length>0?le.pop():new Jr.Matrix4},releaseMatrix4:function(B){le.push(B)},requestVector3:function(){return kr.length>0?kr.pop():new Jr.Vector3},releaseVector3:function(V){kr.push(V)}},Mm=V.Matrix=V.Math.Matrix2d=function(u,P,M,r,S){this.setFromTransform(u,P,M,r,S)},Ai=Mm;Mm.prototype={},Mm.prototype.constructor=Mm,Mm.prototype.set=function(O,e,H,k,K,V){return this.a=O,this.b=e,this.c=H,this.d=k,this.tx=K,this.ty=V,this},Mm.prototype.setFromTransform=function(A,K,l,p,w){var $=this;if(A===_)return $.a=1,$.b=0,$.c=0,$.d=1,$.tx=0,$.ty=0,void 0;var W,n;return A?(W=u(A),n=L(A)):(W=0,n=1),p=p||1,w=w||1,$.a=n*p,$.b=W*p,$.c=-W*w,$.d=n*w,$.tx=K||0,$.ty=l||0,$},Mm.prototype.apply=function(P,w){w=w||new Go;var r=P.x,p=P.y;return w.x=this.a*r+this.c*p+this.tx,w.y=this.b*r+this.d*p+this.ty,w},Mm.prototype.applyInverse=function(X,h){h=h||new Go;var R=1/(this.a*this.d+this.c*-this.b),j=X.x,e=X.y;return h.x=this.d*R*j+-this.c*R*e+(this.ty*this.c-this.tx*this.d)*R,h.y=this.a*R*e+-this.b*R*j+(-this.ty*this.a+this.tx*this.b)*R,h},Mm.prototype.translate=function(k,d){return this.tx+=k,this.ty+=d,this},Mm.prototype.scale=function(U,O){return this.a*=U,this.d*=O,this.c*=U,this.b*=O,this.tx*=U,this.ty*=O,this},Mm.prototype.rotate=function(M){var g=Math.cos(M),J=Math.sin(M),F=this.a,H=this.c,r=this.tx;return this.a=F*g-this.b*J,this.b=F*J+this.b*g,this.c=H*g-this.d*J,this.d=H*J+this.d*g,this.tx=r*g-this.ty*J,this.ty=r*J+this.ty*g,this},Mm.prototype.appendTranslate=function(N,a){return this.tx+=this.a*N+this.c*a,this.ty+=this.b*N+this.d*a,this},Mm.prototype.appendScale=function(j,C){return this.a*=j,this.d*=C,this.c*=C,this.b*=j,this},Mm.prototype.appendRotate=function(L){if(!L)return this;var v=Math.cos(L),J=Math.sin(L),V=this.a,Y=this.b;return this.a=V*v+this.c*J,this.b=Y*v+this.d*J,this.c=-V*J+this.c*v,this.d=-Y*J+this.d*v,this},Mm.prototype.append=function(N){var M=this.a,H=this.b,t=this.c,U=this.d;return this.a=N.a*M+N.b*t,this.b=N.a*H+N.b*U,this.c=N.c*M+N.d*t,this.d=N.c*H+N.d*U,this.tx=N.tx*M+N.ty*t+this.tx,this.ty=N.tx*H+N.ty*U+this.ty,this},Mm.prototype.setTransform=function($,i,h,R,W,K,x,G,d){var m,q,k,E,y,M,U,V,D,S;return y=Math.sin(x),M=Math.cos(x),U=Math.cos(d),V=Math.sin(d),D=-Math.sin(G),S=Math.cos(G),m=M*W,q=y*W,k=-y*K,E=M*K,this.a=U*m+V*k,this.b=U*q+V*E,this.c=D*m+S*k,this.d=D*q+S*E,this.tx=$+(h*m+R*k),this.ty=i+(h*q+R*E),this},Mm.prototype.prepend=function(T){var j=this.tx;if(1!==T.a||0!==T.b||0!==T.c||1!==T.d){var $=this.a,W=this.c;this.a=$*T.a+this.b*T.c,this.b=$*T.b+this.b*T.d,this.c=W*T.a+this.d*T.c,this.d=W*T.b+this.d*T.d}return this.tx=j*T.a+this.ty*T.c+T.tx,this.ty=j*T.b+this.ty*T.d+T.ty,this},Mm.prototype.transform=Mm.prototype.prepend,Mm.prototype.invert=function(){var N=this.a,w=this.b,h=this.c,a=this.d,o=this.tx,R=N*a-w*h;return this.a=a/R,this.b=-w/R,this.c=-h/R,this.d=N/R,this.tx=(h*this.ty-a*o)/R,this.ty=-(N*this.ty-w*o)/R,this},Mm.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Mm.prototype.clone=function(){var m=new Mm;return m.a=this.a,m.b=this.b,m.c=this.c,m.d=this.d,m.tx=this.tx,m.ty=this.ty,m},Mm.prototype.copy=function(D){return D.a=this.a,D.b=this.b,D.c=this.c,D.d=this.d,D.tx=this.tx,D.ty=this.ty,D},Mm.prototype.tf=function(l,S){1===arguments.length&&(S=l.y,l=l.x);var J=this;return{x:J.a*l+J.c*S+J.tx,y:J.b*l+J.d*S+J.ty}},Mm.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Mm.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Mm.prototype.tfi=function(D,K){1===arguments.length&&(K=D.y,D=D.x);var z=this,g=1/(z.a*z.d+z.c*-z.b);return{x:z.d*g*D+-z.c*g*K+(z.ty*z.c-z.tx*z.d)*g,y:z.a*g*K+-z.b*g*D+(-z.ty*z.a+z.tx*z.b)*g}},Mm.IDENTITY=new Mm,Mm.TEMP_MATRIX=new Mm;var Cj=V.Math.Quaternion=function(A,s,g,f){this.set(A,s,g,f)};f.assign(Cj.prototype,{set:function(J,Z,z,k){var e=this;return e._x=J||0,e._y=Z||0,e._z=z||0,e._w=k!==_?k:1,e},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(k){var C=this;return C._x=k._x,C._y=k._y,C._z=k._z,C._w=k._w,C},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var d=this.length();return 0===d?(this._x=0,this._y=0,this._z=0,this._w=1):(d=1/d,this._x=this._x*d,this._y=this._y*d,this._z=this._z*d,this._w=this._w*d),this},fromArray:function(C,V){V===_&&(V=0);var e=this;return e._x=C[V],e._y=C[V+1],e._z=C[V+2],e._w=C[V+3],this},slerp:function(Z,D){if(0===D)return this;if(1===D)return this.copy(Z);var _=this._x,y=this._y,r=this._z,w=this._w,W=w*Z._w+_*Z._x+y*Z._y+r*Z._z;if(0>W?(this._w=-Z._w,this._x=-Z._x,this._y=-Z._y,this._z=-Z._z,W=-W):this.copy(Z),W>=1)return this._w=w,this._x=_,this._y=y,this._z=r,this;var T=Math.sqrt(1-W*W);if(Math.abs(T)<.001)return this._w=.5*(w+this._w),this._x=.5*(_+this._x),this._y=.5*(y+this._y),this._z=.5*(r+this._z),this;var X=Math.atan2(T,W),E=Math.sin((1-D)*X)/T,C=Math.sin(D*X)/T;return this._w=w*E+this._w*C,this._x=_*E+this._x*C,this._y=y*E+this._y*C,this._z=r*E+this._z*C,this},setFromAxisAngle:function(u,d){var W=d/2,V=Math.sin(W);return this._x=u.x*V,this._y=u.y*V,this._z=u.z*V,this._w=Math.cos(W),this},setFromEuler:function(s){var z=s._x,E=s._y,n=s._z,N=s._order,C=Math.cos,h=Math.sin,T=C(z/2),i=C(E/2),P=C(n/2),g=h(z/2),b=h(E/2),Q=h(n/2);return"XYZ"===N?(this._x=g*i*P+T*b*Q,this._y=T*b*P-g*i*Q,this._z=T*i*Q+g*b*P,this._w=T*i*P-g*b*Q):"YXZ"===N?(this._x=g*i*P+T*b*Q,this._y=T*b*P-g*i*Q,this._z=T*i*Q-g*b*P,this._w=T*i*P+g*b*Q):"ZXY"===N?(this._x=g*i*P-T*b*Q,this._y=T*b*P+g*i*Q,this._z=T*i*Q+g*b*P,this._w=T*i*P-g*b*Q):"ZYX"===N?(this._x=g*i*P-T*b*Q,this._y=T*b*P+g*i*Q,this._z=T*i*Q-g*b*P,this._w=T*i*P+g*b*Q):"YZX"===N?(this._x=g*i*P+T*b*Q,this._y=T*b*P+g*i*Q,this._z=T*i*Q-g*b*P,this._w=T*i*P-g*b*Q):"XZY"===N&&(this._x=g*i*P-T*b*Q,this._y=T*b*P-g*i*Q,this._z=T*i*Q+g*b*P,this._w=T*i*P+g*b*Q),this},setFromRotationMatrix:function(_){var P,H=_.el,D=H[0],N=H[4],p=H[8],G=H[1],z=H[5],F=H[9],S=H[2],O=H[6],J=H[10],L=D+z+J;return L>0?(P=.5/Math.sqrt(L+1),this._w=.25/P,this._x=(O-F)*P,this._y=(p-S)*P,this._z=(G-N)*P):D>z&&D>J?(P=2*Math.sqrt(1+D-z-J),this._w=(O-F)/P,this._x=.25*P,this._y=(N+G)/P,this._z=(p+S)/P):z>J?(P=2*Math.sqrt(1+z-D-J),this._w=(p-S)/P,this._x=(N+G)/P,this._y=.25*P,this._z=(F+O)/P):(P=2*Math.sqrt(1+J-D-z),this._w=(G-N)/P,this._x=(p+S)/P,this._y=(F+O)/P,this._z=.25*P),this},setFromToVectors:function(){var A,F;return function(L,N){return A===_&&(A=new io),F=L.dot(N)+1,1e-7>F?(F=0,Math.abs(L.x)>Math.abs(L.z)?A.set(-L.y,L.x,0):A.set(0,-L.z,L.y)):A.crossVectors(L,N),this._x=A.x,this._y=A.y,this._z=A.z,this._w=F,this.normalize()}}(),setFromUnitVectors:function(){var d,j,b=1e-6;return function(o,L){return d===_&&(d=new io),j=o.dot(L)+1,b>j?(j=0,Math.abs(o.x)>Math.abs(o.z)?d.set(-o.y,o.x,0):d.set(0,-o.z,o.y)):d.crossVectors(o,L),this._x=d.x,this._y=d.y,this._z=d.z,this._w=j,this.normalize()}}(),multiply:function(J){return this.multiplyQuaternions(this,J)},premultiply:function(p){return this.multiplyQuaternions(p,this)},multiplyQuaternions:function(U,x){var j=U._x,m=U._y,q=U._z,D=U._w,w=x._x,b=x._y,e=x._z,_=x._w;return this._x=j*_+D*w+m*e-q*b,this._y=m*_+D*b+q*w-j*e,this._z=q*_+D*e+j*b-m*w,this._w=D*_-j*w-m*b-q*e,this},toArray:function(v,h){return v||(v=[]),h=h||0,v[h]=this._x,v[h+1]=this._y,v[h+2]=this._z,v[h+3]=this._w,v}});var Zf=V.Math.Vector4=function(r,m,Q,g){this.x=r||0,this.y=m||0,this.z=Q||0,this.w=g!==_?g:1};f.assign(Zf.prototype,{isVector4:!0,set:function(p,n,S,s){return this.x=p,this.y=n,this.z=S,this.w=s,this},setScalar:function(W){return this.x=W,this.y=W,this.z=W,this.w=W,this},setX:function(x){return this.x=x,this},setY:function(_){return this.y=_,this},setZ:function(l){return this.z=l,this},setW:function(h){return this.w=h,this},setComponent:function(m,H){switch(m){case 0:this.x=H;break;case 1:this.y=H;break;case 2:this.z=H;break;case 3:this.w=H;break;default:throw new Error("index is out of range: "+m)}return this},getComponent:function(T){switch(T){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+T)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(y){return this.x=y.x,this.y=y.y,this.z=y.z,this.w=y.w!==_?y.w:1,this},add:function(m,t){return t!==_?this.addVectors(m,t):(this.x+=m.x,this.y+=m.y,this.z+=m.z,this.w+=m.w,this)},addScalar:function(Q){return this.x+=Q,this.y+=Q,this.z+=Q,this.w+=Q,this},addVectors:function(V,b){return this.x=V.x+b.x,this.y=V.y+b.y,this.z=V.z+b.z,this.w=V.w+b.w,this},addScaledVector:function(K,x){return this.x+=K.x*x,this.y+=K.y*x,this.z+=K.z*x,this.w+=K.w*x,this},sub:function(k,c){return c!==_?this.subVectors(k,c):(this.x-=k.x,this.y-=k.y,this.z-=k.z,this.w-=k.w,this)},subScalar:function(k){return this.x-=k,this.y-=k,this.z-=k,this.w-=k,this},subVectors:function(k,g){return this.x=k.x-g.x,this.y=k.y-g.y,this.z=k.z-g.z,this.w=k.w-g.w,this},multiplyScalar:function(x){return this.x*=x,this.y*=x,this.z*=x,this.w*=x,this},applyMatrix4:function(W){var i=this.x,y=this.y,j=this.z,K=this.w,D=W.el;return this.x=D[0]*i+D[4]*y+D[8]*j+D[12]*K,this.y=D[1]*i+D[5]*y+D[9]*j+D[13]*K,this.z=D[2]*i+D[6]*y+D[10]*j+D[14]*K,this.w=D[3]*i+D[7]*y+D[11]*j+D[15]*K,this},divideScalar:function(B){return this.multiplyScalar(1/B)},setAxisAngleFromQuaternion:function(X){this.w=2*Math.acos(X.w);var M=Math.sqrt(1-X.w*X.w);return 1e-4>M?(this.x=1,this.y=0,this.z=0):(this.x=X.x/M,this.y=X.y/M,this.z=X.z/M),this},setAxisAngleFromRotationMatrix:function(d){var A,r,m,H,h=.01,S=.1,F=d.el,P=F[0],c=F[4],Q=F[8],f=F[1],q=F[5],i=F[9],p=F[2],x=F[6],b=F[10];if(Math.abs(c-f)<h&&Math.abs(Q-p)<h&&Math.abs(i-x)<h){if(Math.abs(c+f)<S&&Math.abs(Q+p)<S&&Math.abs(i+x)<S&&Math.abs(P+q+b-3)<S)return this.set(1,0,0,0),this;A=Math.PI;var L=(P+1)/2,Y=(q+1)/2,s=(b+1)/2,l=(c+f)/4,_=(Q+p)/4,D=(i+x)/4;return L>Y&&L>s?h>L?(r=0,m=.707106781,H=.707106781):(r=Math.sqrt(L),m=l/r,H=_/r):Y>s?h>Y?(r=.707106781,m=0,H=.707106781):(m=Math.sqrt(Y),r=l/m,H=D/m):h>s?(r=.707106781,m=.707106781,H=0):(H=Math.sqrt(s),r=_/H,m=D/H),this.set(r,m,H,A),this}var C=Math.sqrt((x-i)*(x-i)+(Q-p)*(Q-p)+(f-c)*(f-c));return Math.abs(C)<.001&&(C=1),this.x=(x-i)/C,this.y=(Q-p)/C,this.z=(f-c)/C,this.w=Math.acos((P+q+b-1)/2),this},min:function(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this.w=Math.min(this.w,n.w),this},max:function(R){return this.x=Math.max(this.x,R.x),this.y=Math.max(this.y,R.y),this.z=Math.max(this.z,R.z),this.w=Math.max(this.w,R.w),this},clamp:function(R,X){return this.x=Math.max(R.x,Math.min(X.x,this.x)),this.y=Math.max(R.y,Math.min(X.y,this.y)),this.z=Math.max(R.z,Math.min(X.z,this.z)),this.w=Math.max(R.w,Math.min(X.w,this.w)),this},clampScalar:function(){var H,G;return function(I,z){return H===_&&(H=new Zf,G=new Zf),H.set(I,I,I,I),G.set(z,z,z,z),this.clamp(H,G)}}(),clampLength:function(d,m){var G=this.length();return this.divideScalar(G||1).multiplyScalar(Math.max(d,Math.min(m,G)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(j){return this.x*j.x+this.y*j.y+this.z*j.z+this.w*j.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(E){return this.normalize().multiplyScalar(E)},lerp:function(H,e){return this.x+=(H.x-this.x)*e,this.y+=(H.y-this.y)*e,this.z+=(H.z-this.z)*e,this.w+=(H.w-this.w)*e,this},lerpVectors:function(V,r,n){return this.subVectors(r,V).multiplyScalar(n).add(V)},equals:function(K){return K.x===this.x&&K.y===this.y&&K.z===this.z&&K.w===this.w
},fromArray:function(B,$){return $===_&&($=0),this.x=B[$],this.y=B[$+1],this.z=B[$+2],this.w=B[$+3],this},toArray:function(t,s){return t===_&&(t=[]),s===_&&(s=0),t[s]=this.x,t[s+1]=this.y,t[s+2]=this.z,t[s+3]=this.w,t},fromBufferAttribute:function(q,c){return this.x=q.getX(c),this.y=q.getY(c),this.z=q.getZ(c),this.w=q.getW(c),this}});var io=V.Math.Vector3=function(K,h,$){K===_?(this.x=0,this.y=0,this.z=0):"object"==typeof K?this.copy(K):this.set(K,h==_?K:h,$==_?K:$)},pm=V.Math.Vector3;f.assign(io.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(F,Z,E){return this.x=F,this.y=Z,this.z=E,this},equals:function(E){return E&&this.x===E.x&&this.y===E.y&&this.z===E.z},setScalar:function(m){return this.x=m,this.y=m,this.z=m,this},setX:function(z){return this.x=z,this},setY:function(G){return this.y=G,this},setZ:function(j){return this.z=j,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(p){return p.x===_?(this.x=p[0],this.y=p[1],this.z=p[2]):(this.x=p.x,this.y=p.y,this.z=p.z||0),this},add:function(U){return this.x+=U.x,this.y+=U.y,this.z+=U.z,this},addScalar:function(L){return this.x+=L,this.y+=L,this.z+=L,this},addVectors:function(J,D){return this.x=J.x+D.x,this.y=J.y+D.y,this.z=J.z+D.z,this},addScaledVector:function(h,A){return this.x+=h.x*A,this.y+=h.y*A,this.z+=h.z*A,this},sub:function(w){return this.x-=w.x,this.y-=w.y,this.z-=w.z,this},subScalar:function($){return this.x-=$,this.y-=$,this.z-=$,this},subVectors:function(M,C){return this.x=M.x-C.x,this.y=M.y-C.y,this.z=M.z-C.z,this},divide:function(V){return this.x/=V.x,this.y/=V.y,this.z/=V.z,this},multiply:function(z){return this.x*=z.x,this.y*=z.y,this.z*=z.z,this},multiplyScalar:function(c){return this.x*=c,this.y*=c,this.z*=c,this},divideScalar:function($){if(0!==$){var i=1/$;this.x*=i,this.y*=i,this.z*=i}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(z){return Math.sqrt(this.distanceToSquared(z))},distanceToSquared:function(Q){var l=this.x-Q.x,i=this.y-Q.y,E=this.z-Q.z;return l*l+i*i+E*E},distanceToSquared2:function(G){var h=this.x-G[0],z=this.y-G[1],Z=this.z-G[2];return h*h+z*z+Z*Z},divideVectors:function(Q,C){return this.x=Q.x/C.x,this.y=Q.y/C.y,this.z=Q.z/C.z,this},multiplyVectors:function(T,W){return this.x=T.x*W.x,this.y=T.y*W.y,this.z=T.z*W.z,this},transformDirection:function(f){var h=this.x,d=this.y,n=this.z,Q=f.el;return this.x=Q[0]*h+Q[4]*d+Q[8]*n,this.y=Q[1]*h+Q[5]*d+Q[9]*n,this.z=Q[2]*h+Q[6]*d+Q[10]*n,this.normalize()},applyAxisAngle:function(){var P=new Cj;return function(a,x){return this.applyQuaternion(P.setFromAxisAngle(a,x))}}(),applyEuler:function(){var u=new Cj;return function(v){return this.applyQuaternion(u.setFromEuler(v))}}(),applyQuaternion:function(l){var N=this.x,k=this.y,h=this.z,W=l._x,Z=l._y,Y=l._z,p=l._w,C=p*N+Z*h-Y*k,_=p*k+Y*N-W*h,d=p*h+W*k-Z*N,J=-W*N-Z*k-Y*h;return this.x=C*p+J*-W+_*-Y-d*-Z,this.y=_*p+J*-Z+d*-W-C*-Y,this.z=d*p+J*-Y+C*-Z-_*-W,this},applyMatrix4:function(h){var F=this.x,_=this.y,q=this.z,N=h.el,D=1/(N[3]*F+N[7]*_+N[11]*q+N[15]);return this.x=(N[0]*F+N[4]*_+N[8]*q+N[12])*D,this.y=(N[1]*F+N[5]*_+N[9]*q+N[13])*D,this.z=(N[2]*F+N[6]*_+N[10]*q+N[14])*D,this},applyMatrix3:function(h){var L=this.x,x=this.y,Q=this.z,R=h.el;return this.x=R[0]*L+R[3]*x+R[6]*Q,this.y=R[1]*L+R[4]*x+R[7]*Q,this.z=R[2]*L+R[5]*x+R[8]*Q,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var Q=new io;return function(O){return this.sub(Q.copy(O).multiplyScalar(2*this.dot(O)))}}(),dot:function(u){return this.x*u.x+this.y*u.y+this.z*u.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var G=this.length();return G?this.multiplyScalar(1/G):this},setLength:function(X){return this.normalize().multiplyScalar(X)},fromArray:function(r,i){return i===_&&(i=0),this.x=r[i],this.y=r[i+1],this.z=r[i+2],this},toArray:function(A,i){return A===_&&(A=[0,0,0]),i===_&&(i=0),A[i]=this.x,A[i+1]=this.y,A[i+2]=this.z,A},cross:function(W){return this.crossVectors(this,W)},angleTo:function(E){var h=this.dot(E)/Math.sqrt(this.lengthSq()*E.lengthSq());return h>1||-1>h?0:Math.acos(h)},lerp:function($,x){return this.x+=($.x-this.x)*x,this.y+=($.y-this.y)*x,this.z+=($.z-this.z)*x,this},lerpVectors:function(s,L,c){return this.subVectors(L,s).multiplyScalar(c).add(s)},crossVectors:function(w,P){var U=w.x,n=w.y,H=w.z,e=P.x,h=P.y,a=P.z;return this.x=n*a-H*h,this.y=H*e-U*a,this.z=U*h-n*e,this},min:function(Q){return this.x=Math.min(this.x,Q.x),this.y=Math.min(this.y,Q.y),this.z=Math.min(this.z,Q.z),this},max:function(u){return this.x=Math.max(this.x,u.x),this.y=Math.max(this.y,u.y),this.z=Math.max(this.z,u.z),this},setFromMatrixPosition:function(i){return this.setFromMatrixColumn(i,3)},setFromMatrixScale:function(k){var b=this.setFromMatrixColumn(k,0).length(),q=this.setFromMatrixColumn(k,1).length(),I=this.setFromMatrixColumn(k,2).length();return this.x=b,this.y=q,this.z=I,this},setFromMatrixColumn:function(X,C){return this.fromArray(X.el,4*C)}});var Go=V.Math.Vector2=function(n,c,y){"object"==typeof n&&(n.x!=_?(c=n.y,y=n.e,n=n.x):(y=n[2],c=n[1],n=n[0])),this.set(n||0,c||0,y)};Go.prototype={},Go.prototype.constructor=Go;var Be=Go;f.defineProperties(Go.prototype,{width:{get:function(){return this.x},set:function(n){this.x=n}},height:{get:function(){return this.y},set:function(S){this.y=S}}}),Go.prototype.clone=function(){return new Go(this.x,this.y,this.e)},Go.prototype.copy=function(u){return this.set(u.x,u.y,u.e),this},Go.prototype.equals=function(W){return W.x===this.x&&W.y===this.y&&W.e===this.e},Go.prototype.set=function(Y,k,Q){return this.x=Y||0,this.y=k||(0!==k?this.x:0),Q!=_&&(this.e=Q),this},Go.prototype.setScalar=function(z){return this.x=z,this.y=z,this.e=z,this},Go.prototype.setX=function(r){return this.x=r||0,this},Go.prototype.setY=function(z){return this.y=z||0,this},Go.prototype.setE=function(m){return this.e=m||0,this},Go.prototype.add=function(r){return this.x+=r.x,this.y+=r.y,this},Go.prototype.addVectors=function(W,S){return this.x=W.x+S.x,this.y=W.y+S.y,this},Go.prototype.addScalar=function(k){return this.x+=k,this.y+=k,this},Go.prototype.addScaledVector=function(Z,K){return this.x+=Z.x*K,this.y+=Z.y*K,this},Go.prototype.sub=function(X){return this.x-=X.x,this.y-=X.y,this},Go.prototype.subScalar=function($){return this.x-=$,this.y-=$,this},Go.prototype.subVectors=function(t,N){return this.x=t.x-N.x,this.y=t.y-N.y,this},Go.prototype.multiply=function(B){return this.x*=B.x,this.y*=B.y,this},Go.prototype.multiplyScalar=function(M){return this.x*=M,this.y*=M,this},Go.prototype.divide=function(y){return this.x/=y.x,this.y/=y.y,this},Go.prototype.divideScalar=function(_){return this.multiplyScalar(1/_)},Go.prototype.min=function(Q){return this.x=Math.min(this.x,Q.x),this.y=Math.min(this.y,Q.y),this},Go.prototype.max=function(N){return this.x=Math.max(this.x,N.x),this.y=Math.max(this.y,N.y),this},Go.prototype.fromArray=function(Q,I){return I===_&&(I=0),this.x=Q[I],this.y=Q[I+1],this},Go.prototype.clamp=function(m,F){return this.x=Math.max(m.x,Math.min(F.x,this.x)),this.y=Math.max(m.y,Math.min(F.y,this.y)),this},Go.prototype.clampScalar=function(){var g,y;return function(A,V){return g===_&&(g=new Go,y=new Go),g.set(A,A),y.set(V,V),this.clamp(g,y)}}(),Go.prototype.clampLength=function(I,C){var c=this.length();return this.multiplyScalar(Math.max(I,Math.min(C,c))/c)},Go.prototype.dot=function(B){return this.x*B.x+this.y*B.y},Go.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Go.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Go.prototype.normalize=function(){return this.divideScalar(this.length())},Go.prototype.angle=function(){var i=Math.atan2(this.y,this.x);return 0>i&&(i+=2*Math.PI),i},Go.prototype.distanceTo=function(m){return Math.sqrt(this.distanceToSquared(m))},Go.prototype.distanceToSquared=function(P){var p=this.x-P.x,Y=this.y-P.y;return p*p+Y*Y},Go.prototype.isNearEnough=function(l){return this.distanceToSquared(l)<1e-8},Go.prototype.setLength=function(a){var G=this.length();return G?this.multiplyScalar(a/G):this},Go.prototype.lerp=function(_,p){return this.x+=(_.x-this.x)*p,this.y+=(_.y-this.y)*p,"number"==typeof _.e&&"number"==typeof this.e&&(this.e+=(_.e-this.e)*p),this},Go.prototype.lerpVectors=function(M,t,P){return this.subVectors(t,M).multiplyScalar(P).add(M)},Go.prototype.rotateAround=function(G,O){var n=G?G.x:0,H=G?G.y:0,R=Math.cos(O),d=Math.sin(O),L=this.x-n,X=this.y-H;return this.x=L*R-X*d+n,this.y=L*d+X*R+H,this};var Qg=V.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};f.assign(Qg.prototype,{isMatrix3:!0,set:function(m,z,Z,L,R,d,x,S,T){var D=this.el;return D[0]=m,D[1]=L,D[2]=x,D[3]=z,D[4]=R,D[5]=S,D[6]=Z,D[7]=d,D[8]=T,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(T){var M=this.el,w=T.el;return M[0]=w[0],M[1]=w[1],M[2]=w[2],M[3]=w[3],M[4]=w[4],M[5]=w[5],M[6]=w[6],M[7]=w[7],M[8]=w[8],this},setFromMatrix4:function(k){var r=k.el;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this},applyToBufferAttribute:function(){var x=new io;return function(q){for(var s=0,g=q.count;g>s;s++)x.x=q.getX(s),x.y=q.getY(s),x.z=q.getZ(s),x.applyMatrix3(this),q.setXYZ(s,x.x,x.y,x.z);return q}}(),multiply:function(w){return this.multiplyMatrices(this,w)},premultiply:function(S){return this.multiplyMatrices(S,this)},multiplyMatrices:function(Z,B){var U=Z.el,w=B.el,z=this.el,Q=U[0],x=U[3],m=U[6],M=U[1],p=U[4],c=U[7],k=U[2],s=U[5],o=U[8],v=w[0],d=w[3],l=w[6],h=w[1],J=w[4],R=w[7],g=w[2],T=w[5],q=w[8];return z[0]=Q*v+x*h+m*g,z[3]=Q*d+x*J+m*T,z[6]=Q*l+x*R+m*q,z[1]=M*v+p*h+c*g,z[4]=M*d+p*J+c*T,z[7]=M*l+p*R+c*q,z[2]=k*v+s*h+o*g,z[5]=k*d+s*J+o*T,z[8]=k*l+s*R+o*q,this},multiplyScalar:function(g){var D=this.el;return D[0]*=g,D[3]*=g,D[6]*=g,D[1]*=g,D[4]*=g,D[7]*=g,D[2]*=g,D[5]*=g,D[8]*=g,this},determinant:function(){var g=this.el,z=g[0],u=g[1],H=g[2],k=g[3],y=g[4],p=g[5],F=g[6],t=g[7],K=g[8];return z*y*K-z*p*t-u*k*K+u*p*F+H*k*t-H*y*F},getInverse:function(V){var E=V.el,S=this.el,j=E[0],K=E[1],o=E[2],C=E[3],c=E[4],k=E[5],P=E[6],Z=E[7],R=E[8],q=R*c-k*Z,g=k*P-R*C,s=Z*C-c*P,D=j*q+K*g+o*s;if(0===D)return this.identity();var L=1/D;return S[0]=q*L,S[1]=(o*Z-R*K)*L,S[2]=(k*K-o*c)*L,S[3]=g*L,S[4]=(R*j-o*P)*L,S[5]=(o*C-k*j)*L,S[6]=s*L,S[7]=(K*P-Z*j)*L,S[8]=(c*j-K*C)*L,this},transpose:function(){var w,Z=this.el;return w=Z[1],Z[1]=Z[3],Z[3]=w,w=Z[2],Z[2]=Z[6],Z[6]=w,w=Z[5],Z[5]=Z[7],Z[7]=w,this},getNormalMatrix:function(z){return this.setFromMatrix4(z).getInverse(this).transpose()},transposeIntoArray:function(s){var $=this.el;return s[0]=$[0],s[1]=$[3],s[2]=$[6],s[3]=$[1],s[4]=$[4],s[5]=$[7],s[6]=$[2],s[7]=$[5],s[8]=$[8],this},setUvTransform:function(n,H,Y,Z,B,G,$){var j=Math.cos(B),c=Math.sin(B);this.set(Y*j,Y*c,-Y*(j*G+c*$)+G+n,-Z*c,Z*j,-Z*(-c*G+j*$)+$+H,0,0,1)},scale:function(D,Q){var j=this.el;return j[0]*=D,j[3]*=D,j[6]*=D,j[1]*=Q,j[4]*=Q,j[7]*=Q,this},rotate:function(b){var g=Math.cos(b),C=Math.sin(b),G=this.el,T=G[0],d=G[3],W=G[6],p=G[1],n=G[4],r=G[7];return G[0]=g*T+C*p,G[3]=g*d+C*n,G[6]=g*W+C*r,G[1]=-C*T+g*p,G[4]=-C*d+g*n,G[7]=-C*W+g*r,this},translate:function(l,I){var g=this.el;return g[0]+=l*g[2],g[3]+=l*g[5],g[6]+=l*g[8],g[1]+=I*g[2],g[4]+=I*g[5],g[7]+=I*g[8],this},equals:function(U){for(var L=this.el,Y=U.el,V=0;9>V;V++)if(L[V]!==Y[V])return!1;return!0},fromArray:function(O,X){X===_&&(X=0);for(var c=0;9>c;c++)this.el[c]=O[c+X];return this},toArray:function(o,G){o===_&&(o=[]),G===_&&(G=0);var S=this.el;return o[G]=S[0],o[G+1]=S[1],o[G+2]=S[2],o[G+3]=S[3],o[G+4]=S[4],o[G+5]=S[5],o[G+6]=S[6],o[G+7]=S[7],o[G+8]=S[8],o}});var Jp=V.Math.Plane=function(M,P){this.normal=M!==_?M:new io(1,0,0),this.constant=P!==_?P:0};f.assign(Jp.prototype,{set:function(e,l){return this.normal.copy(e),this.constant=l,this},setComponents:function(Z,W,P,R){return this.normal.set(Z,W,P),this.constant=R,this},setFromNormalAndCoplanarPoint:function(P,w){return this.normal.copy(P),this.constant=-w.dot(this.normal),this},setFromCoplanarPoints:function(){var w=new io,C=new io;return function(t,U,Y){var D=w.subVectors(Y,U).cross(C.subVectors(t,U)).normalize();return this.setFromNormalAndCoplanarPoint(D,t),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(z){return this.normal.copy(z.normal),this.constant=z.constant,this},normalize:function(){var U=1/this.normal.length();return this.normal.multiplyScalar(U),this.constant*=U,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(M){return this.normal.dot(M)+this.constant},distanceToSphere:function($){return this.distanceToPoint($.center)-$.radius},projectPoint:function($,V){return V===_&&(V=new io),V.copy(this.normal).multiplyScalar(-this.distanceToPoint($)).add($)},intersectLine:function(){var V=new io;return function(s,G){G===_&&(G=new io);var X=s.delta(V),I=this.normal.dot(X);if(0===I)return 0===this.distanceToPoint(s.start)?G.copy(s.start):_;var g=-(s.start.dot(this.normal)+this.constant)/I;return 0>g||g>1?_:G.copy(X).multiplyScalar(g).add(s.start)}}(),intersectsLine:function(h){var i=this.distanceToPoint(h.start),o=this.distanceToPoint(h.end);return 0>i&&o>0||0>o&&i>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(C){return C===_&&(C=new io),C.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var V=new io,i=new Qg;return function(t,J){var M=J||i.getNormalMatrix(t),p=this.coplanarPoint(V).applyMatrix4(t),N=this.normal.applyMatrix3(M).normalize();return this.constant=-p.dot(N),this}}(),translate:function(S){return this.constant-=S.dot(this.normal),this},equals:function(q){return q.normal.equals(this.normal)&&q.constant===this.constant}});var Jk=V.Math.Ray=function(u,r){this.origin=u!==_?u.clone():new io,this.direction=r!==_?r.clone():new io};f.assign(Jk.prototype,{set:function(X,T){return this.origin.copy(X),this.direction.copy(T),this},clone:function(){return(new this.constructor).copy(this)},copy:function(M){return this.origin.copy(M.origin),this.direction.copy(M.direction),this.maxHitLen=M.maxHitLen,this},at:function(H,N){var K=N||new io;return K.copy(this.direction).multiplyScalar(H).add(this.origin)},setMaxHitLength:function(o){this.maxHitLen=o},lookAt:function(U){return this.direction.copy(U).sub(this.origin).normalize(),this},applyMatrix4:function(T){var p=this.maxHitLen;if(p){var S=this.direction.clone().multiplyScalar(p).add(this.origin);S.applyMatrix4(T)}return this.origin.applyMatrix4(T),this.direction.transformDirection(T),p&&(this.maxHitLen=this.origin.distanceTo(S)),this},distanceToPlane:function(p){var O=p.normal.dot(this.direction);if(0===O)return 0===p.distanceToPoint(this.origin)?0:null;var k=-(this.origin.dot(p.normal)+p.constant)/O;return k>=0?k:null},intersectPlane:function(_,e){var s=this.distanceToPlane(_);return null===s?null:this.at(s,e)},intersectSphere:function(){var J=new io;return function(C,T){J.subVectors(C.center,this.origin);var p=J.dot(this.direction),F=J.dot(J)-p*p,G=C.radius*C.radius;if(F>G)return null;var x=Math.sqrt(G-F),y=p-x,e=p+x;return 0>y&&0>e?null:0>y?this.at(e,T):this.at(y,T)}}(),intersectEllipsoid:function(){var M=new io,q=new io;return function(i,n){M.subVectors(i.center,this.origin),M.divide(i.radius),q.divideVectors(this.direction,i.radius);var V=q.lengthSq(),o=M.dot(q),T=M.dot(M)*V-o*o;if(T>V)return null;var F=Math.sqrt(V-T),P=(o-F)/V,s=(o+F)/V;return 0>P&&0>s?null:0>P?this.at(s,n):this.at(P,n)}}(),intersectBox:function(b,u){var j,B,k,c,P,R,y=1/this.direction.x,K=1/this.direction.y,h=1/this.direction.z,M=this.origin;if(y>=0?(j=(b.min.x-M.x)*y,B=(b.max.x-M.x)*y):(j=(b.max.x-M.x)*y,B=(b.min.x-M.x)*y),K>=0?(k=(b.min.y-M.y)*K,c=(b.max.y-M.y)*K):(k=(b.max.y-M.y)*K,c=(b.min.y-M.y)*K),j>c||k>B)return null;if((k>j||j!==j)&&(j=k),(B>c||B!==B)&&(B=c),h>=0?(P=(b.min.z-M.z)*h,R=(b.max.z-M.z)*h):(P=(b.max.z-M.z)*h,R=(b.min.z-M.z)*h),j>R||P>B)return null;if((P>j||j!==j)&&(j=P),(B>R||B!==B)&&(B=R),0>B)return null;var U=j>=0?j:B,e=this.maxHitLen;return e&&U>e?null:this.at(U,u)},intersectTriangle:function(){var v=new io,L=new io,T=new io,S=new io;return function(F,f,e,Q,p){L.subVectors(f,F),T.subVectors(e,F),S.crossVectors(L,T);var x,O=this.direction.dot(S);if(O>0){if(Q)return null;x=1}else{if(!(0>O))return null;x=-1,O=-O}v.subVectors(this.origin,F);var V=x*this.direction.dot(T.crossVectors(v,T));if(0>V)return null;var b=x*this.direction.dot(L.cross(v));if(0>b||V+b>O)return null;var q=-x*v.dot(S);if(0>q)return null;var U=q/O,W=this.maxHitLen;return W&&U>W?null:this.at(U,p)}}()});var fq=V.Math.Box3=function(b,Z){this.min=b!==_?b:new io(1/0,1/0,1/0),this.max=Z!==_?Z:new io(-1/0,-1/0,-1/0)};f.assign(fq.prototype,{set:function(V,D){return this.min.copy(V),this.max.copy(D),this},setFromArray:function(R){for(var P=1/0,v=1/0,H=1/0,O=-1/0,W=-1/0,t=-1/0,G=0,h=R.length;h>G;G+=3){var T=R[G],M=R[G+1],$=R[G+2];P>T&&(P=T),v>M&&(v=M),H>$&&(H=$),T>O&&(O=T),M>W&&(W=M),$>t&&(t=$)}return this.min.set(P,v,H),this.max.set(O,W,t),this},setFromPoints:function(S){this.makeEmpty();for(var W=0,c=S.length;c>W;W++)this.expandByPoint(S[W]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(D){return D.max.x<this.min.x||D.min.x>this.max.x||D.max.y<this.min.y||D.min.y>this.max.y||D.max.z<this.min.z||D.min.z>this.max.z?!1:!0},copy:function(P){return this.min.copy(P.min),this.max.copy(P.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(Q){return this.min.min(Q),this.max.max(Q),this},expandByBox:function(B){return this.min.min(B.min),this.max.max(B.max),this},applyMatrix4:function(){var X=[new io,new io,new io,new io,new io,new io,new io,new io];return function(o){return this.isEmpty()?this:(X[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(o),X[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(o),X[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(o),X[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(o),X[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(o),X[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(o),X[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(o),X[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(o),this.setFromPoints(X),this)}}()});var Vh=V.Math.Sphere=function(V,d){this.center=V!==_?V:new io,this.radius=d!==_?d:0};f.assign(Vh.prototype,{set:function(l,m){return this.center.copy(l),this.radius=m,this},setFromPoints:function(){var f=new fq;return function(n,j){var u=this.center;j!==_?u.copy(j):f.setFromPoints(n).getCenter(u);for(var D=0,R=0,d=n.length;d>R;R++)D=Math.max(D,u.distanceToSquared(n[R]));return this.radius=Math.sqrt(D),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(j){return this.center.copy(j.center),this.radius=j.radius,this},empty:function(){return this.radius<=0},containsPoint:function(q){return q.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(x){return x.distanceTo(this.center)-this.radius},intersectsSphere:function(I){var v=this.radius+I.radius;return I.center.distanceToSquared(this.center)<=v*v},intersectsBox:function(I){return I.intersectsSphere(this)},intersectsPlane:function(l){return Math.abs(l.distanceToPoint(this.center))<=this.radius},clampPoint:function(s,u){var E=this.center.distanceToSquared(s);return u===_&&(u=new io),u.copy(s),E>this.radius*this.radius&&(u.sub(this.center).normalize(),u.multiplyScalar(this.radius).add(this.center)),u},getBoundingBox:function(y){return y===_&&(y=new fq),y.set(this.center,this.center),y.expandByScalar(this.radius),y},applyMatrix4:function(H){return this.center.applyMatrix4(H),this.radius=this.radius*H.getMaxScaleOnAxis(),this},translate:function($){return this.center.add($),this},equals:function(B){return B.center.equals(this.center)&&B.radius===this.radius}});var Sg=V.Math.Frustum=function(B,N,t,Y,b,m){this.planes=[B!==_?B:new Jp,N!==_?N:new Jp,t!==_?t:new Jp,Y!==_?Y:new Jp,b!==_?b:new Jp,m!==_?m:new Jp]};f.assign(Sg.prototype,{set:function(V,R,k,Q,J,o){var u=this.planes;return u[0].copy(V),u[1].copy(R),u[2].copy(k),u[3].copy(Q),u[4].copy(J),u[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(d){for(var P=this.planes,s=0;6>s;s++)P[s].copy(d.planes[s]);return this},setFromMatrix:function(Q){var U=this.planes,s=Q.el,m=s[0],Z=s[1],P=s[2],W=s[3],q=s[4],w=s[5],y=s[6],j=s[7],c=s[8],A=s[9],M=s[10],F=s[11],t=s[12],E=s[13],V=s[14],O=s[15];return U[0].setComponents(W-m,j-q,F-c,O-t).normalize(),U[1].setComponents(W+m,j+q,F+c,O+t).normalize(),U[2].setComponents(W+Z,j+w,F+A,O+E).normalize(),U[3].setComponents(W-Z,j-w,F-A,O-E).normalize(),U[4].setComponents(W-P,j-y,F-M,O-V).normalize(),U[5].setComponents(W+P,j+y,F+M,O+V).normalize(),this},intersectsObject:function(){var U=new Vh;return function(c){var X=c.geometry;return null===X.boundingSphere&&X.computeBoundingSphere(),U.copy(X.boundingSphere).applyMatrix4(c.matrixWorld),this.intersectsSphere(U)}}(),intersectsSprite:function(){var W=new Vh;return function(F){return W.center.set(0,0,0),W.radius=.7071067811865476,W.applyMatrix4(F.matrixWorld),this.intersectsSphere(W)}}(),intersectsSphere:function(g){for(var H=this.planes,h=g.center,N=-g.radius,V=0;6>V;V++){var P=H[V].distanceToPoint(h);if(N>P)return!1}return!0},intersectsBox:function(){var n=new io;return function(k){for(var Z=this.planes,O=0;6>O;O++){var C=Z[O];if(n.x=C.normal.x>0?k.max.x:k.min.x,n.y=C.normal.y>0?k.max.y:k.min.y,n.z=C.normal.z>0?k.max.z:k.min.z,C.distanceToPoint(n)<0)return!1}return!0}}(),containsPoint:function(C){for(var Y=this.planes,l=0;6>l;l++)if(Y[l].distanceToPoint(C)<0)return!1;return!0}});var bf=V.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};f.assign(bf.prototype,{set:function(J,Z,I,f,e,w,k,c,g,i,m,Y,r,H,t,a){var O=this.el;return O[0]=J,O[4]=Z,O[8]=I,O[12]=f,O[1]=e,O[5]=w,O[9]=k,O[13]=c,O[2]=g,O[6]=i,O[10]=m,O[14]=Y,O[3]=r,O[7]=H,O[11]=t,O[15]=a,this},clone:function(){return(new bf).fromArray(this.el)},fromArray:function(p,P){P===_&&(P=0);for(var C=this.el,Q=0;16>Q;Q++)C[Q]=p[Q+P];return this},getElements:function(){return this.el},scale:function(B){var s=this.el,E=B.x,f=B.y,e=B.z;return s[0]*=E,s[4]*=f,s[8]*=e,s[1]*=E,s[5]*=f,s[9]*=e,s[2]*=E,s[6]*=f,s[10]*=e,s[3]*=E,s[7]*=f,s[11]*=e,this},makeRotationFromEuler:function(C){var m=this.el,q=C._x,W=C._y,i=C._z,R=C._order,n=Math.cos(q),Z=Math.sin(q),b=Math.cos(W),d=Math.sin(W),B=Math.cos(i),F=Math.sin(i);if("XYZ"===R){var A=n*B,U=n*F,v=Z*B,s=Z*F;m[0]=b*B,m[4]=-b*F,m[8]=d,m[1]=U+v*d,m[5]=A-s*d,m[9]=-Z*b,m[2]=s-A*d,m[6]=v+U*d,m[10]=n*b}else if("YXZ"===R){var l=b*B,D=b*F,y=d*B,N=d*F;m[0]=l+N*Z,m[4]=y*Z-D,m[8]=n*d,m[1]=n*F,m[5]=n*B,m[9]=-Z,m[2]=D*Z-y,m[6]=N+l*Z,m[10]=n*b}else if("ZXY"===R){var l=b*B,D=b*F,y=d*B,N=d*F;m[0]=l-N*Z,m[4]=-n*F,m[8]=y+D*Z,m[1]=D+y*Z,m[5]=n*B,m[9]=N-l*Z,m[2]=-n*d,m[6]=Z,m[10]=n*b}else if("ZYX"===R){var A=n*B,U=n*F,v=Z*B,s=Z*F;m[0]=b*B,m[4]=v*d-U,m[8]=A*d+s,m[1]=b*F,m[5]=s*d+A,m[9]=U*d-v,m[2]=-d,m[6]=Z*b,m[10]=n*b}else if("YZX"===R){var a=n*b,X=n*d,z=Z*b,S=Z*d;m[0]=b*B,m[4]=S-a*F,m[8]=z*F+X,m[1]=F,m[5]=n*B,m[9]=-Z*B,m[2]=-d*B,m[6]=X*F+z,m[10]=a-S*F}else if("XZY"===R){var a=n*b,X=n*d,z=Z*b,S=Z*d;m[0]=b*B,m[4]=-F,m[8]=d*B,m[1]=a*F+S,m[5]=n*B,m[9]=X*F-z,m[2]=z*F-X,m[6]=Z*B,m[10]=S*F+a}return m[3]=0,m[7]=0,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,this},makeRotationFromQuaternion:function(q){var M=this.el,K=q._x,A=q._y,f=q._z,X=q._w,I=K+K,h=A+A,c=f+f,L=K*I,Z=K*h,_=K*c,Y=A*h,o=A*c,b=f*c,F=X*I,W=X*h,J=X*c;return M[0]=1-(Y+b),M[4]=Z-J,M[8]=_+W,M[1]=Z+J,M[5]=1-(L+b),M[9]=o-F,M[2]=_-W,M[6]=o+F,M[10]=1-(L+Y),M[3]=0,M[7]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(n){var V=this.el,A=n.el,E=A[0],g=A[1],T=A[2],c=A[3],h=A[4],v=A[5],k=A[6],L=A[7],w=A[8],S=A[9],p=A[10],X=A[11],u=A[12],J=A[13],$=A[14],y=A[15],x=S*$*L-J*p*L+J*k*X-v*$*X-S*k*y+v*p*y,e=u*p*L-w*$*L-u*k*X+h*$*X+w*k*y-h*p*y,Q=w*J*L-u*S*L+u*v*X-h*J*X-w*v*y+h*S*y,K=u*S*k-w*J*k-u*v*p+h*J*p+w*v*$-h*S*$,H=E*x+g*e+T*Q+c*K;if(0===H)return this.identity();var j=1/H;return V[0]=x*j,V[1]=(J*p*c-S*$*c-J*T*X+g*$*X+S*T*y-g*p*y)*j,V[2]=(v*$*c-J*k*c+J*T*L-g*$*L-v*T*y+g*k*y)*j,V[3]=(S*k*c-v*p*c-S*T*L+g*p*L+v*T*X-g*k*X)*j,V[4]=e*j,V[5]=(w*$*c-u*p*c+u*T*X-E*$*X-w*T*y+E*p*y)*j,V[6]=(u*k*c-h*$*c-u*T*L+E*$*L+h*T*y-E*k*y)*j,V[7]=(h*p*c-w*k*c+w*T*L-E*p*L-h*T*X+E*k*X)*j,V[8]=Q*j,V[9]=(u*S*c-w*J*c-u*g*X+E*J*X+w*g*y-E*S*y)*j,V[10]=(h*J*c-u*v*c+u*g*L-E*J*L-h*g*y+E*v*y)*j,V[11]=(w*v*c-h*S*c-w*g*L+E*S*L+h*g*X-E*v*X)*j,V[12]=K*j,V[13]=(w*J*T-u*S*T+u*g*p-E*J*p-w*g*$+E*S*$)*j,V[14]=(u*v*T-h*J*T-u*g*k+E*J*k+h*g*$-E*v*$)*j,V[15]=(h*S*T-w*v*T+w*g*k-E*S*k-h*g*p+E*v*p)*j,this},makeRotationAxis:function(e,g){var Z=Math.cos(g),j=Math.sin(g),S=1-Z,q=e.x,B=e.y,V=e.z,O=S*q,K=S*B;return this.set(O*q+Z,O*B-j*V,O*V+j*B,0,O*B+j*V,K*B+Z,K*V-j*q,0,O*V-j*B,K*V+j*q,S*V*V+Z,0,0,0,0,1),this},multiply:function(O){return this.multiplyMatrices(this,O)},premultiply:function(Q){return this.multiplyMatrices(Q,this)},multiplyMatrices:function(g,o){var j=g.el,T=o.el,W=this.el,Q=j[0],u=j[4],Z=j[8],M=j[12],x=j[1],J=j[5],q=j[9],D=j[13],i=j[2],z=j[6],f=j[10],H=j[14],F=j[3],$=j[7],I=j[11],v=j[15],t=T[0],K=T[4],e=T[8],b=T[12],d=T[1],y=T[5],G=T[9],A=T[13],V=T[2],E=T[6],B=T[10],X=T[14],h=T[3],l=T[7],_=T[11],p=T[15];return W[0]=Q*t+u*d+Z*V+M*h,W[4]=Q*K+u*y+Z*E+M*l,W[8]=Q*e+u*G+Z*B+M*_,W[12]=Q*b+u*A+Z*X+M*p,W[1]=x*t+J*d+q*V+D*h,W[5]=x*K+J*y+q*E+D*l,W[9]=x*e+J*G+q*B+D*_,W[13]=x*b+J*A+q*X+D*p,W[2]=i*t+z*d+f*V+H*h,W[6]=i*K+z*y+f*E+H*l,W[10]=i*e+z*G+f*B+H*_,W[14]=i*b+z*A+f*X+H*p,W[3]=F*t+$*d+I*V+v*h,W[7]=F*K+$*y+I*E+v*l,W[11]=F*e+$*G+I*B+v*_,W[15]=F*b+$*A+I*X+v*p,this},lookAt:function(){var a=new io;return function(i,j,x){return a.subVectors(i,j),this.lookAtDirection(a,x)}}(),lookAtDirection:function(){var N=new io,V=new io,S=new io;return function(M,D){var d=this.el;return S.copy(M),0===S.lengthSq()&&(S.z=1),S.normalize(),N.crossVectors(D,S),0===N.lengthSq()&&(1===Math.abs(D.z)?S.x+=1e-4:S.z+=1e-4,S.normalize(),N.crossVectors(D,S)),N.normalize(),V.crossVectors(S,N),d[0]=N.x,d[4]=V.x,d[8]=S.x,d[1]=N.y,d[5]=V.y,d[9]=S.y,d[2]=N.z,d[6]=V.z,d[10]=S.z,this}}(),extractScale:function(){var j;return function(V){j===_&&(j=new io),V===_&&(V=new io);var p=j.setFromMatrixColumn(this,0).length(),u=j.setFromMatrixColumn(this,1).length(),i=j.setFromMatrixColumn(this,2).length();return V.set(p,u,i),V}}(),extractRotation:function(){var n;return function(Q){n===_&&(n=new io),Q===_&&(Q=new bf);var Y=this.el,p=Q.el,m=1/n.setFromMatrixColumn(Q,0).length(),g=1/n.setFromMatrixColumn(Q,1).length(),y=1/n.setFromMatrixColumn(Q,2).length();return Y[0]=p[0]*m,Y[1]=p[1]*m,Y[2]=p[2]*m,Y[4]=p[4]*g,Y[5]=p[5]*g,Y[6]=p[6]*g,Y[8]=p[8]*y,Y[9]=p[9]*y,Y[10]=p[10]*y,this}}(),multiplyScalar:function(T){var Z=this.el;return Z[0]*=T,Z[4]*=T,Z[8]*=T,Z[12]*=T,Z[1]*=T,Z[5]*=T,Z[9]*=T,Z[13]*=T,Z[2]*=T,Z[6]*=T,Z[10]*=T,Z[14]*=T,Z[3]*=T,Z[7]*=T,Z[11]*=T,Z[15]*=T,this},getPosition:function(p){return p===_&&(p=new io),p.setFromMatrixColumn(this,3)},setPosition:function($){var O=this.el;return O[12]=$.x,O[13]=$.y,O[14]=$.z,this},toArray:function(x,u){x===_&&(x=[]),u===_&&(u=0);var o=this.el;return x[u]=o[0],x[u+1]=o[1],x[u+2]=o[2],x[u+3]=o[3],x[u+4]=o[4],x[u+5]=o[5],x[u+6]=o[6],x[u+7]=o[7],x[u+8]=o[8],x[u+9]=o[9],x[u+10]=o[10],x[u+11]=o[11],x[u+12]=o[12],x[u+13]=o[13],x[u+14]=o[14],x[u+15]=o[15],x},determinant:function(){var J=this.el,B=J[0],X=J[4],R=J[8],E=J[12],x=J[1],O=J[5],Z=J[9],h=J[13],t=J[2],W=J[6],$=J[10],r=J[14],N=J[3],V=J[7],G=J[11],j=J[15];return N*(+E*Z*W-R*h*W-E*O*$+X*h*$+R*O*r-X*Z*r)+V*(+B*Z*r-B*h*$+E*x*$-R*x*r+R*h*t-E*Z*t)+G*(+B*h*W-B*O*r-E*x*W+X*x*r+E*O*t-X*h*t)+j*(-R*O*t-B*Z*W+B*O*$+R*x*W-X*x*$+X*Z*t)},copy:function(O){var o=this.el,A=O.el;return o[0]=A[0],o[1]=A[1],o[2]=A[2],o[3]=A[3],o[4]=A[4],o[5]=A[5],o[6]=A[6],o[7]=A[7],o[8]=A[8],o[9]=A[9],o[10]=A[10],o[11]=A[11],o[12]=A[12],o[13]=A[13],o[14]=A[14],o[15]=A[15],this},compose:function(V,A,C){var D=this.el,b=A._x,K=A._y,Q=A._z,H=A._w,J=b+b,P=K+K,o=Q+Q,p=b*J,s=b*P,F=b*o,f=K*P,u=K*o,L=Q*o,q=H*J,z=H*P,S=H*o,X=C.x,j=C.y,t=C.z;return D[0]=(1-(f+L))*X,D[1]=(s+S)*X,D[2]=(F-z)*X,D[3]=0,D[4]=(s-S)*j,D[5]=(1-(p+L))*j,D[6]=(u+q)*j,D[7]=0,D[8]=(F+z)*t,D[9]=(u-q)*t,D[10]=(1-(p+f))*t,D[11]=0,D[12]=V.x,D[13]=V.y,D[14]=V.z,D[15]=1,this},decompose:function(){var b=new io,s=new bf;return function(V,d,M){var q=this.el,P=b.set(q[0],q[1],q[2]).length(),E=b.set(q[4],q[5],q[6]).length(),K=b.set(q[8],q[9],q[10]).length(),t=this.determinant();0>t&&(P=-P),V.x=q[12],V.y=q[13],V.z=q[14],s.copy(this);var k=1/P,m=1/E,O=1/K;return s.el[0]*=k,s.el[1]*=k,s.el[2]*=k,s.el[4]*=m,s.el[5]*=m,s.el[6]*=m,s.el[8]*=O,s.el[9]*=O,s.el[10]*=O,d.setFromRotationMatrix(s),M.x=P,M.y=E,M.z=K,this}}()});var kh=V.Math.Triangle=function(D,K,d){this.a=D!==_?D:new io,this.b=K!==_?K:new io,this.c=d!==_?d:new io};f.assign(kh,{barycoordFromPoint:function(){var T=new io,v=new io,S=new io;return function(p,N,s,B,P){T.subVectors(B,N),v.subVectors(s,N),S.subVectors(p,N);var W=T.dot(T),Z=T.dot(v),f=T.dot(S),C=v.dot(v),r=v.dot(S),c=W*C-Z*Z,o=P||new io;if(0===c)return o.set(-2,-1,-1);var e=1/c,w=(C*f-Z*r)*e,t=(W*r-Z*f)*e;return o.set(1-w-t,t,w)}}()});var kn=V.Math.Euler=function(J,i,h,m,M){this.set(J,i,h,m,M)};kn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],kn.DefaultOrder="XYZ",kn.ReverseOrder=function(){var X={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(i){return X[i]}}(),f.defineProperties(kn.prototype,{x:{get:function(){return this._x},set:function(s){this._x=s,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(V){this._y=V,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(n){this._z=n,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(b){this._order=b,this.onChangeCallback()}}}),f.assign(kn.prototype,{set:function(g,$,_,x,s){return mh(g)&&(s=_,x=$,_=g[2],$=g[1],g=g[0]),x?s&&(x=kn.ReverseOrder(x)):x="ZYX",this._x=g||0,this._y=$||0,this._z=_||0,this._order=x||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(D){return this._x=D._x,this._y=D._y,this._z=D._z,this._order=D._order,this.onChangeCallback(),this},setFromRotationMatrix:function(i,d,v){var X=V.Math.clamp,Z=i.el||i,l=Z[0],J=Z[4],o=Z[8],k=Z[1],O=Z[5],r=Z[9],u=Z[2],I=Z[6],c=Z[10];return d=d||this._order,"XYZ"===d?(this._y=Math.asin(X(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(-r,c),this._z=Math.atan2(-J,l)):(this._x=Math.atan2(I,O),this._z=0)):"YXZ"===d?(this._x=Math.asin(-X(r,-1,1)),Math.abs(r)<.99999?(this._y=Math.atan2(o,c),this._z=Math.atan2(k,O)):(this._y=Math.atan2(-u,l),this._z=0)):"ZXY"===d?(this._x=Math.asin(X(I,-1,1)),Math.abs(I)<.99999?(this._y=Math.atan2(-u,c),this._z=Math.atan2(-J,O)):(this._y=0,this._z=Math.atan2(k,l))):"ZYX"===d?(this._y=Math.asin(-X(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(I,c),this._z=Math.atan2(k,l)):(this._x=0,this._z=Math.atan2(-J,O))):"YZX"===d?(this._z=Math.asin(X(k,-1,1)),Math.abs(k)<.99999?(this._x=Math.atan2(-r,O),this._y=Math.atan2(-u,l)):(this._x=0,this._y=Math.atan2(o,c))):"XZY"===d?(this._z=Math.asin(-X(J,-1,1)),Math.abs(J)<.99999?(this._x=Math.atan2(I,O),this._y=Math.atan2(o,l)):(this._x=Math.atan2(-r,c),this._y=0)):console.warn("unsupported order: "+d),this._order=d,v!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var C=new bf;return function(F,A,X){return C.makeRotationFromQuaternion(F),this.setFromRotationMatrix(C,A,X)}}(),setFromVector3:function(U,J){return this.set(U.x,U.y,U.z,J||this._order)
},reorder:function(){var p=new Cj;return function(C){return p.setFromEuler(this),this.setFromQuaternion(p,C)}}(),equals:function(J){return J._x===this._x&&J._y===this._y&&J._z===this._z&&J._order===this._order},fromArray:function(o){return this._x=o[0],this._y=o[1],this._z=o[2],o[3]!==_&&(this._order=o[3]),this.onChangeCallback(),this},toArray:function(I,X){return I===_&&(I=[]),X===_&&(X=0),I[X]=this._x,I[X+1]=this._y,I[X+2]=this._z,I[X+3]=this._order,I},toVector3:function(T){return T?T.set(this._x,this._y,this._z):new io(this._x,this._y,this._z)},onChange:function(A){return this.onChangeCallback=A,this},onChangeCallback:function(){}});var km={ms_ac:function(D,V){for(var d=V.ms_ac,L=0;L<d.length;L++)fk(D,d[L])},ms_listener:function(u){u.addListeners=function(){var Y=this,E=Rf;C.mockTouch&&(E=Ag.concat(hn).concat(Xr)),Y.__events__=E;for(var G=0,Q=E.length;Q>G;G++){var L=E[G];"wheel"===L&&!Y.handle_wheel&&Y.handle_mousewheel&&(Y.handle_wheel=function(k){uo(Y,k)}),Y["handle_"+L]&&Xp(L,Y.getView(),Y)}},u.removeListeners=function(){var s=this,A=s.__events__;if(A){s.__events__=_;for(var X=0,B=A.length;B>X;X++)s["handle_"+A[X]]&&Ll(A[X],s.getView(),s)}}},ms_fire:function(x){x.mp=function(J,C,R){this.addPropertyChangeListener(J,C,R)},x.ump=function(m,D){this.removePropertyChangeListener(m,D)},x.fp=function(T,j,d,F,z){return this.firePropertyChange(T,j,d,F,z)},x.addPropertyChangeListener=function(P,h,W){var G=this;G._62I||(G._62I=new Zb),G._62I.add(P,h,W)},x.removePropertyChangeListener=function(W,U){this._62I&&this._62I.remove(W,U)},x.firePropertyChange=function(n,i,u,S,C){if(S){if(S(i,u))return!1}else if(i===u)return!1;var t=this,_=C||{};return _.property=n,_.oldValue=i,_.newValue=u,_.source=t,_.data=t,t._62I&&t._62I.fire(_),t.onPropertyChanged&&t.onPropertyChanged(_),!0}},ms_attr:function(i){i.a=function(z,$){var E=this;if(2===arguments.length)E.setAttr(z,$);else{if(!Dg(z))return E.getAttr(z);for(var C in z)E.setAttr(C,z[C])}return E},i.getAttr=function(C,u){if(u===_&&(u=1),this._attrObject&&C in this._attrObject)return this._attrObject[C];if(this.getImage){var I=this.getImage();if(zq(I)&&(I=pr[I]),Dg(I)&&"dataBindings"in I)for(var v=I.dataBindings,A=v.length-1;A>=0;A--){var Z=v[A];if(Z.attr===C){if("defaultValue"in Z)return Z.defaultValue;break}}}return u?h[C]:_},i.setAttr=function(d,Q){var O=this;O._attrObject||(O._attrObject={});var D=O._attrObject[d];Q===_?delete O._attrObject[d]:O._attrObject[d]=Q,O.fp&&O.fp("a:"+d,D,Q)&&O.onAttrChanged&&O.onAttrChanged(d,D,Q)},i.getSerializableAttrs=function(){var J,x={};for(J in this._attrObject)x[J]=1;return x}},ms_bnb:function(u){u.getBodyColor=function(q){return q.s("body.color")},u.getBorderColor=function(o){return o.s("border.color")}},_51o:function(J){J.mi=function(q,s,i){this.addInteractorListener(q,s,i)},J.umi=function(h,X){this.removeInteractorListener(h,X)},J.fi=function(p){this.fireInteractorEvent(p)},J.addInteractorListener=function(X,x,_){var e=this;e._63I||(e._63I=new Zb),e._63I.add(X,x,_)},J.removeInteractorListener=function(F,u){this._63I&&this._63I.remove(F,u)},J.fireInteractorEvent=function(M){this._63I&&this._63I.fire(M)},J.setInteractors=function(r){var s=this,h=s._interactors;h&&h.each(function(n){n.tearDown()}),mh(r)&&(r=new _n(r)),s._interactors=r,r&&r.each(function(Q){Q.setUp()}),s.fp("interactors",h,r),s.invalidateSelection()},J.getInteractors=function(){return this._interactors}},_49o:function(o){o._44O=F,o._45O=F,o.getTopPainters=function(){return this._44O},o.getBottomPainters=function(){return this._45O},o.addTopPainter=function(M){var v=this;v._44O||(v._44O=new _n),v._44O.contains(M)||(v._44O.add(M),v.redraw&&v.redraw())},o.removeTopPainter=function(w){var s=this;s._44O&&(s._44O.remove(w),s.redraw&&s.redraw())},o.addBottomPainter=function(h){var u=this;u._45O||(u._45O=new _n),u._45O.contains(h)||(u._45O.add(h),u.redraw&&u.redraw())},o.removeBottomPainter=function(S){var d=this;d._45O&&(d._45O.remove(S),d.redraw&&d.redraw())},o._93db=function(I,C){var n=this;n._45O&&n._45O.each(function(T){T.draw?T.draw(I,C):T.call(n,I,C)})},o._92db=function(p,N){var x=this;x._44O&&x._44O.each(function(e){e.draw?e.draw(p,N):e.call(x,p,N)})}},ms_sm:function(S){S.sm=function(){return this.getSelectionModel()},S.setSelectableFunc=function(L){this.sm().setFilterFunc(L)},S.getSelectableFunc=function(){return this.sm().getFilterFunc()},S.getSelectionModel=function(){var H=this;return H._selectionModel?H._selectionModel:H.dm().sm()},S.isSelectionModelShared=function(){return!this._selectionModel},S.setSelectionModelShared=function(M){var S=this,K=!S._selectionModel,i=S.handleSelectionChange,g=S.dm();K!==M&&(S.invalidateSelection&&S.invalidateSelection(),M?(g.sm().ms(i,S),S._selectionModel.ums(i,S),S._selectionModel.dispose(),S._selectionModel=F):(g.sm().ums(i,S),S._selectionModel=new so(g),S._selectionModel.ms(i,S)),S.onSelectionModelSharedChanged(),S.fp("selectionModelShared",K,M))},S.onSelectionModelSharedChanged=function(){var I=this;I.redraw(),I.invalidateSelection&&I.invalidateSelection()},S.removeSelection=function(){var W=this.dm();W.beginTransaction(),this.sm().toSelection().each(W.remove,W),W.endTransaction()},S.selectAll=function(){var d=this;d.sm().ss(d.dm().toDatas(function(y){return d.isVisible(y)&&d.isSelectable(y)}))},S.isSelected=function(P){return this.sm().co(P)},S.isSelectedById=function(o){var i=this.dm().getDataById(o);return i?this.isSelected(i):!1},S.isSelectable=function(P){return this.sm().isSelectable(P)}},ms_tx:function(n){n._64I=0,n._65O=0,n.isScrollable=function(){return this.getWidth()<this._64I},n._40o=function(){return this.isScrollable()},n.getLogicalPoint=function(X){return hl(X,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},n.tx=function(H){return H===_?this.getTranslateX():(this.setTranslateX(H),void 0)},n.getTranslateX=function(){return this._65O},n.setTranslateX=function(V){var C=this,T=C.getWidth()-C._64I;T>V&&(V=T),V>0&&(V=0),V=U(V);var l=C._65O;C._65O=V,C.fp(Ec,l,V)}},ms_ty:function(K){K._23Q=0,K._66O=0,K._41o=function(){return this.getHeight()<this._23Q},K.getLogicalPoint=function(k){return hl(k,this._canvas||this._view,this.tx?this.tx():0,this.ty())},K.ty=function(o){return o===_?this.getTranslateY():(this.setTranslateY(o),void 0)},K.getTranslateY=function(){return this._66O},K.setTranslateY=function(L){var W=this,$=W.getHeight()-W._23Q;$>L&&(L=$),L>0&&(L=0),L=U(L);var B=W._66O;W._66O=L,W.fp(ln,B,L)}},ms_txy:function(q){q._65O=0,q._66O=0,q.tx=function($){return $===_?this.getTranslateX():(this.setTranslateX($),void 0)},q.ty=function(G){return G===_?this.getTranslateY():(this.setTranslateY(G),void 0)},q.onTranslateEnded=function(){},q.setTranslate=function(U,R,u){var k=this;if(u=Nk(u)){k._65I&&k._65I.stop(!0);var I=k.tx(),h=k.ty();u.action=function(i){k.setTranslate(I+(U-I)*i,h+(R-h)*i)},u._37o=function(){delete k._66I,delete k._65I,k.onTranslateEnded()},k._66I=1,k._65I=$h(u)}else k.tx(U),k.ty(R)},q.getTranslateX=function(){return this._65O},q.setTranslateX=function(D){var g=this;D=g.adjustTranslateX(D);var m=g._65O;g._65O=D,g.fp(Ec,m,D)},q.getTranslateY=function(){return this._66O},q.setTranslateY=function(j){var D=this;j=D.adjustTranslateY(j);var o=D._66O;D._66O=j,D.fp(ln,o,j)},q.adjustTranslateX=function(k){return U(k)},q.adjustTranslateY=function(w){return U(w)},q.translate=function(n,P,N){this.setTranslate(this.tx()+n,this.ty()+P,N)},q.getLogicalPoint=function(f){var h=this;return hl(f,this._canvas||h._view,h.tx(),h.ty())}},ms_dm:function(r){r.dm=function(u){return u?(this.setDataModel(u),void 0):this.getDataModel()},r.getDataModel=function(){return this._dataModel}},ms_lp:function(b){b.lp=function(w){return this.getLogicalPoint(w)}},ms_v:function(u){u._disabled=!1,u.setDisabled=function(u,K){var M=this,y=M._disabled;y!==u&&(y&&(Ol(M._63O),delete M._63O),u&&(of(M._view,M._63O=Tn(K)),M.iv()),M._disabled=u,M.fp("disabled",y,u))},u.isDisabled=function(){return this._disabled},u.getDisabledDiv=function(){return this._63O},u.getView=function(){return this._view},u.addToDOM=function(T){var u=this,t=u.getView(),z=t.style;T=T||v.body,T.appendChild(t),z.left="0",z.right="0",z.top="0",z.bottom="0",x(b,"resize",function(){u.iv()}),u.iv()},u.getWidth=function(){return this._view.clientWidth},u.getHeight=function(){return this._view.clientHeight},u.setWidth=function(a){var l=this;l._view.style.width=a+ke,l.iv(),l.fp&&l.fp(ye,F,a)},u.setHeight=function(O){var t=this;t._view.style.height=O+ke,t.iv(),t.fp&&t.fp(je,F,O)},u.setFocus=function(Y){var f=this,B=f._currentEditor;return Y&&B&&(B.getView&&(B=B.getView()),B.contains(Y.target))?!1:(fj(f._view),f.endEditing&&f.endEditing(),f.fireViewEvent("focus"),!0)},u.iv=function(K){this.invalidate(K)},u.invalidate=function(y){var X=this;X._68I||(X._68I=1,Vp(X.validate,X,F,y),X.onInvalidated&&X.onInvalidated(),X.fireViewEvent("invalidate"))},u.validate=function(){var R=this,E=R._view;if(R._68I&&(delete R._68I,E.parentNode))if(0===E.offsetWidth&&0===E.offsetHeight&&R._67I!==F)R._67I===_&&(R._67I=C.reinvalidateCount),R._67I>0?R._67I--:R._67I=F,R.iv();else{R.fireViewEvent("beginValidate"),R.validateImpl(),R.onValidated&&R.onValidated(),R.fireViewEvent("validate");var b=R._63O;b&&(E.lastChild!==b&&(Ol(b),of(E,b)),mm(b,0,0,R.getWidth(),R.getHeight())),lj(R),Jl(R),rm(R)}},u.layout=function(N,h,D,T){1===arguments.length?mm(this,N):mm(this,N,h,D,T)},u.addViewListener=function(n,Y,e){var K=this;K._67O||(K._67O=new Zb),K._67O.add(n,Y,e)},u.removeViewListener=function(x,u){this._67O.remove(x,u)},u.fireViewEvent=function(f){var m=this;m._67O&&(zq(f)&&(f={kind:f}),m._67O.fire(f)),C.viewListener&&C.viewListener(m,f)}},ms_tip:function(I){I.setToolTipEnabled=function(o){var p=this;o?Zk||p._13o||(p.enableToolTip(),p.fp("toolTipEnabled",!1,!0)):p._13o&&(p.disableToolTip(),p.fp("toolTipEnabled",!0,!1))},I.isToolTipEnabled=function(){return!!this._13o},I.enableToolTip=function(){var N=this;if(!Zk&&!N._13o){N._13o=function(s){var e=N.getToolTip(s);e!=F?(C.toolTipContinual&&C.isToolTipShowing()?Ui(s,e):(qn(),Rn={timeout:gr(ch,mg),e:s,info:e}),Er={e:s,view:N}):qn()};var h=N.getView();x(h,$p,N._13o),x(h,"mouseleave",C.hideToolTip)}},I.disableToolTip=function(){var N=this;if(N._13o){var g=N.getView();d(g,$p,N._13o),d(g,"mouseleave",C.hideToolTip),delete N._13o}},I.getToolTip=function(M){var v=this;if(v.getDataAt){var _=v.getDataAt(M);return _?_.getToolTip():F}return v.getValue?v.getValue():void 0}},_52o:function(i){i._zoom=1,i._29I=wq,i.zoomIn=function(D,M){this.setZoom(this._zoom*Ig,D,M)},i.zoomOut=function(R,z){this.setZoom(this._zoom/Ig,R,z)},i.zoomReset=function(P,b){this.setZoom(1,P,b)},i.scrollZoomIn=function(e){this.setZoom(this._zoom*Ke,F,e)},i.scrollZoomOut=function(S){this.setZoom(this._zoom/Ke,F,S)},i.pinchZoomIn=function(j){this.setZoom(this._zoom*wb,F,j)},i.pinchZoomOut=function(v){this.setZoom(this._zoom/wb,F,v)},i.adjustZoom=function(R){return Ne>R?Ne:R>Kj?Kj:R},i.getZoom=function(){return this._zoom},i.setZoom=function(n,J,G){var C=this;if(J=Nk(J)){C._14o&&C._14o.stop(!0);var D=C._zoom;J.action=function(X){C._96O(D+(n-D)*X,G)},J._37o=function(){delete C._zooming,delete C._14o,C.onZoomEnded()},C._zooming=1,C._14o=$h(J)}else C._96O(n,G)},i._96O=function(P,T){var w=this;if(P=w.adjustZoom(P),P!==w._zoom){w.validate();var V=w._29I,c=w._zoom;0!==V.width&&0!==V.height&&(T=T?T:{x:V.x+V.width/2,y:V.y+V.height/2},w.tx((T.x-V.x)*c-T.x*P),w.ty((T.y-V.y)*c-T.y*P)),w._zoom=P,w.fp("zoom",c,P)}}},ms_edge:function(N){N._2I=function(F){var j=this;j._44I||(j._44I=new _n),j._42I||(j._42I=new _n),j._44I.add(F),j._42I.add(F),j._20I()},N._4I=function(S){var E=this;E._44I||(E._44I=new _n),E._43I||(E._43I=new _n),E._44I.add(S),E._43I.add(S),E._20I()},N._16I=function(_){var A=this;A._44I.remove(_),A._42I.remove(_),A._44I.isEmpty()&&delete A._44I,A._42I.isEmpty()&&delete A._42I,A._20I()},N._18I=function(p){var m=this;m._44I.remove(p),m._43I.remove(p),m._44I.isEmpty()&&delete m._44I,m._43I.isEmpty()&&delete m._43I,m._20I()},N._20I=function(){var T=this;if(delete T._45I,!T._44I||T._44I.isEmpty())return delete T._70O,void 0;var q;T._44I.each(function(E){E.isLooped()&&(q||(q={}),q[E._id]||(T._45I||(T._45I=new _n),T._45I.add(E),q[E._id]=E))}),q?(T._70O=new _n,T._44I.each(function(d){q[d._id]?"A"===q[d._id]||(q[d._id]="A",T._70O.add(d)):T._70O.add(d)})):T._70O=T._44I},N.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},N.getSourceAgentEdges=function(){return this._46I},N.getTargetAgentEdges=function(){return this._47I},N._1I=function(w){var V=this;V._46I||(V._46I=new _n),V._48I||(V._48I=new _n),V._46I.add(w),V._48I.add(w),V._19I()},N._3I=function(X){var x=this;x._47I||(x._47I=new _n),x._48I||(x._48I=new _n),x._47I.add(X),x._48I.add(X),x._19I()},N._15I=function(R){var B=this;B._46I.remove(R),B._48I.remove(R),B._46I.isEmpty()&&delete B._46I,B._48I.isEmpty()&&delete B._48I,B._19I()},N._17I=function(P){var I=this;I._47I.remove(P),I._48I.remove(P),I._47I.isEmpty()&&delete I._47I,I._48I.isEmpty()&&delete I._48I,I._19I()},N._19I=function(){var x=this;delete x._49I;var R=x._48I;if(R&&!R.isEmpty()){var W={};R.each(function(o){W[o._id]?x._49I||(x._49I=new _n):W[o._id]=o}),x._49I?R.each(function(J){W[J._id]&&(x._49I.add(J),delete W[J._id])}):x._49I=R}},N.getLoopedEdges=function(){return this._45I},N.getEdges=function(){return this._70O},N.getAgentEdges=function(){return this._49I},N.getSourceEdges=function(){return this._42I},N.getTargetEdges=function(){return this._43I},N._8I=function(){this._70O&&this._70O.each(function(n){n._7I()})}},ms_shadow:function(o){tr.PARAMS.forEach(function(L){var Q=L.replace(/(^|\.)[a-z]/g,function(Z){return Z[Z.length-1].toUpperCase()}),G=Q.charAt(0).toLowerCase()+Q.substr(1);o["getShadow"+Q]=function(){return this._getShadowParam(G)},o["setShadow"+Q]=function(s){this._setShadowParam(G,s)}}),o.enableShadow=function(J){this.shadowMap.setShadow(!0,J)},o.disableShadow=function(){this.shadowMap.setShadow(!1)},o._getShadowParam=function(q){return this.shadowMap.getShadow()[q]},o._setShadowParam=function(v,Z){var R=this._getShadowParam(v),C={};C[v]=Z;var o=this.shadowMap;o.setShadow(o.enable,C),this.firePropertyChange("shadow"+v.charAt(0).toUpperCase()+v.substr(1),R,Z)}}};Xf(C,{getVersion:function(){return"7.2.3-dev8"}},!0),Xf(C,{numberDigits:5,crossOrigin:"",baseZIndex:_,isTouchable:Zk,mockTouch:!0,devicePixelRatio:b.devicePixelRatio?b.devicePixelRatio:b.screen?b.screen.deviceXDPI/b.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:S.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Ee},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(W){return W*W},labelColor:hi,labelSelectColor:Hh,labelFont:"12px arial, sans-serif",widgetIndent:Zk?30:20,widgetRowHeight:Zk?30:20,widgetHeaderHeight:Zk?32:22,widgetTitleHeight:Zk?34:24,scrollBarColor:Qi,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Zk?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Io,intersectionLineLine:Qr,isEnter:vb,isEsc:dp,isDelete:sl,isSpace:pc,isLeft:Re,isUp:Wk,isRight:se,isDown:mo,isTouchEvent:os,getTarget:Ah,isString:zq,isNumber:kd,isBoolean:yb,isArray:mh,isSelectAll:Oh,isFunction:ne,isObject:Dg,getPropertyValue:Zh,setPropertyValue:Sc,addMethod:Xf,createGradient:function(s,O,H,R,v,u,x,r){var t=Te[O];return t(s,H,R,v,u,x,r)},appendToScreen:function(u){u=u.getView?u.getView():u,(v.fullscreenElement||v.mozFullScreenElement||v.webkitFullscreenElement||v.msFullscreenElement||v.body).appendChild(u)},encodeString:function(I){return V.Math.encodeBase64(I,C.encodeStringKey)},decodeString:function(j){return V.Math.decodeBase64(j,C.encodeStringKey)},findView:function(Q){var F=function(Z,m){var P=m._ht;P&&Z.push(P);var I=m.children,u=I.length;if(u)for(var h=0;u>h;h++)F(Z,I[h])},y=[];F(y,v.body);var H=function(L,i){for(var f="2d"===i?Rp.GraphView:Mj.Graph3dView,S=0,R=L.length;R>S;S++)if(L[S]instanceof f)return y[S];return null};return"all"===Q?y:"2d"===Q?H(y,"2d"):"3d"===Q?H(y,"3d"):H(y,"3d")||H(y,"2d")},toggleFullscreen:function(h){var e=h.getView();if(v.fullscreenElement||v.mozFullScreenElement||v.webkitFullscreenElement||v.msFullscreenElement)v.exitFullscreen?v.exitFullscreen():v.msExitFullscreen?v.msExitFullscreen():v.mozCancelFullScreen?v.mozCancelFullScreen():v.webkitExitFullscreen&&v.webkitExitFullscreen();else{var a=!0;if(h.isSelfViewEvent){var q=h.getX(),Y=h.getY(),Z=h.getWidth(),M=h.getHeight(),n=e.style.background,r=e.style.backgroundColor;n||r||(e.style.backgroundColor="white"),e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen();var p=setInterval(function(){if(e!==(v.fullscreenElement||v.mozFullScreenElement||v.webkitFullscreenElement||v.msFullscreenElement))clearInterval(p),h.setX(q),h.setY(Y),h.setWidth(Z),h.setHeight(M),h._fullscreen=!1,e.style.oldBackgroundColor=r,h.iv();else{var N=V.Default.getWindowInfo();(a||N.width!==h.getWidth()||N.height!==h.getHeight())&&(h.setX(N.left),h.setY(N.top),h.setWidth(N.width),h.setHeight(N.height),h._fullscreen=!0,h.iv(),a=!1)}},500)}else{var j=e.style.left,R=e.style.top,Z=e.style.width,M=e.style.height,n=e.style.background,r=e.style.backgroundColor;n||r||(e.style.backgroundColor="white"),e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen();var p=setInterval(function(){if(e!==(v.fullscreenElement||v.mozFullScreenElement||v.webkitFullscreenElement||v.msFullscreenElement))clearInterval(p),e.style.left=j,e.style.top=R,e.style.width=Z,e.style.height=M,e.style.oldBackgroundColor=r,h.iv();else{var s=V.Default.getWindowInfo();(a||s.width!==h.getWidth()||s.height!==h.getHeight())&&(mm(h),a=!1)}},500)}}},appendTimeStamp:function(D){return D},setCompType:function(v,U){zq(U)&&U.substr(0,12)==tq&&(U=C.parse(U)),ne(U)||Dg(U)?fi[v]=U:qi(v)},getCompType:function(h){var z=fi[h];return z===_&&Mr.test(h)&&qi(h),z},getCompTypeMap:function(){return fi},drawCompType:function(V,W,B,c,G,a){V(W,B,c,G,a)},numberListener:function(){var A={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(n){var N=n.keyCode;A[N]||65===N&&C.isCtrlDown(n)||86===N&&C.isCtrlDown(n)||67===N&&C.isCtrlDown(n)||88===N&&C.isCtrlDown(n)||N>=35&&40>=N||(n.shiftKey||48>N||N>57)&&(96>N||N>105)&&n.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(p){var M=p.target.tagName;("DIV"===M||"CANVAS"===M)&&!(C.ignoreKeyCodes.indexOf(p.keyCode)>=0)&&("keydown"!==p.type||Re(p)||se(p)||Wk(p)||mo(p)||sl(p)||65===p.keyCode&&(p.metaKey||p.ctrlKey))&&p.cancelable===!0&&(p.preventDefault(),p.preventManipulation&&p.preventManipulation())},getWindowInfo:function(){var g=v.documentElement,$=g&&(g.scrollLeft||g.scrollTop)?g:v.body;return{target:$,left:$.scrollLeft,top:$.scrollTop,width:b.innerWidth||$.clientWidth,height:b.innerHeight||$.clientHeight}},isDragging:function(){return!!Ee},isLeftButton:function(e){return os(e)?!0:0===e.button},isMiddleButton:function(V){return os(V)?!1:V&&(1===V.button||4&(V.buttons||0))},isRightButton:function(W){return os(W)?!1:W&&(2===W.button||2&(W.buttons||0))},isInput:function(E){if(!E)return!1;var c=E.tagName;return"INPUT"===c||"TEXTAREA"===c||"SELECT"===c},getTouchCount:function(Y){return os(Y)?Y.touches.length:1},isDoubleClick:function(){function O(o){o.details=0,o.timeout=null,o.lastPoint=null}var g={};return hq=new In,Pp=hq.getTime(),function($){if(_k($)>1)return!1;var c=$.button==F?"":$.button,o=$.type+c,s=o+"_isDoubleClick",I=g[o];if(I||(I=g[o]={details:0,timeout:null,lastPoint:null}),$[s]===_){$[s]=!0;var l=ci($);I.timeout&&(Iq(I.timeout),I.timeout=null);var Z=os($)?C.doubleTouchRange:C.doubleClickRange;I.lastPoint&&kj(I.lastPoint,l)>Z&&O(I),I.lastPoint=l,I.details++,I.timeout=gr(function(){O(this)}.bind(I),C.doubleClickSpeed)}return 2===I.details}}(),isShiftDown:function(o){return o?o.shiftKey:Wc["16"]},isCtrlDown:function(s){return s?Yo?s.metaKey:s.ctrlKey:Yo?Wc["91"]:Wc["17"]},getClientPoint:function(B){return os(B)&&(B=ab(B)),{x:B.clientX,y:B.clientY}},isMouseEvent:function(I){return I instanceof MouseEvent||0===I.type.indexOf("mouse")},getTargetElement:function(D){var P,f=pb(D);if(P=C.isMouseEvent(D)||!v.elementFromPoint?D.target:v.elementFromPoint(f.x,f.y),Ic&&v.elementFromPoint){for(var W=[],e=[];"none"===P.style.pointerEvents;)W.push(P),e.push(P.style.display||""),P.style.display="none",P=v.elementFromPoint(f.x,f.y);W.forEach(function(R,O){R.style.display=e[O]})}return P},getPagePoint:function(M){return os(M)&&(M=ab(M)),{x:M.pageX,y:M.pageY}},createObject:function(P,u){var U=new P;for(var s in u){var A=u[s];if(ne(A))U[s]=A;else if(0===s.indexOf("s:"))U.s(s.substr(2),u[s]);else if(0===s.indexOf("a:"))U.a(s.substr(2),u[s]);else{var F=Ro(s),A=u[s];U[F]?(U[F](A),"setToolTip"===F&&U.enableToolTip&&U.enableToolTip()):U[s]=A}}return U},setImage:function(g,c,V,i){var r=arguments.length;4===r?cc(g,i,c,V):2===r?zq(c)?c.substr(0,12)==tq?mb(g,C.parse(c)):cc(g,c):mb(g,c):1===r&&cc(g,g)},getImage:function(k,Q,j){var S;if(k==F)return F;if(Dg(k)?S=k:(S=pr[k],k&&S===_&&(Hb&&Hb[k]||cc(k,k))),Q&&S&&S.tagName){var t;t="override"===j?"colors_override":"override_rgb"===j?"colors_override_rgb":"override_a"===j?"colors_override_a":"colors",S[t]||(S[t]={__count__:0});var w=S[t][Q];return w||(S[t].__count__>C.imageCacheThreshold&&(S[t]={__count__:0}),w=Oc(S,Sj(Q),S.width,S.height,j),S[t][Q]=w,S[t].__count__++),w}return S},isImageComplete:function(Z,x,o){var i=ij(Z);if(!i)return!1;if(i.tagName)return i.complete;for(var v,Z,p,f=i.comps,r=!0,z=0,m=f.length;m>z;z++)if(v=f[z],p=v.type,"image"===v.type){Z=v.name,Z&&Z.func&&(Z=cs(Z,x));var B=Oe(Z,x,o);if(!B){r=!1;break}}else if(Mr.test(p)&&C.getCompType(p)===_){r=!1,qi(p);break}return r},getId:function(){var S=1;return function(){return++S}}(),callLater:function(j,O,J,P){var Y=function(){j.apply(O,J)};return P?gr(Y,P):b.requestAnimationFrame(Y)},cancelLater:function(x,p){p?Iq(x):b.cancelAnimationFrame(x)},clone:function(y){if(null==y||"object"!=typeof y)return y;if(y instanceof Date){var n=new Date;return n.setTime(y.getTime()),n}if(y instanceof Array){for(var n=[],e=0,G=y.length;G>e;e++)n[e]=Hq(y[e]);return n}if(y instanceof _n){for(var n=new _n,e=0,G=y.length;G>e;e++)n.set(e,Hq(y.get(e)));return n}if(y instanceof Lq)return y;if(y instanceof ip){var n=new ip;return n.deserialize(y.serialize()),n}if(y instanceof f){var n={};for(var W in y)y.hasOwnProperty(W)&&(n[W]=Hq(y[W]));return n}return y},callWhenLoaded:function(M,T){T=T||100;var c=wk(M,T);Ip||(Ip={}),Ip[c]={tick:c,cb:M,delay:T}},beforeLoadURL:function(o,O){if(Ip){var d={};for(var O in Ip){var U=Ip[O];Iq(U.tick);var F=wk(U.cb,U.delay);d[F]={tick:F,delay:U.delay,cb:U.cb}}Ip=d}return C.convertURL?C.convertURL(o,O):o},convertURL:function(j){return j},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return C.getImage("default_blank")},resizeImagePOT:function($,p){if(!$||!$.tagName)return $;var c=$.width,U=$.height;if(!c||!U)return $;if(Jr.isPOT(c)&&Jr.isPOT(U)&&(!p||c===U))return $;var m,C;p?C=m=Jr.nearestPOT(Math.min(c,U)):(m=Jr.nearestPOT(c),C=Jr.nearestPOT(U));var Y=ys(),D=Y.getContext("2d");return Db(Y,m,C,1),D.drawImage($,0,0,c,U,0,0,m,C),Y},sortFunc:function(C,z){if(C===z)return 0;if(C==F&&z!=F)return 1;if(C!=F&&z==F)return-1;if(C==F&&z==F)return 0;var h,U=typeof C,p=typeof z;return U===Yf&&p===Yf?h=C.localeCompare(z):U===Lh&&p===Lh&&(h=C-z),h===_&&(h=(""+C).localeCompare(""+z)),h>0?1:0>h?-1:0},getClassMap:function(){return Hi},getClass:function(i){if(zq(i)){var H,P=Hi[i];if(!P){H=i.split("."),P=b;for(var V=0;V<H.length;V++)P=P[H[V]];Hi[i]=P}return P}return i},def:function(X,o,d){var i,$,_,G=function(){};if(G.prototype=o.prototype,i=new G,zq(X)){if(Hi[X])throw"'"+X+"' already defined";_=nk(X),i.getClassName=function(){return X}}else _=X;if(i.constructor=_,i.getClass=function(){return _},i.getSuperClass=function(){return o},d)for($ in d)km[$]&&km.hasOwnProperty($)?km[$](i,d):eq(i,d,$);_.prototype=i,_.superClass=o.prototype},startAnim:function(){var s=function(D){D.duration&&(D.startTime=Ln()),D.timeId=Vp(D.tick,F,F,D.interval)};return function(N){return N=Hq(N),N.easing=N.easing||C.animEasing,N.duration||N.frames||(N.duration=C.animDuration),N.t=0,N.duration?N.interval=0:(N.frame=0,N.interval=N.interval||10),N.tick=function(){if(N.duration){var V=(Ln()-N.startTime)/N.duration;if(V>1&&(V=1),N.t=V,N.action(N.easing(V),V),!N.isRunning())return;1===V?N.stop():N._isPaused||(N.timeId=Vp(N.tick))}else{if(N.frame++,V=N.t=N.frame/N.frames,N.action(N.easing(V),V),!N.isRunning())return;N.frame<N.frames?N._isPaused||(N.timeId=Vp(N.tick,F,F,N.interval)):N.stop()}},N.resume=function(){N._isPaused&&(delete N._isPaused,N.duration?N.t<1&&(N.startTime=Ln()-N.duration*N.t,N.timeId=Vp(N.tick)):N.frame<N.frames&&(N.timeId=Vp(N.tick,F,F,N.interval)))},N.pause=function(){Fg(N.timeId,!N.duration),N._isPaused=!0},N.isPaused=function(){return this._isPaused},N.stop=function(C){N.isRunning()&&(Fg(N.timeId,!N.duration),delete N.timeId,N.duration?N.t<1&&C&&(N.t=1,N.action(N.easing(1),1)):N.frame<N.frames&&C&&(N.frame=N.frames,N.action(N.easing(1),1)),N._37o&&N._37o(),N.finishFunc&&N.finishFunc())},N.isRunning=function(){return N.timeId!=F},N.delay?Vp(s,F,[N],N.delay):s(N),N}}(),getTextSize:function(){var z={},m=v?ys().getContext("2d"):F;return function(n,Z){m.font=n?n:di;var Q=z[m.font];return Q||(Q=2*m.measureText("e").width+4,z[m.font]=Q),{width:m.measureText(Z).width+C.textExtraWidth,height:Q}}}(),drawText:function(V,e,Z,z,t,E,f,n,m,p,H){if(e!=F){var W=Tg(Z,e),O={};if(O.y=p&&p!==Jf?p===Ob?E+W.height/2:E+n-W.height/2:E+n/2,O.x=m&&m!==aq?m===zc?t+f-W.width/2:t+f/2:t+W.width/2,tp(V,e,O,Z,z),H){V.font=Z;var J=V.measureText(e);V.beginPath(),V.strokeStyle=z,"underline"===H?(V.moveTo(O.x-W.width/2,O.y+J.actualBoundingBoxDescent+1),V.lineTo(O.x+W.width/2,O.y+J.actualBoundingBoxDescent+1)):"line.through"===H?(V.moveTo(O.x-W.width/2,O.y),V.lineTo(O.x+W.width/2,O.y)):"overline"===H&&(V.moveTo(O.x-W.width/2,O.y-J.fontBoundingBoxAscent),V.lineTo(O.x+W.width/2,O.y-J.fontBoundingBoxAscent)),V.stroke()}}},getDistance:function(f,J){var i=f.length;return J?3===i?A(Ej(f[0]-J[0])+Ej(f[1]-J[1])+Ej(f[2]-J[2])):2===i?A(Ej(f[0]-J[0])+Ej(f[1]-J[1])):f.z===_?A(Ej(J.x-f.x)+Ej(J.y-f.y)):A(Ej(J.x-f.x)+Ej(J.y-f.y)+Ej(J.z-f.z)):3===i?A(Ej(f[0])+Ej(f[1])+Ej(f[2])):2===i?A(Ej(f[0])+Ej(f[1])):void 0},brighter:function(V,u){return 0>u&&(u=-u),Oi(V,u?u:40)},darker:function(z,C){return C>0&&(C=-C),Oi(z,C?C:-40)},unionPoint:function(h,Q){if(!h)return F;if(2===arguments.length)return h&&Q?{x:B(h.x,Q.x),y:B(h.y,Q.y),width:D(h.x-Q.x),height:D(h.y-Q.y)}:F;var I=h;if(I._as&&(I=I._as),I.length===_)return F;var r=I.length;if(0>=r)return F;for(var S=1,b=I[0],P={x:b.x,y:b.y,width:0,height:0};r>S;S++){b=I[S];var W=B(P.x,b.x),J=i(P.x+P.width,b.x),u=B(P.y,b.y),y=i(P.y+P.height,b.y);P.x=W,P.y=u,P.width=J-W,P.height=y-u}return P},unionRect:function(z,Q){if(z&&!Q)return Hq(z);if(!z&&Q)return Hq(Q);if(z&&Q){var K={x:B(z.x,Q.x),y:B(z.y,Q.y)};return K.width=i(z.x+z.width,Q.x+Q.width)-K.x,K.height=i(z.y+z.height,Q.y+Q.height)-K.y,K}return F},containsPoint:function(r,i,n,K){if(K!=F&&1!==K){var C=r.x+r.width/2,j=r.y+r.height/2;r={x:C-r.width/2*K,y:j-r.height/2*K,width:r.width*K,height:r.height*K}}if(n){var Y=r.width/2,U=r.height/2,Q=u(-n),A=L(-n),H=i.x-r.x-Y,f=i.y-r.y-U;return i={x:A*H-Q*f,y:Q*H+A*f},Hd({x:-Y,y:-U,width:r.width,height:r.height},i)}return!(!r||i.x<r.x||i.y<r.y||i.x>r.x+r.width||i.y>r.y+r.height)},containsRect:function(I,K){if(!I||!K)return!1;var e=K.x,U=K.y,X=K.width,p=K.height,z=I.width,W=I.height;if(0>(z|W|X|p))return!1;var P=I.x,S=I.y;if(P>e||S>U)return!1;if(z+=P,X+=e,e>=X){if(z>=P||X>z)return!1}else if(z>=P&&X>z)return!1;if(W+=S,p+=U,U>=p){if(W>=S||p>W)return!1}else if(W>=S&&p>W)return!1;return!0},intersectsRect:function(F,N){if(!F||!N)return!1;var M=N.width,w=N.height,Y=F.width,U=F.height;if(0>=Y||0>=U||0>=M||0>=w)return!1;var t=N.x,n=N.y,R=F.x,m=F.y;return Y+=R,U+=m,M+=t,w+=n,Y>t&&U>n&&M>R&&w>m},intersection:function(f,K){if(!f||!K)return F;var H=K.x,P=K.y,M=f.x,o=f.y,W=H,D=P,g=M,v=o;return W+=K.width,D+=K.height,g+=f.width,v+=f.height,M>H&&(H=M),o>P&&(P=o),W>g&&(W=g),D>v&&(D=v),W-=H,D-=P,0>=W||0>=D?F:{x:H,y:P,width:W,height:D}},grow:function(p,Q,B){B===_&&(B=Q),p.x-=Q,p.y-=B,p.width=p.width+2*Q,p.height=p.height+2*B},getScreenPoint:function(j,s,f,c,T,Y,M){var J=f.getBoundingClientRect(),t=j*(Y||1)-f.scrollLeft+(c||0),C=s*(M||1)-f.scrollTop+(T||0),G=Yh(f,!1);if(G){var o=new io(t,C,0);return o.applyMatrix4(G),console.log(o),{x:o.x,y:o.y}}return{x:t+J.left,y:C+J.top}},getLogicalPoint:function(b,z,J,o,n,Q){var k,X,C=z.getBoundingClientRect();b.target?(Ef(b)?Yo?Wc["91"]=!0:Wc["17"]=!0:Yo?Wc["91"]=!1:Wc["17"]=!1,Wc["16"]=er(b)?!0:!1,b=os(b)?ab(b):b,k=b.clientX,X=b.clientY):(k=b.x,X=b.y);var M=Yh(z,!0);if(M){var f=new io(k,X,0);f.applyMatrix4(M);do{if(Math.abs(f.z)<=1e-6)break;var R=new io(k,X,1);if(R.applyMatrix4(matrix),Math.abs(R.z)<=1e-6){f=R;break}if(R.sub(f),Math.abs(R.z)<=1e-6)break;f.addScaledVector(R,-f.z/R.z)}while(!1);return{x:(f.x+z.scrollLeft-(J||0))/(n||1),y:(f.y+z.scrollTop-(o||0))/(Q||1)}}return{x:(k-C.left+z.scrollLeft-(J||0))/(n||1),y:(X-C.top+z.scrollTop-(o||0))/(Q||1)}},removeHTML:function(){var E;return function(e){return e&&e.getView&&(e=e.getView()),e&&e.parentNode?E===e?!0:(E=e,e.parentNode.removeChild(e),E=F,!0):!1}}(),getToolTipDiv:function(){if(!nb){nb=ir(),Uc=ir();var X=nb.style;C.baseZIndex!=F&&(X.zIndex=Pq(C.baseZIndex)+3+""),X.whiteSpace="nowrap",X.color=C.toolTipLabelColor,X.background=C.toolTipBackground,X.font=C.toolTipLabelFont,X.padding="5px",X.boxShadow="0px 0px 3px "+C.toolTipShadowColor}return nb},isToolTipShowing:function(){return nb&&nb.parentNode?!0:Uc&&Uc.parentNode?!0:!1},updateToolTipContent:function(v,U){if(C.isToolTipShowing()&&(U||(U=Er&&Er.view),v===_&&U&&Er.e&&(v=U.getToolTip(Er.e)),v!=F)){var u;v.html?(v=v.html,u=Uc):u=nb,u.innerHTML=v}},hideToolTip:function(){if(C.isToolTipShowing()){Ol(nb),Ol(Uc),wh();var R=Er&&Er.view;R&&R.onHideToolTip&&R.onHideToolTip(),Er=F}},showToolTip:function(D,m,q){if(!D||m==F)return qn(),void 0;C.getToolTipDiv();var H,n;if(m.html?(m=m.html,H=Uc,Ol(nb)):(H=nb,Ol(Uc)),n=H.style,H.innerHTML=m,H.parentNode||V.Default.appendToScreen(H),D.target){D=pb(D);var B=He(),U=D.x,J=D.y,P=Zk?60:12;if(Zk){var I=H.getBoundingClientRect();n.left=U-I.width/2+ke,n.top=J-I.height-P<B.top?J+P+ke:J-I.height-P+ke}else{n.left=U+P+ke,n.top=J+P+ke;var I=H.getBoundingClientRect();I.left+I.width>B.width&&(n.left=U-P-I.width+ke),I.top+I.height>B.height&&(n.top=J-P-I.height+ke),I.left<0&&(n.left=U+P+ke),I.top<0&&(n.top=J+P+ke)}}else n.left=D.x+ke,n.top=D.y+ke;wh(),q===_?q=Er&&Er.view:Er={e:D,view:q},q&&q.onShowToolTip&&q.onShowToolTip()},startDragging:function(o,d,e){e==_&&(e=!0),o!==Ee&&(Ee?e&&(os(d)?Ee.handleWindowTouchEnd(d):Ee.handleWindowMouseUp(d)):os(d)?(x(b,df,zj),x(b,Gd,Bl)):(x(b,$p,Im),x(b,Sn,vn)),Ee=o)},getImageMap:function(){return pr},toBoundaries:function(N,z,C,v){var e=[];return tg(N,z,C,v).forEach(function(i){var L=[];i.forEach(function(u){L.push(u.x,u.y)}),e.push(L)}),e},getCurrentKeyCodeMap:function(){return Wc},drawCenterImage:function(_,f,t,s,C,c,P,O){!C&&c&&c.isSelfViewEvent&&(C=c);var V=ob(f,C,c),z=$n(f,C,c);Fp(_,f,U(t-V/2),U(s-z/2),V,z,C,c,P,O)},drawStretchImage:function(q,v,m,y,N,x,l,H,g,$,i,T){!H&&g&&g.isSelfViewEvent&&(H=g);var K,r=ob(v,H,g,x),Y=$n(v,H,g,l);
"uniform"===m?(K=B(x/r,l/Y),r*=K,Y*=K,y+=U((x-r)/2),N+=U((l-Y)/2),x=r,l=Y):"centerUniform"===m&&((r>x||Y>l)&&(K=B(x/r,l/Y),r*=K,Y*=K),y+=U((x-r)/2),N+=U((l-Y)/2),x=r,l=Y);var M=q.interactiveInfo;if(M){var w;if(w="center"===m?{x:y+x/2-r/2,y:N+l/2-Y/2,width:r,height:Y}:{x:y,y:N,width:x,height:l},M.rect){var X=M.compInfos,n=X.length;n&&(X[n-1].rect.image=v)}else M.rect=w}if("center"===m){var a=i!==!1&&(r>x||Y>l);a&&(q.save(),q.beginPath(),q.rect(y,N,x,l),q.clip()),Fp(q,v,y+x/2-r/2,N+l/2-Y/2,r,Y,H,g,$,T),a&&q.restore()}else Fp(q,v,y,N,x,l,H,g,$,T)},toCanvas:function(B,G,T,K,p,b,M,O,P){B=ij(B,M),G=G||ob(B,p),T=T||$n(B,p);var o=ys(),J=Zq(o);return O?(Db(o,G,T,O),J.scale(O,O)):Db(o,G,T,1),qs(J,B,K,0,0,G,T,p,b,M,P),B&&B.clampToEdge&&(o.clampToEdge=B.clampToEdge),J.restore(),o},toGrayColor:function(I){if(!I)return I;var z=Bm(I),T=U(.299*z[0]+.587*z[1]+.114*z[2]);return"rgba("+T+","+T+","+T+","+z[3]/255+")"},createGradientImage:function(n,L,z,i){for(var x=["L",0,0,n,0,1,0,0,1,0,0],k=0,r=Math.min(L.length,z.length);r>k;k++)x.push(z[k],L[k]);var B=V.Default.toCanvas({width:n,height:n,clampToEdge:!0,comps:[{type:"shape",rotation:i||0,points:[0,0,n,0,n,n,0,n],background:"#ffffff",gradientPack:x}]});return B},createElement:function(H,A,Z,T){var b=v.createElement(H);return Fr(b,A||S.widgetBorder,2),b.style.font=Z?Z:di,T!=F&&(b.value=T),C.onElementCreated&&C.onElementCreated(b),b},containedInView:function(R,g){var f=Wr(g).getBoundingClientRect();return Hd({x:f.left,y:f.top,width:f.width,height:f.height},ci(R))},isIsolating:function(){return Wn>0},setIsolating:function(I){I?Wn++:Wn--},getMSMap:function(){return km},stringify:function(b,T,S){var R=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var w=ip.prototype.toJSON;ip.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},T=S?0:T==F?2:T;var _=JSON.stringify(b,function(G,b){return"function"==typeof b?"__ht__"+(b.__ht__||b.toString()):kd(b)?Dh(b):b instanceof V.List?"__ht__list"+(b.__ht__list||C.stringify(b._as)):b},T);return Date.prototype.toJSON=R,ip.prototype.toJSON=w,S&&(_=tq+Lj(_)),_},parse:function(e,W){return zq(e)?e.substr(0,12)!=tq||(e=Ph(e.substr(12)),zq(e))?(W=W||{},JSON.parse(e,function(A,Y){if(zq(Y))if(W.ignoreFunction||"__ht__function"!=Y.substr(0,14)){if(!W.ignoreDate&&"__ht__date"==Y.substr(0,10))return new Date(Pq(Y.substr(10)));if("__ht__list"===Y.substr(0,10))return new _n(C.parse(Y.substr(10)));if(!W.ignoreDataModel&&"__ht__dataModel"===Y.substr(0,15)){var D=new ip;return D.deserialize(C.parse(Y.substr(15))),D}}else{var k=Y.indexOf("{")+1,M=Y.lastIndexOf("}"),c=Y.indexOf("(")+1,b=Y.indexOf(")");if(k&&M&&c&&b)try{var g=new Function(Y.substring(c,b),Y.substring(k,M));return g.__ht__=Y.substr(6),g}catch(j){throw console.info("=== SyntaxError ===\n",Y),j}}return Y})):e:e},loadJS:function(J,b){b&&J.push(b);var s=J.shift();if(mh(s))J=s.contact(J),C.loadJS(J);else if(ne(s))s(),C.loadJS(J);else if(zq(s)){var Y=v.createElement("script");Y.onload=function(){C.loadJS(J)},Y.setAttribute("src",s),v.getElementsByTagName("head")[0].appendChild(Y)}else J.length&&C.loadJS(J)},extendClass:function(D,O){var i=D.prototype;for(var y in O)km[y]&&km.hasOwnProperty(y)?km[y](i,O):i[y]=O[y]},toRoundedCorner:function(){function L(G,N,x){G.x=N.x,G.y=N.e||x,G.z=N.y}var K=new io,R=new io,Z=new io,d=new io;return function(k,t){var s,$=0;k.getPoints&&($=k.getElevation(),k=k.getPoints()),s=k instanceof _n?k:new _n(k);var T=s.size();if(0>=t)return{points:s};var u=new _n,p=new _n,W=s.get(0);L(K,W,$),u.add(W),p.add(1);for(var o=1;T>o;o++)if(T>o+1){var G=s.get(o),S=s.get(o+1);L(R,G,$),L(Z,S,$),d.subVectors(K,R).setLength(Math.min(.99*d.length(),t)).add(R),G.e!==_||W.e!==_?u.add({x:d.x,y:d.z,e:d.y}):u.add({x:d.x,y:d.z}),u.add(G),d.subVectors(Z,R).setLength(Math.min(.99*d.length(),t)).add(R),G.e!==_||S.e!==_?u.add(W={x:d.x,y:d.z,e:d.y}):u.add(W={x:d.x,y:d.z}),K.copy(d),p.addAll([2,3])}else u.add(s.get(o)),p.add(2);return{points:u,segments:p}}}(),toColorData:Bm,setCanvas:Db,createDiv:ir,createDisabledDiv:Tn,createView:oj,createCanvas:ys,appendChild:of,initContext:Zq,checkLoadingImage:lj,translateAndScale:Gc,layout:mm,getPosition:Vf,drawPoints:Mf,drawRoundRect:us,drawBorder:If,setFocus:fj,getter:Tp,setter:Ro,isEmptyObject:Xn,cameraPriority:function(){var k={skybox:0,main:1e4,top:1e7,infinity:1/0};return f.seal(f.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return k.skybox},set:function(N){if(N>=k.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");k.skybox=Number(N)}},main:{configurable:!1,enumerable:!1,get:function(){return k.main},set:function(i){if(i<=k.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(i>=k.top)throw new RangeError("Main camera must have lower priority than the top camera.");k.main=Number(i)}},top:{configurable:!1,enumerable:!1,get:function(){return k.top},set:function(i){if(i<=k.main)throw new RangeError("Top camera must have higher priority than the main camera.");k.top=Number(i)}}}))}()},!0),Xf(e,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Pi=C.disabledOpacity,mg=C.toolTipDelay,nj=C.devicePixelRatio,ao=C.autoMakeVisible,iq=C.autoHideScrollBar,te=C.imageGradient,Ui=C.showToolTip,qn=C.hideToolTip,oq=C.dashPattern,fh=C.lineCap,Fm=C.lineJoin,rl=C.labelColor,Dn=C.labelSelectColor,di=C.labelFont,rp=C.widgetIndent,Fk=C.widgetRowHeight,Kr=C.widgetHeaderHeight,mi=C.widgetTitleHeight,Nn=C.scrollBarColor,Sr=C.scrollBarSize,_b=C.scrollBarTimeout,og=C.scrollBarMinLength,Jq=C.scrollBarInteractiveSize,Ig=C.zoomIncrement,Ke=C.scrollZoomIncrement,wb=C.pinchZoomIncrement,Kj=C.zoomMax,Ne=C.zoomMin,Ud=C.createObject,Qq=C.preventDefault,Se=C.setImage,ij=C.getImage,Oe=C.isImageComplete,Lf=C.drawCenterImage,qs=C.drawStretchImage,Ch=C.getId,Vp=C.callLater,Fg=C.cancelLater,Hg=C.sortFunc,Hq=C.clone,nk=C.getClass,$h=C.startAnim,zl=C.brighter,jn=C.darker,Je=C.drawText,Tg=C.getTextSize,Ab=C.isLeftButton,Gq=C.isMiddleButton,ae=C.isRightButton,_k=C.getTouchCount,gm=C.isDoubleClick,er=C.isShiftDown,Ef=C.isCtrlDown,ci=C.getClientPoint,pb=C.getPagePoint,kj=C.getDistance,np=C.unionPoint,ti=C.unionRect,Hd=C.containsPoint,gj=C.containsRect,Yq=C.intersectsRect,Qp=C.intersection,He=C.getWindowInfo,ps=C.grow,hl=C.getLogicalPoint,Sm=C.getScreenPoint,$l=C.startDragging,Ol=C.removeHTML,uj=C.createElement,uk=C.segmentResolution,Nq=C.shapeResolution,ib=C.shapeSide,cd=C.def,Lr=function(E,y,d){cd(X+"."+E,y,d)},Ii=function(a,Y){a.childNodes.forEach(function(L){Y(L),Ii(L,Y)})};Xf(C,{toolTipLabelColor:rl,toolTipLabelFont:di,toolTipBackground:S.toolTipBackground,toolTipShadowColor:Qi,debugTipLabelFont:di,debugTipLabelColor:rl,debugTipBackground:S.toolTipBackground,drawBreakableText:yc,setDevicePixelRatio:function(i){nj=C.devicePixelRatio="number"==typeof i?i:b.screen?b.screen.deviceXDPI/b.screen.logicalXDPI:1,Ii(v.body,function(y){var o=y._ht;o&&o._canvas&&(Db(o._canvas,o.getWidth(),o.getHeight()),o.redraw?o.redraw():o.iv())})}},!0);var Lc=1e-6,md="undefined"!=typeof Uint16Array?Uint16Array:Array,ad="undefined"!=typeof Float32Array?Float32Array:Array,No=function(N,G,U){var u=[N[0]-G[0],N[1]-G[1],N[2]-G[2]];if(U){var Z=kj(u);Z>0&&(u[0]/=Z,u[1]/=Z,u[2]/=Z)}return u},Wd=function(){var l="charCodeAt",S=2*(2*$b.length+1);for(var M in b)if(M===X+aq[0]+(ke.length+2)){var o=b[M];if(!o)break;for(var C=o.length,x=0;C>x;x++)if(o[x][l](0)===S&&o[x+1]!=F&&o[x+1]===ke[0]&&o[x+2]!=F&&o[x+2][l](0)===S){for(var e=x+3;C>e;e++)if(o[e][l](0)===S){if(0==o[e+1])for(var t,u=e+2;C>u;u++){if(o[u][l](0)===S){0==o[u-1]&&t&&(qb=t.substr(0,t.length-1));break}t==F?t=o[u]:t+=o[u]}break}break}break}return function(E){return[-E[0],-E[1],-E[2]]}}(),Ze=function(u,q){return 3===u.length?u[0]*q[0]+u[1]*q[1]+u[2]*q[2]:u[0]*q[0]+u[1]*q[1]},Bf=function(){var K=new Array(16);return K[0]=1,K[1]=0,K[2]=0,K[3]=0,K[4]=0,K[5]=1,K[6]=0,K[7]=0,K[8]=0,K[9]=0,K[10]=1,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,K},We=Bf(),ds=function(X){var T=new Array(16);return T[0]=X[0],T[1]=X[1],T[2]=X[2],T[3]=X[3],T[4]=X[4],T[5]=X[5],T[6]=X[6],T[7]=X[7],T[8]=X[8],T[9]=X[9],T[10]=X[10],T[11]=X[11],T[12]=X[12],T[13]=X[13],T[14]=X[14],T[15]=X[15],T},Gg=function(n,N){return n[0]=N[0],n[1]=N[1],n[2]=N[2],n[3]=N[3],n[4]=N[4],n[5]=N[5],n[6]=N[6],n[7]=N[7],n[8]=N[8],n[9]=N[9],n[10]=N[10],n[11]=N[11],n[12]=N[12],n[13]=N[13],n[14]=N[14],n[15]=N[15],n},nm=function(Z){return Z[0]=1,Z[1]=0,Z[2]=0,Z[3]=0,Z[4]=0,Z[5]=1,Z[6]=0,Z[7]=0,Z[8]=0,Z[9]=0,Z[10]=1,Z[11]=0,Z[12]=0,Z[13]=0,Z[14]=0,Z[15]=1,Z},vr=function(e,T){var s=e[0],d=e[1],R=e[2];return e[0]=T[0]*s+T[4]*d+T[8]*R+T[12],e[1]=T[1]*s+T[5]*d+T[9]*R+T[13],e[2]=T[2]*s+T[6]*d+T[10]*R+T[14],e},lr=function(A,L){var G=A[0],z=A[1],d=A[2],W=A[3];return A[0]=L[0]*G+L[4]*z+L[8]*d+L[12]*W,A[1]=L[1]*G+L[5]*z+L[9]*d+L[13]*W,A[2]=L[2]*G+L[6]*z+L[10]*d+L[14]*W,A[3]=L[3]*G+L[7]*z+L[11]*d+L[15]*W,A},Uq=function(){var c,J,e,G,v=ik(xj[1]+xj[7]),M=ik(xj[0]+xj[3]-xj[10]),p=ik(xj[8]+2),d=function(){return J=e.charAt(c),c+=1,J},C=function(){var R="";if(J===p)for(;d();){if(J===p)return d(),R;R+=J}else d()},K=function(){for(;J&&" ">=J;)d()},F=function(){var g,s={};if(J===v){if(d(),K(),J===M)return d(),s;for(;J;){if(g=C(),K(),d(),s[g]=G(),K(),J===M)return d(),s;d(),K()}}};return G=function(){switch(K(),J){case v:return F();default:return C()}},function(T){if(r={},T){var z;if(e=T,c=0,J=" ",z=G(),K(),!J)return z}}}(),xe=function(X,F){if(F){var t=u(F),N=L(F),W=X[4],S=X[5],T=X[6],j=X[7],B=X[8],J=X[9],e=X[10],a=X[11];X[4]=W*N+B*t,X[5]=S*N+J*t,X[6]=T*N+e*t,X[7]=j*N+a*t,X[8]=B*N-W*t,X[9]=J*N-S*t,X[10]=e*N-T*t,X[11]=a*N-j*t}},_p=function(b,B){if(B){var y=u(B),U=L(B),t=b[0],N=b[1],i=b[2],X=b[3],v=b[8],S=b[9],E=b[10],O=b[11];b[0]=t*U-v*y,b[1]=N*U-S*y,b[2]=i*U-E*y,b[3]=X*U-O*y,b[8]=t*y+v*U,b[9]=N*y+S*U,b[10]=i*y+E*U,b[11]=X*y+O*U}},ud=function(e,K){if(K){var A=u(K),r=L(K),j=e[0],I=e[1],P=e[2],S=e[3],w=e[4],p=e[5],C=e[6],t=e[7];e[0]=j*r+w*A,e[1]=I*r+p*A,e[2]=P*r+C*A,e[3]=S*r+t*A,e[4]=w*r-j*A,e[5]=p*r-I*A,e[6]=C*r-P*A,e[7]=t*r-S*A}},Vl=function(k,x,o){return wi(F,o===!1?F:k.getFinalScale3d(),k.getFinalRotation3d(),k.getRotationMode(),k.p3(),F,x)},wi=function(u,$,U,b,q,R,p){return R||(R=Bf()),q&&jc(R,q),sp(R,U,b),p&&Si(R,R,p),$&&ul(R,$),u&&Si(R,R,u),R},Oq=function(g,J,T){J=Pq(J),T=Pq(T);var h=this;h.g=g,h._84O=J,h._85O=T,h._70I=!0,h.F=0,h._83O=J+T,h.pen={x:0,y:0}},Bi="lineDashOffset",Wf="setLineDash",ls=function(P){for(var V in P)1===V.length&&(Bi=P[V]);return V?1:0},dl=function(W,Z,b){return pq(Z)?W:W[Wf]?(W[Wf](Z),b&&(W.lineDashOffset=b),W):new Oq(W,Z[0],Z.length>1?Z[1]:Z[0])},Gk=function(m,z){!pq(z)&&m[Wf]&&(m[Wf](Me),m.lineDashOffset=0)};cd(Oq,f,{_69I:6,moveTo:function(t,h){var J=this,$=J.pen;$.x=t,$.y=h,J.g.moveTo(t,h),J.start||(J.start={x:t,y:h})},lineTo:function(F,r){var q=this,H=q.pen,B=F-H.x,d=r-H.y,e=ub(d,B),x=L(e),V=u(e),o=q._23O(H.x,H.y,F,r),w=q._85O,Y=q._84O,I=q._83O;if(q.F){if(q.F>o)return q._70I?q._72I(F,r):q.moveTo(F,r),q.F-=o,void 0;if(q._70I?q._72I(H.x+x*q.F,H.y+V*q.F):q.moveTo(H.x+x*q.F,H.y+V*q.F),o-=q.F,q.F=0,q._70I=!q._70I,!o)return}var Z=P(o/I);if(Z){for(var k=x*Y,D=V*Y,E=x*w,C=V*w,i=0;Z>i;i++)q._70I?(q._72I(H.x+k,H.y+D),q.moveTo(H.x+E,H.y+C)):(q.moveTo(H.x+E,H.y+C),q._72I(H.x+k,H.y+D));o-=I*Z}q._70I?o>Y?(q._72I(H.x+x*Y,H.y+V*Y),q.moveTo(F,r),q.F=w-(o-Y),q._70I=!1):(q._72I(F,r),o===Y?(q.F=0,q._70I=!q._70I):(q.F=Y-o,q.moveTo(F,r))):o>w?(q.moveTo(H.x+x*w,H.y+V*w),q._72I(F,r),q.F=Y-(o-w),q._70I=!0):(q.moveTo(F,r),o===w?(q.F=0,q._70I=!q._70I):q.F=w-o)},quadraticCurveTo:function(y,V,x,b){var B,n=this,J=n.pen,U=J.x,e=J.y,t=n._22O(U,e,y,V,x,b),d=0,h=0,D=n._85O,q=n._84O;if(n.F){if(n.F>t)return n._70I?n._71I(y,V,x,b):n.moveTo(x,b),n.F-=t,void 0;if(d=n.F/t,B=n._20O(U,e,y,V,x,b,d),n._70I?n._71I(B[2],B[3],B[4],B[5]):n.moveTo(B[4],B[5]),n.F=0,n._70I=!n._70I,!t)return}var L=t-t*d,S=P(L/n._83O),l=q/t,H=D/t;if(S)for(var X=0;S>X;X++)n._70I?(h=d+l,B=n._21O(U,e,y,V,x,b,d,h),n._71I(B[2],B[3],B[4],B[5]),d=h,h=d+H,B=n._21O(U,e,y,V,x,b,d,h),n.moveTo(B[4],B[5])):(h=d+H,B=n._21O(U,e,y,V,x,b,d,h),n.moveTo(B[4],B[5]),d=h,h=d+l,B=n._21O(U,e,y,V,x,b,d,h),n._71I(B[2],B[3],B[4],B[5])),d=h;L=t-t*d,n._70I?L>q?(h=d+l,B=n._21O(U,e,y,V,x,b,d,h),n._71I(B[2],B[3],B[4],B[5]),n.moveTo(x,b),n.F=D-(L-q),n._70I=!1):(B=n._19O(U,e,y,V,x,b,d),n._71I(B[2],B[3],B[4],B[5]),t===q?(n.F=0,n._70I=!n._70I):(n.F=q-L,n.moveTo(x,b))):L>D?(h=d+H,B=n._21O(U,e,y,V,x,b,d,h),n.moveTo(B[4],B[5]),B=n._19O(U,e,y,V,x,b,h),n._71I(B[2],B[3],B[4],B[5]),n.F=q-(L-D),n._70I=!0):(n.moveTo(x,b),L===D?(n.F=0,n._70I=!n._70I):n.F=D-L)},bezierCurveTo:function(){var U=arguments;this.pen={x:U[4],y:U[5]},this.g.bezierCurveTo(U[0],U[1],U[2],U[3],U[4],U[5])},arc:function(W,t,P,z,y,f){f||(z=-z,y=-y),Vr(this,W,t,z,y-z,P,P,!1)},rect:function(N,u,b,V){var U=this;U.pen={x:N,y:u},U.moveTo(N,u),U.lineTo(N,u+V),U.lineTo(N+b,u+V),U.lineTo(N+b,u),U.lineTo(N,u)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(S,j,b,M){var z=b-S,p=M-j;return A(z*z+p*p)},_22O:function(t,j,J,I,E,Y,Z){for(var a,S,Q,D,B,$,O,c=0,u=t,o=j,y=Z>0?Z:this._69I,V=1;y>=V;V++)Q=V/y,D=1-Q,B=D*D,$=2*Q*D,O=Q*Q,a=B*t+$*J+O*E,S=B*j+$*I+O*Y,c+=this._23O(u,o,a,S),u=a,o=S;return c},_21O:function(b,n,x,s,D,I,S,T){var z=this;if(0===S)return z._20O(b,n,x,s,D,I,T);if(1===T)return z._19O(b,n,x,s,D,I,S);var O=z._20O(b,n,x,s,D,I,T);return O.push(S/T),z._19O.apply(z,O)},_20O:function(H,v,n,o,N,q,I){if(1!==I){var g=n+(N-n)*I,w=o+(q-o)*I;n=H+(n-H)*I,o=v+(o-v)*I,N=n+(g-n)*I,q=o+(w-o)*I}return[H,v,n,o,N,q]},_19O:function(G,M,b,D,l,Z,g){if(1!==g){var h=G+(b-G)*g,U=M+(D-M)*g;b+=(l-b)*g,D+=(Z-D)*g,G=h+(b-h)*g,M=U+(D-U)*g}return[G,M,b,D,l,Z]},_72I:function(i,t){var g=this.pen;(i!==g.x||t!==g.y)&&(g.x=i,g.y=t,this.g.lineTo(i,t))},_71I:function(w,O,g,D){var C=this.pen;(w!==g||O!==D||g!==C.x||D!==C.y)&&(C.x=g,C.y=D,this.g.quadraticCurveTo(w,O,g,D))}}),zo=Vo()+1,fo&&b.console&&zo&&!0&&(b.navigator&&b.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?b.console.log.apply(console,["Hightopo - Version"+V.Default.getVersion()+" - %cTrialhttp://hightopo.com/request.html","color: #f00;"]):b.console.log("Hightopo - Version"+V.Default.getVersion()+" - Trialhttp://hightopo.com/request.html"));var Bq=F,ki=F,Jl=C.checkLoadingCompType=function(h){Bq&&!h._72O&&(ki||(ki={}),ki[h._72O=Ch()]=h)},qi=function(S,D){if(D||(D=S),D&&(Bq||(Bq={}),!Bq[S])){var E=new zi;if(Bq[D]={request:E,url:D},D=C.beforeLoadURL(D,S),D.data){var Y=C.parse(D.data);Dq(S,Y),C.handleCompTypeLoaded(S,Y)}else{E.onload=function(){if(200===this.status||0===this.status){var R=C.parse(E.getResponseText());Dq(S,R),C.handleCompTypeLoaded(S,R)}else Dq(S,F)},E.onerror=function(){Dq(S,F)};var u={};u.url=encodeURI(D),u.sync=!1,E.send(u)}}},Dq=function(g,q){if(fi[g]=q,delete Bq[g],Xn(Bq)&&(Bq=F,ki)){for(var E in ki){var I=ki[E];I.invalidateAll&&I.invalidateAll(_,"compTypeLoaded",g),I.redraw&&I.redraw(),I.iv(),delete I._72O}ki=F}if(q&&ki)for(var E in ki){var I=ki[E];I.invalidateAll&&I.invalidateAll(_,"compTypeLoading",g),I.redraw&&I.redraw(),I.iv()}},Ac=S.chart,gg="",Jn=!0,Po=C.compStack=[],ic=/^style@/,fc=/^attr@/,Cp=/^field@/,Np={x:.5,y:.5},ap=function(){Jn=!0},vj=function(){return Jn},ob=function(L,$,n,X){if(!L)return 0;if(cs(L.fitSize,$,n)&&X)return X;var A=cs(L.width,$,n);return null==A?20:A},$n=function(W,m,s,R){if(!W)return 0;if(cs(W.fitSize,m,s)&&R)return R;var F=cs(W.height,m,s);return null==F?20:F},cs=function(H,y,J){if(!H||!H.func)return H;var Q,m=H.func,q=H.value;return Q=ne(m)?J&&J.vectorDataBindingDisabled&&!H.isSafeFunc?q:m(y,J):y instanceof Lq||(V.ui?y instanceof V.ui.View:0)?fc.test(m)?y.a(gg+m.slice(5)):ic.test(m)?y.s(gg+m.slice(6)):Cp.test(m)?y[m.slice(6)]:y[m]?y[m](J):q:q,q!==_&&Q==F?q:Q},Fp=C.drawImage=function(){var n,r,U,G,p,Q,c=3,T=6,x=function(i){var j,P,s,I=!1;return m(i,"shadow")&&(j=m(i,"shadowOffsetX")||c,P=m(i,"shadowOffsetY")||c,s=m(i,"shadowBlur")||T,I=!0),!I&&r instanceof Lq&&((Zh(r,xp,"shadow")||"shadow"===Zh(r,xp,"select.type")&&U&&U.isSelected&&U.isSelected(r))&&(j=Zh(r,xp,"shadow.offset.x")||0,P=Zh(r,xp,"shadow.offset.y")||0,s=Zh(r,xp,"shadow.blur")||0,I=!0),!I&&Zh(r,xp,"shadow2")&&(j=Zh(r,xp,"shadow2.offset.x")||0,P=Zh(r,xp,"shadow2.offset.y")||0,s=Zh(r,xp,"shadow2.blur")||0,I=!0)),I?1.5*s+Math.max(j,P):0},d=function(U,E){U.getValue&&U.getValue.compType===E||(U.getValue=function(F){var t=m(U,F);if(t===_&&E.properties){var I=E.properties[F];I&&(t=I.defaultValue)}return t},U.getColor=function(P,y){return y===!0?j(P):j(U.getValue(P))},U.getValue.compType=E)},m=function(l,n,q){var T,F=!1;if(l.prefix&&r instanceof Lq){var z=r.a(gg+n);z!==_&&(F=!0,T=z)}return T===_&&(T=l[n]),T&&T.func&&(F=!0,T=cs(T,r,U)),q&&(T=q(T),F||(l[n]=T)),T},j=function(k,A){var E;return E=A?m(k,A):k,n&&n.compGray&&E?C.toGrayColor(E):p&&E?vo(E,p,Q):E},e=function(l){if(mh(l)){for(var n=new _n,C=l.length,H=0;C>H;H+=2)n.add({x:l[H],y:l[H+1]});l=n}return l},v=function(e){var L=m(e,"anchorX"),w=m(e,"anchorY");if(L!==_||w!==_)return{x:L===_?Np.x:L,y:w===_?Np.y:w};var B=m(e,"type"),u=m(e,"name");if("image"!==B||!u)return Np;var n=ij(u);return n&&n.anchorX!==_&&n.anchorY!==_?{x:n.anchorX,y:n.anchorY}:Np},a=function(i,s){var T=m(i,pi),w=v(i);if(mh(T)){var k=T.length,x=m(i,"relative"),D=s.width,c=s.height;if(4===k)T={x:T[0],y:T[1],width:T[2],height:T[3]},x&&(T.x*=D,T.y*=c,T.width*=D,T.height*=c);else if(3===k){var Y=T[0];T={width:T[1],height:T[2]},x&&(T.width*=D,T.height*=c),"object"==typeof Y?Y.length&&(Y={x:Y[0],y:Y[1]}):Y=Vf(Y,s,T),T.x=Y.x-T.width*w.x,T.y=Y.y-T.height*w.y}T.x+=m(i,"offsetX")||0,T.y+=m(i,"offsetY")||0,!x&&s.fitSize&&(T=P(i,T,s))}return T},P=function(T,c,O){if(c){var w,j,E,M={x:c.x,y:c.y,width:c.width,height:c.height},P=v(T),Q=m(T,"layoutH"),L=m(T,"layoutV"),k=1,I=1,U=0,C=0,h=1,H=1;switch(Q){case"left":break;case"right":M.x+=O.width-O.rw;break;case"center":M.x+=.5*(O.width-O.rw);break;case"scale":case"leftright":default:w=m(T,qh)||0,w&&(U=Math.abs(C=Math.sin(w)),h=Math.abs(H=Math.cos(w))),"leftright"!==Q?(k+=h*(O.widthScale-1),I+=U*(O.widthScale-1)):(k+=M.width?h*(O.width-O.rw)/M.width:0,I+=M.height?U*(O.width-O.rw)/M.height:0,j=-Math.min(-P.x*H+P.y*C,-P.x*H-(1-P.y)*C,(1-P.x)*H+P.y*C,(1-P.x)*H-(1-P.y)*C))}switch(L){case"top":break;case"bottom":M.y+=O.height-O.rh;break;case"center":M.y+=.5*(O.height-O.rh);break;case"scale":case"topbottom":default:w==F&&(w=m(T,qh),w&&(U=Math.abs(C=Math.sin(w)),h=Math.abs(H=Math.cos(w)))),"topbottom"!==L?(k+=U*(O.heightScale-1),I+=h*(O.heightScale-1)):(k+=M.width?U*(O.height-O.rh)/M.width:0,I+=M.height?h*(O.height-O.rh)/M.height:0,E=-Math.min(-P.x*C-P.y*H,-P.x*C+(1-P.y)*H,(1-P.x)*C-P.y*H,(1-P.x)*C+(1-P.y)*H))}return(1!==k||1!==I)&&("scale"!==Q&&Q?"leftright"===Q&&(M.x+=M.width*(1-k)*P.x+j*(O.width-O.rw)):M.x+=M.x*(O.widthScale-1)+P.x*M.width*(O.widthScale-k),"scale"!==L&&L?"topbottom"===L&&(M.y+=M.height*(1-I)*P.y+E*(O.height-O.rh)):M.y+=M.y*(O.heightScale-1)+P.y*M.height*(O.heightScale-I),M.width*=k,M.height*=I),M.width<0&&(M.width=0),M.height<0&&(M.height=0),M}},$=function(L){return mh(L)?new _n(L):L},D=function(G,z,d,A,R,h,B){var L=n.interactiveInfo,Y=G.transform;if(Y)return n.save(),n.setTransform(Y.a,Y.b,Y.c,Y.d,Y.tx,Y.ty),L&&L.compInfos.push({comp:G,rect:z,matrix:Y.clone(),prefix:gg,refRect:L.refRect}),!0;R===_&&(R=1),h===_&&(h=1);var y=m(G,"clipPercentage"),S=wj(d,z);if(S&&!A&&1===R&&1===h&&!(1>y))return L&&L.compInfos.push({comp:G,rect:z,matrix:L.matrix.clone(),prefix:gg,refRect:L.refRect}),!1;B=B||Np;var C=z.x+z.width*B.x,v=z.y+z.height*B.y,Z=d.x+d.width*B.x,i=d.y+d.height*B.y,t=d.width?R*(z.width/d.width):1,E=d.height?h*(z.height/d.height):1;if(n.save(),L&&(L.matrix.appendTranslate(C,v).appendRotate(A).appendScale(t,E).appendTranslate(-Z,-i),L.compInfos.push({comp:G,rect:z,matrix:L.matrix.clone(),prefix:gg,refRect:L.refRect})),zg(n,C,v),_g(n,A||0),qf(n,t,E),zg(n,-Z,-i),1>y){0>y&&(y=0);var k=un(d,m(G,"clipDirection"),y,x(G));n.beginPath(),n.rect(k.x,k.y,k.width,k.height),n.clip()}return!0},K=function(){n.restore()},X=function(C,c,q){var k=m(C,"path"),y=m(C,qh),l=m(C,"scaleX"),Z=m(C,"scaleY"),d=v(C),b=F,s=Pn(null,k);if(q||(q=C.unionRect,q||(q=np(s),C.path.func||(C.unionRect=q)),b=q),q){b||(b=C.unionRect,b||(b=np(s),C.path.func||(C.unionRect=b)));var V=D(C,q,b,y,l,Z,d),L=m(C,"borderPattern"),X=dl(n,L),g=j(C,"background"),x=j(C,"borderColor"),e=m(C,"borderWidth"),J=m(C,"gradient"),O=j(C,"gradientColor"),p=m(C,"border3d"),Q=j(C,"border3dColor"),t=m(C,"border3dAccuracy"),P=n.lineJoin,R=n.lineCap;n.lineJoin=m(C,"borderJoin")||Fm,n.lineCap=m(C,"borderCap")||fh,g?(Uf(n,g,J,O,b),Pn(n,k),n.fill(),X!==n&&Pn(n,k)):Pn(n,k);var S=m(C,"borderWidthAbsolute");if(S&&(n.save(),n.setTransform(1,0,0,1,0,0)),e&&x&&(n.lineWidth=e,n.strokeStyle=x,n.stroke(),p&&kq(n,x,Q,e,G,t)),Gk(n,L),m(C,"dash")){var Y=m(C,"dashWidth")||e;if(Y>0){L=m(C,"dashPattern")||oq;var X=dl(n,L,m(C,"dashOffset")),T=j(C,"dashColor")||j(lf);X!==n&&Pn(n,k),n.strokeStyle=T,n.lineWidth=Y,n.stroke(),m(C,"dash3d")&&kq(n,T,j(C,"dash3dColor"),Y,G,m(C,"dash3dAccuracy")),Gk(n,L)}}S&&n.restore(),c===pi&&fs(n,g,m(C,"depth"),b),n.lineJoin=P,n.lineCap=R,V&&K()}},o=function(H,g,q,w){var X=m(H,Gf,e),R=m(H,qh),u=v(H);if(X&&w.fitSize){var Y=new _n,z=np(X),O=P(H,z,w),l=z.x+u.x*z.width,S=z.y+u.y*z.height,C=O.x+u.x*O.width,t=O.y+u.y*O.height,I=z.width?O.width/z.width:1,d=z.height?O.height/z.height:1;X.each(function(r){Y.add({x:C+(r.x-l)*I,y:t+(r.y-S)*d})}),X=Y,H.unionRect=null}var h=m(H,"scaleX"),y=m(H,"scaleY"),s=g===eg,i=F;if(!q&&s&&(q=H.unionRect,q||(q=np(X),H.points.func||(H.unionRect=q)),i=q),q){s?i||(i=H.unionRect,i||(i=np(X),H.points.func||(H.unionRect=i))):i=q;var A,T,B,N,c=D(H,q,i,R,h,y,u),L=m(H,"borderPattern"),Z=dl(n,L),b=j(H,"background"),W=ij(m(H,"repeatImage"),p,Q),M=m(H,"gradientPack"),_=j(H,"borderColor"),k=m(H,"borderWidth"),E=ij(m(H,"borderRepeatImage"),p,Q),a=m(H,"segments",$),V=m(H,"gradient"),J=j(H,"gradientColor"),o=m(H,"border3d"),f=j(H,"border3dColor"),gc=m(H,"border3dAccuracy"),td=m(H,"closePath"),_r=m(H,"fillRule")||"nonzero",mp=n.lineJoin,Hl=n.lineCap,$o=x(H);if(n.lineJoin=m(H,"borderJoin")||Fm,n.lineCap=m(H,"borderCap")||fh,s)if(b||W||M){var Sn=m(H,"fillClipPercentage");if(1>Sn){0>Sn&&(Sn=0);var ck=un(i,m(H,"fillClipDirection"),Sn,$o);n.save(),n.beginPath(),n.rect(ck.x,ck.y,ck.width,ck.height),n.clip()}Mf(n,X,a,td),M?Th(n,M,j):W?Mq(n,W,p,Q,r,U):Uf(n,b,V,J,i),n.fill(_r),M&&n.restore(),1>Sn&&n.restore(),Z!==n&&Mf(Z,X,a,td)}else Mf(Z,X,a,td);else if("roundRect"===g?A=m(H,"cornerRadius"):"polygon"===g?A=m(H,"polygonSide"):"arc"===g&&(A=m(H,"arcFrom"),T=m(H,"arcTo"),B=m(H,"arcClose"),N=m(H,"arcOval")),b||W||M){var Sn=m(H,"fillClipPercentage");if(1>Sn){0>Sn&&(Sn=0);var ck=un(i,m(H,"fillClipDirection"),Sn,$o);n.save(),n.beginPath(),n.rect(ck.x,ck.y,ck.width,ck.height),n.clip()}Gr(n,g,i,A,T,B,N),M?Th(n,M,j):W?Mq(n,W,p,Q,r,U):Uf(n,b,V,J,i),n.fill(_r),M&&n.restore(),1>Sn&&n.restore(),n!==Z&&Gr(Z,g,i,A,T,B,N)}else Gr(Z,g,i,A,T,B,N);var Hc=m(H,"borderWidthAbsolute");if(Hc&&(n.save(),n.setTransform(1,0,0,1,0,0)),k&&(_||E)&&(n.lineWidth=k,E?hs(n,E,p,Q,r,U):n.strokeStyle=_,n.stroke(),o&&kq(n,_,f,k,G,gc)),Gk(n,L),m(H,"dash")){var Wb=m(H,"dashWidth")||k;if(Wb>0){L=m(H,"dashPattern")||oq;var Z=dl(n,L,m(H,"dashOffset")),hp=j(H,"dashColor")||j(lf);Z!==n&&(s?Mf(Z,X,a,td):Gr(Z,g,i,A,T,B,N)),n.strokeStyle=hp,n.lineWidth=Wb,n.stroke(),m(H,"dash3d")&&kq(n,hp,j(H,"dash3dColor"),Wb,G,m(H,"dash3dAccuracy")),Gk(n,L)}}Hc&&n.restore(),g===pi&&fs(n,b,m(H,"depth"),i),n.lineJoin=mp,n.lineCap=Hl,c&&K()}},A=function(A,K){var s=p||m(A,Kn),k=Q||m(A,"blendMode"),h=m(A,"name"),E=ij(h,s,k);E&&E.cacheRule!=F&&(E=zd(n,E,m(A,"stretch"),K.width,K.height,r,U,s)),E?qs(n,E,m(A,"stretch"),K.x,K.y,K.width,K.height,r,U,s,null,k):Jn=!1},w=function(G,R){var e=m(G,"text");if(e!=F){var t,Y=m(G,"gradientPack"),c=m(G,"gradient"),B=j(G,"gradientColor"),o=m(G,"font"),v=m(G,"vertical"),I=m(G,"align"),p=m(G,"vAlign"),J=m(G,"decoration");if(t=Y?Th(n,Y,j):j(G,Kn),!Y&&c&&(t=C.createGradient(n,c,t||C.labelColor,B||S.imageGradient,R.x,R.y,R.width,R.height)),v){var u,r,U=e.length,A=0,g=1*(U-1),V=[];n.textBaseline=Ob,n.font=o;for(var N=0;U>N;N++){var d=n.measureText(e[N]);V.push(d),g+=d.fontBoundingBoxDescent,A=i(A,d.width)}r=p&&p!==Jf?p===Ob?R.y:R.y+R.height-g:R.y+(R.height-g)/2,u=I&&I!==aq?I===zc?R.x+R.width-A:R.x+(R.width-A)/2:R.x;for(var N=0;U>N;N++){var f=e[N],d=V[N];Je(n,f,o,t,u,r,A,d.fontBoundingBoxDescent,Pd,Jf,J),r+=d.fontBoundingBoxDescent+1}}else Je(n,e,o,t,R.x,R.y,R.width,R.height,I,p,J);Y&&n.restore()}},M=function(v,Y){If(n,j(v,Kn),Y.x,Y.y,Y.width,Y.height,m(v,"width"))},q=function(N,O){var y=m(N,Qc),t=0;if(y&&(y.forEach(function(P){t+=P}),t>0)){for(var T=m(N,"colors")||Ac,o=m(N,"startAngle")||0,f=m(N,"hollow"),d=m(N,Mi),k=m(N,lc),i=m(N,Eg),g=d?new _n:F,w=O.x,R=O.y,e=O.width,_=O.height,v=w+e/2,H=R+_/2,I=B(e,_)/2,a=0,W=0;W<y.length;W++){var U=y[W],z=E*U/t,X=o+z;if(n.fillStyle=T[a++],a===T.length&&(a=0),n.beginPath(),f){var $=v+L(o)*I/2,V=H+u(o)*I/2,l=v+L(X)*I,A=H+u(X)*I;n.moveTo($,V),n.arc(v,H,I/2,o,X,!1),n.lineTo(l,A),n.arc(v,H,I,X,o,!0)}else n.moveTo(v,H),n.arc(v,H,I,X,o,!0);g&&(z=(o+X)/2,g.add({text:ne(d)?d(U,W,t,r):U,x:v+.75*L(z)*I,y:H+.75*u(z)*I})),n.closePath(),n.fill(),o=X}g&&g.each(function(H){Je(n,H.text,k,i,H.x,H.y,0,0,Pd)})}},h=function(R,Z){var H=m(R,Kl);if(H&&H.length>0){var z=H.length,P=m(R,Mi),K=m(R,lc),f=m(R,Eg),q=P?new _n:F,x=m(R,"minValue")||0,Y=m(R,"maxValue");if(Y==F&&(Y=0,H.forEach(function(T){m(T,Qc).forEach(function(A){Y=i(Y,A)})})),x===Y)return;for(var y=Z.height/(Y-x),I=Z.y+Y*y,l=m(H[0],Qc).length,p=Z.width/(3*l+1),C=2*p/z,t=0,b=0;z>b;b++)for(var h=H[b],d=m(h,Kn),k=m(h,"colors"),X=m(h,Qc),w=0;l>w;w++){k?n.fillStyle=k[w]:d?n.fillStyle=d:(n.fillStyle=Ac[t++],t===Ac.length&&(t=0));var E=X[w],B=E*y,T=Z.x+(1+3*w)*p+b*C;if(Qm(n,T,I-B,C,B),q){var N=ne(P)?P(E,w,h,r):E,o=Tg(K,N).height;q.add({x:T,y:I-B-o,width:C,height:o,text:N})}}q&&q.each(function(v){Je(n,v.text,K,f,v.x,v.y,v.width,v.height,Pd)})}},l=function(k,T){var z=m(k,Kl);if(z&&z.length>0){var Z=z.length,l=m(z[0],Qc).length,A=T.width/(3*l+1),s=0,H=m(k,"maxValue"),j=m(k,Mi),g=m(k,lc),I=m(k,Eg),w=j?new _n:F;if(H==F){H=0;for(var h=0;l>h;h++){for(var t=0,v=0;Z>v;v++)t+=m(z[v],Qc)[h];H=i(H,t)}}if(H>0){for(var h=0;l>h;h++)for(var J=T.y+T.height,v=0;Z>v;v++){var Q=z[v],X=m(Q,Kn),$=m(Q,Qc)[h],P=$/H*T.height;X?n.fillStyle=X:(n.fillStyle=Ac[s++],s===Ac.length&&(s=0)),J-=P;var S={x:T.x+(1+3*h)*A,y:J,width:2*A,height:P};Qm(n,S.x,S.y,S.width,S.height),w&&(S.text=ne(j)?j($,h,Q,r):$,w.add(S))}w&&w.each(function(N){Je(n,N.text,g,I,N.x,N.y,N.width,N.height,Pd)})}}},Y=function(t,y){var M=m(t,Kl);if(M&&M.length>0){for(var o=M.length,g=m(M[0],Qc).length,K=y.width/(3*g+1),j=0,v=m(t,Mi),q=m(t,lc),I=m(t,Eg),J=v?new _n:F,U=0;g>U;U++){for(var H=0,S=0;o>S;S++)H+=m(M[S],Qc)[U];if(H>0){var b=y.y+y.height;for(S=0;o>S;S++){var B=M[S],e=m(B,Kn),Z=m(B,Qc)[U],E=Z/H*y.height;e?n.fillStyle=e:(n.fillStyle=Ac[j++],j===Ac.length&&(j=0)),b-=E;var d={x:y.x+(1+3*U)*K,y:b,width:2*K,height:E};Qm(n,d.x,d.y,d.width,d.height),J&&(d.text=ne(v)?v(Z,U,B,r):Z,J.add(d))}}}J&&J.each(function(P){Je(n,P.text,q,I,P.x,P.y,P.width,P.height,Pd)})}},g=function(v,N){var O=m(v,Kl);if(O&&O.length>0){var e=O.length,C=m(v,"minValue")||0,T=m(v,"maxValue");if(T==F&&(T=0,O.forEach(function(w){m(w,Qc).forEach(function(m){T=i(T,m)})})),C===T)return;for(var h=N.height/(T-C),y=N.y+T*h,b=m(O[0],Qc).length,c=N.width/(3*b+1),l=0,a=m(v,"lineWidth")||2,t=m(v,"line3d"),Z=m(v,"linePoint"),X=m(v,Mi),o=m(v,lc),q=m(v,Eg),d=0;e>d;d++){var V=O[d],U=m(V,Kn),P=m(V,Qc);U?n.strokeStyle=U:(U=n.strokeStyle=Ac[l++],l===Ac.length&&(l=0)),n.beginPath();for(var p=0;b>p;p++){var k=N.x+(2+3*p)*c,Q=y-P[p]*h;0===p?n.moveTo(k,Q):n.lineTo(k,Q)}if(n.lineWidth=a,n.stroke(),t&&kq(n,U,F,a,G),Z||X){var D,L=a/2+2;for(p=0;b>p;p++){var W=P[p];if(k=N.x+(2+3*p)*c,Q=y-W*h,ne(Z)?Z(n,k,Q,U,p,V,r):Z&&(n.fillStyle=U,n.beginPath(),n.arc(k,Q,L,0,E,!0),n.fill()),ne(X)?D=X(W,p,V,r):X&&(D=W),D){var f=Tg(o,D).height,R=n.shadowBlur;if(R){var x=n.shadowOffsetX,j=n.shadowOffsetY,$=n.shadowColor;n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0,n.shadowColor=F}Je(n,D,o,q,k,Q-f-L+2,0,f,Pd),R&&(n.shadowOffsetX=x,n.shadowOffsetY=j,n.shadowBlur=R,n.shadowColor=$)}}}}}},s=function(z){n=z[0],r=z[1],U=z[2],G=z[3],p=z[4],Q=z[5]},W=function(){return[n,r,U,G,p,Q]},O=function(d,J){var S;U&&U.getDrawableState?S=U.getDrawableState(r):U&&U.getState?S=U.getState(r):(S=r instanceof Lq?r.s(Xg):null,(S===_||null===S)&&(S=m(d,Xg)));var k=m(J,Xg);return k!==_&&null!==k&&k!==S?!1:m(J,zn)},V={border:M,image:A,text:w,pieChart:q,columnChart:h,stackedColumnChart:l,percentageColumnChart:Y,lineChart:g};return function(f,h,S,N,Z,g,P,I,H,J){if(h&&Z&&g){var Y=W();n=f,r=P,U=I,!r&&U&&U.isSelfViewEvent&&(r=U),G=U?U._zoom?U._zoom:1:1,p=H,Q=J;var R=Z,i=g;if(gf()){var w,x,y,q,z;0===n[Fd]?gf[0]&&(w=!0):w=!0,n.texureImage2D?gf[1]&&(x=!0):x=!0,n.texureImage3D?gf[2]&&(y=!0):y=!0,n.drawDNDState?gf[3]&&(z=!0):z=!0,em.widget[0]?gf[4]&&(q=!0):q=!0,w&&x&&y&&q&&z&&(R=S,i=N)}if(h.tagName)return zq(qb)&&!b[qb]||n.drawImage(h,R,i,Z,g),s(Y),void 0;if(0==m(h,"visible"))return s(Y),void 0;p||(p=cs(h.color,r,U)),J||(Q=cs(h.blendMode,r,U)),zq(qb)&&!b[qb]&&(Z=R,g=i);var L=ob(h,r,U,Z),u=$n(h,r,U,g),A={x:0,y:0,width:L,height:u,fitSize:m(h,"fitSize")},B=m(h,"clip"),M=m(h,"opacity");if(A.fitSize){var k=A.rw=cs(h.width,r,U)||20;A.widthScale=L/k;var t=A.rh=cs(h.height,r,U)||20;A.heightScale=u/t}if(n.save(),n.interactiveInfo){var l=n.interactiveInfo.matrix,E=l.clone();l.appendTranslate(R,i).appendScale(Z/L,g/u),n.interactiveInfo.refRect=A}zg(n,R,i),(L!==Z||u!==g)&&n.scale(Z/L,g/u),B&&(ne(B)?B(n,L,u,r,U,h):(n.beginPath(),n.rect(0,0,L,u),n.clip())),M!=F&&(n.globalAlpha*=M),m(h,"comps").forEach(function(p){if(p.prefix){var f=gg,R=cs(p.prefix,r,U);R&&(gg=gg+R+".")}if(0==O(h,p))return p.prefix&&(gg=f),void 0;if(Po.splice(0,0,p),n.interactiveInfo)var B=n.interactiveInfo.matrix.clone();var i=m(p,"opacity"),Q=m(p,"shadow"),y=m(p,"type"),x=m(p,"refRect")||A,W=a(p,x);if(i!=F){var J=n.globalAlpha;n.globalAlpha*=i}if(Q){var w=G*C.devicePixelRatio,Z=n.shadowOffsetX,S=n.shadowOffsetY,M=n.shadowBlur,H=n.shadowColor,k=m(p,"shadowOffsetX"),u=m(p,"shadowOffsetY"),N=m(p,"shadowBlur"),q=j(p,"shadowColor");n.shadowOffsetX=(k==F?c:k)*w,n.shadowOffsetY=(u==F?c:u)*w,n.shadowBlur=(N==F?T:N)*w,n.shadowColor=q||j(vl)}if("save"===y)n.save();else if("endClip"===y||"restore"===y)n.restore();else if("clip"===y)n.save(),Mf(n,m(p,"points",e),m(p,"segments",$),!0),n.clip();else if(Te[y])W=W||{x:0,y:0,width:x.width,height:x.height},o(p,y,W,x);else if(y===eg)o(p,y,W,x);else if("SVGPath"===y)X(p,y,W);else{W=W||{x:0,y:0,width:x.width,height:x.height};var P=m(p,qh),b=m(p,"scaleX"),E=m(p,"scaleY"),z=v(p),g=D(p,W,W,P,b,E,z);if(ne(y))d(p,y),C.drawCompType(y,n,W,p,r,U);else if(C.getCompType(y)){var t=C.getCompType(y),s=t.func||t;d(p,t),C.drawCompType(s,n,W,p,r,U)}else V[y]?V[y](p,W):C.getCompType(y)===_&&Mr.test(y)&&qi(y);g&&K()}Q&&(n.shadowOffsetX=Z,n.shadowOffsetY=S,n.shadowBlur=M,n.shadowColor=H),i!=F&&(n.globalAlpha=J),n.interactiveInfo&&(n.interactiveInfo.matrix=B),p.prefix&&(gg=f),Po.splice(0,1)}),n.interactiveInfo&&(n.interactiveInfo.matrix=E),n.restore(),s(Y)}}}();C.getCurrentComp=function(){return Po[0]},C.getParentComp=function(){return Po[1]},C.getInternal=function(){return{isEnter:vb,isEsc:dp,isSpace:pc,isLeft:Re,isUp:Wk,isRight:se,isDown:mo,addMethod:Xf,superCall:tl,toPointsArray:tg,translateAndScale:Gc,appendArray:hj,createWorldMatrix:wi,vec3TransformMat4:vr,setCanvas:Db,createDiv:ir,createView:oj,createCanvas:ys,createImage:$m,initContext:Zq,layout:mm,fillRect:Qm,Mat:Ai,drawBorder:If,isString:zq,setBorder:Fr,getPropertyValue:Zh,setPropertyValue:Sc,drawVerticalLine:li,draw3DRect:fs,getPinchDist:Ce,isSameRect:wj,getPosition:Vf,intersectionLineRect:Io,getNodeRect:Yc,getEdgeAgentPosition:Hl,getEdgeHostPosition:Lg,getImageWidth:ob,getImageHeight:$n,initItemElement:ff,drawPoints:Mf,createG2:dl,closePopup:bi,isH:Hn,createAnim:Nk,createNormalMatrix:ie,toColorArray:Sj,createNormals:lk,toFloatArray:Ib,glMV:pn,glPop:Yk,batchShape:Un,createNodeMatrix:Vl,getShapeModel:go,getFaceInfo:pg,transformAppend:vd,drawFaceInfo:tn,glUploadData:ge,glUploadElementData:Rj,glDrawArray:Pr,glDrawElement:yf,glBindTexture:ri,pickValueToColor:$f,to3dPointsArray:mc,setGLDebugMode:function(L){Km=L
},cube:function(){return{vs:tc,is:Bj,uv:Bs}},ui:function(){return{DataUI:$j,NodeUI:up,EdgeUI:ym,GroupUI:Bo,ShapeUI:Qd,GridUI:zp,Data3dUI:Js,Node3dUI:Ks,Shape3dUI:Ns}},getInternalVersion:function(){return"U2FsdGVkX1/Jj+6tvDoKHuJCB8nUgl6UQ9CkDxgzM8k="},getDragger:function(){return Ee},addMSMap:function(o){Xf(km,o)},k:t,overrideTimerFunc:function(l,R){Vp=V.Default.callLater=l,Fg=V.Default.cancelLater=R},canEnterEditDetailMode:_i,addEventListener:x,removeEventListener:d}},function(_){function T(e,B){e!=F&&(B==F&&Yf!=typeof e?this._54O(e,256):this._54O(e,B))}function f(){return new T(F)}function v(U,t,C,p,b,h){for(;--h>=0;){var i=t*this[U++]+C[p]+b;b=P(i/67108864),C[p++]=67108863&i}return b}function z(w,F,Z,k,m,b){for(var C=32767&F,T=F>>15;--b>=0;){var O=32767&this[w],g=this[w++]>>15,c=T*O+g*C;O=C*O+((32767&c)<<15)+Z[k]+(1073741823&m),m=(O>>>30)+(c>>>15)+T*g+(m>>>30),Z[k++]=1073741823&O}return m}function d(K,F,$,a,h,t){for(var _=16383&F,p=F>>14;--t>=0;){var n=16383&this[K],J=this[K++]>>14,D=p*n+J*_;n=_*n+((16383&D)<<14)+$[a]+h,h=(n>>28)+(D>>14)+p*J,$[a++]=268435455&n}return h}function b(M){return wo.charAt(M)}function G(X,S){var s=Ur[X.charCodeAt(S)];return s==F?-1:s}function n(g){for(var l=this.t-1;l>=0;--l)g[l]=this[l];g.t=this.t,g.s=this.s}function C(b){this.t=1,this.s=0>b?-1:0,b>0?this[0]=b:-1>b?this[0]=b+this.DV:this.t=0}function S(h){var e=f();return e._58O(h),e}function q(d,_){var p,W=this;if(16==_)p=4;else if(8==_)p=3;else if(256==_)p=8;else if(2==_)p=1;else if(32==_)p=5;else{if(4!=_)return W.fromRadix(d,_),void 0;p=2}W.t=0,W.s=0;for(var I=d.length,Y=!1,V=0;--I>=0;){var m=8==p?255&d[I]:G(d,I);0>m?"-"==d.charAt(I)&&(Y=!0):(Y=!1,0==V?W[W.t++]=m:V+p>W.DB?(W[W.t-1]|=(m&(1<<W.DB-V)-1)<<V,W[W.t++]=m>>W.DB-V):W[W.t-1]|=m<<V,V+=p,V>=W.DB&&(V-=W.DB))}8==p&&0!=(128&d[0])&&(W.s=-1,V>0&&(W[W.t-1]|=(1<<W.DB-V)-1<<V)),W._57O(),Y&&T.ZERO._78O(W,W)}function D(){for(var P=this,X=P.s&P.DM;P.t>0&&P[P.t-1]==X;)--P.t}function J(C){var E=this;if(E.s<0)return"-"+E._85O()[Ce](C);var c;if(16==C)c=4;else if(8==C)c=3;else if(2==C)c=1;else if(32==C)c=5;else{if(4!=C)return E.toRadix(C);c=2}var u,O=(1<<c)-1,Z=!1,n="",Y=E.t,x=E.DB-Y*E.DB%c;if(Y-->0)for(x<E.DB&&(u=E[Y]>>x)>0&&(Z=!0,n=b(u));Y>=0;)c>x?(u=(E[Y]&(1<<x)-1)<<c-x,u|=E[--Y]>>(x+=E.DB-c)):(u=E[Y]>>(x-=c)&O,0>=x&&(x+=E.DB,--Y)),u>0&&(Z=!0),Z&&(n+=b(u));return Z?n:"0"}function $(){var z=f();return T.ZERO._78O(this,z),z}function j(){return this.s<0?this._85O():this}function h($){var Q=this,w=Q.s-$.s;if(0!=w)return w;var l=Q.t;if(w=l-$.t,0!=w)return Q.s<0?-w:w;for(;--l>=0;)if(0!=(w=Q[l]-$[l]))return w;return 0}function W(m){var z,r=1;return 0!=(z=m>>>16)&&(m=z,r+=16),0!=(z=m>>8)&&(m=z,r+=8),0!=(z=m>>4)&&(m=z,r+=4),0!=(z=m>>2)&&(m=z,r+=2),0!=(z=m>>1)&&(m=z,r+=1),r}function Y(){var f=this;return f.t<=0?0:f.DB*(f.t-1)+W(f[f.t-1]^f.s&f.DM)}function N(X,O){var m;for(m=this.t-1;m>=0;--m)O[m+X]=this[m];for(m=X-1;m>=0;--m)O[m]=0;O.t=this.t+X,O.s=this.s}function w(N,z){for(var q=N;q<this.t;++q)z[q-N]=this[q];z.t=i(this.t-N,0),z.s=this.s}function H(W,X){var r,Z=this,j=W%Z.DB,u=Z.DB-j,E=(1<<u)-1,p=P(W/Z.DB),w=Z.s<<j&Z.DM;for(r=Z.t-1;r>=0;--r)X[r+p+1]=Z[r]>>u|w,w=(Z[r]&E)<<j;for(r=p-1;r>=0;--r)X[r]=0;X[p]=w,X.t=Z.t+p+1,X.s=Z.s,X._57O()}function l(g,p){var H=this;p.s=H.s;var T=P(g/H.DB);if(T>=H.t)return p.t=0,void 0;var I=g%H.DB,f=H.DB-I,b=(1<<I)-1;p[0]=H[T]>>I;for(var j=T+1;j<H.t;++j)p[j-T-1]|=(H[j]&b)<<f,p[j-T]=H[j]>>I;I>0&&(p[H.t-T-1]|=(H.s&b)<<f),p.t=H.t-T,p._57O()}function V(T,p){for(var y=this,q=0,m=0,U=B(T.t,y.t);U>q;)m+=y[q]-T[q],p[q++]=m&y.DM,m>>=y.DB;if(T.t<y.t){for(m-=T.s;q<y.t;)m+=y[q],p[q++]=m&y.DM,m>>=y.DB;m+=y.s}else{for(m+=y.s;q<T.t;)m-=T[q],p[q++]=m&y.DM,m>>=y.DB;m-=T.s}p.s=0>m?-1:0,-1>m?p[q++]=y.DV+m:m>0&&(p[q++]=m),p.t=q,p._57O()}function o(D,p){var L=this.abs(),Q=D.abs(),l=L.t;for(p.t=l+Q.t;--l>=0;)p[l]=0;for(l=0;l<Q.t;++l)p[l+L.t]=L.am(0,Q[l],p,l,0,L.t);p.s=0,p._57O(),this.s!=D.s&&T.ZERO._78O(p,p)}function O(W){for(var U=this.abs(),c=W.t=2*U.t;--c>=0;)W[c]=0;for(c=0;c<U.t-1;++c){var n=U.am(c,U[c],W,2*c,0,1);(W[c+U.t]+=U.am(c+1,2*U[c],W,2*c+1,n,U.t-c-1))>=U.DV&&(W[c+U.t]-=U.DV,W[c+U.t+1]=1)}W.t>0&&(W[W.t-1]+=U.am(c,U[c],W,2*c,0,1)),W.s=0,W._57O()}function e(s,b,B){var e=s.abs(),c=this;if(!(e.t<=0)){var V=c.abs();if(V.t<e.t)return b!=F&&b._58O(0),B!=F&&c._77O(B),void 0;B==F&&(B=f());var t=f(),E=c.s,v=s.s,G=c.DB-W(e[e.t-1]);G>0?(e._44O(G,t),V._44O(G,B)):(e._77O(t),V._77O(B));var q=t.t,r=t[q-1];if(0!=r){var h=r*(1<<c.F1)+(q>1?t[q-2]>>c.F2:0),Z=c.FV/h,o=(1<<c.F1)/h,_=1<<c.F2,C=B.t,A=C-q,N=b==F?f():b;for(t._59O(A,N),B._52O(N)>=0&&(B[B.t++]=1,B._78O(N,B)),T.ONE._59O(q,N),N._78O(t,t);t.t<q;)t[t.t++]=0;for(;--A>=0;){var i=B[--C]==r?c.DM:P(B[C]*Z+(B[C-1]+_)*o);if((B[C]+=t.am(0,i,B,A,0,q))<i)for(t._59O(A,N),B._78O(N,B);B[C]<--i;)B._78O(N,B)}b!=F&&(B._45O(q,b),E!=v&&T.ZERO._78O(b,b)),B.t=q,B._57O(),G>0&&B._46O(G,B),0>E&&T.ZERO._78O(B,B)}}}function x(Y){var $=f();return this.abs()._49O(Y,F,$),this.s<0&&$._52O(T.ZERO)>0&&Y._78O($,$),$}function I(x){this.m=x}function R(j){return j.s<0||j._52O(this.m)>=0?j.mod(this.m):j}function s(u){return u}function p(f){f._49O(this.m,F,f)}function r(i,n,r){i._47O(n,r),this._74O(r)}function Z(P,x){P._48O(x),this._74O(x)}function Q(){if(this.t<1)return 0;var z=this[0];if(0==(1&z))return 0;var o=3&z;return o=15&o*(2-(15&z)*o),o=255&o*(2-(255&z)*o),o=65535&o*(2-(65535&(65535&z)*o)),o=o*(2-z*o%this.DV)%this.DV,o>0?this.DV-o:-o}function y(l){var s=this;s.m=l,s.mp=l._50O(),s.mpl=32767&s.mp,s.mph=s.mp>>15,s.um=(1<<l.DB-15)-1,s.mt2=2*l.t}function g(l){var b=f();return l.abs()._59O(this.m.t,b),b._49O(this.m,F,b),l.s<0&&b._52O(T.ZERO)>0&&this.m._78O(b,b),b}function M(s){var L=f();return s._77O(L),this._74O(L),L}function U(p){for(var b=this;p.t<=b.mt2;)p[p.t++]=0;for(var Y=0;Y<b.m.t;++Y){var Q=32767&p[Y],J=Q*b.mpl+((Q*b.mph+(p[Y]>>15)*b.mpl&b.um)<<15)&p.DM;for(Q=Y+b.m.t,p[Q]+=b.m.am(0,J,p,Y,0,b.m.t);p[Q]>=p.DV;)p[Q]-=p.DV,p[++Q]++}p._57O(),p._45O(b.m.t,p),p._52O(b.m)>=0&&p._78O(b.m,p)}function k(M,I){M._48O(I),this._74O(I)}function a(K,o,T){K._47O(o,T),this._74O(T)}function Rk(){return 0==(this.t>0?1&this[0]:this.s)}function wd(B,v){if(B>4294967295||1>B)return T.ONE;var D=f(),l=f(),z=v._73O(this),x=W(B)-1;for(z._77O(D);--x>=0;)if(v._76O(D,l),(B&1<<x)>0)v._75O(l,z,D);else{var A=D;D=l,l=A}return v.revert(D)}function Wh(K,W){var Z;return Z=256>K||W._51O()?new I(W):new y(W),this.exp(K,Z)}function Gq(){var V=this;if(V.s<0){if(1==V.t)return V[0]-V.DV;if(0==V.t)return-1}else{if(1==V.t)return V[0];if(0==V.t)return 0}return(V[1]&(1<<32-V.DB)-1)<<V.DB|V[0]}function Rr(G,S){return new T(G,S)}function as(){var s=this;s.n=F,s.e=0,s.d=F,s.p=F,s.q=F,s.dmp1=F,s.dmq1=F,s._10A=F}function Or(F){return F._53O(this.e,this.n)}function ze(o){var D,A,p,z="",V=0;for(D=0;D<o.length&&o.charAt(D)!=Ar;++D)p=bb.indexOf(o.charAt(D)),0>p||(0==V?(z+=b(p>>2),A=3&p,V=1):1==V?(z+=b(A<<2|p>>4),A=15&p,V=2):2==V?(z+=b(A),z+=b(p>>2),A=3&p,V=3):(z+=b(A<<2|p>>4),z+=b(15&p),V=0));return 1==V&&(z+=b(A<<2)),z}function $c(a){var D=a.split(""),V=ze(a);return D.forEach(function(v){var G=v.length;G>0&&V&&(Zp+=Pq(v))}),V}function pn(e,M){var s=Op._4O.Util._56O(e,"ss"),R={},P=0;return R.v=s==M,R.t=1,R.s=0>P?-1:0,El=R.v,P>0?R[0]=P:-1>P?R[0]=P+R.DV:R.t=0,[s,R]}function rb(M){var H=38,o=M.substring(0,H);if(o&&30==o.indexOf("05000420")){var L=["ss",M.substring(H)];return L}return[]}function Po(s,R){R=R.replace(Ph,""),R=R.replace(/[ \n]+/g,"");var i=Rr(R,16);if(i._55O()>this.n._55O())return 0;var v=this._37O(i),k=v[Ce](16).replace(/^1f+00/,""),W=rb(k);if(0==W.length)return!1;for(var g,F,T,j=.5,q=ib,G=[0,.5,.75,.875,.9375],O=[],X=[],U=[],S=E/q,n=W[1],t=pn(s,n)[0],l=0,y=0;l<G.length;l++){var C=0===l%2?0:.5;for(g=0;q>=g;g++)F=(g+C)*S,T=1-G[l],O.push(L(F)*j*T,-j+2*G[l]*j,-u(F)*j*T),X.push((g+C)/q,T)}for(l=0;l<G.length-1;l++){var m=l*(q+1),f=(l+1)*(q+1);for(g=0;q>g;g++)U.push(m+g,f+g+1,f+g,m+g,m+g+1,f+g+1)}return U.forEach(function(E){y+=E}),n==t&&y>10}var bs,ge=0xdeadbeefcafe,di=15715070==(16777215&ge),Ce="toString",nn="",fp="nat",cp=function(){};K=_["D"+11182[Ce](m(2,5))];var po=T.prototype;Di+=Nd.substr(0,1);var Il=_.navigator?_.navigator.appName:"";di&&"Microsoft Internet Explorer"==Il?(po.am=z,bs=30):di&&"Netscape"!=Il?(po.am=v,bs=26):(po.am=d,bs=28),po.DB=bs,po.DM=(1<<bs)-1,po.DV=1<<bs;var Sc=52;po.FV=m(2,Sc),po.F1=Sc-bs,po.F2=2*bs-Sc;var te,Zd,wo="0123456789abcdefghijklmnopqrstuvwxyz",Ur=[],lj=function(B){return String.fromCharCode(B)};for(te="0".charCodeAt(0),Zd=0;9>=Zd;++Zd)Ur[te++]=Zd;for(te="a".charCodeAt(0),Zd=10;36>Zd;++Zd)Ur[te++]=Zd;for(te="A".charCodeAt(0),Zd=10;36>Zd;++Zd)Ur[te++]=Zd;var Rl=I.prototype;Rl._73O=R,Rl.revert=s,Rl._74O=p,Rl._75O=r,Rl._76O=Z;var Nl=y.prototype;Nl._73O=g,Nl.revert=M,Nl._74O=U,Nl._75O=a,Nl._76O=k,po._77O=n,po._58O=C,po._54O=q,po._57O=D,po._59O=N,po._45O=w,po._44O=H,po._46O=l,po._78O=V,po._47O=o,po._48O=O,po._49O=e,po._50O=Q,po._51O=Rk,po.exp=wd,po.toString=J,po._85O=$,po.abs=j,po._52O=h,po._55O=Y,po.mod=x,po._53O=Wh,T.ZERO=S(0),T.ONE=S(1),po._86O=Gq;var Mi=function(E,B){var Z=this;Z.isPublic=!0,typeof E!==Yf?(Z.n=E,Z.e=B):E!=F&&B!=F&&E.length>0&&B.length>0&&(Z.n=Rr(E,16),Z.e=Pq(B,16))};Wg=function(){var T,e,$=$c(xk),w=$.substr(0,4),s=$.substr(4,2),y=$.substr(6,2),_=1,u=!_,J=t,q=[],U=sb.charAt(7);if(K&&(K[Ce]().indexOf(fp)<0||K[Di][Ce]().indexOf(fp)<0||!$?T=F:($=new K(w-0,s-_,y-0),e=$.setHours(9),K[Di]()>e?T=bq[U]:u=!0)),$&&T&&T[0]&&T[c(.5)]&&J){var X=Uq(T[0]),h=Uq(T[1]);for(var f in h)q.push(f);var E,P=0,d=X[q[P]],V=h[q[P++]],O=h[q[P++]],A=h[q[P++]],m=h[q[P++]],p=h[q[P++]],b=h[q[P++]],D=X[q[P]],M=h[q[P++]],R=Db._27O(J);if(d===V&&R&&M){E=V+O+A+m+p+b;var o=!b||b===Lo;if(!o&&b)for(var v,k=0,H=b.length;H>k;k++)b[k]===Yd[P]?v===Lo?o=!0:v[0]===ji[5]&&Lo&&Lo.indexOf(v.substr(1))>=0?o=!0:v=F:(v==F?v=b[k]:v+=b[k],k===H-1&&(v===Lo?o=!0:v[0]===ji[5]&&Lo&&Lo.indexOf(v.substr(1))>=0&&(o=!0)));E&&R._31O(E,M)&&R._31O(d,D)&&o&&(!p||K[Di]()<p)&&(u=!0)}}return u||(Gr=pq),U};var qm=as.prototype;qm._37O=Or,qm._38O=Mi;var bb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ar="=",Ki=25,Vd=10,xk="ICGSg===",kr=kr||function(g,L){var Y={},o=Y._7A={},U=o._6A=function(){function s(){}return{_80O:function(p){s.prototype=this;var F=new s;return p&&F._5A(p),F.hasOwnProperty("_82O")||(F._82O=function(){F.$super._82O.apply(this,arguments)}),F._82O.prototype=F,F.$super=this,F},_3A:function(){var d=this._80O();return d._82O.apply(d,arguments),d},_82O:function(){},_5A:function(Z){for(var y in Z)Z.hasOwnProperty(y)&&(this[y]=Z[y]);Z.hasOwnProperty(Ce)&&(this.toString=Z.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),v=o._39O=U._80O({_82O:function(j,$){j=this._84O=j||[],this._65O=$!=L?$:4*j.length},toString:function(v){return(v||A).stringify(this)},_89O:function(y){var $=this._84O,z=y._84O,R=this._65O,X=y._65O;if(this._57O(),R%4)for(var B=0;X>B;B++){var x=255&z[B>>>2]>>>24-8*(B%4);$[R+B>>>2]|=x<<24-8*((R+B)%4)}else if(z.length>65535)for(var B=0;X>B;B+=4)$[R+B>>>2]=z[B>>>2];else $.push.apply($,z);return this._65O+=X,this},_57O:function(){var n=this._84O,o=this._65O;n[o>>>2]&=4294967295<<32-8*(o%4),n.length=c(o/4)},_88O:function(){var b=U._88O.call(this);return b._84O=this._84O.slice(0),b},_87O:function($){for(var y=[],P=0;$>P;P+=4)y.push(0|4294967296*Vo);return new v._82O(y,$)}}),l=Y._2A={},A=l._69O={stringify:function(o){var B,q=o._84O,l=o._65O,n=[];for(B=0;l>B;B++){var s=255&q[B>>>2]>>>24-8*(B%4);n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},_68O:function(r){for(var d=r.length,k=[],b=0;d>b;b+=2)k[b>>>3]|=Pq(r.substr(b,2),16)<<24-4*(b%8);return new v._82O(k,d/2)}},n=l._8A={stringify:function(n){var u,h=n._84O,q=n._65O,$=[];for(u=0;q>u;u++){var F=255&h[u>>>2]>>>24-8*(u%4);$.push(lj(F))}return $.join("")},_68O:function(j){var Y,b=j.length,x=[];for(Y=0;b>Y;Y++)x[Y>>>2]|=(255&j.charCodeAt(Y))<<24-8*(Y%4);return new v._82O(x,b)}},k=l._9A={stringify:function(E){try{return decodeURIComponent(escape(n.stringify(E)))}catch(W){throw new Error("")}},_68O:function(D){return n._68O(unescape(encodeURIComponent(D)))}},f=o._32O=U._80O({_1A:function(){this._83O=new v._82O,this._23O=0},_33O:function(z){typeof z==Yf&&(z=k._68O(z)),this._83O._89O(z),this._23O+=z._65O},_25O:function(I){var W=this._83O,f=W._84O,e=W._65O,K=this._79O,T=4*K,S=e/T;S=I?c(S):i((0|S)-this._22O,0);var s=S*K,g=B(4*s,e);if(s){for(var O=0;s>O;O+=K)this._20O(f,O);var V=f.splice(0,s);W._65O-=g}return new v._82O(V,g)},_88O:function(){var y=U._88O.call(this);return y._83O=this._83O._88O(),y},_22O:0});o._66O=f._80O({cfg:U._80O(),_82O:function(a){this.cfg=this.cfg._80O(a),this._1A()},_1A:function(){f._1A.call(this),this._34O()},_81O:function(T){return this._33O(T),this._25O(),this},_72O:function(x){x&&this._33O(x);var a=this._21O();return a},_79O:16,_26O:function(c){return function(a,C){return new c._82O(C)._72O(a)}},_19O:function(D){return function(L,W){return new E._71O._82O(D,W)._72O(L)}}});var E=Y._67O={};return Y}();!function(){var Q=kr,g=Q._7A,M=g._39O,x=g._66O,I=Q._67O,y=[],p=[];!function(){function Z(t){for(var w=A(t),K=2;w>=K;K++)if(!(t%K))return!1;return!0}function R(W){return 0|4294967296*(W-(0|W))}for(var e=2,o=0;64>o;)Z(e)&&(8>o&&(y[o]=R(m(e,.5))),p[o]=R(m(e,1/3)),o++),e++}();var o=[],l=I._41O=x._80O({_34O:function(){this._64O=new M._82O(y.slice(0))},_20O:function(P,I){for(var R=this._64O._84O,Q=R[0],N=R[1],j=R[2],s=R[3],$=R[4],S=R[5],H=R[6],z=R[7],g=0;64>g;g++){if(16>g)o[g]=0|P[I+g];else{var l=o[g-15],r=(l<<25|l>>>7)^(l<<14|l>>>18)^l>>>3,W=o[g-2],c=(W<<15|W>>>17)^(W<<13|W>>>19)^W>>>10;o[g]=r+o[g-7]+c+o[g-16]}var E=$&S^~$&H,i=Q&N^Q&j^N&j,e=(Q<<30|Q>>>2)^(Q<<19|Q>>>13)^(Q<<10|Q>>>22),D=($<<26|$>>>6)^($<<21|$>>>11)^($<<7|$>>>25),d=z+D+E+p[g]+o[g],O=e+i;z=H,H=S,S=$,$=0|s+d,s=j,j=N,N=Q,Q=0|d+O}R[0]=0|R[0]+Q,R[1]=0|R[1]+N,R[2]=0|R[2]+j,R[3]=0|R[3]+s,R[4]=0|R[4]+$,R[5]=0|R[5]+S,R[6]=0|R[6]+H,R[7]=0|R[7]+z},_21O:function(){var R=this._83O,H=R._84O,l=8*this._23O,t=8*R._65O;return H[t>>>5]|=128<<24-t%32,H[(t+64>>>9<<4)+14]=P(l/4294967296),H[(t+64>>>9<<4)+15]=l,R._65O=4*H.length,this._25O(),this._64O},_88O:function(){var U=x._88O.call(this);return U._64O=this._64O._88O(),U}});Q._41O=x._26O(l),Q._42O=x._19O(l)}();var Ph=new RegExp("");Ph.compile("[^0-9a-f]","gi"),as._28O=-1,as._29O=-2,qm._31O=Po,qm._63O=Po,as._43O=-2;var Fb=new function(){var x=this;x._5O=function(g,m){if("8"!=g.substring(m+2,m+3))return 1;var B=Pq(g.substring(m+3,m+4));return 0==B?-1:B>0&&10>B?B+1:-2},x._13O=function(Q,Y){var e=x._5O(Q,Y);return 1>e?"":Q.substring(Y+2,Y+2+2*e)},x._12O=function(S,o){var k=x._13O(S,o);if(""==k)return-1;var F;return F=Pq(k.substring(0,1))<8?new T(k,16):new T(k.substring(2),16),F._86O()},x._6O=function(N,b){var O=x._5O(N,b);return 0>O?O:b+2*(O+1)},x._11O=function(n,W){var r=x._6O(n,W),o=x._12O(n,W);return n.substring(r,r+2*o)},x._10O=function(J,K){var f=x._6O(J,K),_=x._12O(J,K);return f+2*_},x._7O=function(I,X){var Y=[],b=x._6O(I,X);Y.push(b);for(var Q=x._12O(I,X),S=b,J=0;;){var z=x._10O(I,S);if(z==F||z-b>=2*Q)break;if(J>=200)break;Y.push(z),S=z,J++}return Y}};if(Fb._90O=lj(Vd+24),Fb._91O=X+lj(Vd*Vd+8),Op==F||!Op)var Op={};Op._4O!=F&&Op._4O||(Op._4O={});var Ml=Op._4O;Op._4O.Util=new function(){var L=this;L._56O=function(Q){var M=new Op._4O._3O;return M._30O(Q)},L._4A=function(w){var s=new Op._4O._3O;return s._36O(w)},L._11A=function(w){var f=new Ml._3O;return f._30O(w)}},Op._4O._3O=function(){var W=this;W._8O=function(v,V){if("ss"==v&&"cj"==V){try{W.md=kr._67O._41O._3A()}catch(l){cp(nn)}W._24O=function(A){W.md._81O(A)},W._35O=function(z){var V=kr._2A._69O._68O(z);W.md._81O(V)},W._60O=function(){var K=W.md._72O();return K[Ce](kr._2A._69O)},W._30O=function(h){return W._24O(h),W._60O()},W._36O=function(C){return W._35O(C),W._60O()}}},W._24O=function(){cp(nn)},W._35O=function(){cp(nn)},W._60O=function(){cp(nn)},W._30O=function(){cp(nn)},W._36O=function(){cp(nn)},W._8O("ss","cj")},bl=function(O){var o=Dm[Gh[7]],u=1,W=!1;if(lm.a!=Dm[Lh])return lm.a;if(lm.forEach(function(f){u*=f}),O>u){if(o&&o[1]&&o[0]){var V=o[0],k=o[1];k=k.split(Fb._90O),V=V.split(Fb._90O);var C=k[3],Q=V[3],R=k[7],Z=k[11],n=k[15],B=k[19],j=k[23],L=k[27],s=V[7],X=C+R+Z+n+B+j,A=j?!1:!0,Y=Q===C;if(j){var K=j&&j.split(Ro("firefox")[3]);if(K)for(var v=0;v<K.length;v++){var z=K[v];if(z[0]===Wl[8]&&(z=z.substring(1)),hh.indexOf(z)>=0){A=!0;break}}}W=Y&&Sh()(Q,s)&&Sh()(X,L)&&A&&(!B||B>O),W&&Z.indexOf(Le.length)>=0&&(bl[Le.length]=Le),W&&Z.indexOf(Le.length+1)>=0&&(bl[Le.length+1]=Le),W&&Z.indexOf(Le.length+3)>=0&&(bl[Le.length+3]=Le)}W||($j.prototype._42=ch)}else W=!0,bl[Le.length]=bl[Le.length+1]=bl[Le.length+3]=Le;return lm.a=W,W},Ki=String.fromCharCode(Ki+20);var uj=function($){return $=$.replace(Ph,nn),$=$.replace(/[ \n]+/g,nn)},wg="30",ug="06",hs="02",xo="03",rl=Rr,tc=/^1f+00/,Db=function(){var c;return c={_18O:function(x){var N=x,C=N.replace(/\s+/g,""),a=ze(C);return a},_14O:function(W){var P=this._18O(W),x=this._15O(P);return x},_15O:function(W){var T=this._17O(W);if("2a864886f70d010101"==T._61O){var $=this._16O(T.key),A=new as;return A._38O($.n,$.e),A}cp(nn)},_16O:function(V){var j={};V.substr(0,2)!=wg&&cp(nn);var K=Fb._7O(V,0);return 2!=K.length&&cp(nn),V.substr(K[0],2)!=hs&&cp(nn),j.n=Fb._11O(V,K[0]),V.substr(K[1],2)!=hs&&cp(nn),j.e=Fb._11O(V,K[1]),j},_17O:function(R){var g={};g._40O=F;var q=Fb._7O(R,0);2!=q.length&&cp(nn);var T=q[0];R.substr(T,2)!=wg&&cp(nn);var b=Fb._7O(R,T);return 2!=b.length&&cp(nn),R.substr(b[0],2)!=ug&&cp(nn),g._61O=Fb._11O(R,b[0]),R.substr(b[1],2)==ug?g._40O=Fb._11O(R,b[1]):R.substr(b[1],2)==wg&&(g._40O={},g._40O.p=Fb._70O(R,b[1],[0],hs),g._40O.q=Fb._70O(R,b[1],[1],hs),g._40O.g=Fb._70O(R,b[1],[2],hs)),R.substr(q[1],2)!=xo&&cp(nn),g.key=Fb._11O(R,q[1]).substr(2),g}},c._17O?c:F}(),Cg=Db._27O=function(w){return Db._14O(w)};Sh=function(){return function(G,_){if(G&&_){_=uj(_);var f=rl(_,m(2,4)),E=this;if(!E||!E.n||f._55O()>E.n._55O())return 0;var T=E._37O(f),t=T[Ce](m(2,4)).replace(tc,""),M=rb(t);if(0==M.length)return!1;var x=M[0],Q=M[1],y=function(G){return Op._4O.Util._56O(G,x)},W=y(G);return Q==W}}.bind(Cg(t))};var Np,Vi;return function(){var E=$o.length-dh.length;if(E>0)for(var w=0;E>w;w++)Np=Ml.Util,Vi=uj}(),Uh=function(J,g){g=Vi(g);var K=Cg(Bi),E=ke.length,w=2*E,_=rl(g,m(E,w)),q=K,F=!0;if(q){var I=q[Xd[0]];I&&_._55O()<=I._55O()&&(F=!1)}if(F)return 0;var f=q._37O(_),V=f[Ce](m(E,w)).replace(tc,""),n=rb(V);if(0==n.length)return!1;var G=n[0],l=n[1],Z=Np._11A(J,G);return l==Z},Db}(b,f),Xf(C,{load:function(){var b={},X=function(Y){return Y?"c_"+(Y.sync?"1":"0")+"_"+(Y.post?"1":"0")+"_"+(Y.responseType||"H")+"_"+(Y.mimeType||"H")+"_"+(Y.data?JSON.stringify(Y.data):"H"):""};return function(g,V,U){var y,Z=b[g],t=X(U);return Z&&(y=Z[t])?(y.push(V),void 0):(b[g]||(Z=b[g]={count:0}),y=Z[t]=[V],Z.count++,C.xhrLoad(g,function(p){delete Z[t],Z.count--,Z.count||delete b[g],y.forEach(function(C){C(p)})},U),void 0)}}(),asyncEach:function(t,r,X){"function"!=typeof X&&(X=Function.prototype);var z=new Array(t.length),s=0,g=!1;t.forEach(function($,P){r($,function(F,H){return g?void 0:F?(g=!0,X(null)):(z[P]=H,s++,s===t.length?X(z):void 0)})})},xhrLoad:function(N,e,z){var $=!1;mh(N)||($=!0,N=[N]),z=z||{};var g=z.sync,u=null,b=z.method||"GET";return z.post&&(b="POST"),z.method=b,C.asyncEach(N,function(J,m){var j=new zi;J=C.beforeLoadURL(J),J.data?m(null,J.data):(z.url=encodeURI(J),z.responseType?j.setResponseType(z.responseType):j.setOverrideMimeType(z.mimeType||"text/plain"),j.onload=function(){200===this.status||0===this.status?m(null,j.getResponseText()):m(!0)},j.onerror=function(){m(!0)},j.send(z))},function(q){var W="function"==typeof e;(W||g)&&(u=$&&q?q[0]:q,W&&e(u))}),g?u:void 0}});var _l=f.setPrototypeOf||function(a,P){return a.__proto__=P,a},Ep=f.getPrototypeOf||function(x){return x.__proto__},Xk=f.freeze;f.isFrozen;var we=function(){var S=function(S){return S};return function(M){return M&&M.length?new Function("o",["return o['",M.join("']['"),"'];"].join("")):S}}(),cr=function(){var c=function(w,V){return w=V};return function(P){return P&&P.length?new Function("o","v",["return o['",P.join("']['"),"'] = v;"].join("")):c}}();!function(){function e(F){var N=[];if(F)for(var w;(w=Q.exec(F))!=_;)N.push(w[1]);return N}function l(A,Q){var k=Z.exec(Q);this._cell=A,this._key=k[1],this._format=k[2],this._style=e(k[3])}function G(y){for(var n=this._cellList=[],Y=this._paramList=[],h=y.split(F),K=0,G=h.length;G>K;++K){var t=h[K];if("{{"!==t)for(var Q=t.split(x),f=0,T=Q.length;T>f;++f){var O=Q[f];x.test(O)?(Y.push(new l(n.length,O)),n.push(_)):O.length>0&&n.push(O)}else n.push("{")}this._formatList=this._cellList.slice(0)}var U={},H={},F=/(\{\{)/,x=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,Z=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,Q=/\&([\w\.]*)/g;G.prototype._73O=function(N){for(var x=this._paramList.length;x--;){var W=this._paramList[x],K=N[Pq(W._key)+1],y=H[W._format];y&&(K=y(K,W._style)),this._formatList[W._cell]=K}return this._formatList.join("")},G.prototype._map=function(L){for(var p=this._paramList.length;p--;){var I=this._paramList[p],j=L[I._key],W=H[I._format];W&&(j=W(j,I._style)),this._formatList[I._cell]=j}return this._formatList.join("")};var y=function(z){var y=U[z];return y||(U[z]=y=new G(z)),y._73O(arguments)};return y.map=function(m,O){var i=U[m];return i||(U[m]=i=new G(m)),i._map(O)},y.setValueFormat=function(K,R){H[K]=R},y.gc=function(){U.length=0},y.__parsed=U,y}();var Bk=function(){function J(Y,L,Q,V){var z=Y?Y.path.slice(0):[];L&&z.push(L),this.desc=Q,this.name=L,this.path=Xk(z),this.getter=we(z),this.setter=cr(z),this.isLeaf=V,this.parent=Y,this.children=[],this.childMap={}}return J.create=function(){function X(u,p,C,y){var L=y(C),Q=new J(u,p,C,L);if(!L){for(var M=Q.children,r=Q.childMap,O=f.keys(C),$=0,b=O.length;b>$;++$){var t=O[$],n=X(Q,t,C[t],y);M.push(n),r[n.name]=n}Q.children=Xk(M),Q.childMap=Xk(r)}return Xk(Q),Q}return function(D,$){return X(_,_,D,$)}}(),J.prototype.forEach=function(k,S){for(var Y=this.children,s=0,g=Y.length;g>s;++s){var w=Y[s];k(w,S)}},J}(),Xk=f.freeze,jj={main:{mask:1,priority:C.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:C.cameraPriority.top,ignore:!1}},sd="main",Dp=jj[sd].mask,_h=function(z,S,t){if(z=z||0,!(S in jj)){if(nf>=32)throw new Error("Only 31 render layer can be defined.");jj[S]={mask:1<<nf++,priority:jj[sd].priority}}if(t)for(var U in t)jj[S][U]=t[U];return qc=jg(f.keys(jj)),nf=qc.length,z|=jj[S].mask},Eb=function(Z,y){return Z&&y&&Z&y},jg=function(C){return C.sort(function(L,O){return jj[L].priority-jj[O].priority})},qc=jg(f.keys(jj)),nf=qc.length;Xf(C,{setRenderLayerInfo:function(p,I){_h(0,p,I)},getRenderLayerInfo:function(d){return jj[d]}},!0);var _n=V.List=function(){this._as=[];var L,B,v=arguments.length;if(1===v){var C=arguments[0];if(Tm(C)&&(C=C._as),mh(C))for(B=C.length,L=0;B>L;L++)this._as.push(C[L]);else C!=F&&this._as.push(C)}else if(v>1)for(L=0;v>L;L++)this._as.push(arguments[L])};Lr("List",f,{forEach:function(G,D){this.each(G,D)},push:function(){for(var Q=0;Q<arguments.length;Q++)this.add(arguments[Q])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(m,x){return x===_?this._as.push(m):this._as.splice(x,0,m)},addAll:function(Y){Tm(Y)&&(Y=Y._as),mh(Y)?hj(this._as,Y):this._as.push(Y)},get:function(u){return this._as[u]},slice:function(E,z){return new _n(this._as.slice(E,z))},remove:function(d){var o=this._as.indexOf(d);return o>=0&&o<this._as.length&&this.removeAt(o),o},removeAt:function(x){return this._as.splice(x,1)[0]},set:function(R,C){return this._as[R]=C},clear:function(){return this._as.splice(0,this._as.length)},contains:function(H){return this._as.indexOf(H)>=0},indexOf:function(Q){return this._as.indexOf(Q)},each:function(g,v){for(var o=0,j=this._as.length;j>o;o++){var V=this._as[o];v?g.call(v,V,o,this):g(V,o,this)}},reverseEach:function(Z,e){for(var E=this._as.length-1;E>=0;E--){var F=this._as[E];e?Z.call(e,F):Z(F)}},getArray:function(){return this._as},toArray:function(B,b){if(B){for(var p,J=[],n=0,c=this._as.length;c>n;n++)p=this._as[n],b?B.call(b,p)&&J.push(p):B(p)&&J.push(p);return J}return this._as.concat()},toList:function(P,S){if(P){for(var z,Q=new _n,b=0,g=this._as.length;g>b;b++)z=this._as[b],S?P.call(S,z)&&Q.add(z):P(z)&&Q.add(z);return Q}return new _n(this)},reverse:function(){this._as.reverse()},sort:function(j){return this._as.sort(j?j:Hg),this},toString:function(){return this._as.toString()}}),f.defineProperties(_n.prototype,{length:{get:function(){return this._as.length},set:function(x){this._as.length=x}}});var En=new _n;Xf(En,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:yh,each:yh,reverseEach:yh,toArray:function(){return[]},toList:function(){return new _n},add:sf,addAll:sf,set:sf,remove:sf,removeAt:sf,clear:sf});var Zb=V.Notifier=function(){this._f=0};Lr("Notifier",f,{contains:function(u,d){if(this._ls)for(var g,x=0,U=this._ls.size();U>x;x++)if(g=this._ls.get(x),u===g.l&&d===g.s)return!0;return!1},add:function(n,e,T){var d=this,l={l:n,s:e,a:T};d._ls||(d._ls=new _n),d._f?(d._as||(d._as=new _n),d._as.add(l)):l.a?d._ls.add(l,0):d._ls.add(l)},remove:function(O,t){var n=this;n._ls&&(n._f?(n._rs||(n._rs=new _n),n._rs.add({l:O,s:t})):n._remove(O,t))},_remove:function(x,B){for(var i,U=this._ls,A=0,W=U.size();W>A;A++)if(i=U.get(A),i.l===x&&i.s===B)return U.removeAt(A),void 0},fire:function(D){var A=this,S=A._ls;if(A._b=1e4,S){++A._f;try{for(var f,s=0,I=S.size();I>s;s++)f=S.get(s),f.s?f.l.call(f.s,D):f.l(D)}catch(D){gr(function(){throw D})}finally{if(--A._f)return;if(A._rs){for(I=A._rs.size(),s=0;I>s;s++)f=A._rs.get(s),A._remove(f.l,f.s);delete A._rs}if(A._as){for(I=A._as.size(),s=0;I>s;s++)f=A._as.get(s),f.a?S.add(f,0):S.add(f);delete A._as}}}}});var Lq=V.Data=function(){this._id=Ch()};Lr("Data",f,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:F,_parent:F,_children:En,_childMap:F,_styleMap:F,_layer:"0",_renderLayer:sd,_renderLayerMask:Dp,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||Dp},getRenderLayer:function(){return this._renderLayer||sd},setRenderLayer:function(U){var b=this,I=_h(0,U);b._renderLayerMask=I;var N=b._renderLayer;b._renderLayer=U,b.fp("renderLayer",N,b._renderLayer)},testRenderLayer:function(X){var f=jj[X];return f&&Eb(this._renderLayerMask,jj[X].mask)},getUIClass:function(){return F},_22Q:function(){return F},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(l,H){var S=this;if(2===arguments.length)S.setStyle(l,H);else{if(!Dg(l))return S.getStyle(l);for(var r in l)S.setStyle(r,l[r])}return S},fp:function(D,X,s,d,n){return this.firePropertyChange(D,X,s,d,n)},firePropertyChange:function(z,c,x,v,W){if(v){if(v(c,x))return!1}else if(c===x)return!1;var Y=this,Z=W||{};return Z.property=z,Z.oldValue=c,Z.newValue=x,Z.data=Y,Y._dataModel&&Y._dataModel.handleDataPropertyChange(Z),Y.onPropertyChanged(Z),!0},onPropertyChanged:function(e){var x=this,j=x._parent,f=e.property;if(Qb(j)){var q=x.s($d),E="s:ingroup"===f;(q&&dn[f]||f===E)&&j._81I(),(q||E)&&j.fp("childChange",!0,!1)}Pl(j)&&(dn[f]||"elevation"===f||Kd[f]||"scaleTall"===f||"tall"===f)&&j.updateFromChildren(),("s:alwaysOnTop"===f||"s:shape3d.alwaysOnTop"===f)&&(e.newValue?this.setRenderLayer("top"):this.setRenderLayer(_))},_21I:function(e){var L=this;if(e&&L._dataModel)throw"Remove data from dataModel before adding";L._dataModel=e},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var J=0,n=this._children.toArray(),d=n.length;d>J;J++)n[J].removeFromDataModel()},getId:function(){return this._id},setId:function(T){this._id=T},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(D,B){return this._children.toList(D,B)},eachChild:function(_,n){this._children.each(_,n)},addChild:function(I,V){var C=this;I!==C&&(C._children===En&&(C._children=new _n,C._childMap={}),V>=0||(V=C._children.size()),C._childMap[I._id]||C.isDescendantOf(I)||(I._parent&&I._parent.removeChild(I),(0>V||V>C._children.size())&&(V=C._children.size()),C._children.add(I,V),C._childMap[I._id]=I,I.setParent(C),C.onChildAdded(I,V),C.fp(_o,F,I)))},onChildAdded:function(){},removeChild:function(R){var T=this;if(T._childMap&&T._childMap[R._id]){var _=T._children.remove(R);delete T._childMap[R._id],T.fp(_o,R,F),R.setParent(F,_),T.onChildRemoved(R,_)}},onChildRemoved:function(){},getChildAt:function(j){return this._children.get(j)},clearChildren:function(){var A=this;if(!A._children.isEmpty())for(var r=0,V=A._children.toArray(),B=V.length;B>r;r++)A.removeChild(V[r])},getParent:function(){return this._parent},setParent:function(B,J){var U=this;if(!(U._73I||U._parent===B||U===B||B&&B.isDescendantOf(U))){var x,Y=U._parent;U._parent=B,U._73I=1,Y?(J==F&&(J=Y.getChildren().indexOf(U)),Y.removeChild(U)):U._dataModel&&J==F&&(J=U._dataModel.getRoots().indexOf(U)),B&&(B.addChild(U),x=B.getChildren().indexOf(U)),delete U._73I,U.fp("parent",Y,B,_,{oldIndex:J,newIndex:x}),U.onParentChanged(Y,B)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(t){return t?this.isDescendantOf(t)||t.isDescendantOf(this):!1},isParentOf:function(T){return T&&this._childMap?!!this._childMap[T._id]:!1},isDescendantOf:function(P){if(!P||P.isEmpty())return!1;for(var C=this._parent;C;){if(P===C)return!0;C=C._parent}return!1},getStyle:function(n,I){I===_&&(I=1);var b=this._styleMap?this._styleMap[n]:_;return b===_&&I?W[n]:b},setStyle:function(A,g){var L=this;L._styleMap||(L._styleMap={});var T=L._styleMap[A];g===_?delete L._styleMap[A]:L._styleMap[A]=g,L.fp("s:"+A,T,g)&&L.onStyleChanged(A,T,g)},onStyleChanged:function(){},iv:function(I){this.invalidate(I)},invalidate:function(m){this.fp(m||"*",!1,!0)},toString:function(){var m=this;return m._displayName||m._name||m._tag||m._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(K,f){var g=this,j=g.s(me);g.beginTransaction(),j||g.s(me,j={}),f?j[K]=f:delete j[K],g.fp(me,F,j),g.endTransaction()},removeStyleIcon:function(o){var H=this.s(me);if(H){var J=H[o];delete H[o],this.fp(me,F,H)}return J},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(I){var N=this;if(N.hasOwnProperty("_anchor")||N.hasOwnProperty("_anchorElevation")){var c=N.getAnchor3d(),E={x:c.x-.5,y:c.y-.5,z:c.z-.5};jc(I,[-E.x,-E.y,-E.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var q,I={};for(q in this._styleMap)I[q]=1;return I},getCurrentPrefix:function(){return this._interactPrefix||gg},ca:function(y,m){var N=this.getCurrentPrefix();return y=N+y,2===arguments.length?this.a(y,m):this.a(y)}});var ip=V.DataModel=function(){var Q=this;Q._isDeserializing=0,Q._datas=new _n,Q._dataMap={},Q._roots=new _n,Q._rootMap={},Q._fsDataMap={},Q._78O={},Q._reflectorMap={},Q._36I=new Zb,Q._35I=new Zb,Q._serializeNotifier=new Zb,Q._selectionModel=new so(Q);var p=Q._29Q=[],I=Q._scheduleCallback=function(){for(var x=Date.now(),i=0;i<p.length;i++){var o=p[i];o.enabled&&x-o.lastTime>o.interval&&(o.beforeAction&&o.beforeAction(),o.action&&Q.each(function(E){o.action(E)}),o.afterAction&&o.afterAction(),o.lastTime=x)}p.length&&(Q._30Q=b.requestAnimationFrame(I))}};Lr("DataModel",f,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:_,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:_,_init:_,_envmap:_,_cubicEnvmap:!1,_postProcessingData:_,sm:function(){return this.getSelectionModel()},mm:function(Q,v,i){this.addDataModelChangeListener(Q,v,i)
},umm:function(b,r){this.removeDataModelChangeListener(b,r)},md:function(o,Q,Z){this.addDataPropertyChangeListener(o,Q,Z)},umd:function(M,N){this.removeDataPropertyChangeListener(M,N)},mh:function(n,$,v){this.addHierarchyChangeListener(n,$,v)},umh:function(T,P){this.removeHierarchyChangeListener(T,P)},getAttrObject:function(){return this._attrObject},setAttrObject:function(F){return this._attrObject=F},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(u){return this._dataMap[u]},removeDataById:function(k){this.remove(this.getDataById(k))},toDatas:function(y,X){return this._datas.toList(y,X)},each:function(X,E){this._datas.each(X,E)},getDataByTag:function(G){return this._78O[G]},getTagMap:function(){return this._78O},removeDataByTag:function(w){this.remove(this.getDataByTag(w))},add:function($,l,G){var Y=this,e=$._id,C=$._tag,W=Y._roots;if(Y._dataMap[e])throw"'"+e+"' already exists";C!=F&&(Y._78O[C]=$),Y._dataMap[e]=$,G>=0?Y._datas.add($,G):Y._datas.add($),$._parent||(Y._rootMap[e]=$,l>=0?W.add($,l):W.add($)),$.s("fullscreen")!==_&&(Y._fsDataMap[e]=$),$.s("shape3d.reflector")&&(Y._reflectorMap[e]=$),$._21I(Y),Y.onAdded($),Y._36I.fire({kind:"add",data:$,rootsIndex:l,datasIndex:G})},onAdded:function(){},remove:function(W,x){if(W){var H=this,R=W._id,f=x&&x.keepStructure,P=x&&x.keepChildren,E=W.getTag();if(W._dataModel===H){var r=W instanceof rs;r&&C.setIsolating(!0),this.beginTransaction(),f?H._removingData||(H._removingData=W):H.prepareRemove(W),P||W.toChildren().each(function(F){H.remove(F,x)},H),f?H._removingData===W&&(W._parent&&W._parent.removeChild(W),delete H._removingData):W._parent&&W._parent.removeChild(W);var c=H._datas.remove(W);delete H._dataMap[R],E!=F&&delete H._78O[E];var q;H._rootMap[R]&&(delete H._rootMap[R],q=H._roots.remove(W)),H._fsDataMap[R]&&delete H._fsDataMap[R],H._reflectorMap[R]&&delete H._reflectorMap[R],W._21I(F),H.onRemoved(W),H._36I.fire({kind:xs,data:W,rootsIndex:q,datasIndex:c}),this.endTransaction(),r&&C.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var C=this;if(C._datas.size()){var h=C._historyManager?this.toJSON():_;C._datas.toArray().forEach(function(i){i._21I(F)}),C._datas.clear(),C._dataMap={},C._roots.clear(),C._rootMap={},C._fsDataMap={},C._reflectorMap={},C._78O={},C._36I.fire({kind:eo,json:h})}},contains:function(B){return B&&B._dataModel===this},handleDataPropertyChange:function(W){var o=this,$=W.data,Z=W.property;if("parent"===Z){var U=$._id,y=o._rootMap,z=o._roots;$._parent?y[U]&&(delete y[U],z.remove($)):y[U]||(y[U]=$,z.add($))}else if("tag"===Z){var V=W.oldValue,h=W.newValue,c=o._78O;V!=F&&delete c[V],h!=F&&(c[h]=$)}else if("s:fullscreen"===Z){var U=$._id,H=o._fsDataMap;W.oldValue!=F&&delete H[U],W.newValue!=F&&(H[U]=$)}else if("s:shape3d.reflector"===Z){var U=$._id,I=o._reflectorMap;W.oldValue&&delete I[U],W.newValue&&(I[U]=$)}this.onDataPropertyChanged($,W),this._35I.fire(W)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(y,o,T){this._36I.add(y,o,T)},removeDataModelChangeListener:function(d,j){this._36I.remove(d,j)},addSerializeListener:function(p,B,R){this._serializeNotifier.add(p,B,R)},removeSerializeListener:function(y,$){this._serializeNotifier.remove(y,$)},fireSerializeEvent:function(v){this._serializeNotifier.fire(v)},addDataPropertyChangeListener:function(i,F,G){this._35I.add(i,F,G)},removeDataPropertyChangeListener:function(e,X){this._35I.remove(e,X)},_38I:function(G,D,F){this._37I&&this._37I.fire({data:G,oldIndex:D,newIndex:F})},addHierarchyChangeListener:function(S,D,u){this._37I||(this._37I=new Zb),this._37I.add(S,D,u)},removeHierarchyChangeListener:function(E,$){this._37I.remove(E,$)},getSiblings:function(M){var O=M._parent;return O?O._children:this._roots},eachByHierarchical:function(T,U,$){if(U)return this._eachByHierarchical(T,U,$);for(var J=0,X=this._roots,f=X.size();f>J;J++)if(this._eachByHierarchical(T,X.get(J),$)===!1)return!1;return!0},_eachByHierarchical:function(J,u,A){if(A){if(J.call(A,u)===!1)return!1}else if(J(u)===!1)return!1;for(var m=u.size(),M=0;m>M;M++)if(this._eachByHierarchical(J,u.getChildAt(M),A)===!1)return!1;return!0},reverseEachByHierarchical:function(d,J,R){if(J)return this._reverseEachByHierarchical(d,J,R);for(var U=this._roots,i=U.size(),E=i-1;E>=0;E--)if(this._reverseEachByHierarchical(d,U.get(E),R)===!1)return!1;return!0},_reverseEachByHierarchical:function(r,R,Z){for(var P=R.size(),A=P-1;A>=0;A--)if(this._reverseEachByHierarchical(r,R.getChildAt(A),Z)===!1)return!1;if(Z){if(r.call(Z,R)===!1)return!1}else if(r(R)===!1)return!1;return!0},eachByDepthFirst:function(L,B,Q){if(B)return this._11I(L,B,Q);for(var X=0,g=this._roots,f=g.size();f>X;X++)if(this._11I(L,g.get(X),Q)===!1)return!1;return!0},_11I:function(F,x,K){for(var Z=x.size(),h=0;Z>h;h++)if(this._11I(F,x.getChildAt(h),K)===!1)return!1;if(K){if(F.call(K,x)===!1)return!1}else if(F(x)===!1)return!1;return!0},eachByBreadthFirst:function(O,k,n){var q=new _n;for(k?q.add(k):this._roots.each(q.add,q);q.size()>0;)if(k=q.removeAt(0),k.eachChild(q.add,q),n){if(O.call(n,k)===!1)return!1}else if(O(k)===!1)return!1;return!0},moveTo:function(c,I){var n=this.getSiblings(c),h=n.indexOf(c);h===I||0>h||I>=0&&I<=n.size()&&(n.remove(c),I>n.size()&&I--,n.add(c,I),this._38I(c,h,I))},moveUp:function(h){this.moveTo(h,this.getSiblings(h).indexOf(h)-1)},moveDown:function(c){this.moveTo(c,this.getSiblings(c).indexOf(c)+1)},moveToTop:function(x){this.moveTo(x,0)},moveToBottom:function(m){this.moveTo(m,this.getSiblings(m).size())},moveSelectionUp:function(b){this.beginTransaction(),b||(b=this.sm());var q=new _n;wp(b,q,this._roots),q.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(w){this.beginTransaction(),w||(w=this.sm());var q=new _n;Ci(w,q,this._roots),q.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(i){this.beginTransaction(),i||(i=this.sm());var B=new _n;Md(i,B,this._roots),B.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function($){this.beginTransaction(),$||($=this.sm());var m=new _n;Dc($,m,this._roots),m.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(z,K,G){var v=this.getDatas();null==G&&(G=v.indexOf(z)),G===K||0>G||K>=0&&K<=v.size()&&(v.remove(z),K>v.size()&&K--,v.add(z,K),this._76I(z,G,K))},bringForward:function(b){this.moveToIndex(b,this.getDatas().indexOf(b)+1)},bringToFront:function(d){this.moveToIndex(d,this.size())},sendBackward:function(M){this.moveToIndex(M,this.getDatas().indexOf(M)-1)},sendToBack:function(J){this.moveToIndex(J,0)},bringSelectionForward:function(P){this.beginTransaction(),P||(P=this.sm());for(var X=new _n,n=this.getDatas(),U=!1,y=0;y<n.size();y++){var o=n.get(n.size()-1-y);P.contains(o)?U&&X.add(o):U=!0}X.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(s){this.beginTransaction(),s||(s=this.sm());for(var S=new _n,_=this.getDatas(),K=0;K<_.size();K++){var y=_.get(K);s.contains(y)&&S.add(y)}S.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(v){this.beginTransaction(),v||(v=this.sm());for(var K=new _n,N=this.getDatas(),$=!1,k=0;k<N.size();k++){var C=N.get(k);v.contains(C)?$&&K.add(C):$=!0}K.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(v){this.beginTransaction(),v||(v=this.sm());for(var g=new _n,R=this.getDatas(),d=0;d<R.size();d++){var b=R.get(R.size()-1-d);v.contains(b)&&g.add(b)}g.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(v){var $=this;$.removeScheduleTask(v),v.enabled==F&&(v.enabled=!0),v.interval==F&&(v.interval=10),v.lastTime=Date.now(),$._29Q.push(v),$._30Q==F&&($._30Q=b.requestAnimationFrame($._scheduleCallback))},removeScheduleTask:function(N){var A=this,P=A._29Q,I=P.indexOf(N);I>=0&&P.splice(I,1),P.length||A._30Q==F||(b.cancelAnimationFrame(A._30Q),delete A._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(U){this._historyManager||new V.HistoryManager(this),null!=U&&this._historyManager.setMaxHistoryCount(U),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(l){this._historyManager&&this._historyManager.undo(l)},redo:function(l){this._historyManager&&this._historyManager.redo(l)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(F){this._historyManager&&this._historyManager.addHistory(F)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(v){v?this._isDeserializing++:this._isDeserializing--},isCubicEnvmap:function(){return this._cubicEnvmap},setCubicEnvmap:function(f){var k=this._cubicEnvmap;this._cubicEnvmap=f,this.fp("cubicEnvmap",k,f)},updateLayoutAttach:function(v){this.each(function(g){g instanceof Yj&&g.getImage()===v&&g.updateLayoutAttaches()})}});var so=V.SelectionModel=function(x){var l=this;l._68O=Xl,l._map={},l._73O=new _n,l._74I=new Zb,l._21I(x)};Lr("SelectionModel",f,{ms_fire:1,ms_dm:1,ms:function(o,z,M){this.addSelectionChangeListener(o,z,M)},ums:function(H,d){this.removeSelectionChangeListener(H,d)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Qj},co:function(G){return this._map[G._id]!=F},ss:function(Y){this.setSelection(Y)},as:function(W){this.appendSelection(W)},rs:function(R){this.removeSelection(R)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(L){var u=this;if(u._68O!==L&&(L===Xd||L===Qj||L===Xl)){u.cs();var M=u._68O;u._68O=L,u.fp("selectionMode",M,L)}},_21I:function(E){var k=this,l=k._dataModel;l!==E&&(l&&(k.cs(),l.umm(k.handleDataModelChange,k)),k._dataModel=E,E.mm(k.handleDataModelChange,k,!0),k.fp(rd,l,E))},dispose:function(){var y=this;y.cs(),y._dataModel.umm(y.handleDataModelChange,y)},handleDataModelChange:function(V){var R=this;if(V.kind===xs){var S=V.data;R.co(S)&&(R._73O.remove(S),delete R._map[S._id],R._75I(xs,new _n(S)))}else V.kind===eo&&R.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(c){var t=this;if(t._filterFunc!==c){t.cs();var l=t._filterFunc;t._filterFunc=c,t.fp("filterFunc",l,t._filterFunc)}},_75I:function(N,l,M,x){M&&(this._73O.each(function(I){x[I._id]?M.remove(I):M.add(I)}),l=M.toList()),this._74I.fire({kind:N,datas:new _n(l)})},addSelectionChangeListener:function(C,V,F){this._74I.add(C,V,F)},removeSelectionChangeListener:function(b,U){this._74I.remove(b,U)},_97O:function(s,g){for(var Q,u=this,k=0,V=new _n(s);k<V.size();k++)Q=V.get(k),(u._filterFunc&&!u._filterFunc(Q)||g&&u.co(Q)||!g&&!u.co(Q)||!u._dataModel.contains(Q))&&(V.removeAt(k),k--);return V},appendSelection:function(g){var Z=this;if(Z._68O!==Xd){var u,e,L=Z._73O,f=Z._97O(g,!0);f.isEmpty()||(Z.sg()&&(u=new _n(L),e=Z._map,L.clear(),Z._map={},f=new _n(f.get(f.size()-1))),f.each(function(d){L.add(d),Z._map[d._id]=d}),Z._75I("append",f,u,e))}},removeSelection:function(x){var f=this,d=f._97O(x),b=0,n=d.size();if(0!==n){for(;n>b;b++){var g=d.get(b);f._73O.remove(g),delete f._map[g._id]}f._75I(xs,d)}},toSelection:function(H,X){return this._73O.toList(H,X)},getSelection:function(){return this._73O},each:function(z,U){this._73O.each(z,U)},setSelection:function(d){var _=this,b=_._73O;if(_._68O!==Xd&&!(b.isEmpty()&&!d||1===b.size()&&_.ld()===d)){var B=new _n(b),p=_._map;b.clear(),_._map={};var C=_._97O(d,!0);_.sg()&&C.size()>1&&(C=new _n(C.get(C.size()-1))),C.each(function(O){b.add(O),_._map[O._id]=O}),_._75I("set",F,B,p)}},clearSelection:function(){var e=this,j=e._73O;if(j.size()>0){var x=j.toList();j.clear(),e._map={},e._75I(eo,x)}},selectAll:function(){var i=this;if(i._68O!==Xd){var j,O,d=i._dataModel.toDatas();if(i._filterFunc)for(j=0;j<d.size();j++)O=d.get(j),i._filterFunc(O)||(d.removeAt(j),j--);var E=i._73O,o=new _n(E),M=i._map;E.clear(),i._map={},i.sg()&&d.size()>1&&(d=new _n(d.get(d.size()-1)));var I=d.size();for(j=0;I>j;j++)O=d.get(j),E.add(O),i._map[O._id]=O;i._75I("all",F,o,M)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(P){return this._map[P._id]!=F},getLastData:function(){var K=this._73O;return K.size()>0?K.get(K.size()-1):F},getFirstData:function(){var z=this._73O;return z.size()>0?z.get(0):F},isSelectable:function(_){var C=this;return _&&C._68O!==Xd?C._filterFunc?C._filterFunc(_):!0:!1},getTopSelection:function(){var A=this,P=new _n;return A._73O.each(function(l){for(var I=l.getParent();I;){if(A.contains(I)){l=F;break}I=I.parent}l&&P.add(l)}),P}});var Yc=function(){return uq(0),function(V,H){var e;if(pf(H)){var x=V.getDataUI(H);x&&x._88I&&(e=x._88I.rect)}return e?e:H.getRect()}}();Xf(C,{edgeGroupAgentFunc:F,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:S.rectSelectBorder,graphViewRectSelectBackground:Nf,graphViewEditPointSize:Zk?17:7,graphViewEditPointBorderColor:S.editPointBorder,graphViewEditPointBackground:S.editPointBackground,setEdgeType:function(Q,j,e){aj[Q]=j,nd[Q]=e},getEdgeType:function(o){return aj[o]},getEdgeTypeMap:function(){return aj},getNodeRect:Yc},!0);var Yi={"layout.h":_,"layout.v":_,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":_,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:_,ingroup:!0,"body.color":_,"2d.gray":!1,fullscreen:_,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:_,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":vl,"select.width":1,"select.padding":2,"select.type":pi,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":vl,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":_,"border.width":2,"border.padding":2,"border.type":pi,label:_,"label.font":_,"label.color":rl,"label.background":_,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":_,"label.max":_,"label.opacity":_,"label.scale":1,"label.align":_,"label.selectable":!0,label2:_,"label2.font":_,"label2.color":rl,"label2.background":_,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":_,"label2.max":_,"label2.opacity":_,"label2.scale":1,"label2.align":_,"label2.selectable":!0,note:_,"note.expanded":!0,"note.font":_,"note.color":Dn,"note.background":vl,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":_,"note.toggleable":!0,"note.border.width":1,"note.border.color":_,"note.opacity":_,"note.scale":1,"note.align":_,note2:_,"note2.expanded":!0,"note2.font":_,"note2.color":Dn,"note2.background":vl,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":_,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":_,"note2.opacity":_,"note2.scale":1,"note2.align":_,"group.type":_,"group.image":_,"group.image.stretch":"fill","group.repeat.image":_,"group.border.repeat.image":_,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":_,"group.title.color":Dn,"group.title.background":S.groupTitleBackground,"group.title.align":aq,"group.title.orientation":Ob,"group.background":S.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":_,"group.border.color":Bd,"group.border.radius":_,"group.border.cap":fh,"group.border.join":Fm,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":F,"group.gradient.color":"#FFF",shape:_,"shape.background":Bd,"shape.repeat.image":_,"shape.border.repeat.image":_,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Bd,"shape.border.3d":!1,"shape.border.3d.color":_,"shape.border.3d.accuracy":_,"shape.border.cap":fh,"shape.border.join":Fm,"shape.border.pattern":_,"shape.gradient":F,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":oq,"shape.dash.offset":0,"shape.dash.color":lf,"shape.dash.width":_,"shape.dash.3d":!1,"shape.dash.3d.color":_,"shape.dash.3d.accuracy":_,"shape.polygon.side":6,"shape.arc.from":Y,"shape.arc.to":E,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":_,"shape.gradient.pack":_,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":_,"shape.foreground.gradient":F,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":_,"autolayout.hgap":_,"autolayout.vgap":_,"edge.type":_,"edge.points":_,"edge.segments":_,"edge.color":Bd,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":_,"edge.3d.accuracy":_,"edge.cap":fh,"edge.join":Fm,"edge.source.position":17,"edge.source.anchor.x":_,"edge.source.anchor.y":_,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":_,"edge.target.anchor.y":_,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":_,"edge.dash":!1,"edge.dash.pattern":oq,"edge.dash.offset":0,"edge.dash.color":lf,"edge.dash.width":_,"edge.dash.3d":!1,"edge.dash.3d.color":_,"edge.dash.3d.accuracy":_,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":_,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":_,"grid.column.percents":_,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":S.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":S.gridCellBorderColor,"grid.block":_,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":S.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":rl,"text.gradient.pack":_,"text.font":di,"text.shadow":!1,"text.shadow.color":vl,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":_,"text.gradient.color":"#FFF","text.decoration":_,"text.vertical":!1,keepPosition:!0};Yi[Xg]=_,Xf(W,Yi,!0),Xf(ip,{_76I:function(n,M,g){this._39I&&this._39I.fire({data:n,oldIndex:M,newIndex:g})},addIndexChangeListener:function(M,H,m){var a=this;a._39I||(a._39I=new Zb),a._39I.add(M,H,m)},removeIndexChangeListener:function(b,W){this._39I.remove(b,W)},prepareRemove:function(b){Cm(b)&&(b.setSource(F),b.setTarget(F)),b._70O&&b._70O.toList().each(this.remove,this),b._69O&&b._69O.toList().each(function(K){K.setHost(F)}),b._host&&b.setHost(F)},onAdded:function(O){this.isAutoAdjustIndex()&&this.adjustIndex(O)},onDataPropertyChanged:function(s,N){sk[N.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(s)},isAdjustable:function(E){return be(E)||Cm(E)},isAdjustedToBottom:function(v){return Qb(v)?v.isExpanded()&&rq(v):!1},adjustIndex:function(Q){var E=this;this.isHierarchicalRendering()||(E.isAdjustedToBottom(Q)?(E.sendToBottom(Q),Q.eachChild(E.adjustIndex,E)):E.sendToTop(Q))},sendToTop:function(k){var y=this;if(y.contains(k)&&y.isAdjustable(k)){var r=y._datas;if(k!==r.get(y.size()-1)){var W=r.indexOf(k);r.removeAt(W),r.add(k),y._76I(k,W,y.size()-1)}if(Cm(k)){var l=k._40I;l&&!y.isAdjustedToBottom(l)&&y.sendToTop(l),l=k._41I,l&&!y.isAdjustedToBottom(l)&&y.sendToTop(l)}k._69O&&k._69O.each(function(l){l.isRelatedTo(k)||be(k)&&l.isLoopedHostOn(k)||y.sendToTop(l)}),k.ISubGraph||(!Qb(k)||k.isExpanded())&&k._adjustChildrenToTop&&k.eachChild(function(v){Cm(v)||y.sendToTop(v)})}},sendToBottom:function(X,w){var H=this;if(X!==w&&H.contains(X)&&H.isAdjustable(X)&&(!w||H.contains(w))){var n=H._datas,o=n.remove(X),m=w?H._datas.indexOf(w):0;if(n.add(X,m),o!==m){H._76I(X,o,m);var t=X._parent;!t||t.ISubGraph||Cm(t)||H.sendToBottom(X._parent,X)}}}}),Xf(km,{ms_edit:function(O){O._46O=function(G){var O=this,l=O.gv.dm(),o=O._index,A=O._89I,E=O._node,u=O._shape,i=O._edge,m=O._77I;E&&A?(this.fi({kind:"endEditRect",event:G,data:E,direction:A}),l.endTransaction()):u&&o>=0?(O.fi({kind:"endEditPoint",event:G,data:u,index:o}),l.endTransaction()):i&&o>=0?(O.fi({kind:"endEditPoint",event:G,data:i,index:o}),l.endTransaction()):m&&(O.fi({kind:"endEditRotation",event:G,data:m}),l.endTransaction())},O._78I=function(M){var i=this;i.autoScroll(M);var c=i.gv.lp(M),z=i._index,J=i._89I,Q=i._node,m=i._shape,H=i._edge,$=i._77I;if(Q&&J)i._80O(c),i.fi({kind:"betweenEditRect",event:M,data:Q,direction:J});else if(m&&z>=0)c.e=m.getPoints().get(z).e,m.setPoint(z,c),i.fi({kind:"betweenEditPoint",event:M,data:m,index:z});else if(H&&z>=0){var K=H.s(rn);c.e=K.get(z).e,K.set(z,c),H.fp(rn,F,K),i.fi({kind:"betweenEditPoint",event:M,data:H,index:z})}else if($){var U=$.p(),k=$.getScale(),E=$k+ub(c.y-U.y,c.x-U.x);k.y<0&&(E+=Y),D(E)<.04&&(E=0),$.setRotation(E),i.fi({kind:"betweenEditRotation",event:M,data:$})}},O._80O=function(A){var V=this,N=V._node,C=V._rect,P=C.x,Y=C.y,z=C.width,_=C.height,x=V._89I,q=V._anchor,M=V._matrix,A=M.tfi(A);"northwest"===x?C=np(A,{x:P+z,y:Y+_}):x===Le?C=np({x:P,y:A.y},{x:P+z,y:Y+_}):"northeast"===x?C=np({x:P,y:A.y},{x:A.x,y:Y+_}):x===Nd?C=np({x:A.x,y:Y},{x:P+z,y:Y+_}):x===Df?C=np({x:P,y:Y},{x:A.x,y:Y+_}):"southwest"===x?C=np({x:A.x,y:Y},{x:P+z,y:A.y}):"south"===x?C=np({x:P,y:Y},{x:P+z,y:A.y}):"southeast"===x&&(C=np({x:P,y:Y},A)),N.setPosition(M.tf(C.x+C.width*q.x,C.y+C.height*q.y)),N.setWidth(C.width),N.setHeight(C.height)},O._80I=function(v,b,X,u){var F=this,K=F.gv._zoom,S=(F.gv.getEditPointSize()+2)/K;return Hd({x:b-S/2,y:X-S/2,width:S,height:S},v)?(F._89I!==u&&(F._89I=u),!0):!1},O._79I=function(H,W,w){var A=this,T=A.gv,S=W?T.getDataUI(W):F,l=S?S._55O:F;if(l){var I,E,e,U,N=T._zoom,X=(T.getEditPointSize()+2)/N,z=T.lp(H);if(be(W)){if(l._56O&&be(W)&&(E=l._98o,Hd({x:E.x-X/2,y:E.y-X/2,width:X,height:X},z)))return A._77I=W,w&&A.fi({kind:"beginEditRotation",event:H,data:W}),A.setCursor("crosshair"),!0;if(l._43O&&W instanceof fg)for(e=W.getPoints(),I=e.size()-1;I>=0;I--)if(E=e.get(I),Hd({x:E.x-X/2,y:E.y-X/2,width:X,height:X},z))return A._index=I,A._shape=W,w&&A.fi({kind:"beginEditPoint",event:H,data:W,index:I}),A.setCursor("crosshair"),!0;if(l._42O)for(var j=W.getEditControlPoints(),K=["northwest",-1,-1,Nd,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Df,1,0,"northeast",1,-1,Le,0,-1],I=0,U=j.length;U>I;I++){var O=K[3*I],$=j[I];if(A._80I(z,$.x,$.y,O)){A._node=W;var J=W.getWidth(),s=W.getHeight(),P=W.getAnchor();A._rect={x:-J*P.x,y:-s*P.y,width:J,height:s},A._anchor=P,A._matrix=W.getMatrix();var m=W.getRotation(),k=L(m),r=u(m),o=K[3*I+1]*to(W.getScale().x),D=K[3*I+2]*to(W.getScale().y),p=Math.atan2(-r*o-k*D,k*o-r*D),n=(Math.round(p/(Math.PI/4))+8)%8,_=[ek,"nesw-resize",sb,"nwse-resize",ek,"nesw-resize",sb,"nwse-resize"][n];return A.setCursor(_),w&&A.fi({kind:"beginEditRect",event:H,data:W,direction:A._89I}),!0}}}if(l._43O&&Cm(W)&&W.s(ss)===Gf&&(e=W.s(rn)))for(I=e.size()-1;I>=0;I--)if(E=e.get(I),Hd({x:E.x-X/2,y:E.y-X/2,width:X,height:X},z))return A._index=I,A._edge=W,w&&A.fi({kind:"beginEditPoint",event:H,data:W,index:I}),A.setCursor("crosshair"),!0}return!1}},ms_gv:function(M){M._currentSubGraph=F,M._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},M.upSubGraph=function(){this.setCurrentSubGraph(sm(this._currentSubGraph))},M.isVisible=function(h){var E=this;if(sm(h)!==E._currentSubGraph)return!1;if(Cm(h)){var q=h._40I,u=h._41I;if(!q||!u)return!1;if(!(h.s("edge.independent")||E.isVisible(q)&&E.isVisible(u)))return!1;if(h.isEdgeGroupHidden())return!1}else for(var x=h._parent;x&&!x.ISubGraph;){if(Qb(x)&&(!x.isExpanded()||!E.isVisible(x)))return!1;x=x._parent}if(h._parent instanceof rs&&!E.isVisible(h._parent))return!1;if(h._refGraph instanceof Ri&&!E.isVisible(h._refGraph))return!1;if(E instanceof Qn){if(!h.s("3d.visible"))return!1}else{var O=E.getLayersInfo();if(O){var B=O[h._layer];if(B&&B.visible===!1)return!1}if(!h.s("2d.visible"))return!1}return E._visibleFunc?E._visibleFunc(h):!0},M.handleSelectionChange=function(R){var b=this;R.datas.each(function(X){b.invalidateData(X);var m=X._parent;Qb(m)&&be(X)&&X.s($d)&&(b.invalidateData(m),m._49I&&m._49I.each(function(V){b.invalidateData(V)}))}),b.onSelectionChanged(R)},M.onSelectionChanged=function(m){var e=this,c=e.sm();if(1===c.size()&&("set"===m.kind||"append"===m.kind)){var q=c.ld();e.isAutoMakeVisible()&&e.makeVisible(q),e.adjustIndex&&e._dataModel.isAutoAdjustIndex()&&e.adjustIndex(q)}},M.makeVisible=function(n){if(n){var V=this,r=V.getDataUI?V.getDataUI(n):V.getData3dUI(n);if(r){var M=n,j=sm(n);for(j!==V._currentSubGraph&&V.setCurrentSubGraph(j);(M=M._parent)&&M!==j;)Qb(M)&&M.setExpanded(!0);V._23I=n,V.iv()}}},M.getLabel=function(W){var Z=W.getStyle(Mi);return Z===_?W.getName():Z},M.getLabelBackground=function(o){return o.getStyle("label.background")},M.getLabelColor=function(e){return e.getStyle("label.color")},M.getLabel2=function(C){return C.getStyle("label2")},M.getLabel2Background=function(M){return M.getStyle("label2.background")},M.getLabel2Color=function(r){return r.getStyle("label2.color")},M.getNote=function(X){return X.getStyle(Jm)},M.getNoteBackground=function(l){return l.getStyle("note.background")},M.getNote2=function(t){return t.getStyle(Eq)},M.getNote2Background=function(X){return X.getStyle("note2.background")},M.handleClick=function(S,c,f){var s=this;c?(s.fi({kind:"clickData",event:S,data:c,part:f}),s.onDataClicked(c,S)):(s.fi({kind:"clickBackground",event:S}),s.onBackgroundClicked(S))},M.handleDoubleClick=function(t,V,g){var Z=this;Ab(t)&&(V?(Z.fi({kind:"doubleClickData",event:t,data:V,part:g}),Z.onDataDoubleClicked(V,t,g),Z.checkDoubleClickOnNote(t,V,g)||Z.checkDoubleClickOnRotation&&Z.checkDoubleClickOnRotation(t,V,g)||(Cm(V)?Z.onEdgeDoubleClicked(V,t,g):V.ISubGraph?Z.onSubGraphDoubleClicked(V,t,g):Qb(V)?Z.onGroupDoubleClicked(V,t,g):V.IDoorWindow?Z.onDoorWindowDoubleClicked(V,t,g):V.ICSGBox&&Z.onCSGBoxDoubleClicked(V,t,g))):(Z.fi({kind:"doubleClickBackground",event:t}),Z.onBackgroundDoubleClicked(t)))},M.onSubGraphDoubleClicked=function(d){this.setCurrentSubGraph(d)},M.onEdgeDoubleClicked=function(F,J){this.isEditable(F)||(F.ISubGraph&&!Ef(J)?this.setCurrentSubGraph(F):F.s("edge.toggleable")&&F.toggle())},M._39Q=function(o){return this.isInteractive(o)?this.preventDefaultWhenInteractive(o):!1},M.preventDefaultWhenInteractive=function($){return $.s("preventDefaultWhenInteractive")},M.onGroupDoubleClicked=function(f){f.s("group.toggleable")&&f.toggle()},M.onDoorWindowDoubleClicked=function(W){W.s("dw.toggleable")&&W.toggle(!0)},M.onCSGBoxDoubleClicked=function(X,O){var u=this;if(u instanceof Qn){var C=u.intersectObject(O,X);C&&X.s(C.part+".toggleable")&&X.toggleFace(C.part,!0)}},M.onBackgroundClicked=function(){},M.onBackgroundDoubleClicked=function(){this.upSubGraph()},M.onDataClicked=function(){},M.onDataDoubleClicked=function(){},M.onAutoLayoutEnded=function(){},M.onMoveEnded=function(){},M.onPanEnded=function(){},M.onPinchEnded=function(){},M.onRectSelectEnded=function(){},M.onZoomEnded=function(){},M.serialize=function(b){return this.dm().serialize(b)},M.toJSON=function(){return this.dm().toJSON()},M.deserialize=function(W,n){var J=this;n=n instanceof Lq?{rootParent:n}:yb(n)?{setId:n}:ne(n)?{finishFunc:n}:n||{},n.view=J;var m=J.dm();return n.__innerHandler__=function(w){if(yb(m.a("toolTipEnable"))&&(m.a("toolTipEnable")?J.enableToolTip():J.disableToolTip()),J instanceof V.graph.GraphView&&(yb(m.a("zoomable"))&&J.setZoomable&&J.setZoomable(m.a("zoomable")),yb(m.a("pannable"))&&J.setPannable&&J.setPannable(m.a("pannable")),yb(m.a("rectSelectable"))&&J.setRectSelectable&&J.setRectSelectable(m.a("rectSelectable")),m.a("fitContent")===!0&&J.fitContent&&J.fitContent(!0,0)),J instanceof V.graph3d.Graph3dView){var e=w.scene;e&&e.shadow!=F&&J.shadowMap.setShadow(e.shadow,e.shadowParams);var g=m.a("sceneContext");g?(g.eye&&J.setEye(g.eye),g.center&&J.setCenter(g.center),kd(g.far)&&J.setFar(g.far),kd(g.near)&&J.setNear(g.near)):(kd(m.a("sceneNear"))&&J.setNear(m.a("sceneNear")),kd(m.a("sceneFar"))&&J.setFar(m.a("sceneFar")),e&&(e.eye&&J.setEye(e.eye),e.center&&J.setCenter(e.center))),yb(m.a("sceneShadowEnabled"))&&(m.a("sceneShadowEnabled")?J.enableShadow():J.disableShadow()),kd(m.a("sceneShadowDegreeX"))&&J.setShadowDegreeX(m.a("sceneShadowDegreeX")),kd(m.a("sceneShadowDegreeZ"))&&J.setShadowDegreeZ(m.a("sceneShadowDegreeZ")),kd(m.a("sceneShadowIntensity"))&&J.setShadowIntensity(m.a("sceneShadowIntensity")),m.a("sceneShadowQuality")!=F&&J.setShadowQuality(m.a("sceneShadowQuality")),m.a("sceneShadowType")&&J.setShadowType(m.a("sceneShadowType")),kd(m.a("sceneShadowRadius"))&&J.setShadowRadius(m.a("sceneShadowRadius")),kd(m.a("sceneShadowBias"))&&J.setShadowBias(m.a("sceneShadowBias")),yb(m.a("sceneDashEnable"))&&J.setDashDisabled(!m.a("sceneDashEnable")),zq(m.a("sceneHighlightMode"))&&J.setHighlightMode(m.a("sceneHighlightMode")),kd(m.a("sceneHighlightWidth"))&&J.setHighlightWidth(m.a("sceneHighlightWidth")),m.a("sceneHighlightColor")&&J.setHighlightColor(m.a("sceneHighlightColor")),m.a("sceneHighlightType")&&J.setHighlightType(m.a("sceneHighlightType")),m.a("sceneHighlightGlow")&&J.setHighlightGlow(m.a("sceneHighlightGlow")),m.a("sceneHighlightStrength")&&J.setHighlightStrength(m.a("sceneHighlightStrength")),yb(m.a("sceneHeadlightEnable"))&&J.setHeadlightDisabled(!m.a("sceneHeadlightEnable")),kd(m.a("sceneHeadlightRange"))&&J.setHeadlightRange(m.a("sceneHeadlightRange")),m.a("sceneHeadlightColor")&&J.setHeadlightColor(m.a("sceneHeadlightColor")),kd(m.a("sceneHeadlightIntensity"))&&J.setHeadlightIntensity(m.a("sceneHeadlightIntensity")),kd(m.a("sceneHeadlightAmbientIntensity"))&&J.setHeadlightAmbientIntensity(m.a("sceneHeadlightAmbientIntensity")),yb(m.a("sceneFogEnable"))&&J.setFogDisabled(!m.a("sceneFogEnable")),m.a("sceneFogMode")&&J.setFogMode(m.a("sceneFogMode")),kd(m.a("sceneFogDensity"))&&J.setFogDensity(m.a("sceneFogDensity")),m.a("sceneFogColor")&&J.setFogColor(m.a("sceneFogColor")),kd(m.a("sceneFogNear"))&&J.setFogNear(m.a("sceneFogNear")),kd(m.a("sceneFogFar"))&&J.setFogFar(m.a("sceneFogFar")),yb(m.a("sceneBatchBrightnessDisabled"))&&J.setBatchBrightnessDisabled(m.a("sceneBatchBrightnessDisabled")),yb(m.a("sceneBatchBlendDisabled"))&&J.setBatchBlendDisabled(m.a("sceneBatchBlendDisabled")),yb(m.a("sceneBatchColorDisabled"))&&J.setBatchColorDisabled(m.a("sceneBatchColorDisabled")),m.a("sceneBatchInfoMap")&&J.setBatchInfoMap(m.a("sceneBatchInfoMap")),kd(m.a("sceneMoveStep"))&&J.setMoveStep(m.a("sceneMoveStep")),kd(m.a("sceneRotateStep"))&&J.setRotateStep(m.a("sceneRotateStep")),yb(m.a("sceneSortable"))&&J.setSortable(m.a("sceneSortable")),ne(m.a("sceneSortFunc"))&&J.setSortFunc(m.a("sceneSortFunc"));var A=m.a("sceneSkyboxType")||"sphere";if(A!=F){var $={},s=!1;if("sphere"===A){$.shape3d=A;var z=m.a("sceneSkyboxImage");z&&($["shape3d.image"]=z,s=!0)
}else $.shape3d=_,["front","back","left","right","top","bottom"].forEach(function(t){var S=t+".image",A=t.charAt(0).toUpperCase()+t.slice(1),R=m.a("sceneSkybox"+A+"Image");R&&($[S]=R,s=!0)});if(s){var q=new Yj,o=m.a("sceneSkyboxDiameter");kd(o)?q.s3(o,o,o):q.s3(20,20,20),$["body.color"]=m.a("sceneSkyboxBodyColor"),$.envmap=m.a("sceneSkyboxEnvmap"),$.light=!1,$["texture.wrap"]="clampToEdge",q.s($),["X","Y","Z"].forEach(function(C){var p=m.a("sceneSkyboxRotation"+C);kd(p)&&q["setRotation"+C](p)}),J.setSkybox(q)}}}},m.deserialize(W,n.rootParent,n)},M.isDebugTipShowing=function(){return!!this._debugDiv},M.showDebugTip=function(){var k=this,P=k._debugDiv;if(!P){P=k._debugDiv=v.createElement("div"),P.style.position="absolute",P.style.overflow="hidden",P.style.font=C.debugTipLabelFont,P.style.padding="6px",P.style.backgroundColor=C.debugTipBackground,P.style.color=C.debugTipLabelColor;var A=k.getView();k._79O?A.insertBefore(P,k._79O):A.appendChild(P);var I=function(){k.redraw();var f=k._canvas,E="FPS: "+k._fpsInfo.fps+"<br/>"+"Datas: "+k.dm().getDatas().length+(f?"<br/>Size: "+f.width+" * "+f.height:""),l=k.dm()._historyManager;l&&(E+="<br/>Undoes: "+l.getHistories().length+" index: "+l.getHistoryIndex());var O=k.getDebugTip();O&&(E+="<hr>"+O),P.innerHTML=E,k._isDebugging&&requestAnimationFrame(I)};requestAnimationFrame(I),k._isDebugging=!0}},M.hideDebugTip=function(){var j=this,R=j._debugDiv;R&&(delete j._debugDiv,j.getView().removeChild(R),j._isDebugging=!1)},M.updateDOMAppendMatrix=function(){var a=this.getView();a&&(a.updateAppendMatrix=!0)},M.countFrame=function(){if(this._isDebugging){var O=Date.now(),G=this._fpsInfo;O-G.time>1e3?(G.fps=Math.round(1e5*(G.frames+1)/(O-G.time))/100,G.time=O,G.frames=0):G.frames++}}},ms_icons:function(K){K.getRotation=function(h){return h==F?0:h},K._15O=function(){var k=this,o=k.s(me);if(o){var W=k,j=k.data||k._data,O=k._38o={icons:o,rects:{}};for(var G in o){var T=o[G],L=cs(T.shape3d,j,W);if(!(cs(T.visible,j,W)===!1||cs(T.for3d,j,W)&&!k.I3d||L&&!k.I3d)){var X=L?[L]:cs(T.names,j,W),d=X?X.length:0,s=cs(T.position,j,W)||3,m=cs(T.offsetX,j,W)||0,K=cs(T.offsetY,j,W)||0,h=cs(T.direction,j,W)||Df,y=cs(T.gap,j,W),e=y!=F?y:1,A=cs(T.rotation,j,W),t=cs(T.keepOrien,j,W),B=cs(T.rotationFixed,j,W)?A:k.getRotation(A,t,s),Z=F,a=O.rects[G]=new Array(d);a.rotation=B;for(var z=0;d>z;z++){var V,f,i,Q,U=X[z];if(L)i=0,Q=0;else{var N=ij(U);i=cs(T.width,j,W),Q=cs(T.height,j,W),i==F&&(i=ob(N,j)),Q==F&&(Q=$n(N,j))}if(Z?h===Df?m+=i/2:h===Nd?m-=i/2:h===Le?K-=Q/2:K+=Q/2:Z={width:i,height:Q},k.I3d){var l=-i/2,Y=-Q/2;f={width:i,height:Q,mat:k._16O(cs(T.autorotate,j,W),s,Z,cs(T.face,j,W)||Br,cs(T.t3,j,W),cs(T.r3,j,W),cs(T.rotationMode,j,W),m,K),vs:new ad([l,-Y,0,l,-Y-Q,0,l+i,-Y-Q,0,l+i,-Y,0])}}else V=k.getPosition(s,m,K,Z,cs(T.positionFixed,j,W)),f={x:V.x-i/2,y:V.y-Q/2,width:i,height:Q},k._68o(f,B);a[z]=f,h===Df?m+=i/2+e:h===Nd?m-=i/2+e:h===Le?K-=Q/2+e:K+=Q/2+e}}}}}}});var vm={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Rd={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Am={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},sk={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},dn={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},An={"edge.type":1,"edge.group":1},Kd={rotation:1,rotationX:1,rotationZ:1},bd={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},Ar={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Al={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},ks={shape:1,thickness:1,position:1,anchor:1,scale:1},sm=function(v){if(!v)return F;if(Cm(v)){var S=v._40I,Z=v._41I;if(!S||!Z)return F;var U=sm(S),n=sm(Z);return U===n?U:F}for(var N=v._parent;Cm(N)&&!N.ISubGraph;)N=N._parent;return N?N.ISubGraph?N:sm(N):F},sr=function(P,v,G,s){var x=v.getStyle(G)*s;x&&ps(P,x),x=v.getStyle(G+".left")*s,x&&(P.x-=x,P.width+=x),x=v.getStyle(G+".right")*s,x&&(P.width+=x),x=v.getStyle(G+".top")*s,x&&(P.y-=x,P.height+=x),x=v.getStyle(G+".bottom")*s,x&&(P.height+=x),P.width<0&&(P.width=-P.width,P.x-=P.width),P.height<0&&(P.height=-P.height,P.y-=P.height)},rq=function(V){for(var i,N=0,M=V.size();M>N;N++)if(i=V.getChildAt(N),be(i)&&rq(i))return!0;return V.hasAgentEdges()},Lk=function(d){if(!d)return F;for(var k=d._parent;Qb(k);){if(!Qb(k._parent))return k.isExpanded()?d:k;k.isExpanded()||(d=k),k=k._parent}return d},wo=function(h,W){if(!h||!W)return F;var m,y,s,u=sm(h),k=sm(W);if(u!==k){for(;k&&u!==k;)k=sm(k);if(u===k)return h;m=new _n,m.add(h,0);for(var r=h._parent;be(r)&&!W.isDescendantOf(r);)m.add(r,0),r=r._parent;for(s=m.size(),y=0;s>y;y++){var L=m.get(y);if(Qb(L)&&!L.isExpanded())return L;if(L.ISubGraph)return L}return h}return h},hr=function(V){if(V.isLooped())return V._source;var g=Lk(V._source),o=Lk(V._target);return g===o?V._source:wo(g,o)},qq=function(r){if(r.isLooped())return r._target;var Y=Lk(r._source),p=Lk(r._target);return Y===p?r._target:wo(p,Y)},Lg=function(_,y,M){"target"!==M&&(M="source");var L="target"===M?y.getTargetAgent():y.getSourceAgent(),S="edge."+M+".";if(Cm(L)){var J=_.getDataUI(L);J._79o();var s=y.s(S+"index");if(s>=0){var c=Xe(J);return c[Math.max(0,Math.min(s,c.length-1))]}var T=y.s(S+"percent")||0;T=Math.max(0,Math.min(T,1));var W=ih(J);return jh(W,100*T)}return Hl(_,L,y.s(S+"position"),y.s(S+"offset.x"),y.s(S+"offset.y"),y.s(S+"anchor.x"),y.s(S+"anchor.y"))},Hl=function(k,I,Y,R,x,D,K){if(!I)return F;var v,U=I.getRotation?I.getRotation():0;if(D!==_||K!==_){D=D===_?.5:D,K=K===_?.5:K;var O=I.getScale();if(U&&!pf(I,k)||O.x<0||O.y<0){var t=I.getPosition(),r=I.getWidth(),T=I.getHeight(),m=I.getAnchor(),X=new Ai(U,t.x,t.y,O.x,O.y);Y=X.tf((D-m.x)*r,(K-m.y)*T)}else v=Yc(k,I),Y={x:v.x+D*v.width,y:v.y+K*v.height}}else Y=Vf(Y,Yc(k,I));if(U){var B=L(U),i=u(U),e=R*B-x*i;x=R*i+x*B,R=e}return Y.x+=R,Y.y+=x,Y},ec=function(A,n){if(!A||!n)return F;var z,$,R,g,M,T;if(A===n){if(g=A.getLoopedEdges(),!g)return F;g=new _n(g)}else{if(M=A.getAgentEdges(),T=n.getAgentEdges(),!M||!T)return F;for($=M.size(),z=0;$>z;z++)R=M.get(z),T.contains(R)&&(g||(g=new _n),g.add(R))}if(g)for(z=0;z<g.size();z++)R=g.get(z),R.getStyle(ss)===Gf&&(R._22I(F),g.removeAt(z),z--);return g},Ml=function(e,j){var u=ec(e,j);if(u&&!u.isEmpty()){if(1===u.size())return u.get(0)._22I(F),void 0;var L=new _n,f=new _n;u.each(function(z){var H=z.s("edge.group");L.contains(H)||L.add(H)}),L.sort(),L.each(function(E){f.add(new V.EdgeGroup(u.toList(function(H){return E===H.s("edge.group")}),f))}),f.each(function(s){s.each(function(Q){Q._22I(s)})})}},Bp=function(C,V,x){var a=C._canvas;C._zoom;var r=hl(V,a),z=hl(x,a);return{x:r.x-z.x,y:r.y-z.y}},Sf=function(l,b){if(b){var p=b.rect,x=b.color,W=b.rotation,t=b.labelWidth,B=b.background,f=b.opacity,A=b.scale,M=A!=F&&1!==A;if(f!=F){var r=l.globalAlpha;l.globalAlpha*=f}if(W||M){l.save();var D=p.x+p.width/2,i=p.y+p.height/2;zg(l,D,i),W&&_g(l,W),M&&l.scale(A,A),zg(l,-D,-i)}if(B&&Qm(l,p.x,p.y,p.width,p.height,B),t){var H=p.width,N=l.createLinearGradient(p.x,p.y,p.x+H,p.y);N.addColorStop(0,x),N.addColorStop(.9,x),N.addColorStop(1,vg),x=N,p.width=t}yc(l,b.ss,p,b.font,x,b.align),t&&(p.width=H),(W||M)&&l.restore(),f!=F&&(l.globalAlpha=r)}},Sl=function(y,Q){if(Q){var f=Q.rect,R=f.x,h=f.y,q=f.width,D=f.height,d=Q.background,b=Q.backgroundImage,w=Q.borderWidth,$=Q.borderColor,S=Q.labelWidth,l=Q.opacity,X=Q.scale,k=X!=F&&1!==X;if(l!=F){var U=y.globalAlpha;y.globalAlpha*=l}if(k){y.save();var H=f.x+f.width/2,i=f.y+f.height/2;zg(y,H,i),y.scale(X,X),zg(y,-H,-i)}if(Q.expanded){var P=B(8,q/4),A=h+D-8;if(y.fillStyle=d,y.beginPath(),y.moveTo(R,h),y.lineTo(R,A),y.lineTo(R+q/2,A),y.lineTo(R+q/2,h+D),y.lineTo(R+q/2+P,A),y.lineTo(R+q,A),y.lineTo(R+q,h),y.closePath(),y.fill(),w&&(y.lineWidth=w,y.lineJoin="round",y.lineCap="round",$?(y.strokeStyle=$,y.stroke()):(y.strokeStyle=jn(d),y.beginPath(),y.moveTo(R+q,h),y.lineTo(R+q,A),y.lineTo(R+q/2+P,A),y.lineTo(R+q/2,h+D),y.stroke(),y.strokeStyle=zl(d),y.beginPath(),y.moveTo(R+q,h),y.lineTo(R,h),y.lineTo(R,A),y.lineTo(R+q/2,A),y.lineTo(R+q/2,h+D),y.stroke())),b)qs(y,ij(b),sq,f.x,f.y,f.width,f.height-8,Q.data,Q.view);else{if(f.height-=8,d=Q.color,S){var c=q,p=y.createLinearGradient(R,h,R+c,h);p.addColorStop(0,d),p.addColorStop(.9,d),p.addColorStop(1,vg),d=p,f.width=S}yc(y,Q.ss,f,Q.font,d,Q.align),S&&(f.width=c),f.height+=8}}else if(Q.icon)Fp(y,ij(Q.icon),R,h,q,D,Q.data,Q.view);else{var M=q/2;w&&(y.lineWidth=w,y.lineJoin="round",y.lineCap="round",y.strokeStyle=$?$:jn(d),y.beginPath(),y.arc(R+M,h+M,M,$k,1.6*Y,!0),y.moveTo(R+M,h+D),y.lineTo(R+q-M/5,h+M),y.stroke(),y.strokeStyle=$?$:zl(d),y.beginPath(),y.arc(R+M,h+M,M,1.6*Y,$k,!0),y.moveTo(R+M,h+D),y.lineTo(R+M/5,h+M),y.stroke()),y.fillStyle=d,y.beginPath(),y.arc(R+M,h+M,M,0,E,!0),y.moveTo(R+M,h+D),y.lineTo(R+q-M/5,h+M),y.lineTo(R+M/5,h+M),y.closePath(),y.fill(),y.fillStyle=Q.color,y.beginPath(),y.arc(R+M,h+M,M/3,0,E,!0),y.fill()}k&&y.restore(),l!=F&&(y.globalAlpha=U)}},Yr=function(k,S){return S>2*k?k:S/2},po=function(V,D,v,A){if(!V||!D)return 0;var f=ub(D.y-V.y,D.x-V.x);return v||(f=D.x<V.x?f+Y:f),f+A},Xj=function(P,G,u,s,m,J,y){y&&(P.x>G.x||P.x===G.x&&P.y>G.y)&&(u=xh[u],m=-m);var g=Vf(u,{x:0,y:0,width:kj(P,G),height:0},J);return g.x+=s,g.y+=m,g=new Ai(ub(G.y-P.y,G.x-P.x)).tf(g),g.x+=P.x,g.y+=P.y,g},Ki=function(n,p,i,c,r){if(n._19Q=!0,!i.getEdgeGroup())return c?i.s("edge.gap"):0;if(Cm(i.getSourceAgent())||Cm(i.getTargetAgent()))return 0;var L,y=0,Q=0,S=0;if(i.getEdgeGroup().getSiblings().each(function(Y){Y.each(function(q){if(p.isVisible(q)&&q.s(ss)==r){var U=q.s("edge.gap");L?(Q+=S/2+U/2,S=U):(L=q,S=U),q===i&&(y=Q)}})}),c)return Q-y+S;var v=y-Q/2;return L&&i._40I!==L._40I&&(n._19Q=!1),v},_i=function(C){var f=C._getValidSelection();if(1===f.length){var A=f[0],J=A instanceof V.Edge;if(A instanceof V.Shape||J){if(J){var h=A.s("edge.type");if(h&&"points"!==h)return}var k=C.gv;if((!k.isPointEditable||k.isPointEditable(A))&&k.isEditable(A))return A}}},kf=function(){var k=function(W){var Z=[];return W.forEach(function(w){Z.push({x:w.x,y:w.y}),Z.push({x:w.x+w.width,y:w.y+w.height}),Z.push({x:w.x+w.width,y:w.y}),Z.push({x:w.x,y:w.y+w.height})}),Z};return function(M,y,T){if("oval"===M){var i=0,w=T.height/T.width,x=w*w,N=T.x+T.width/2,b=T.y+T.height/2,d=k(y);d.forEach(function(h){var I=h.x-N,U=h.y-b,a=I*I+U*U/x;a>i&&(i=a)}),i=A(i);var z=w*i;return{x:N-i,y:b-z,width:2*i,height:2*z}}if("circle"===M){var p=0,N=T.x+T.width/2,b=T.y+T.height/2,d=k(y);return d.forEach(function(c){var r=c.x-N,$=c.y-b,d=r*r+$*$;d>p&&(p=d)}),p=A(p),{x:N-p,y:b-p,width:2*p,height:2*p}}return"roundRect"===M?(ps(T,B(T.width,T.height)/16),T):T}}(),Rp=V.graph={},qj=function(u,k,N){cd(X+".graph."+u,k,N)};V.layout={};var Cf={},zd=function(j,u,B,v,m,O,g,D){var S=g._zoom;if(S!==g._cacheZoom&&(g._cacheZoom=S,g._cacheImage={}),S*=nj,v=Math.ceil(v*S),m=Math.ceil(m*S),v>2048||m>2048)return u;var L=[u.uuid,v,m,B].join("_");u.cacheRule&&(L+="_"+cs(u.cacheRule,O,g));var d=g._cacheImage[L];return d||(ap(),d=V.Default.toCanvas(u,v,m,B,O,g,D),vj()&&(g._cacheImage[L]=d)),d};Xf(C,{setImageCacheRule:function($,K){var v;K||"object"!=typeof $?(v={},v[$]=K):v=$;for(var u in v){var I=v[u];zq(u)?(cd=ij(u),cd?cd.cacheRule=I:Cf[u]=I):u.cacheRule=I}}});var xo={comps:[{type:eg,points:[85,50,70,115,100,71,86,107,88,49,57,105,68,43,79,119,69,50,47,115,116,85,67,109,54,105,101,65,88,73,76,83,69,101,104,105,113,74,99,67,98,113,119,61],borderWidth:1,borderColor:F}]};if(xo[ye]=xo[je]=160,b.Image){var es=new b.Image;es.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Se("default_blank",es)}Se("node_image",$m(30,30,[{type:pi,rect:[4,5,22,16],gradient:te,gradientColor:Om,background:Bd},{type:pi,rect:[2,3,26,20],borderWidth:1,borderColor:Bd},{type:pi,rect:[11,23,8,4],background:Bd},{type:pi,rect:[6,27,18,2],background:Bd}])),Se("node_icon",$m(16,16,[{type:pi,rect:[2,2,12,10],gradient:te,gradientColor:Om,background:Bd},{type:ii,rect:[2,2,12,10],width:1,color:Bd},{type:pi,rect:[6,12,4,2],background:Bd},{type:pi,rect:[4,14,8,1],background:Bd}])),Se("block_icon",$m(16,16,[{type:ii,rect:[1,1,14,14],width:1,color:Bd}])),Se("group_image",$m(66,39,[{type:pi,rect:[44.3,18,18.1,12.8],gradient:te,gradientColor:Om,background:Bd},{type:pi,rect:[3.3,17.8,18.1,12.8],gradient:te,gradientColor:Om,background:Bd},{type:pi,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Bd,gradient:te,gradientColor:Om,background:Bd},{type:pi,rect:[26.2,29.4,12.8,4.2],background:Bd},{type:pi,rect:[21.3,33.5,22.5,2.3],background:Bd},{type:pi,rect:[5.3,32.7,14.1,2.1],background:Bd},{type:pi,rect:[9,30.4,6.7,2.4],background:Bd},{type:pi,rect:[50,30.7,6.7,2.4],background:Bd},{type:pi,rect:[46.3,33,14.1,2.1],background:Bd}])),Se("group_icon",$m(16,16,[{type:pi,rect:[4,12,4,2],background:Bd},{type:pi,rect:[2,13,8,1],background:Bd},{type:pi,rect:[12,12,2,1],background:Bd},{type:pi,rect:[11,13,4,1],background:Bd},{type:pi,rect:[10,7,6,5],gradient:te,gradientColor:Om,background:Bd},{type:pi,rect:[1,2,10,10],gradient:te,gradientColor:Om,background:Bd},{type:ii,rect:[1,2,10,10],width:1,color:Bd}])),Se("refGraph_icon",$m(16,16,[{type:"shape",borderWidth:1,borderColor:Bd,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Bd,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Se("edge_icon",$m(16,16,[{type:pi,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:te,gradientColor:Om,background:Bd},{type:pi,rect:[10.8,1,4,4],background:Bd},{type:pi,rect:[1,11,4,4],background:Bd}])),Se("subGraph_image",$m(72,45,[{type:eg,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:te,gradientColor:Om,background:Bd},{type:pi,rect:[29.6,30.7,3.6,1.8],background:Bd},{type:pi,rect:[28.4,32.3,6,1.2],background:Bd},{type:pi,rect:[37.3,32,10.8,1.8],background:Bd},{type:pi,rect:[39.1,29.9,7.2,2.3],background:Bd},{type:pi,rect:[26.6,23.7,9.6,7.2],gradient:te,gradientColor:Om,background:Bd},{type:pi,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Bd,gradient:te,gradientColor:Om,background:Bd}])),Se("subGraph_icon",$m(17,17,[{type:eg,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:te,gradientColor:Om,background:Bd}])),Se("shape_icon",$m(16,16,[{type:eg,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Bd}])),Se("polyline_icon",$m(16,16,[{type:eg,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Bd},Qk(7.5,.4),Qk(7.5,6.3),Qk(13.6,6.3),Qk(13.6,14),Qk(.7,13.9),Qk(.7,.3)])),Se("grid_icon",$m(16,16,[{type:pi,rect:[1,1,4,4],background:Bd,gradient:te,gradientColor:Om},{type:pi,rect:[6,1,4,4],background:Bd,gradient:te,gradientColor:Om},{type:pi,rect:[11,1,4,4],background:Bd,gradient:te,gradientColor:Om},{type:pi,rect:[11,6,4,4],background:Bd,gradient:te,gradientColor:Om},{type:pi,rect:[6,6,4,4],background:Bd,gradient:te,gradientColor:Om},{type:pi,rect:[1,6,4,4],background:Bd,gradient:te,gradientColor:Om},{type:pi,rect:[11,11,4,4],background:Bd,gradient:te,gradientColor:Om},{type:pi,rect:[6,11,4,4],background:Bd,gradient:te,gradientColor:Om},{type:pi,rect:[1,11,4,4],background:Bd,gradient:te,gradientColor:Om}])),Se("light_icon",$m(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Bd},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Bd,gradient:te,gradientColor:Om,background:{func:function(g){var f=g?g.s(Ae):F;return mh(f)?"rgb("+Pq(255*f[0])+","+Pq(255*f[1])+","+Pq(255*f[2])+")":f||Bd}}}])),Se("text_icon",$m(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Bd}])),Se("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Se("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Se("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Se("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Yg=function(f,Y,D,l,u,m){var i,x,F,C,M,Q,H,P,$,d,R,e=[];if(Math.abs(l)>2*Math.PI&&(l=2*Math.PI),M=Math.ceil(Math.abs(l)/(Math.PI/4)),i=l/M,x=-i,F=-D,M>0){Q=f+Math.cos(D)*u,H=Y+Math.sin(-D)*m,e.push({x:Q,y:H});for(var v=0;M>v;v++)F+=x,C=F-x/2,P=f+Math.cos(F)*u,$=Y+Math.sin(F)*m,d=f+Math.cos(C)*(u/Math.cos(x/2)),R=Y+Math.sin(C)*(m/Math.cos(x/2)),e.push({x:d,y:R}),e.push({x:P,y:$})}return e},Pe=function($){if($){var m=$._data;if(m instanceof V.Shape)return{points:m.getPoints(),segments:m.getSegments()};var O;if(m instanceof V.Edge&&(O=$._78o)){var y,N,n=O.type,e=O.points,f=O.segments,U=O.edgeTypeInfo;if(!n||e){var M=O.sourcePoint,r=M.x,x=M.y,j=O.targetPoint,I=j.x,G=j.y;if(n)f?(y=new _n({x:r,y:x}),y.addAll(e),y.add({x:I,y:G}),N=new _n(f._as)):(y=new _n({x:r,y:x}),e.each(function(T){y.add(T)}),y.add({x:I,y:G}));else if(O.looped){y=new _n(Yg(r,x,0,2*Math.PI,O.radius,O.radius)),N=new _n([1]);for(var g=0;g<(y.size()-1)/2;g++)N.add(3)}else y=new _n,O.center?(y.add({x:O.c1.x,y:O.c1.y}),y.add({x:r,y:x}),y.add({x:I,y:G}),y.add({x:O.c2.x,y:O.c2.y})):(y.add({x:r,y:x}),y.add({x:I,y:G}))}else U&&(y=new _n(U.points._as),U.segments&&(N=new _n(U.segments._as)));return{points:y,segments:N}}}},ih=function(i,o,T){if(null==o){var O=Pe(i);if(!O)return;o=O.points,T=O.segments}if(o){if(Array.isArray(o)&&(o=new _n(o)),"number"==typeof o.get(0)){for(var h=new V.List,r=0;r<o.size();r+=2)h.add({x:o.get(r),y:o.get(r+1)});o=h}if(!T){T=[1];for(var N=o.length-1;N>0;N--)T.push(2)}Array.isArray(T)&&(T=new _n(T));for(var L=tg(o._as,T._as,50),b=L.length,s=[],r=0;b>r;r++){var G=L[r];G.length>1&&s.push(G)}return s}},rb=function(C){for(var u=0,M=C.length-1,U=0;M>U;U++){var p=C[U],f=C[U+1],v=f.x-p.x,G=f.y-p.y;u+=Math.sqrt(v*v+G*G)}return u},xf=function(g,n){for(var A=0,y=n.length,$=0;y>$;$++){var v=n[$];if(A+=v,A>g)return $}return Math.min($,y-1)},nl=function(e,L){for(var R=0,H=0,l=0,Q=e.length-1,W=0;Q>W;W++){var a=e[W],_=e[W+1],x=_.x-a.x,X=_.y-a.y;if(l=Math.sqrt(x*x+X*X),R+=l,R>L){R-=l,H=W;break}}var m=e[H],t=e[H+1],G=Math.atan2(t.y-m.y,t.x-m.x),U=L-R,X=Math.sin(G)*U,x=Math.cos(G)*U;return{x:m.x+x,y:m.y+X}},jh=function(t,I){if(t){var u;if(0===I)u=t[0][0];else if(100===I)t=t[t.length-1],u=t[t.length-1];else{for(var Y=0,T=[],i=t.length,B=0;i>B;B++){var $=t[B],H=rb($);Y+=H,T.push(H)}for(var Z=Y*I/100,j=xf(Z,T),G=0,n=0;j>n;n++)G+=T[n];Z-=G,u=nl(t[j],Z)}return u}},Xe=function(J){var G,h,v,f,W=Pe(J),g=[],q=W.points,x=W.segments,H=-1;for(h=0,v=x?x.length:q.length;v>h;h++){if(G=x?x.get(h):1,3===G)f=2;else if(4===G)f=3;else{if(5===G)continue;f=1}H+=f,g.push(q.get(H))}return g},Pb=function(z,a,P,U){function o(N){if(N>=0&&1>=N){O=a(N);var e=(z.x-O.x)*(z.x-O.x)+(z.y-O.y)*(z.y-O.y);return d>e?(d=e,k=N,!0):!1}}P=P||100,U=U||1e-5;for(var d=1/0,k=0,O=new Go,Q=0;P>Q;++Q)o(Q/P);for(var h=1/(2*P);h>U;)o(k-h)||o(k+h)||(h/=2);return k};Xf(C,{_edgeProtectMethod:{getStraightLinePoints:ih,calculateLineLength:rb,calcSegmentIndexByDistance:xf,calculatePointAlongLine:nl,getPercentPosition:jh,getRealPointsFromDataUI:Xe}});var cj=function(H,f){for(var y=H.vertices,g=0;g<y.length;g++){var O=y[g],s=O.y;O.y=O.z,O.z=-s,f&&(O.y+=f)}},Tk=function(o){for(var d,j,T,p,G,D,P=[],g=[],q=[],J=o.faces,R=0,w=0,t=0,m=J.length;m>R;R++,w+=6,t+=9){var s=J[R];1===s.i?(d||(d=[],j=[],T=[]),Ql(s,R,w,t,o,d,T,j)):2===s.i?(p||(p=[],G=[],D=[]),Ql(s,R,w,t,o,p,D,G)):Ql(s,R,w,t,o,P,q,g)}return{vs:P,uv:g,ns:q,top_vs:d,top_uv:j,top_ns:T,bottom_vs:p,bottom_uv:G,bottom_ns:D}},Ql=function(p,U,P,F,i,n,H,y){var J=i.vertices,m=i.faceVertexUvs,c=J[p.a],j=J[p.b],T=J[p.c];n.push(c.x,c.y,c.z,j.x,j.y,j.z,T.x,T.y,T.z);var r,e,q,A=p.vertexNormals;3===A.length?(r=A[0],e=A[1],q=A[2]):r=e=q=p.normal,H.push(r.x,r.y,r.z,e.x,e.y,e.z,q.x,q.y,q.z);var V=m[0][U][0],d=m[0][U][1],X=m[0][U][2];y.push(V.x,V.y,d.x,d.y,X.x,X.y)},Vq=function(){function b(F,M){return F.dot(M)>0}function a(w,r,z,J,M,c,U){for(var f,H,e=[r,z,J],y=[M,c,U],X=[],A=e.length,v=!0;A--&&v;){for(var m=e[A],o=y.length,k=!1;o--;)if(m.equals(y[o])){y.splice(o,1),X.push(m),k=!0;break}if(!k){if(f){v=!1;break}f=m}}return v&&2===X.length&&(H=y[0],F.subVectors(f,X[0]),q.subVectors(H,X[0]),S.subVectors(f,X[1]),F.x*S.y*q.z+S.x*q.y*F.z+q.x*F.y*S.z-q.x*S.y*F.z-q.y*S.z*F.x-q.z*S.x*F.y<1e-6&&(i.subVectors(H,X[1]),x.subVectors(X[1],X[0]),b(x,F)&&b(x,q)&&(x.negate(),b(x,S)&&b(x,i))))?(w.push(X[1].x,X[1].y,X[1].z),w.push(f.x,f.y,f.z),w.push(f.x,f.y,f.z),w.push(X[0].x,X[0].y,X[0].z),w.push(X[0].x,X[0].y,X[0].z),w.push(H.x,H.y,H.z),w.push(H.x,H.y,H.z),w.push(X[1].x,X[1].y,X[1].z),2):(w.push(r.x,r.y,r.z),w.push(z.x,z.y,z.z),w.push(z.x,z.y,z.z),w.push(J.x,J.y,J.z),w.push(J.x,J.y,J.z),w.push(r.x,r.y,r.z),1)}function h(){this._vertexMap={},this._lineMap={},this._lineList=[]}function E(G,R,q,o,f,x,S){var M=[q,f];G[0]===o&&M.reverse();var P=[M[0]._key,M[1]._key].join("|"),m=G._triangles[P];m||(G._triangles[P]=m={});var F=[x._key,S._key].join("|");m[F]||(m[F]=[x,S])}function V(a,v,K){var r=a._planes[K._key];if(!r)for(var N in a._planes){var Y=a._planes[N];if(Y._normal.angleTo(K)<.001){r=Y;break}}return r?(r._vertices.indexOf(v)<0&&r._vertices.push(v),void 0):(a._planes[K._key]={_normal:K,_vertices:[v]},void 0)}function e(C,c){return 0===c?"0|0|0":1/0===Math.abs(c)?[C.x,C.y,C.z].join("|"):[Math.round(J.angleTo(C)*c),Math.round(P.angleTo(C)*c),Math.round(I.angleTo(C)*c)].join("|")}function u(r,v){var d=r._ctlineModel;if(d||(r._ctlineModel=d=[]),d[0])return d[0];var A;A=mh(r)?r:[r];var H,j,h,S,Q,B,G,x,I,_,D,l,z,u,E,q,W,e,t,X=["","top_","bottom_"];d=[];var R=[];for(Cq(A,v,R),H=0,j=R.length;j>H;H++)if(_=R[H])for(Ji(_),h=0,S=X.length;S>h;h++)if(I=_[X[h]+"lvs"])for(W=d.length,e=I.length,d.length=W+e,t=0;e>t;++t,++W)d[W]=I[t];else if(G=_[X[h]+"vs"]){x=_[X[h]+"is"],B=x?x.length:G.length/3;for(var Q=0;B-1>Q;)x?(D=x[Q],l=x[Q+1],z=x[Q+2],u=x[Q+3],E=x[Q+4],q=x[Q+5]):(D=Q,l=Q+1,z=Q+2,u=Q+3,E=Q+4,q=Q+5),U.fromArray(G,3*D),L.fromArray(G,3*l),g.fromArray(G,3*z),s.fromArray(G,3*u),y.fromArray(G,3*E),o.fromArray(G,3*q),Q+=3*a(d,U,L,g,s,y,o);B>Q&&(x?(D=x[Q],l=x[Q+1],z=x[Q+2]):(D=Q,l=Q+1,z=Q+2),U.fromArray(G,3*D),L.fromArray(G,3*l),g.fromArray(G,3*z),d.push(U.x,U.y,U.z),d.push(L.x,L.y,L.z),d.push(L.x,L.y,L.z),d.push(g.x,g.y,g.z),d.push(g.x,g.y,g.z),d.push(U.x,U.y,U.z))}return r._ctlineModel[0]=d,d}function K(m,W,n){var e=m._ctlineModel;e||(m._ctlineModel=e=[]);var O=e[1];if(O&&O.epsilon===n)return O;O=[],O.epsilon=n;var s;s=mh(m)?m:[m];var o,K,$,X,g,D,V,y,l,t,w,S,c=["","top_","bottom_"],H=new h,U=[];for(Cq(s,W,U),o=0,K=U.length;K>o;o++)if(l=U[o])for(Ji(l),$=0,X=c.length;X>$;$++)if(V=l[c[$]+"vs"]){y=l[c[$]+"is"],D=y?y.length:V.length/3;for(var g=0,g=0;D>g;g+=3)y?(t=y[g],w=y[g+1],S=y[g+2]):(t=g,w=g+1,S=g+2),H._addTriangle(V,_,t,w,S,n)}return H._toLineVS(O),m._ctlineModel[1]=O,O}function M(F,b,y){var n=F._ctlineModel;n||(F._ctlineModel=n=[]);var q=n[2];if(q&&q.epsilon===y)return q;q=[],q.epsilon=y;var c;c=mh(F)?F:[F];var H,P,x,s,g,Y,L,T,t,m,G,R,Z,e=["","top_","bottom_"],p=new h,u=[];for(Cq(c,b,u),H=0,P=u.length;P>H;H++)if(m=u[H])for(Ji(m),x=0,s=e.length;s>x;x++)if(L=m[e[x]+"vs"]){T=m[e[x]+"is"],t=m[e[x]+"ns"],Y=T?T.length:L.length/3;for(var g=0,g=0;Y>g;g+=3)T?(G=T[g],R=T[g+1],Z=T[g+2]):(G=g,R=g+1,Z=g+2),p._addTriangle(L,t,G,R,Z,y)}return p._toLineVS(q),F._ctlineModel[2]=q,q}var U=new io,L=new io,g=new io,s=new io,y=new io,o=new io,F=new io,S=new io,q=new io,i=new io,x=new io,C=new io;h.prototype._findVertex=function(e,w){C.fromArray(e,3*w);var I=[C.x,C.y,C.z].join(","),h=this._vertexMap[I];if(!h){var R=C.clone();R._key=I,this._vertexMap[I]=h=R}return h},h.prototype._findLine=function(n,B){var v=[n,B];n._key>B._key&&v.reverse(),v._key=[v[0]._key,v[1]._key].join("|");var I=this._lineMap[v._key];return I||(this._lineMap[v._key]=I=v,v._triangles={},v._planes={},this._lineList.push(v)),I};var J=new io(1,0,0),P=new io(0,1,0),I=new io(0,0,1),H=new io,O=new io;return h.prototype._addTriangle=function(y,$,M,L,R,K){var b,P,T,G=this._findVertex(y,M),W=this._findVertex(y,L),f=this._findVertex(y,R),u=this._findLine(G,W),C=this._findLine(W,f),S=this._findLine(f,G);$?(b=(new io).fromArray($,3*M),b._key=e(b,K),P=(new io).fromArray($,3*L),P._key=e(P,K),T=(new io).fromArray($,3*R),T._key=e(T,K),E(u,G,b,W,P,f,T),E(C,W,P,f,T,G,b),E(S,f,T,G,b,W,P)):(O.subVectors(f,W),H.subVectors(W,G),b=(new io).crossVectors(H,O),b._key=e(b,K),V(u,f,b),V(C,G,b),V(S,W,b))},h.prototype._toLineVS=function(e){for(var $=this._lineList,p=0,G=$.length;G>p;++p){var H=$[p],Y=!1;for(var O in H._triangles)if(1==f.keys(H._triangles[O]).length){e.push(H[0].x,H[0].y,H[0].z,H[1].x,H[1].y,H[1].z),Y=!0;break}if(!Y)for(var P in H._planes)if(1==H._planes[P]._vertices.length){e.push(H[0].x,H[0].y,H[0].z,H[1].x,H[1].y,H[1].z),Y=!0;break}}},[u,K,M]}(),rj=function(Z,c){var x=Z._lineModel;if(x)return x;var A;A=mh(Z)?Z:[Z];var e,T,q,W,I,d,z,Q,f,i,G,F,X=["","top_","bottom_"];x=[];var h=[];for(Cq(Z,c,h),e=0,T=h.length;T>e;e++)if(f=h[e])for(q=0,W=X.length;W>q;q++)if(z=f[X[q]+"vs"]){Q=f[X[q]+"is"],d=Q?Q.length:z.length/3;for(var I=0;d>I;I+=3)Q?(i=Q[I],G=Q[I+1],F=Q[I+2]):(i=I,G=I+1,F=I+2),i*=3,G*=3,F*=3,x.push(z[i],z[i+1],z[i+2],z[G],z[G+1],z[G+2],z[G],z[G+1],z[G+2],z[F],z[F+1],z[F+2],z[F],z[F+1],z[F+2],z[i],z[i+1],z[i+2])}return Z._lineModel=x,x},Dk=function(o,E,t,O,A,j,M,s,y,T){t==F&&(t=!0),O==F&&(O=!0),M==F&&(M=1),s==F&&(s=0);var W=new ce;Mf(W,o,E,y),W=W.toShapes();var q=_;return T&&(T.length?q={minX:T[0],minY:T[1],maxX:T[2],maxY:T[3]}:(q={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},W.forEach(function(W){var L=W.getBoundingBox();q.minX=B(L.minX,q.minX),q.minY=B(L.minY,q.minY),q.maxX=i(L.maxX,q.maxX),q.maxY=i(L.maxY,q.maxY)}))),Tk(new dg(W,{top:t,bottom:O,curveSegments:A,amount:M,repeatUVLength:j,boundingBox:q},-M/2+s))},Or=function(H,t){this.repeatUVLength=H,this._bb=t};Or.prototype={generateTopUV:function(u,R,a,V,s,g,L){var j,h,Q,P,U=u.vertices,W=U[V].x,O=U[V].y,Y=U[s].x,y=U[s].y,o=U[g].x,$=U[g].y,t=this.repeatUVLength;if(t)j=0,h=0,Q=t,P=t;else{this._bb||(this._bb=R.getBoundingBox());var w=this._bb;j=w.minX,h=w.minY,Q=w.maxX-j,P=w.maxY-h}return L?[new Be((W-j)/Q,(O-h)/P),new Be((Y-j)/Q,(y-h)/P),new Be((o-j)/Q,($-h)/P)]:[new Be((W-j)/Q,1-(O-h)/P),new Be((Y-j)/Q,1-(y-h)/P),new Be((o-j)/Q,1-($-h)/P)]},generateBottomUV:function(h,_,J,P,V,p){return this.generateTopUV(h,_,J,P,V,p,!0)},generateSideWallUV:function(h,n,$,v,l,U,p,k,L,t,d,w){if(!this._cl){for(var S,c,P=[],B=0,C=$.length,Z=0;C>Z;Z++){S=$[Z],c=$[(Z+1)%C];var y=S.x-c.x,Q=S.y-c.y,E=A(y*y+Q*Q);P.push(B),B+=E}for(var Z=0;C>Z;Z++)P[Z]/=B;this._cl=P}var P=this._cl,o=1-L/t,m=1-(L+1)/t,s=P[d],q=P[w];return q>s&&(s+=1),[new Be(s,o),new Be(q,o),new Be(q,m),new Be(s,m)]}};var ve=function(w,T,F,a,S,h){this.a=w,this.b=T,this.c=F,this.i=h,this.normal=a instanceof pm?a:new pm,this.vertexNormals=a instanceof Array?a:[]};ve.prototype={constructor:ve};var yj=[-8,14,-4,8,2,9,5,6,-1],gf=function(){if(gf[im]!=F)return gf[im];for(var n=Jb[im],l=yj,v=Lq.prototype.getClassName(),K='"',d=0,Q="",D=!1,j=+new(b[v.substr(3,3)+ek[d]]),Z=d;Z<l.length;Z++){var w=l.length-Z;Q+=Z%2===d?l[Z]+w+"":l[Z]-w+""}for(var Z=d;4>Z;Z++)Q+=d;if(Q=Q*Q.length/Q.length,j>Q){if(n&&n[d]&&n[4/pi.length]){for(var B,G,i,N,A,m,$,Y,y=n[0],R=n[1],U="",o=0,Z=0;Z<R.length;Z++)R[Z]===K?Y?(Y=!1,0!==o%2&&(B==F?B=U:G==F?G=U:i==F?i=U:N==F?N=U:A==F?A=U:m==F?m=U:$==F&&($=U)),o++,U=""):Y=!0:Y&&(U+=R[Z]);for(var C,O,p,h="",E=0,Z=0;Z<y.length;Z++)y[Z]===K?C?(C=!1,0!==E%2&&(O==F?O=h:p==F&&(p=h)),E++,h=""):C=!0:C&&(h+=y[Z]);var t=B+G+i+N+A+m,H=!m||m===Lo;if(!H&&m)for(var r,Z=0,L=m.length;L>Z;Z++)m[Z]===tm[4]?r===Lo?H=Id:r[0]===bp[7]&&Lo&&Lo.indexOf(r.substr(1))>=0?H=Tj:r=F:(r==F?r=m[Z]:r+=m[Z],Z===L-1&&(r===Lo?H=Id:r[0]===bp[7]&&Lo&&Lo.indexOf(r.substr(1))>=0&&(H=Tj)));(D=Uh(t,$)&&Uh(O,p)&&O===B&&H&&(!A||A>j))&&i.indexOf(Wq[0])>=0&&(gf[Wq[0]]=1),D&&i.indexOf(1)>=0&&(gf[1]=1),D&&i.indexOf(3)>=0&&(gf[2]=1),D&&i.indexOf(4)>=0&&(gf[3]=1),D&&i.indexOf(7)>=0&&(gf[4]=1)}}else D=!0,gf[Wq[0]]=gf[1]=gf[2]=gf[3]=gf[4]=1;return gf[im]=D,D},hd=function(){},Em=hd.prototype;Em.getPointAt=function(b){var $=this.getUtoTmapping(b);return this.getPoint($)},Em.getPoints=function(e){e||(e=5);var N,K=[];for(N=0;e>=N;N++)K.push(this.getPoint(N/e));return K},Em.getSpacedPoints=function(E){E||(E=5);var b,J=[];for(b=0;E>=b;b++)J.push(this.getPointAt(b/E));return J},Em.getLength=function(){var V=this.getLengths();return V[V.length-1]},Em.getLengths=function(a){if(a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var P,_,u=[],J=this.getPoint(0),j=0;for(u.push(0),_=1;a>=_;_++)P=this.getPoint(_/a),j+=P.distanceTo(J),u.push(j),J=P;return this.cacheArcLengths=u,u},Em.getUtoTmapping=function(E,M){var e,T=this.getLengths(),H=0,k=T.length;e=M?M:E*T[k-1];for(var g,n=0,L=k-1;L>=n;)if(H=P(n+(L-n)/2),g=T[H]-e,0>g)n=H+1;else{if(!(g>0)){L=H;break}L=H-1}if(H=L,T[H]==e){var B=H/(k-1);return B}var Y=T[H],x=T[H+1],R=x-Y,l=(e-Y)/R,B=(H+l)/(k-1);return B},Em.getTangent=function(i){var s=1e-4,c=i-s,Y=i+s;0>c&&(c=0),Y>1&&(Y=1);var D=this.getPoint(c),H=this.getPoint(Y),k=H.clone().sub(D);return k.normalize()},Em.getTangentAt=function(E){var L=this.getUtoTmapping(E);return this.getTangent(L)},hd.create=function(F,V){return F.prototype=Hj(hd.prototype),F.prototype.getPoint=V,F};var cl=function(){this.curves=[],this.autoClose=!1},Lb=cl.prototype=Hj(Em);Lb.add=function(q){this.curves.push(q)},Lb.closePath=function(){var H=this.curves[0].getPoint(0),_=this.curves[this.curves.length-1].getPoint(1);H.equals(_)||this.curves.push(new ng(_,H))},Lb.getPoint=function(B){for(var T,w,M=B*this.getLength(),r=this.getCurveLengths(),I=0;I<r.length;){if(r[I]>=M){T=r[I]-M,w=this.curves[I];var U=1-T/w.getLength();return w.getPointAt(U)}I++}return null},Lb.getLength=function(){var V=this.getCurveLengths();return V[V.length-1]},Lb.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;
var I,l=[],f=0,X=this.curves.length;for(I=0;X>I;I++)f+=this.curves[I].getLength(),l.push(f);return this.cacheLengths=l,l},Lb.getTransformedPoints=function(j){return this.getPoints(j)},Lb.getBoundingBox=function(){var Q,p,c,D,s,h,q=this.getPoints();Q=p=Number.NEGATIVE_INFINITY,D=s=Number.POSITIVE_INFINITY;var $,K,x,w,m=q[0]instanceof pm;for(w=m?new pm:new Be,K=0,x=q.length;x>K;K++)$=q[K],$.x>Q&&(Q=$.x),$.x<D&&(D=$.x),$.y>p&&(p=$.y),$.y<s&&(s=$.y),m&&($.z>c&&(c=$.z),$.z<h&&(h=$.z)),w.add($);var N={minX:D,minY:s,maxX:Q,maxY:p};return m&&(N.maxZ=c,N.minZ=h),N};var tf=function(v){cl.call(this),this.actions=[],v&&this.fromPoints(v)},yk=tf.prototype=Hj(cl.prototype),sg="moveTo",cg="lineTo",hg="quadraticCurveTo",ni="bezierCurveTo",zk="arc",Xm="ellipse";yk.fromPoints=function(v){this.moveTo(v[0].x,v[0].y);for(var s=1,z=v.length;z>s;s++)this.lineTo(v[s].x,v[s].y)},yk.moveTo=function(){var T=Array.prototype.slice.call(arguments);this.actions.push({action:sg,args:T})},yk.lineTo=function(M,z){var t=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,o=i[i.length-2],q=i[i.length-1],e=new ng(new Be(o,q),new Be(M,z));this.curves.push(e),this.actions.push({action:cg,args:t})},yk.quadraticCurveTo=function($,I,x,U){var E=Array.prototype.slice.call(arguments),D=this.actions[this.actions.length-1].args,N=D[D.length-2],H=D[D.length-1],A=new Hk(new Be(N,H),new Be($,I),new Be(x,U));this.curves.push(A),this.actions.push({action:hg,args:E})},yk.bezierCurveTo=function(Z,H,g,R,M,s){var K=Array.prototype.slice.call(arguments),k=this.actions[this.actions.length-1].args,I=k[k.length-2],T=k[k.length-1],r=new yi(new Be(I,T),new Be(Z,H),new Be(g,R),new Be(M,s));this.curves.push(r),this.actions.push({action:ni,args:K})},yk.arc=function(N,W,J,S,z,C){var k=this.actions[this.actions.length-1].args,U=k[k.length-2],E=k[k.length-1];this.absarc(N+U,W+E,J,S,z,C)},yk.absarc=function(d,M,Z,O,m,j){this.absellipse(d,M,Z,Z,O,m,j)},yk.ellipse=function(k,i,Q,R,C,s,E){var l=this.actions[this.actions.length-1].args,D=l[l.length-2],O=l[l.length-1];this.absellipse(k+D,i+O,Q,R,C,s,E)},yk.absellipse=function(C,J,P,Q,k,o,U){var c=Array.prototype.slice.call(arguments),t=new Zj(C,J,P,Q,k,o,U);this.curves.push(t);var Y=t.getPoint(1);c.push(Y.x),c.push(Y.y),this.actions.push({action:Xm,args:c})},yk.getSpacedPoints=function(m){m||(m=40);for(var D=[],K=0;m>K;K++)D.push(this.getPoint(K/m));return D},yk.getPoints=function(y,Q){y=y||12;var $,H,o,c,E,r,R,Z,A,n,V,m,h,t,d,G,q,b,Y=[];for($=0,H=this.actions.length;H>$;$++)switch(o=this.actions[$],c=o.action,E=o.args,c){case sg:Y.push(new Be(E[0],E[1]));break;case cg:Y.push(new Be(E[0],E[1]));break;case hg:for(r=E[2],R=E[3],n=E[0],V=E[1],Y.length>0?(t=Y[Y.length-1],m=t.x,h=t.y):(t=this.actions[$-1].args,m=t[t.length-2],h=t[t.length-1]),d=1;y>=d;d++)G=d/y,q=Aq.b2(G,m,n,r),b=Aq.b2(G,h,V,R),Y.push(new Be(q,b));break;case ni:for(r=E[4],R=E[5],n=E[0],V=E[1],Z=E[2],A=E[3],Y.length>0?(t=Y[Y.length-1],m=t.x,h=t.y):(t=this.actions[$-1].args,m=t[t.length-2],h=t[t.length-1]),d=1;y>=d;d++)G=d/y,q=Aq.b3(G,m,n,Z,r),b=Aq.b3(G,h,V,A,R),Y.push(new Be(q,b));break;case zk:var X,O=E[0],l=E[1],k=E[2],z=E[3],x=E[4],j=!!E[5],e=x-z,s=2*y;for(d=1;s>=d;d++)G=d/s,j||(G=1-G),X=z+G*e,q=O+k*L(X),b=l+k*u(X),Y.push(new Be(q,b));break;case Xm:var X,O=E[0],l=E[1],p=E[2],M=E[3],z=E[4],x=E[5],j=!!E[6],e=x-z,s=2*y;for(d=1;s>=d;d++)G=d/s,j||(G=1-G),X=z+G*e,q=O+p*L(X),b=l+M*u(X),Y.push(new Be(q,b))}var w,i,I=W["shape3d.point.epsilon"],B=!1;for(H=Y.length,$=0,H=Y.length;H>$;$++)w=Y[$],i=$===H-1?Y[0]:Y[$+1],w&&i&&D(w.x-i.x)<I&&D(w.y-i.y)<I&&(B=!0,Y[$]=null);if(B){var v=[];for($=0;H>$;$++)Y[$]&&v.push(Y[$]);Y=v}return Q&&Y.push(Y[0]),Y},yk.toShapes=function(l,F){function z(A){var o,j,t,l,n,$=[],k=new tf;for(o=0,j=A.length;j>o;o++)t=A[o],n=t.args,l=t.action,l==sg&&0!=k.actions.length&&($.push(k),k=new tf),k[l].apply(k,n);return 0!=k.actions.length&&$.push(k),$}function f(g){for(var G=[],Y=0,P=g.length;P>Y;Y++){var F=g[Y],D=new ce;D.actions=F.actions,D.curves=F.curves,G.push(D)}return G}function s(f,N){for(var o=1e-10,H=N.length,j=!1,W=H-1,I=0;H>I;W=I++){var V=N[W],p=N[I],K=p.x-V.x,L=p.y-V.y;if(D(L)>o){if(0>L&&(V=N[I],K=-K,p=N[W],L=-L),f.y<V.y||f.y>p.y)continue;if(f.y==V.y){if(f.x==V.x)return!0}else{var F=L*(f.x-V.x)-K*(f.y-V.y);if(0==F)return!0;if(0>F)continue;j=!j}}else{if(f.y!=V.y)continue;if(p.x<=f.x&&f.x<=V.x||V.x<=f.x&&f.x<=p.x)return!0}}return j}var Y=z(this.actions);if(0==Y.length)return[];if(F===!0)return f(Y);var P,M,e,r=[];if(1==Y.length)return M=Y[0],e=new ce,e.actions=M.actions,e.curves=M.curves,r.push(e),r;var c=!Aq.isClockWise(Y[0].getPoints());c=l?!c:c;var w,n=[],p=[],E=[],L=0;p[L]=_,E[L]=[];var H,b;for(H=0,b=Y.length;b>H;H++)M=Y[H],w=M.getPoints(),P=Aq.isClockWise(w),P=l?!P:P,P?(!c&&p[L]&&L++,p[L]={s:new ce,p:w},p[L].s.actions=M.actions,p[L].s.curves=M.curves,c&&L++,E[L]=[]):E[L].push({h:M,p:w[0]});if(!p[0])return f(Y);if(p.length>1){for(var j=!1,x=[],Z=0,y=p.length;y>Z;Z++)n[Z]=[];for(var Z=0,y=p.length;y>Z;Z++){p[Z];for(var o=E[Z],A=0;A<o.length;A++){for(var m=o[A],v=!0,t=0;t<p.length;t++)s(m.p,p[t].p)&&(Z!=t&&x.push({froms:Z,tos:t,hole:A}),v?(v=!1,n[t].push(m)):j=!0);v&&n[Z].push(m)}}x.length>0&&(j||(E=n))}var I,B,O;for(H=0,b=p.length;b>H;H++)for(e=p[H].s,r.push(e),I=E[H],B=0,O=I.length;O>B;B++)e.holes.push(I[B].h);return r};var ce=function(){tf.apply(this,arguments),this.holes=[]},il=ce.prototype=Hj(yk);il.getPointsHoles=function(A){var t,S=this.holes.length,E=[];for(t=0;S>t;t++)E[t]=this.holes[t].getTransformedPoints(A);return E},il.extractAllPoints=function(c){return{shape:this.getTransformedPoints(c),holes:this.getPointsHoles(c)}},il.extractPoints=function(T){return this.extractAllPoints(T)};var Aq={triangulateShape:function(V,q){function v(J,c,T){return J.x!=c.x?J.x<c.x?J.x<=T.x&&T.x<=c.x:c.x<=T.x&&T.x<=J.x:J.y<c.y?J.y<=T.y&&T.y<=c.y:c.y<=T.y&&T.y<=J.y}function E(R,e,l,p,$){var T=1e-10,i=e.x-R.x,m=e.y-R.y,h=p.x-l.x,W=p.y-l.y,s=R.x-l.x,d=R.y-l.y,P=m*h-i*W,M=m*s-i*d;if(D(P)>T){var O;if(P>0){if(0>M||M>P)return[];if(O=W*s-h*d,0>O||O>P)return[]}else{if(M>0||P>M)return[];if(O=W*s-h*d,O>0||P>O)return[]}if(0==O)return!$||0!=M&&M!=P?[R]:[];if(O==P)return!$||0!=M&&M!=P?[e]:[];if(0==M)return[l];if(M==P)return[p];var b=O/P;return[{x:R.x+b*i,y:R.y+b*m}]}if(0!=M||W*s!=h*d)return[];var g=0==i&&0==m,w=0==h&&0==W;if(g&&w)return R.x!=l.x||R.y!=l.y?[]:[R];if(g)return v(l,p,R)?[R]:[];if(w)return v(R,e,l)?[l]:[];var I,C,L,G,t,V,f,y;return 0!=i?(R.x<e.x?(I=R,L=R.x,C=e,G=e.x):(I=e,L=e.x,C=R,G=R.x),l.x<p.x?(t=l,f=l.x,V=p,y=p.x):(t=p,f=p.x,V=l,y=l.x)):(R.y<e.y?(I=R,L=R.y,C=e,G=e.y):(I=e,L=e.y,C=R,G=R.y),l.y<p.y?(t=l,f=l.y,V=p,y=p.y):(t=p,f=p.y,V=l,y=l.y)),f>=L?f>G?[]:G==f?$?[]:[t]:y>=G?[t,C]:[t,V]:L>y?[]:L==y?$?[]:[I]:y>=G?[I,C]:[I,V]}function Q(Z,R,m,M){var u=1e-10,n=R.x-Z.x,d=R.y-Z.y,E=m.x-Z.x,Y=m.y-Z.y,P=M.x-Z.x,b=M.y-Z.y,h=n*Y-d*E,l=n*b-d*P;if(D(h)>u){var x=P*Y-b*E;return h>0?l>=0&&x>=0:l>=0||x>=0}return l>0}function p(B,L){function x(S,q){var D=N.length-1,i=S-1;0>i&&(i=D);var t=S+1;t>D&&(t=0);var s=Q(N[S],N[i],N[t],I[q]);if(!s)return!1;var f=I.length-1,h=q-1;0>h&&(h=f);var V=q+1;return V>f&&(V=0),s=Q(I[q],I[h],I[V],N[S]),s?!0:!1}function h(U,g){var I,p,l;for(I=0;I<N.length;I++)if(p=I+1,p%=N.length,l=E(U,g,N[I],N[p],!0),l.length>0)return!0;return!1}function r(O,b){var o,D,k,H,h;for(o=0;o<d.length;o++)for(D=L[d[o]],k=0;k<D.length;k++)if(H=k+1,H%=D.length,h=E(O,b,D[k],D[H],!0),h.length>0)return!0;return!1}for(var I,s,D,Z,u,i,G,p,y,k,o,N=B.concat(),d=[],A=[],X=0,U=L.length;U>X;X++)d.push(X);for(var q=0,c=2*d.length;d.length>0&&(c--,!(0>c));)for(D=q;D<N.length;D++){Z=N[D],s=-1;for(var X=0;X<d.length;X++)if(i=d[X],G=Z.x+":"+Z.y+":"+i,A[G]===_){I=L[i];for(var P=0;P<I.length;P++)if(u=I[P],x(D,P)&&!h(Z,u)&&!r(Z,u)){s=P,d.splice(X,1),p=N.slice(0,D+1),y=N.slice(D),k=I.slice(s),o=I.slice(0,s+1),N=p.concat(k).concat(o).concat(y),q=D;break}if(s>=0)break;A[G]=!0}if(s>=0)break}return N}for(var b,I,O,o,k,P,C={},Y=V.concat(),l=0,x=q.length;x>l;l++)Array.prototype.push.apply(Y,q[l]);for(b=0,I=Y.length;I>b;b++)k=Y[b].x+":"+Y[b].y,C[k]!==_,C[k]=b;var r=p(V,q),c=mp.Triangulate(r,!1);for(b=0,I=c.length;I>b;b++)for(o=c[b],O=0;3>O;O++)k=o[O].x+":"+o[O].y,P=C[k],P!==_&&(o[O]=P);return c.concat()},isClockWise:function(x){return mp.Triangulate.area(x)<0},b2p0:function(T,y){var n=1-T;return n*n*y},b2p1:function(d,H){return 2*(1-d)*d*H},b2p2:function(t,y){return t*t*y},b2:function(k,J,g,l){return this.b2p0(k,J)+this.b2p1(k,g)+this.b2p2(k,l)},b3p0:function(n,G){var b=1-n;return b*b*b*G},b3p1:function(E,M){var B=1-E;return 3*B*B*E*M},b3p2:function(x,W){var e=1-x;return 3*e*x*x*W},b3p3:function(F,n){return F*F*F*n},b3:function(T,G,n,m,B){return this.b3p0(T,G)+this.b3p1(T,n)+this.b3p2(T,m)+this.b3p3(T,B)}},mp={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var T=f.keys(this.faces);return T.length?T[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(y){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(k){var R=k.familyName.toLowerCase(),u=this;return u.faces[R]=u.faces[R]||{},u.faces[R][k.cssFontWeight]=u.faces[R][k.cssFontWeight]||{},u.faces[R][k.cssFontWeight][k.cssFontStyle]=k,k},drawText:function(k){var O,_=this.getFace(),W=this.size/_.resolution,P=0,Q=String(k).split(""),N=Q.length,t=[];for(O=0;N>O;O++){var w=new tf,U=this.extractGlyphPoints(Q[O],_,W,P,w);U&&(P+=U.offset*this.spacing,t.push(U.path))}var E=P/2;return{paths:t,offset:E}},extractGlyphPoints:function(w,l,b,I,g){var p,v,q,i,D,r,Q,R,M,c,A,s,x,j,n,h,Z,f,H,K=[],o=l.glyphs[w]||l.glyphs["?"];if(o){if(o.o)for(i=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),r=i.length,Q=b,R=b,p=0;r>p;)switch(D=i[p++]){case"m":M=i[p++]*Q+I,c=i[p++]*R,g.moveTo(M,c);break;case"l":M=i[p++]*Q+I,c=i[p++]*R,g.lineTo(M,c);break;case"q":if(A=i[p++]*Q+I,s=i[p++]*R,n=i[p++]*Q+I,h=i[p++]*R,g.quadraticCurveTo(n,h,A,s),H=K[K.length-1])for(x=H.x,j=H.y,v=1,q=this.divisions;q>=v;v++){var O=v/q;Aq.b2(O,x,n,A),Aq.b2(O,j,h,s)}break;case"b":if(A=i[p++]*Q+I,s=i[p++]*R,n=i[p++]*Q+I,h=i[p++]*R,Z=i[p++]*Q+I,f=i[p++]*R,g.bezierCurveTo(n,h,Z,f,A,s),H=K[K.length-1])for(x=H.x,j=H.y,v=1,q=this.divisions;q>=v;v++){var O=v/q;Aq.b3(O,x,n,Z,A),Aq.b3(O,j,h,f,s)}}return{offset:o.ha*b,path:g}}}};mp.generateShapes=function(n,H){H=H||{};var m=H.font;if(m===_&&(m=mp.getDefaultFont(),!m))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var L=H.size!==_?H.size:1,S=H.curveSegments!==_?H.curveSegments:4,q=H.spacing!==_?H.spacing:1,U=H.weight!==_?H.weight:"normal",K=H.style!==_?H.style:"normal";mp.size=L,mp.divisions=S,mp.face=m,mp.weight=U,mp.style=K,mp.spacing=q;for(var x=mp.drawText(n),i=x.paths,l=[],P=0,t=i.length;t>P;P++)Array.prototype.push.apply(l,i[P].toShapes());return l},function(V){var b=1e-10,k=function(i,h){var k=i.length;if(3>k)return null;var l,p,B,b=[],n=[],v=[];if(z(i)>0)for(p=0;k>p;p++)n[p]=p;else for(p=0;k>p;p++)n[p]=k-1-p;var s=k,u=2*s;for(p=s-1;s>2;){if(u--<=0)return h?v:b;if(l=p,l>=s&&(l=0),p=l+1,p>=s&&(p=0),B=p+1,B>=s&&(B=0),o(i,l,p,B,s,n)){var M,N,q,V,J;for(M=n[l],N=n[p],q=n[B],b.push([i[M],i[N],i[q]]),v.push([n[l],n[p],n[B]]),V=p,J=p+1;s>J;V++,J++)n[V]=n[J];s--,u=2*s}}return h?v:b},z=function(f){for(var Q=f.length,A=0,_=Q-1,K=0;Q>K;_=K++)A+=f[_].x*f[K].y-f[K].x*f[_].y;return.5*A},o=function(r,X,o,w,e,I){var Z,t,g,Y,J,R,p,D,H;if(t=r[I[X]].x,g=r[I[X]].y,Y=r[I[o]].x,J=r[I[o]].y,R=r[I[w]].x,p=r[I[w]].y,b>(Y-t)*(p-g)-(J-g)*(R-t))return!1;var k,B,l,V,M,q,O,v,x,$,s,n,T,d,j;for(k=R-Y,B=p-J,l=t-R,V=g-p,M=Y-t,q=J-g,Z=0;e>Z;Z++)if(D=r[I[Z]].x,H=r[I[Z]].y,!(D===t&&H===g||D===Y&&H===J||D===R&&H===p)&&(O=D-t,v=H-g,x=D-Y,$=H-J,s=D-R,n=H-p,j=k*$-B*x,T=M*v-q*O,d=l*n-V*s,j>=-b&&d>=-b&&T>=-b))return!1;return!0};return V.Triangulate=k,V.Triangulate.area=z,V}(mp),b._typeface_js={faces:mp.faces,loadFace:mp.loadFace};var Tb=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Gb=Tb.prototype={constructor:Tb,computeFaceNormals:function(){for(var A=new pm,a=new pm,j=0,d=this.faces.length;d>j;j++){var I=this.faces[j],L=this.vertices[I.a],g=this.vertices[I.b],e=this.vertices[I.c];A.subVectors(e,g),a.subVectors(L,g),A.cross(a),A.normalize(),I.normal.copy(A)}},computeVertexNormals:function(q){var K,u,A,I,J,d;for(d=new Array(this.vertices.length),K=0,u=this.vertices.length;u>K;K++)d[K]=new pm;if(q){var o,t,_,b=new pm,V=new pm;for(A=0,I=this.faces.length;I>A;A++)J=this.faces[A],o=this.vertices[J.a],t=this.vertices[J.b],_=this.vertices[J.c],b.subVectors(_,t),V.subVectors(o,t),b.cross(V),d[J.a].add(b),d[J.b].add(b),d[J.c].add(b)}else for(A=0,I=this.faces.length;I>A;A++)J=this.faces[A],d[J.a].add(J.normal),d[J.b].add(J.normal),d[J.c].add(J.normal);for(K=0,u=this.vertices.length;u>K;K++)d[K].normalize();for(A=0,I=this.faces.length;I>A;A++)J=this.faces[A],J.vertexNormals[0]=d[J.a].clone(),J.vertexNormals[1]=d[J.b].clone(),J.vertexNormals[2]=d[J.c].clone()},mergeVertices:function(){var M,x,V,R,f,p,r,Q,$={},F=[],o=[],H=4,I=m(10,H);for(V=0,R=this.vertices.length;R>V;V++)M=this.vertices[V],x=U(M.x*I)+"_"+U(M.y*I)+"_"+U(M.z*I),$[x]===_?($[x]=V,F.push(this.vertices[V]),o[V]=F.length-1):o[V]=o[$[x]];var A=[];for(V=0,R=this.faces.length;R>V;V++){f=this.faces[V],f.a=o[f.a],f.b=o[f.b],f.c=o[f.c],p=[f.a,f.b,f.c];for(var e=0;3>e;e++)if(p[e]==p[(e+1)%3]){A.push(V);break}}for(V=A.length-1;V>=0;V--){var k=A[V];for(this.faces.splice(k,1),r=0,Q=this.faceVertexUvs.length;Q>r;r++)this.faceVertexUvs[r].splice(k,1)}var i=this.vertices.length-F.length;return this.vertices=F,i}},Zj=function(y,q,C,P,R,e,t){this.aX=y,this.aY=q,this.xRadius=C,this.yRadius=P,this.aStartAngle=R,this.aEndAngle=e,this.aClockwise=t};Zj.prototype=Hj(Em),Zj.prototype.getPoint=function(S){var D,B=this.aEndAngle-this.aStartAngle;0>B&&(B+=E),B>E&&(B-=E),D=this.aClockwise===!0?this.aEndAngle+(1-S)*(E-B):this.aStartAngle+S*B;var C=this.aX+this.xRadius*L(D),Q=this.aY+this.yRadius*u(D);return new Be(C,Q)};var ng=function(K,h){this.v1=K,this.v2=h},mq=ng.prototype=Hj(Em);mq.getPoint=function(f){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(f).add(this.v1),t},mq.getPointAt=function(e){return this.getPoint(e)},mq.getTangent=function(){var p=this.v2.clone().sub(this.v1);return p.normalize()};var Hk=function(j,$,r){this.v0=j,this.v1=$,this.v2=r};Hk.prototype=Hj(Em),Hk.prototype.getPoint=function(b){var N,n;return N=Aq.b2(b,this.v0.x,this.v1.x,this.v2.x),n=Aq.b2(b,this.v0.y,this.v1.y,this.v2.y),new Be(N,n)};var yi=function(I,m,q,n){this.v0=I,this.v1=m,this.v2=q,this.v3=n};yi.prototype=Hj(Em),yi.prototype.getPoint=function(v){var A,h;return A=Aq.b3(v,this.v0.x,this.v1.x,this.v2.x,this.v3.x),h=Aq.b3(v,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Be(A,h)},hd.create(function(h,e){this.v1=h,this.v2=e},function(B){var S=new pm;return S.subVectors(this.v2,this.v1),S.multiplyScalar(B),S.add(this.v1),S});var tk=hd.create(function(w,T,n){this.v0=w,this.v1=T,this.v2=n},function(U){var D,P,B;return D=Aq.b2(U,this.v0.x,this.v1.x,this.v2.x),P=Aq.b2(U,this.v0.y,this.v1.y,this.v2.y),B=Aq.b2(U,this.v0.z,this.v1.z,this.v2.z),new pm(D,P,B)}),en=hd.create(function(A,F,T,u){this.v0=A,this.v1=F,this.v2=T,this.v3=u},function(P){var L,D,z;return L=Aq.b3(P,this.v0.x,this.v1.x,this.v2.x,this.v3.x),D=Aq.b3(P,this.v0.y,this.v1.y,this.v2.y,this.v3.y),z=Aq.b3(P,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new pm(L,D,z)}),ko=function(S,k,W,n,m,R,o,Y){Tb.call(this),n=n!==_?n:.5,m=m!==_?m:.5,Y=Y!==_?Y:1,S=S||8,R=R||0,o=o||E;var F,l,C=1,J=Y/2,M=[],$=[],f=this.vertices,z=this.faces,x=this.faceVertexUvs;for(l=0;C>=l;l++){var G=[],b=[],w=l/C,g=w*(m-n)+n;for(F=0;S>=F;F++){var d=F/S,c=new pm,T=-(d*o+R);c.z=g*u(T),c.y=-w*Y+J,c.x=g*L(T),f.push(c),G.push(f.length-1),b.push(new Be(d,w))}M.push(G),$.push(b)}var t,V,O=(m-n)/Y;for(F=0;S>F;F++)for(0!==n?(t=f[M[0][F]].clone(),V=f[M[0][F+1]].clone()):(t=f[M[1][F]].clone(),V=f[M[1][F+1]].clone()),t.setY(A(t.x*t.x+t.z*t.z)*O).normalize(),V.setY(A(V.x*V.x+V.z*V.z)*O).normalize(),l=0;C>l;l++){var H=M[l][F],j=M[l+1][F],h=M[l+1][F+1],U=M[l][F+1],y=t.clone(),v=t.clone(),a=V.clone(),s=V.clone(),N=$[l][F].clone(),K=$[l+1][F].clone(),B=$[l+1][F+1].clone(),I=$[l][F+1].clone();z.push(new ve(H,j,U,[y,v,s])),x[0].push([N,K,I]),z.push(new ve(j,h,U,[v.clone(),a,s.clone()])),x[0].push([K.clone(),B,I.clone()])}if(k&&n>0)for(this.vertices.push(new pm(0,J,0)),F=0;S>F;F++){var H=M[0][F],j=M[0][F+1],h=this.vertices.length-1,y=new pm(0,1,0),v=new pm(0,1,0),a=new pm(0,1,0),N=$[0][F].clone(),K=$[0][F+1].clone(),B=new Be(K.x,0);z.push(new ve(H,j,h,[y,v,a],null,1));var Z=F/S*E,i=L(Z),P=u(Z),Q=(F+1)/S*E,D=L(Q),r=u(Q);x[0].push([new Be(.5+.5*i,.5+.5*P),new Be(.5+.5*D,.5+.5*r),new Be(.5,.5)])}if(W&&m>0)for(this.vertices.push(new pm(0,-J,0)),F=0;S>F;F++){var H=M[l][F+1],j=M[l][F],h=f.length-1,y=new pm(0,-1,0),v=new pm(0,-1,0),a=new pm(0,-1,0),N=$[l][F+1].clone(),K=$[l][F].clone();z.push(new ve(H,j,h,[y,v,a],null,2));var Z=F/S*E,i=L(Z),P=u(Z),Q=(F+1)/S*E,D=L(Q),r=u(Q);x[0].push([new Be(.5+.5*D,.5-.5*r),new Be(.5+.5*i,.5-.5*P),new Be(.5,.5)])}};ko.prototype=Hj(Gb);var Hf=function(q,y,e,J,c,$,N){Tb.call(this),N=N||.5,q=q||16,y=y||16,e=(e!==_?e:0)-Y,J=J!==_?J:E,c=c!==_?c:0,$=$!==_?$:Y;var H,W,h=[],d=[],C=this.vertices,Z=this.faces,b=this.faceVertexUvs;for(W=0;y>=W;W++){var r=[],K=[];for(H=0;q>=H;H++){var w=H/q,v=W/y,Q=new pm;Q.x=-N*L(e+w*J)*u(c+v*$),Q.y=N*L(c+v*$),Q.z=N*u(e+w*J)*u(c+v*$),C.push(Q),r.push(C.length-1),K.push(new Be(w,v))}h.push(r),d.push(K)}for(W=0;y>W;W++)for(H=0;q>H;H++){var o=h[W][H+1],M=h[W][H],m=h[W+1][H],j=h[W+1][H+1],R=C[o].clone().normalize(),l=C[M].clone().normalize(),O=C[m].clone().normalize(),I=C[j].clone().normalize(),t=d[W][H+1].clone(),z=d[W][H].clone(),X=d[W+1][H].clone(),a=d[W+1][H+1].clone();D(C[o].y)===N?(t.x=(t.x+z.x)/2,Z.push(new ve(o,m,j,[R,O,I])),b[0].push([t,X,a])):D(C[m].y)===N?(X.x=(X.x+a.x)/2,Z.push(new ve(o,M,m,[R,l,O])),b[0].push([t,z,X])):(Z.push(new ve(o,M,j,[R,l,I])),b[0].push([t,z,a]),Z.push(new ve(M,m,j,[l.clone(),O,I.clone()])),b[0].push([z.clone(),X,a.clone()]))}};Hf.prototype=Hj(Gb);var db=function(r,z,x,Q,V,w){Tb.call(this),r=r||.33,z=z||.17,Q=Q||8,x=x||6,V=V||0,w=w||E;for(var Z=new pm,l=[],d=[],f=0;Q>=f;f++)for(var s=f/Q*E+Y,t=0;x>=t;t++){var F=t/x*w+V;Z.x=r*L(F),Z.z=-r*u(F);var n=new pm,c=r+z*L(s);n.x=c*L(F),n.z=-c*u(F),n.y=z*u(s),this.vertices.push(n),l.push(new Be(t/x,1-f/Q)),d.push(n.clone().sub(Z).normalize())}for(var f=1;Q>=f;f++)for(var t=1;x>=t;t++){var o=(x+1)*f+t-1,T=(x+1)*(f-1)+t-1,y=(x+1)*(f-1)+t,W=(x+1)*f+t,O=new ve(o,T,W,[d[o].clone(),d[T].clone(),d[W].clone()]);this.faces.push(O),this.faceVertexUvs[0].push([l[o].clone(),l[T].clone(),l[W].clone()]),O=new ve(T,y,W,[d[T].clone(),d[y].clone(),d[W].clone()]),this.faces.push(O),this.faceVertexUvs[0].push([l[T].clone(),l[y].clone(),l[W].clone()])}this.computeFaceNormals()};db.prototype=Hj(Gb);var dg=function(X,x,i){return X?(Tb.call(this),X=X instanceof Array?X:[X],this.addShapeList(X,x),x.convertYZ!==!1&&cj(this,i),this.computeFaceNormals(),void 0):(X=[],void 0)},lg=dg.prototype=Hj(Tb.prototype);lg.addShapeList=function(R,g){for(var L=R.length,d=0;L>d;d++){var a=R[d];this.addShape(a,g)}},lg.addShape=function(Z,m){function n(){if(m.bottom)for(var T=0;r>T;T++)x=P[T],h(x[2],x[1],x[0],!0);if(m.top)for(T=0;r>T;T++)x=P[T],h(x[0]+e*$,x[1]+e*$,x[2]+e*$,!1)}function s(){var F=0;for(g(Q,F),F+=Q.length,d=0,X=A.length;X>d;d++)S=A[d],g(S,F),F+=S.length}function g(p,W){for(var f,_,V=p.length;--V>=0;){f=V,_=V-1,0>_&&(_=p.length-1);var n=0,O=$;for(n=0;O>n;n++){var l=e*n,J=e*(n+1),R=W+f+l,q=W+_+l,o=W+_+J,C=W+f+J;i(R,q,o,C,p,n,O,f,_)}}}function f(h,q,K){D.vertices.push(new pm(h,q,K))}function h($,S,Y,g){$+=M,S+=M,Y+=M,D.faces.push(new ve($,S,Y,null,null,g?2:1));var T=g?U.generateBottomUV(D,Z,m,$,S,Y):U.generateTopUV(D,Z,m,$,S,Y);D.faceVertexUvs[0].push(T)}function i(L,E,C,j,X,t,F,v,b){L+=M,E+=M,C+=M,j+=M,D.faces.push(new ve(L,E,j)),D.faces.push(new ve(E,C,j));var n=U.generateSideWallUV(D,Z,X,m,L,E,C,j,t,F,v,b);D.faceVertexUvs[0].push([n[0],n[1],n[3]]),D.faceVertexUvs[0].push([n[1],n[2],n[3]])}var K,B,y,G,R,Y=m.amount,H=m.curveSegments||Nq,$=m.steps||1,o=m.extrudePath,c=!1,U=new Or(m.repeatUVLength,m.boundingBox);o&&(K=o.getSpacedPoints($),c=!0,B=m.frames!==_?m.frames:new bc.FrenetFrames(o,$,!1),y=new pm,G=new pm,R=new pm);var S,d,X,D=this,M=this.vertices.length,p=Z.extractPoints(H),E=p.shape,A=p.holes,a=!Aq.isClockWise(E);if(a){for(E=E.reverse(),d=0,X=A.length;X>d;d++)S=A[d],Aq.isClockWise(S)&&(A[d]=S.reverse());a=!1}var P=Aq.triangulateShape(E,A),Q=E;for(d=0,X=A.length;X>d;d++)S=A[d],E=E.concat(S);for(var v,x,e=E.length,r=P.length,N=0;e>N;N++)v=E[N],c?(G.copy(B.normals[0]).multiplyScalar(v.x),y.copy(B.binormals[0]).multiplyScalar(v.y),R.copy(K[0]).add(G).add(y),f(R.x,R.y,R.z)):f(v.x,v.y,0);var W;for(W=1;$>=W;W++)for(N=0;e>N;N++)v=E[N],c?(G.copy(B.normals[W]).multiplyScalar(v.x),y.copy(B.binormals[W]).multiplyScalar(v.y),R.copy(K[W]).add(G).add(y),f(R.x,R.y,R.z)):f(v.x,v.y,Y/$*W);n(),s()};var bc=function(S,w,U,F,O){function b(w,P,p){return d.vertices.push(new pm(w,P,p))-1}Tb.call(this),w=w||64,U=U||1,F=F||8,O=O||!1;var f,z,x,o,y,c,K,m,i,k,h,T,j,q,n,v,J,p,B,I,X=[],d=this,$=w+1,r=new pm,g=new bc.FrenetFrames(S,w,O),e=g.tangents,Y=g.normals,P=g.binormals;for(this.tangents=e,this.normals=Y,this.binormals=P,i=0;$>i;i++)for(X[i]=[],o=i/($-1),m=S.getPointAt(o),f=e[i],z=Y[i],x=P[i],k=0;F>k;k++)y=k/F*E,c=-U*L(y),K=U*u(y),r.copy(m),r.x+=c*z.x+K*x.x,r.y+=c*z.y+K*x.y,r.z+=c*z.z+K*x.z,X[i][k]=b(r.x,r.y,r.z);for(i=0;w>i;i++)for(k=0;F>k;k++)h=O?(i+1)%w:i+1,T=(k+1)%F,j=X[i][k],q=X[h][k],n=X[h][T],v=X[i][T],J=new Be(i/w,k/F),p=new Be((i+1)/w,k/F),B=new Be((i+1)/w,(k+1)/F),I=new Be(i/w,(k+1)/F),this.faces.push(new ve(j,q,v)),this.faceVertexUvs[0].push([J,p,I]),this.faces.push(new ve(q,n,v)),this.faceVertexUvs[0].push([p.clone(),B,I.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};bc.prototype=Hj(Gb),bc.FrenetFrames=function(d,b,i){function e(){F[0]=new pm,o[0]=new pm,J=Number.MAX_VALUE,p=D(P[0].x),B=D(P[0].y),L=D(P[0].z),J>=p&&(J=p,k.set(1,0,0)),J>=B&&(J=B,k.set(0,1,0)),J>=L&&k.set(0,0,1),M.crossVectors(P[0],k).normalize(),F[0].crossVectors(P[0],M),o[0].crossVectors(P[0],F[0])}var A,J,p,B,L,w,y,k=new pm,P=[],F=[],o=[],M=new pm,f=new bf,c=b+1,a=1e-4;for(this.tangents=P,this.normals=F,this.binormals=o,w=0;c>w;w++)y=w/(c-1),P[w]=d.getTangentAt(y),P[w].normalize();for(e(),w=1;c>w;w++)F[w]=F[w-1].clone(),o[w]=o[w-1].clone(),M.crossVectors(P[w-1],P[w]),M.length()>a&&(M.normalize(),A=q(ag(P[w-1].dot(P[w]),-1,1)),F[w].applyMatrix4(f.makeRotationAxis(M,A))),o[w].crossVectors(P[w],F[w]);if(i)for(A=q(ag(F[0].dot(F[c-1]),-1,1)),A/=c-1,P[0].dot(M.crossVectors(F[0],F[c-1]))>0&&(A=-A),w=1;c>w;w++)F[w].applyMatrix4(f.makeRotationAxis(P[w],A*w)),o[w].crossVectors(P[w],F[w])};var wd=function(W,Z,h,S){Tb.call(this),Z=Z||18,h=h||0,S=S==F?E:S;for(var B=1/(W.length-1),w=1/Z,f=0,H=Z;H>=f;f++)for(var q=h+f*w*S,C=L(q),l=u(q),g=0,U=W.length;U>g;g++){var T=W[g],Q=new pm;Q.x=C*T.x-l*T.y,Q.y=l*T.x+C*T.y,Q.z=T.z,this.vertices.push(Q)}for(var k=W.length,f=0,H=Z;H>f;f++)for(var g=0,U=W.length-1;U>g;g++){var $=g+k*f,R=$,M=$+k,C=$+1+k,p=$+1,z=f*w,n=g*B,I=z+w,e=n+B;this.faces.push(new ve(R,p,M)),this.faceVertexUvs[0].push([new Be(z,n),new Be(z,e),new Be(I,n)]),this.faces.push(new ve(M,p,C)),this.faceVertexUvs[0].push([new Be(I,n),new Be(z,e),new Be(I,e)])}this.mergeVertices(),cj(this),this.computeFaceNormals(),this.computeVertexNormals()};wd.prototype=Hj(Gb);var Fo=function(J,b){b=b||{};var Q=mp.generateShapes(J,b);b.amount=b.amount!==_?b.amount:.5,b.convertYZ=!1,b.fill!==!1&&(b.bottom=!0,b.top=!0),dg.call(this,Q,b)};Fo.prototype=Hj(lg);var Yj=V.Node=function(){tl(Yj,this)},zh={X:xe,Y:_p,Z:ud},dj={X:0,Y:1,Z:2},_d={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},re="xzy",sp=function(s,h,S){if(h){var O=h[0],W=h[1],y=h[2];"xzy"===S?(_p(s,W),ud(s,y),xe(s,O)):"xyz"===S?(ud(s,y),_p(s,W),xe(s,O)):"yxz"===S?(ud(s,y),xe(s,O),_p(s,W)):"yzx"===S?(xe(s,O),ud(s,y),_p(s,W)):"zxy"===S?(_p(s,W),xe(s,O),ud(s,y)):"zyx"===S?(xe(s,O),_p(s,W),ud(s,y)):(_p(s,W),ud(s,y),xe(s,O))}};Lr("Node",Lq,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:re,_64O:0,_rotationX:0,_53O:0,_host:F,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return up},_22Q:function(){return Ks},getX:function(){return this.p().x},setX:function(D){this.p(D,this.p().y)},getY:function(){return this.p().y},setY:function(v){this.p(this.p().x,v)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(h){this.setAnchor(h,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(a){this.setAnchor(this.getAnchor().x,a)},getScaleX:function(){return this.getScale().x},setScaleX:function(D){this.setScale(D,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(s){this.setScale(this.getScale().x,s)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(S){var U=(new kn).setFromQuaternion(S,kn.ReverseOrder(this.getRotationMode()));return this.r3(U.x,U.y,U.z)},getQuaternion:function(){var I=new kn,D=new kn,S=new Cj;return function(Y){return Y||(Y=new Cj),this.getEuler(I),I.equals(D)?Y.copy(S):Y.copy(S.setFromEuler(D.copy(I)))}}(),getEuler:function(c){var I=this.r3();return c||(c=new kn),c.set(I[0],I[1],I[2],kn.ReverseOrder(this.getRotationMode()))},setEuler:function(f){return f=f.clone().reorder(kn.ReverseOrder(this.getRotationMode())),this.r3(f.x,f.y,f.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(S,s){vr(S,wi(F,F,this.r3(),this.getRotationMode())),this.translate3d(S[0]*s,S[1]*s,S[2]*s)},translateFront:function(f){this.translate3dBy([0,0,1],f)},translateBack:function(c){this.translate3dBy([0,0,-1],c)},translateLeft:function(x){this.translate3dBy([-1,0,0],x)},translateRight:function(t){this.translate3dBy([1,0,0],t)},translateTop:function(T){this.translate3dBy([0,1,0],T)},translateBottom:function(B){this.translate3dBy([0,-1,0],B)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(f,_,X){1===arguments.length&&(_=f[1],X=f[2],f=f[0]),this.p(f,X),this.setElevation(_)},translate3d:function(N,v,e){1===arguments.length&&(v=N[1],e=N[2],N=N[0]),this.translate(N,e),this.setElevation(this._54O+v)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(E,g,c){1===arguments.length&&(g=E[1],c=E[2],E=E[0]),this.setSize(E,c),this.setTall(g)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(F,E,b){1===arguments.length&&(E=F[1],b=F[2],F=F[0]),this.setRotationX(F),this.setRotation(-E),this.setRotationZ(b)},setRotationY:function(s){this.setRotation(-s)},getRotationY:function(){return-this._64O},lookAtDirection:function(P,r){r=r||Br;var F=this,R=kj(P);r===Br?(F.r3([-T(P[1]/R),-ub(P[2],P[0])+$k,0]),F.setRotationMode("xzy")):r===zc?(F.r3(0,-ub(P[2],P[0]),T(P[1]/R)),F.setRotationMode("zyx")):r===aq?(F.r3(0,-ub(P[2],P[0])+Y,-T(P[1]/R)),F.setRotationMode("zyx")):r===Ob?(F.r3([-T(P[1]/R)+$k,-ub(P[2],P[0])+$k,0]),F.setRotationMode("xzy")):r===fe&&(F.r3([-T(P[1]/R)-$k,-ub(P[2],P[0])+$k,0]),F.setRotationMode("xzy")),r===Ie&&(F.r3([-T(P[1]/R)+Y,-ub(P[2],P[0])+$k,Y]),F.setRotationMode("zxy"))},lookAt:function(i,q){return this.lookAtDirection(No(i,this.p3()),q)},lookAtX:function(){var s=new io,T=new io,X=new io,i=new bf,u=new bf,r=new kn;return function(Y,F){var I=Vl(this);if(i.fromArray(I),X.copy(this.p3()),s.copy(Y).sub(X),!(s.lengthSq()<1e-6)){s.normalize(),F===Br?T.set(0,0,1):F===Ie?T.set(0,0,-1):F===aq?T.set(-1,0,0):F===zc?T.set(1,0,0):F===Ob?T.set(0,1,0):F===fe&&T.set(0,-1,0),T.applyMatrix4(i).sub(X).normalize();var H=Math.acos(s.dot(T));if(H){var G=s.clone().cross(T);G.lengthSq()<1e-6&&(F===Ob||F===fe?G.set(0,0,1).applyMatrix4(i).sub(X):G.set(0,1,0).applyMatrix4(i).sub(X)),G.normalize(),r.set(this.r3(),this.getRotationMode(),!0),i.makeRotationFromEuler(r),u.makeRotationAxis(G,-H),r.setFromRotationMatrix(u.multiply(i)),this.r3([r.x,r.y,r.z])}}}}(),getHost:function(){return this._host},setHost:function(K){var A=this;if(A!==K&&A._host!==K){var b=A._host;b&&(b._removeAttach(A),b.updateLayoutAttaches()),A._host=K,A._host&&(A._host._addAttach(A),A._host.updateLayoutAttaches()),A.fp("host",b,K),A.onHostChanged(b,K)}},getAttaches:function(){return this._69O},_addAttach:function(h){var l=this;l._69O||(l._69O=new _n),l._69O.add(h),l.fp("attaches",F,h)},_removeAttach:function(v){var t=this;t._69O.remove(v),t._69O.isEmpty()&&delete t._69O,t.fp("attaches",v,F)},getImage:function(){if(this._pendingCheckImageJSON){var S=C.getImage(this._image);S&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Ri&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(U){var A=this,l=A._image,r=A.getWidth(),V=A.getHeight();A._image=U,A.fp("image",l,U)&&(null!=U&&(Dg(U)||zq(U)&&/\.json$/i.test(U))&&(this._pendingCheckImageJSON=!0),A.fp(ye,r,A.getWidth()),A.fp(je,V,A.getHeight()))},getElevation:function(){return this._54O},setElevation:function(D){var j=this;if(!j._50O){j._50O=1;var s=j._54O;j._54O=D,j.fp(Aj,s,D),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(f){var c=this;if(!c._49O){c._49O=1;var V=c._64O;c._64O=f,c.fp(qh,V,f),delete c._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(q){var _=this;if(!_._51O){_._51O=1;var J=_._rotationX;_._rotationX=q,_.fp("rotationX",J,q),delete _._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(G){var i=this;if(!i._52O){i._52O=1;var C=i._53O;i._53O=G,i.fp("rotationZ",C,G),delete i._52O}},getPosition:function(){return this._position},setPosition:function(Y,d){var x=this;if(!x._50I){x._50I=1;var U;if(U=2===arguments.length?{x:Y,y:d}:Y,U.x!==x._position.x||U.y!==x._position.y){var Q=x._position;x._position=U,x.fp(qp,Q,U)}delete x._50I}},translate:function(H,X){var U=this._position;this.p(U.x+H,U.y+X)},getWidth:function(){var g=this;if(g._width>=0)return g._width;var B=g.getStyle("shape3d");if(B){var J=Ij(B);if(J&&J.rawS3)return J.rawS3[0];if("billboard"===B||"plane"===B){var S=ij(g.getStyle("shape3d.image"));return S?ob(S,g):20}}var S=ij(g._image);return S?ob(S,g):20},setWidth:function(C){var e=this,T=e._width;e._width=C,e.fp(ye,T,C)},getHeight:function(){var o=this;if(o._height>=0)return o._height;var Y=o.getStyle("shape3d");if(Y){var u=Ij(Y);if(u&&u.rawS3)return u.rawS3[2];if("plane"===Y){var A=ij(o.getStyle("shape3d.image"));return A?$n(A,o):20}if("billboard"===Y)return 2}var A=ij(o._image);return A?$n(A,o):20},setHeight:function(d){var x=this,b=x._height;x._height=d,x.fp(je,b,d)},getTall:function(){var j=this;if(j._tall>=0)return j._tall;var S=j.getStyle("shape3d");if(S){var Z=Ij(S);if(Z&&Z.rawS3)return Z.rawS3[1];if("billboard"===S){var B=ij(j.getStyle("shape3d.image"));return B?$n(B,j):20}if("plane"===S)return 2}return 20},setTall:function(k){var y=this,g=y._tall;y._tall=k,y.fp("tall",g,k)},setSize:function(k,B){var b=this;2===arguments.length?(b.setWidth(k),b.setHeight(B)):(b.setWidth(k.width),b.setHeight(k.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(v,t,$,o,O){var W=this,g=W.getAnchor(),e=W.getScale();arguments.length<=2&&(O=t,t=v.y,$=v.width,o=v.height,v=v.x);var i=O&&e.x<0?1-g.x:g.x,P=O&&e.y<0?1-g.y:g.y;W.p(v+$*i,t+o*P),O&&($/=Math.abs(e.x),o/=Math.abs(e.y)),W.setWidth($),W.setHeight(o)},getMatrix:function(){var h=this,$=h._64O,K=h._position,Q=h.getScale();return new Ai($,K.x,K.y,Q.x,Q.y)
},getMatrix4:function(){var R=new io,g=new Cj,H=new io;return function(p){return this.getQuaternion(g),R.copy(this.p3()),H.copy(this.getFinalScale3d()),p||(p=new bf),p.compose(R,g,H)}}(),getAnchorRect:function(){var p=this,o=p.getWidth(),E=p.getHeight(),Z=p.getAnchor();return{x:-o*Z.x,y:-E*Z.y,width:o,height:E}},toLocal:function(e){return this.getMatrix().tfi(e)},toGlobal:function(p){return this.getMatrix().tf(p)},getAttachPosition:function(){var P=new Ai;return function(r,b,p,x){p=p||0,x=x||0;var B=this,U=B.getAnchor(),N=B._64O,s=B._position,o=B.getScale();return P.setFromTransform(N,s.x,s.y).tf({x:p+o.x*B.getWidth()*(r-U.x),y:x+o.y*B.getHeight()*(b-U.y)})}}(),isInRect:function(n){n=this.toLocal(n);var t=this.getWidth(),h=this.getHeight();return n.x+=t*this.getAnchorX(),n.y+=h*this.getAnchorY(),!(n.x<0||n.y<0||n.x>t||n.y>h)},getRect:function(){var k=this,e=k.getWidth(),T=k.getHeight(),D=k.getAnchor(),z={x:-e*D.x,y:-T*D.y,width:e,height:T},U=k.getMatrix();return z=np([U.tf(z.x,z.y),U.tf(z.x+z.width,z.y),U.tf(z.x+z.width,z.y+z.height),U.tf(z.x,z.y+z.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var S=this,F=S.getAnchor(),E=S._anchorElevation;return{x:F.x,y:E,z:F.y}},setAnchorElevation:function(p){var Y=this,J=Y._anchorElevation;return J!==p?(Y._anchorElevation=p,Y.fp("anchorElevation",J,p),!0):!1},setAnchor3d:function(U,b,v,g){var d,s=this;"number"==typeof U?d={x:U,y:b,z:v}:(d=U.length?{x:U[0],y:U[1],z:U[2]}:U,g=b);var Z=s.getDataModel();Z&&Z.beginTransaction();var N=s.getAnchor3d(),n=s.setAnchor(d.x,d.z);if(s.setAnchorElevation(d.y)&&(n=!0),n&&g&&!Wn){s.getAnchor3d();var $=Vl(s),p=vr([d.x-N.x,d.y-N.y,d.z-N.z],$);s.p3(p)}return Z&&Z.endTransaction(),n},getAnchor:function(){var W=this;if(W.hasOwnProperty("_anchor"))return W._anchor;var X=ij(W._image);return X&&X.anchorX!==_?{x:X.anchorX,y:X.anchorY}:W._anchor},setAnchor:function(_,m,i){var M,k=this;"number"==typeof _?M={x:_,y:m}:(M=_.length?{x:_[0],y:_[1]}:_,i=m);var b=k.getAnchor();if(b.x!==M.x||b.y!==M.y){var p=k.getDataModel();if(p&&p.beginTransaction(),k._anchor=M,k.fp("anchor",b,M),i&&!Wn){var S=k.getPosition(),R=k.getSize(),z=k.getRotation(),J=k.getScale(),V=-R.width*(b.x-M.x)*J.x,B=-R.height*(b.y-M.y)*J.y,D=u(z),s=L(z);k.setPosition(S.x+s*V-D*B,S.y+D*V+s*B)}return p&&p.endTransaction(),!0}return!1},getLocalQuaternion:function(T){var l=this,U=l.getHost();if(!U)return l.getQuaternion(T);var z=U.getQuaternion(),O=l.getQuaternion();return T||(T=new Cj),T.copy(z).inverse().multiply(O)},setLocalQuaternion:function(Q){var u=this,V=u.getHost();if(!V)return u.setQuaternion(Q);var U=V.getQuaternion();u.setQuaternion(U.clone().multiply(Q))},getLocalEuler:function(){var D=new Cj;return function(X){var R=this,Q=R.getHost();return Q?(R.getLocalQuaternion(D),X||(X=new kn),X.setFromQuaternion(D,kn.ReverseOrder(this.getRotationMode()))):R.getEuler(X)}}(),setLocalEuler:function(){var T=new Cj;return function(l){var Z=this,M=Z.getHost();return M?(T.setFromEuler(l),Z.setLocalQuaternion(T)):Z.setEuler(l)}}(),getLocalPosition3d:function(Q){var Y=this;Q||(Q=new io),Q.copy(Y.p3());var d=Y.getHost();if(!d)return Q;var P=d.getMatrix4();return Q.applyMatrix4(P.getInverse(P))},setLocalPosition3d:function(a){var C=this,z=C.getHost();if(!z)return a.x!==_?C.p3(a.x,a.y,a.z):C.p3(a),void 0;var g=z.getMatrix4(),h=new io(a);h.applyMatrix4(g),C.p3(h.x,h.y,h.z)},getScale:function(){return this._scale},setScale:function(x,n){var q,R=this;q=2===arguments.length?{x:x,y:n}:x;var F=R.getScale();(F.x!==q.x||F.y!==q.y)&&(R._scale=q,R.fp("scale",F,q))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var X=this,E=X._scaleTall,Y=X.getScale();return[Y.x,E,Y.y]},getFinalScale3d:function(){var y=this,_=y.s3(),J=y._dynamicScale3d,B=y.getScale3d();return _&&(B[0]*=_[0],B[1]*=_[1],B[2]*=_[2]),J&&(B[0]*=J[0],B[1]*=J[1],B[2]*=J[2]),B},getFinalRotation3d:function(){var _=this;return _._dynamicRotation||_.r3()},setScaleTall:function(M){var D=this,L=D._scaleTall;L!==M&&(D._scaleTall=M,D.fp("scaleTall",L,M))},setScale3d:function(T,U,B){var D,l=this;D="number"==typeof T?{x:T,y:U,z:B}:T.length?{x:T[0],y:T[1],z:T[2]}:T,l.setScaleTall(D.y),l.setScale(D.x,D.z)},getCorners:function(v,d){v==F&&(v=0),d==F&&(d=v);var B=this,X=B.getAnchor(),V=B.getWidth(),j=B.getHeight(),p=-V*X.x-v,M=-j*X.y-d,n=V+2*v,P=j+2*d,S=B.getMatrix();return[S.tf(p,M),S.tf(p,M+P),S.tf(p+n,M+P),S.tf(p+n,M)]},getEditControlPoints:function(o,Z,C){Z==F&&(Z=0),C==F&&(C=Z);var A=this,D=A.getAnchor(),N=A.getWidth(),l=A.getHeight(),j=-N*D.x-Z,W=-l*D.y-C,v=N+2*Z,w=l+2*C;if(o)return[{x:j,y:W},{x:j,y:0},{x:j,y:W+w},{x:0,y:W+w},{x:j+v,y:W+w},{x:j+v,y:0},{x:j+v,y:W},{x:0,y:W}];var n=A.getMatrix();return[n.tf(j,W),n.tf(j,0),n.tf(j,W+w),n.tf(0,W+w),n.tf(j+v,W+w),n.tf(j+v,0),n.tf(j+v,W),n.tf(0,W)]},rotateAt:function(F,s,c){var d=this,i=d._position,Y=d._64O,g=new Ai(Y,i.x,i.y).tf(F,s),K=A(F*F+s*s),k=ub(i.y-g.y,i.x-g.x)+c;d.setRotation(Y+c),d.p(g.x+K*L(k),g.y+K*u(k))},onParentChanged:function(){Yj.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var u={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(x){u[x]=!0}),function(t){var j=this;if(Yj.superClass.onPropertyChanged.call(j,t),u[t.property]&&!j._layoutUpdating&&j.updateLayoutParameters(null,t.property),j._69O&&j._69O.each(function($){$.handleHostPropertyChange(t)}),j._49I&&j._49I.each(function(Y){Y.fp("agentChange",!0,!1)}),bd[t.property]&&this.updateLayoutAttaches(),"a:layout"===t.property.substring(0,8)){this.updateLayoutAttaches();var p=j._host;p&&p.updateLayoutAttaches()}}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(t){this.updateAttach(t)},onStyleChanged:function(p){Yj.superClass.onStyleChanged.apply(this,arguments),Al[p]&&this.updateAttach()},updateLayoutAttaches:function(){var t,B,$=this;return t=ij($.getImage()),t&&t.layoutAttach&&(B=t.layoutAttach,B&&B($))?!0:void 0},updateAttach:function(J){var S=this;return Wn?(S.updateLayoutParameters(),void 0):(S._51I||(S._51I=1,S._71O(J),delete S._51I),void 0)},_71O:function(q){var S,D,h,$,i,v,X=this,y=X._host,P=q?q.property:F,k=q?q.oldValue:F,L=q?q.newValue:F;if(y instanceof Yj&&(!q||bd[P])){var Q;if(Q=ij(y.getImage()),Q&&Q.layoutAttach)return}if(y instanceof V.Grid){if(P===Aj)X.setElevation(X._54O+L-k);else if(!q||Ar[P]){if(S=X.s("attach.row.index"),D=X.s("attach.column.index"),h=y.getCellRect(S,D),!h)return;$=X.s("attach.row.span"),i=X.s("attach.column.span"),(1!==$||1!==i)&&(h=ti(h,y.getCellRect(S+$-1,D+i-1))),sr(h,X,"attach.padding",1),X.setRect(h)}}else if(y instanceof fg&&(v=X.s("attach.index"))>=0&&(!q||ks[P])){var I=X.s("attach.thickness"),f=y.getScale(),J=Math.max(f.x,f.y);I>0&&X.setHeight(y.getThickness()*I*J);var o=X.s("attach.offset"),B=y.getPoints(),H=B.size();if(H>v){var x=y.getPointsMatrix2d(),w=B.get(v),e=H===v+1?B.get(0):B.get(v+1);w=x.apply(w),e=x.apply(e);var A=[e.x-w.x,e.y-w.y],N=kj(A);if(N){X.s("attach.offset.relative")&&(o*=N),X.s("attach.offset.opposite")&&(o=N-o);var K={x:w.x+A[0]/N*o,y:w.y+A[1]/N*o},Y=X.s("attach.gap");Y&&(X.s("attach.gap.relative")&&(Y*=y.getThickness()*J),K=ak(F,K,e,Y)),X.p(K),X.setRotation(ub(A[1],A[0]))}}}else q&&(P===qp?X.translate(L.x-k.x,L.y-k.y):P===Aj?X.setElevation(X._54O+L-k):Kd[P]?X._11Q(y,P,L-k):("anchor"===P||"width"===P||"height"===P||"scale"===P)&&X.layout(y))},_11Q:function(){var N=new V.Math.Euler,x=V.Math.Euler.ReverseOrder,c=new V.Math.Vector2,p=new V.Math.Vector2;return function(C,f,F){var W=this,e=C.p3(),I=C.r3(),r=W.p3(),G=W.r3();if(f===qh&&(f="rotationY",F=-F),(f===qh||"rotationY"===f)&&0===G[0]&&0===G[2]&&0===I[0]&&0===I[2]&&0===r[1]&&0===e[1])return W.setRotation(-G[1]-F),c.set(r[0],r[2]).rotateAround(p.set(e[0],e[2]),-F),W.p(c.x,c.y),void 0;var B=_d[C.getRotationMode()],X=B[0],g=B[1],U=B[2],Y=zh[X],T=zh[g],z=zh[U],_=Bf();f===qh+X?(z(_,I[dj[U]]),T(_,I[dj[g]]),Y(_,F),T(_,-I[dj[g]]),z(_,-I[dj[U]])):f===qh+g?(z(_,I[dj[U]]),T(_,F),z(_,-I[dj[U]])):f===qh+U&&z(_,F);var $=No(r,e);vr($,_),W.p3(e[0]+$[0],e[1]+$[1],e[2]+$[2]);var v=W.getRotationMode();sp(_,W.r3(),v),N.setFromRotationMatrix(_,x(v)),W.r3([N.x,N.y,N.z])}}(),isHostOn:function(o){var t=this;if(t._host&&o&&o._69O)for(var p={},s=t._host;s&&s!==t&&!p[s._id];){if(s===o)return!0;p[s._id]=s,s=s._host}return!1},isLoopedHostOn:function(n){return this.isHostOn(n)&&n.isHostOn(this)},getScaledSize:function(){var s=this.getSize(),A=this.getScale();return s.width*=Math.abs(A.x),s.height*=Math.abs(A.y),s},layout:function(s){if(s=s||this.getHost()){var t=this,i=t.s("layout.h")||"center",C=t.s("layout.v")||"center";if("center"!==i||"center"!==C){var K=new V.Math.Vector2,q=s.getPosition(),M=s.getAnchor(),f=s.getScaledSize();t.getPosition();var k,h,G,u,d,I=1,Y=1;switch(t._layoutUpdating=!0,i){case"left":K.setX(t._layoutHValue-M.x*f.width);break;case"right":K.setX((1-M.x)*f.width-t._layoutHValue);break;case"leftright":k=f.width-t._layoutHValue[2],G=t.getRotation()-s.getRotation(),u=Math.abs(Math.sin(G)),d=Math.abs(Math.cos(G)),I+=d*k/t._layoutHValue[3],Y+=u*k/t._layoutHValue[4],K.setX(t._layoutHValue[1]+(t._layoutHValue[5]-M.x)*f.width);break;case"center":K.setX((.5-M.x)*f.width-t._layoutHValue);break;case"scale":G=t.getRotation()-s.getRotation(),u=Math.abs(Math.sin(G)),d=Math.abs(Math.cos(G)),K.setX((.5-M.x)*f.width-t._layoutHValue[1]*f.width/t._layoutHValue[0]),h=f.width/t._layoutHValue[2]-1,I+=d*h,Y+=u*h}switch(C){case"top":K.setY(t._layoutVValue-M.y*f.height);break;case"bottom":K.setY((1-M.y)*f.height-t._layoutVValue);break;case"topbottom":G||(G=t.getRotation()-s.getRotation(),u=Math.abs(Math.sin(G)),d=Math.abs(Math.cos(G))),k=f.height-t._layoutVValue[2],I+=u*k/t._layoutVValue[3],Y+=d*k/t._layoutVValue[4],K.setY(t._layoutVValue[1]+(t._layoutVValue[5]-M.y)*f.height);break;case"center":K.setY((.5-M.y)*f.height-t._layoutVValue);break;case"scale":G||(G=t.getRotation()-s.getRotation(),u=Math.abs(Math.sin(G)),d=Math.abs(Math.cos(G))),K.setY((.5-M.y)*f.height-t._layoutVValue[1]*f.height/t._layoutVValue[0]),h=f.height/t._layoutVValue[2]-1,I+=u*h,Y+=d*h}if("leftright"===i||"scale"===i||"topbottom"===C||"scale"===C){var n=this.getScale(),x=Math.abs(n.x),w=Math.abs(n.y);"leftright"===i||"scale"===i?t.setSize(t._layoutHValue[3]*I/x,t._layoutHValue[4]*Y/w):t.setSize(t._layoutVValue[3]*I/x,t._layoutVValue[4]*Y/w)}K.rotateAround(null,s.getRotation()),this.setPosition(K.x+q.x,K.y+q.y),t._layoutUpdating=_}}},updateLayoutParameters:function(A,E){if(A=A||this.getHost()){var W=this,O=W.s("layout.h"),D=W.s("layout.v");if(O||D){var I,t,s,F,y,S,l=new V.Math.Vector2,P=A.getPosition(),Q=A.getAnchor(),J=A.getScaledSize(),x=W.getPosition(),H=W.getScaledSize();switch(l.set(x.x-P.x,x.y-P.y),l.rotateAround(null,-A.getRotation()),O){case"left":W._layoutHValue=l.x+Q.x*J.width;break;case"right":W._layoutHValue=-l.x+(1-Q.x)*J.width;break;case"center":W._layoutHValue=-l.x+(.5-Q.x)*J.width;break;case"leftright":case"scale":"scale"===O?I=-l.x+(.5-Q.x)*J.width:(t=W.getAnchor(),s=W.getRotation()-A.getRotation(),F=Math.cos(s),y=Math.sin(s),S=-Math.min(-t.x*F+t.y*y,-t.x*F-(1-t.y)*y,(1-t.x)*F+t.y*y,(1-t.x)*F-(1-t.y)*y),I=l.x-(S-Q.x)*J.width),"position"===E&&"object"==typeof W._layoutHValue?(W._layoutHValue[0]=J.width,W._layoutHValue[1]=I):W._layoutHValue=[J.width,I,J.width,H.width,H.height,S]}switch(D){case"top":W._layoutVValue=l.y+Q.y*J.height;break;case"bottom":W._layoutVValue=-l.y+(1-Q.y)*J.height;break;case"center":W._layoutVValue=-l.y+(.5-Q.y)*J.height;break;case"topbottom":case"scale":"scale"===D?I=-l.y+(.5-Q.y)*J.height:(s||(t=W.getAnchor(),s=W.getRotation()-A.getRotation(),F=Math.cos(s),y=Math.sin(s)),S=-Math.min(-t.x*y-t.y*F,-t.x*y+(1-t.y)*F,(1-t.x)*y-t.y*F,(1-t.x)*y+(1-t.y)*F),I=l.y-(S-Q.y)*J.height),"position"===E&&"object"==typeof W._layoutVValue?(W._layoutVValue[0]=J.height,W._layoutVValue[1]=I):W._layoutVValue=[J.height,I,J.height,H.width,H.height,S]}}}},getSerializableProperties:function(){var N=Yj.superClass.getSerializableProperties.call(this);return Xf(N,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),N}});var Ho=V.Edge=function($,E){var O=this;tl(Ho,O),O.setSource($),O.setTarget(E)};Lr("Edge",Lq,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return ym},_22Q:function(){return Ms},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(t){if(t===this)return!1;if(be(t))return!0;for(var $,h,g,C,X,Z=[this],H=-1,L=0;L>H;)if(H++,$=Z[H],h=$._44I)for(h=h.getArray(),C=0,X=h.length;X>C;C++)if(g=h[C],Cm(g)&&!(Z.indexOf(g)>=0)){if(g===t)return!1;Z.push(g),L++}return!0},setSource:function(h){var w=this;if(w._source!==h&&w.canSetSourceTarget(h)){var Q=w._source;w._source=h,Q&&Q._16I(w),h&&h._2I(w),w._7I(),w.fp("source",Q,h)}},setTarget:function(v){var z=this;if(z._target!==v&&z.canSetSourceTarget(v)){var O=z._target;z._target=v,O&&O._18I(z),v&&v._4I(z),z._7I(),z.fp("target",O,v)}},isLooped:function(){var p=this;return p._source===p._target&&be(p._source)&&be(p._target)},onPropertyChanged:function(){var r=this;r._49I&&r._49I.each(function(U){U.fp("agentChange",!0,!1)})},_7I:function(){var o,G=this,K=hr(G);G._40I!==K&&(o=this._40I,o&&o._15I(G),G._40I=K,K&&K._1I(G),G.fp("sourceAgent",o,K),Ml(o,G._41I),Ml(K,G._41I));var Z=qq(G);G._41I!==Z&&(o=G._41I,o&&o._17I(G),G._41I=Z,Z&&Z._3I(G),G.fp("targetAgent",o,Z),Ml(o,G._40I),Ml(Z,G._40I))},_22I:function(t){this._52I=t,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var G=this;return G._52I&&G._52I.get(0)!==G&&!G.getStyle(Ue)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var Z=this,d=Z._52I;return d&&!Z.getStyle(Ue)&&d.size()>1&&Z===d.get(0)},toggle:function(){this.beginTransaction();var C=this._52I,f=!this.s(Ue);C&&C.size()>1&&(C.each(function(Z){Z.s(Ue,f)}),C.getSiblings().each(function($){$!==C&&$.each(function(S){S.fp("edgeGroup",F,$)})})),this.endTransaction()},setStyle:function(p,R){(p===rn||"edge.segments"===p)&&(R=qd(R)),Ho.superClass.setStyle.call(this,p,R)},onStyleChanged:function(v){Ho.superClass.onStyleChanged.apply(this,arguments),An[v]&&Ml(this._41I,this._40I)},getSerializableProperties:function(){var C=Ho.superClass.getSerializableProperties.call(this);return Xf(C,{source:1,target:1}),C}});var fd=V.Group=function(){tl(fd,this)};Lr("Group",Yj,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Bo},onChildAdded:function(){fd.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){fd.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var T=this;if(!T._54I&&!Wn){var J=T.getChildrenRect();J&&(T._53I=1,T.p(Vf(T.s("group.position"),J,T.getSize())),delete T._53I)}},getChildrenRect:function(){var M,t=this;return t.eachChild(function(e){be(e)&&(M=ti(M,t.getChildRect(e)))}),M},getChildRect:function(A){var T;return be(A)&&A.s($d)&&(Qb(A)&&A.isExpanded()&&A.eachChild(function(Z){T=ti(T,A.getChildRect(Z))}),!T&&A.getRect&&(T=A.getRect())),T},setPosition:function(D,m){var t=this;if(!t._54I){var u;u=2===arguments.length?{x:D,y:m}:D,Wn||t._53I||(t._54I=1,mr(t._children,u.x-t._position.x,u.y-t._position.y),delete t._54I),fd.superClass.setPosition.call(this,u)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(Q){var j=this;if(j._57O!==Q){var D=j._57O;j._57O=Q,j.fp("expanded",D,j._57O),j._fireInvalidateDeep(),j._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(J){Qb(J)?J._fireInvalidateDeep():J.iv()})},_8I:function(){fd.superClass._8I.call(this),this.eachChild(function(e){be(e)&&e._8I()})},onStyleChanged:function(O){fd.superClass.onStyleChanged.apply(this,arguments),"group.position"===O&&this._81I()},getSerializableProperties:function(){var v=fd.superClass.getSerializableProperties.call(this);return v.expanded=1,v}});var rs=V.Block=function(){tl(rs,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Lr("Block",Yj,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Td},_22Q:function(){return Ls},onChildAdded:function(){rs.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){rs.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function p(x,W,i){k.fromArray(Vl(W));var G=W.getAnchor3d();x.push((new io).set(0-G.x,0-G.y,0-G.z).applyMatrix4(k).applyMatrix4(i)),x.push((new io).set(0-G.x,0-G.y,1-G.z).applyMatrix4(k).applyMatrix4(i)),x.push((new io).set(0-G.x,1-G.y,0-G.z).applyMatrix4(k).applyMatrix4(i)),x.push((new io).set(0-G.x,1-G.y,1-G.z).applyMatrix4(k).applyMatrix4(i)),x.push((new io).set(1-G.x,0-G.y,0-G.z).applyMatrix4(k).applyMatrix4(i)),x.push((new io).set(1-G.x,0-G.y,1-G.z).applyMatrix4(k).applyMatrix4(i)),x.push((new io).set(1-G.x,1-G.y,0-G.z).applyMatrix4(k).applyMatrix4(i)),x.push((new io).set(1-G.x,1-G.y,1-G.z).applyMatrix4(k).applyMatrix4(i))}function s(M,S){var y=(new bf).makeRotationFromEuler(this.getEuler()).setPosition((new io).fromArray(this.p3()));y.getInverse(y),M.forEach(function(s){be(s)&&p(S,s,y)})}var k=new bf;return function(W,x){if(W instanceof Yj&&(W=[W]),!W||0===W.length)return F;var x=[];s.call(this,W,x);var z=[1/0,1/0,1/0],t=[-1/0,-1/0,-1/0];return x.forEach(function(m){z[0]=Math.min(m.x,z[0]),z[1]=Math.min(m.y,z[1]),z[2]=Math.min(m.z,z[2]),t[0]=Math.max(m.x,t[0]),t[1]=Math.max(m.y,t[1]),t[2]=Math.max(m.z,t[2])}),{min:z,max:t}}}(),updateFromChildren:function(){var H=this;if(!Wn&&!H._updatingToChildren&&H._syncSize&&0!==H.size()&&!H._freezeSyncFromChildren){var c=this._getBoundingBox(H.toChildren(be));if(c){H._updatingFromChildren=1;var N=(new io).fromArray(this.getScale3d()),R=(new io).fromArray(c.min),l=(new io).fromArray(c.max),e=C.blockMinSize,M=new io,i=l.clone().sub(R);0===i.x&&M.setX(.5),0===i.y&&M.setY(.5),0===i.z&&M.setZ(.5);var o=this._width==F||-1===this._width,L=new io(this.getAnchor3d()),k=N.clone().multiply((new io).fromArray(this.s3())),$=i.clone();0===$.x&&$.setX(e),0===$.y&&$.setY(e),0===$.z&&$.setZ(e);var j=L.clone().multiply(k),a=j.clone().multiplyScalar(-1).sub(R).divide($).add(j.divide($)).add(M),P=this.s("keepPosition");if(o||this._anchorChanged||this._scaleChanged||!P){!o&&P&&(L=a);var v=L.clone().multiply(i).add(R).applyEuler(this.getEuler()).add((new io).fromArray(this.p3()));this.p3([v.x,v.y,v.z])}else this.setAnchor3d(a.x,a.y,a.z);var J=new io(1,1,1).divide(N).multiply(i);this.s3(Math.abs(J.x),Math.abs(J.y),Math.abs(J.z)),delete H._updatingFromChildren}}},setPosition:function(H,Z){var x=this;if(!x._updatingToChildren){var L;L=2===arguments.length?{x:H,y:Z}:H,Wn||x._updatingFromChildren||(x._updatingToChildren=1,mr(x._children,L.x-x._position.x,L.y-x._position.y),delete x._updatingToChildren),rs.superClass.setPosition.call(this,L)}},setSize3d:function(){this.beginTransaction(),rs.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(B){var d=this;if(!d._updatingToChildren){this.beginTransaction(),B=i(B,C.blockMinSize);var w=d.getTall();if(B!==w&&rs.superClass.setTall.call(d,B),!Wn&&!d._updatingFromChildren){d._updatingToChildren=1;var s=B/w;d._adjustChildTallOrScale(s,"size"),delete d._updatingToChildren,d.updateFromChildren()}this.endTransaction()}},setWidth:function(i){return this.setSize(i,this.getHeight())},setHeight:function(G){return this.setSize(this.getWidth(),G)},setSize:function(N,E){var q=C.blockMinSize;N=i(N,q),E=i(E,q);var T=this;if(!T._updatingToChildren){2!==arguments.length&&(E=N.height,N=N.width),this.beginTransaction();var Q=T.getWidth(),U=T.getHeight();if(N!==Q&&rs.superClass.setWidth.call(T,N),E!==U&&rs.superClass.setHeight.call(T,E),!Wn&&!T._updatingFromChildren){T._updatingToChildren=1;var u=N/Q,c=E/U;T._adjustChildScaleOrSize(u,c,"size"),delete T._updatingToChildren,T.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(B,N,F){var f=this;if(f._syncSize){var Y=f.getPosition(),O=f.getRotation();f.eachChild(function(R){if(be(R)){var M=R.getPosition(),f=R.getRotation(),d=R.getWidth(),G=R.getHeight(),E=R.getScale(),p=E.x*d,m=E.y*G;if(0!==p&&0!==m){0>B*N&&R.setRotation(-1*f);var A=new Ai(f,M.x,M.y,p,m);A.translate(-Y.x,-Y.y),A.rotate(-O),f=ub(A.b*Math.sign(p),A.a*Math.sign(p)),A.scale(B,N);var C,e,T,g=L(f);if(Math.abs(g)<.001?(C=u(f),e=A.b/C,T=-A.c/C):(e=A.a/g,T=A.d/g),"scale"===F)R.setScale(e/d,T/G);else if("size"===F){var h=e/E.x,P=T/E.y;R.setScale(to(e)*Math.abs(E.x),to(T)*Math.abs(E.y)),R instanceof V.Shape?(R.setWidthForce(Math.max(Math.abs(h),1e-5)),R.setHeightForce(Math.max(Math.abs(P),1e-5))):R.setSize(Math.max(.01,Math.abs(h)),Math.max(.01,Math.abs(P)))}A.rotate(O),A.translate(Y.x,Y.y),R.setPosition(A.tx,A.ty)}}})}},_calcChangeFactor:function(L,z,v,k){var E,Z,U,t;return E=D(L),Z=D(v),U=E>Z?E/Z:Z/E,E=D(z),Z=D(k),t=E>Z?E/Z:Z/E,i(U,t)},setElevation:function(v){var W=this;if(!W._updatingToChildren){var P=W.getElevation(),t=v-P;0!==t&&(Wn||W._updatingFromChildren||(W._updatingToChildren=1,mr(W._children,0,t,0),delete W._updatingToChildren),rs.superClass.setElevation.apply(W,arguments))}},setScaleTall:function(i){var l=this;if(!l._updatingToChildren){var e=l.getScaleTall();if(D(i)<.01&&(i=.01*(to(i)||to(e))),rs.superClass.setScaleTall.call(l,i),!Wn&&!l._updatingFromChildren){l._updatingToChildren=1;var o=i/e;l._adjustChildTallOrScale(o,"size"),delete l._updatingToChildren,l._scaleChanged=1,this.updateFromChildren(),delete l._scaleChanged}}},_adjustChildTallOrScale:function(N,E){var Y=this;if(Y._syncSize){var f=Y.getElevation();Y.eachChild(function(P){if(be(P))if("size"===E){var I=P.getTall();0>N&&P.setScaleTall(-1*P.getScaleTall()),P.setTall(Math.max(.01,Math.abs(I*N))),P.setElevation(f+(P.getElevation()-f)*N)}else{var m=P.getScaleTall();P.setScaleTall(m*N)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var F=rs.superClass.setAnchor3d.apply(this,arguments);return F&&!Wn&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),F}},setAnchor:function(){var t=this;if(!t._updatingToChildren){var I=t.getAnchor(),Z=rs.superClass.setAnchor.apply(t,arguments);if(Wn||t._updatingFromChildren||!t._syncSize)return Z;t._updatingToChildren=1;var w=t.getAnchor();t.getPosition();var B=t.getSize(),W=t.getScale(),D=t.getRotation(),E=-B.width*W.x*(I.x-w.x),y=-B.height*W.y*(I.y-w.y),C=u(D),z=L(D),K=z*E-C*y,v=C*E+z*y;return t.eachChild(function(I){if(be(I)){var M=I.getPosition();I.setPosition(M.x-K,M.y-v)}}),delete t._updatingToChildren,Z}},setAnchorElevation:function(){var m=this;if(!m._updatingToChildren){var B=m.getAnchorElevation(),x=rs.superClass.setAnchorElevation.apply(m,arguments);if(Wn||m._updatingFromChildren||!m._syncSize)return x;m._updatingToChildren=1;var N=m.getAnchorElevation(),u=m.getTall(),t=m.getScaleTall(),p=-u*t*(B-N);return m.eachChild(function(E){if(be(E)){var y=E.getElevation();E.setElevation(y-p)}}),delete m._updatingToChildren,x}},setRotation:function(f){this._updateChildrenRotation3d("rotation",f)},setRotationX:function(F){this._updateChildrenRotation3d("rotationX",F)},setRotationZ:function(W){this._updateChildrenRotation3d("rotationZ",W)},_updateChildrenRotation3d:function(m,T){var L=this;if(!L._updatingToChildren){var Z=L[Tp(m)]();if(rs.superClass[Ro(m)].call(L,T),!Wn&&!L._updatingFromChildren){L._updatingToChildren=1;var o=T-Z;L.eachChild(function(P){be(P)&&P._11Q(L,m,o)}),delete L._updatingToChildren}}},setScale:function(U,N){var m=this;if(!m._updatingToChildren){null==N&&(N=U.y,U=U.x);var T=m.getScale();if(D(U)<.01&&(U=.01*(to(U)||to(T.x))),D(N)<.01&&(N=.01*(to(N)||to(T.y))),rs.superClass.setScale.call(m,U,N),!Wn&&!m._updatingFromChildren){m._updatingToChildren=1;var P=U/T.x,u=N/T.y;m._adjustChildScaleOrSize(P,u,"size"),delete m._updatingToChildren,m._scaleChanged=1,m.updateFromChildren(),delete m._scaleChanged}}},onPropertyChanged:function(O){rs.superClass.onPropertyChanged.call(this,O),"s:3d.visible"===O.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(M){(M.s("batch")||M.s("wf.geometry")||M.s("wf.visible"))&&M.iv(),M instanceof rs&&M._invalidateChildrenBatch()})},getSerializableProperties:function(){var A=rs.superClass.getSerializableProperties.call(this);return A.clickThroughEnabled=1,A.syncSize=1,A}});var um=V.Grid=function(){tl(V.Grid,this)};Lr("Grid",Yj,{IRotatable:!1,_icon:"grid_icon",_image:F,getUIClass:function(){return zp},setRotation:function(){},getCellRect:function(m,c){var s=this,b=s.s("grid.row.count"),I=s.s("grid.column.count");if(0>=b||0>=I||0>m||m>=b||0>c||c>=I)return F;var T,k,R,f=s.getRect(),B=s.s("grid.row.percents"),o=s.s("grid.column.percents");if(sr(f,s,"grid.border",-1),B&&B._as&&(B=B._as),o&&o._as&&(o=o._as),B&&B.length===b){for(R=0,T=0;m>T;T++)R+=f.height*B[T];f.y+=R,f.height=f.height*B[m]}else f.height=f.height/b,f.y+=f.height*m;if(o&&o.length===I){for(k=0,T=0;c>T;T++)k+=f.width*o[T];f.x+=k,f.width=f.width*o[c]}else f.width=f.width/I,f.x+=f.width*c;return ps(f,-s.s("grid.gap")),f}});var Jj=V.Text=function(){tl(Jj,this),this.setSize(100,50),this.s("text","TEXT")};Lr("Text",Yj,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Nm},setWidth:function(T){T||(T=.001),Jj.superClass.setWidth.call(this,T)},setHeight:function(y){y||(y=.001),Jj.superClass.setHeight.call(this,y)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Se("__text__",{width:{value:100,isSafeFunc:!0,func:function(W){return W?W._width:100}},height:{value:50,isSafeFunc:!0,func:function(W){return W?W._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"}}]});var fg=V.Shape=function(){tl(fg,this),this._59O=new _n};fg.__de__=xo,Lr("Shape",Yj,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Qd},_22Q:function(){return Ns},getLength:function(Y){return Pm(tg(this._59O,this._58O,Y,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var m=this._58O;return m?new _n(m._as.slice(0)):m},setSegments:function(I){var P=this._58O;I=I?mh(I)?new _n(I.slice(0)):new _n(I._as.slice(0)):null,(P&&I&&P._as.join(",")!==I._as.join(",")||P!==I)&&(this._58O=I,this.fp("segments",P,I))},getPoints:function(){return this._59O},toPoints:function(){var O=this._59O;return new _n(O._as.slice(0))},getPointsMatrix2d:function(){var M=this,U=new Jr.Matrix2d,O=M.getPosition(),Q=M.getScale(),o=M.getRotation();return U.translate(-O.x,-O.y).scale(Q.x,Q.y).rotate(o).translate(O.x,O.y),U},getPointsMatrix3d:function(){return function(){var m=this,J=new Jr.Matrix4,I=J.getElements(),V=m.p3();jc(I,V),sp(I,m.getFinalRotation3d(),m.getRotationMode());var s=m.getScale3d(),P=m._dynamicScale3d;return P&&(s[0]*=P[0],s[1]*=P[1],s[2]*=P[2]),ul(I,s),jc(I,Wd(V)),J}}(),setPoints:function(U,J){var i=this,D=i._59O;U=U?mh(U)?new _n(U.slice(0)):new _n(U._as.slice(0)):new _n;var k,W,O,M,$,N;J&&(k=i.getPosition(),N=new Ai(i.getRotation(),0,0,i.getScale().x,i.getScale().y)),(D&&U&&D._as.join(",")!==U._as.join(",")||D!==U)&&(i._59O=U,i.fs(),i.fp("points",D,U)),J&&(W=i.getPosition(),O=W.x-k.x,M=W.y-k.y,$=N.tf(O,M),i.setPosition(W.x-O+$.x,W.y-M+$.y))},addPoint:function(y,j,K){var I=this.toPoints();I.add(y,j),this.setPoints(I,K)},setPoint:function(i,Q,b){var n=this.toPoints();n.set(i,Q),this.setPoints(n,b)},removePointAt:function(C){var Q=this.toPoints();Q.removeAt(C),this.setPoints(Q)},setWidthForce:function(B){var W=this;if(!W._55I&&!Wn&&W.getWidth()){W._55I=1;var P=W._position.x,p=B/W.getWidth(),R=W.toPoints(),q=new _n;1!==p&&(R.each(function(E){q.add({x:(E.x-P)*p+P,y:E.y,e:E.e})}),W.setPoints(q),bq(W,[p,0,0,1,P*(1-p),0]),W.fs()),delete W._55I}fg.superClass.setWidth.call(W,B)},setWidth:function(N){return this.setWidthForce(Lc>N?Lc:N)},setHeightForce:function(P){var L=this;if(!L._55I&&!Wn&&L.getHeight()){L._55I=1;var $=L._position.y,c=P/L.getHeight(),m=L.toPoints(),F=new _n;1!==c&&(m.each(function(f){F.add({x:f.x,y:(f.y-$)*c+$,e:f.e})}),L.setPoints(F),bq(L,[1,0,0,c,0,$*(1-c)]),L.fs()),delete L._55I}fg.superClass.setHeight.call(L,P)},setHeight:function(f){return this.setHeightForce(Lc>f?Lc:f)},setAnchorElevation:function(u){var R=this;R._55I=!0;var k=R._updatingAnchor3d,A=!Wn&&!k;if(A){var i,E=u,L=R.getAnchorElevation(),M=R.getTall();i=M*(L-E),0!==i&&R.shiftPointsElevation(i)}var Z=fg.superClass.setAnchorElevation.apply(R,arguments);return k||delete R._55I,Z},getShapeElevation:function(){var R=this,E=R._54O;return E-(R.getTall()||0)*(R._anchorElevation-.5)},setAnchor3d:function(M,q,R,c){var o,C=this;"number"==typeof M?o={x:M,y:q,z:R}:(o=M.length?{x:M[0],y:M[1],z:M[2]}:M,c=q),C._55I=!0,C._updatingAnchor3d=!0;var H=C.getDataModel();if(H&&H.beginTransaction(),!Wn){var X=C.getAnchor3d(),p=C.getSize(),f=C.getTall(),B=p.width*(X.x-o.x),y=p.height*(X.z-o.z),F=f*(X.y-o.y);c||C.shiftPoints(B,y,F);var Q=C.p3()}var u=fg.superClass.setAnchor3d.apply(C,arguments);if(!Wn&&c){var V=C.p3();C.shiftPoints(V[0]-Q[0]+B,V[2]-Q[2]+y,V[1]-Q[1]+F)}return H&&H.endTransaction(),delete C._updatingAnchor3d,delete C._55I,u},setAnchor:function(l,H,G){var V=this;V._55I=!0;var r=V._updatingAnchor3d,L=!Wn&&!r;if(L){var s,U,X;"number"==typeof l?X={x:l,y:H}:(X=l.length?{x:l[0],y:l[1]}:l,G=H);var Z=V.getAnchor(),a=V.getSize();s=a.width*(Z.x-X.x),U=a.height*(Z.y-X.y),G||V.shiftPoints(s,U);var A=V.getPosition()}var B=fg.superClass.setAnchor.apply(V,arguments);if(L){var f=V.getPosition();G&&V.shiftPoints(f.x-A.x+s,f.y-A.y+U)}return r||delete V._55I,B},shiftPoints:function(D,R,B){if(D||R||B){var X=this,Y=X.getElevation()||0,M=X.toPoints(),H=new _n;M.each(function(E){var V=E.e;B&&(V=(V==F?Y:V)+B),H.add({x:E.x+D,y:E.y+R,e:V})}),X.setPoints(H),X.fs()}},shiftPointsElevation:function(C){return this.shiftPoints(0,0,C)},setPosition:function(h,c){var o,j=this;if(!j._28Q){if(j._28Q=1,!j._55I&&!Wn){o=2===arguments.length?{x:h,y:c}:h;var A=o.x-j._position.x,p=o.y-j._position.y;if(0===A&&0===p)return delete j._28Q,void 0;j._55I=1,j.shiftPoints(A,p),bq(j,[1,0,0,1,A,p]),delete j._55I}fg.superClass.setPosition.apply(j,arguments),delete j._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var w=this;if(2!==w._59O.size())return!1;var Z=w._58O;return Z?2===Z.size()&&1===Z.get(0)&&2===Z.get(1)?!0:!1:!0},fireShapeChange:function(){var W=this;if(!W._55I&&!Wn){var X=np(W._59O);X&&(W._55I=1,W.setRect(X),delete W._55I)}W.fp(eg,!1,!0)},getSerializableProperties:function(){var y=fg.superClass.getSerializableProperties.call(this);return y.segments=1,y.points=1,y.thickness=1,y.closePath=1,y}});var Co=V.Points=function(){tl(Co,this)};Lr("Points",Yj,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return Os},getPoints:function(){return this._59O},setPoints:function(N){var F=this._59O;N=N?N.slice(0):[],this._59O=N,this._pointsDirty=!0,this.fp("points",F,this._59O)},setPoint:function(h,l){var G=this._59O.slice(0);G[h]=l,this.setPoints(G)},addPoint:function(F){this.setPoint(this._59O.length,F)},getColors:function(){return this._colors
},setColors:function(w){var O=this._colors;w=w?w.slice(0):[],this._colors=w,this._colorsDirty=!0,this.fp("colors",O,w)},setPointColor:function(r,T){var v=this._colors.slice(0);v[r]=T,this.setColors(v)},getSizes:function(){return this._sizes},setSizes:function(H){var N=this._sizes;H=H?H.slice(0):[],this._sizes=H,this._sizesDirty=!0,this.fp("sizes",N,this._sizes)},setPointSize:function(r,N){var W=this._sizes.slice(0);W[r]=N,this.setSizes(W)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(p){var n=this._uvoffsets;p=p?p.slice(0):[],this._uvoffsets=p,this._offsetsDirty=!0,this.fp("uvoffsets",n,this._uvoffsets)},setPointUvoffset:function(u,W,r){var C;"object"==typeof W?(C=W[0],r=W[1]):C=W;var N=this._uvoffsets.slice(0);N[2*u+0]=C,N[2*u+1]=r,this.setUvoffsets(N)},getPointInfo:function(J){var t=this.getPoints();if(!t||t[J]==F)return F;var j=t[J],H=[j.x,j.e,j.y],u=this.mat||Vl(this),c=[H[0],H[1],H[2]];vr(c,u);var U=this.getColors(),V=U[J]||this.s("points.color"),M=this.getSizes(),m=M[J];return{size:m==F?this.s("points.size"):m,color:V,local:H,world:c}},getSerializableProperties:function(){var s=Co.superClass.getSerializableProperties.call(this);return s.points=1,s.colors=1,s.sizes=1,s.uvoffsets=1,s},onPropertyChanged:function(A){Co.superClass.onPropertyChanged.call(this,A);var K=A.property;"s:points.color"===K?this._colorsDirty=!0:"s:points.size"===K?this._sizesDirty=!0:"s:points.model"===K&&(this._modelDirty=!0)},getWidth:function(){var F=this;if(F._width>=0)return F._width;var w=F.getStyle("points.model");if(w){var A=Ij(w);if(A&&A.rawS3)return A.rawS3[0]}return 1},getHeight:function(){var D=this;if(D._height>=0)return D._height;var A=D.getStyle("points.model");if(A){var r=Ij(A);if(r&&r.rawS3)return r.rawS3[2]}return 1},getTall:function(){var Q=this;if(Q._tall>=0)return Q._tall;var n=Q.getStyle("points.model");if(n){var _=Ij(n);if(_&&_.rawS3)return _.rawS3[1]}return 1}});var Kq=V.Polyline=function(){tl(Kq,this),this.s({"shape.background":null,"shape.border.width":2})};Lr("Polyline",fg,{_icon:"polyline_icon",_22Q:function(){return Rs},getUIClass:function(){return _q},setClosePath:function(){},setTall:function(q){var A=this,C=A.getDataModel();if(C&&C.beginTransaction(),!A._55I&&!A._24Q&&!Wn&&A.getTall()){A._24Q=1;var J=A._54O,O=q/A.getTall();if(1!==O){var B=A.toPoints(),n=new _n;B.each(function(l){n.add({x:l.x,y:l.y,e:l.e==F?l.e:(l.e-J)*O+J})}),A.setPoints(n),A.fs()}delete A._24Q}Kq.superClass.setTall.call(A,q),C&&C.endTransaction()},setElevation:function(P){var D=this,A=D.getDataModel();if(A&&A.beginTransaction(),!D._55I&&!D._24Q&&!Wn){D._24Q=1;var J=P-D._54O;0!==J&&D.shiftPointsElevation(J),delete D._24Q}Kq.superClass.setElevation.apply(D,arguments),A&&A.endTransaction()},fireShapeChange:function(){var n=this,S=n._59O;if(!n._55I&&!n._24Q&&!Wn){var l=S.size();if(l){var A=1,W=S.get(0),I=n._54O;W.e==F&&(W.e=I);for(var Y=W.e,U=0;l>A;A++){W=S.get(A),W.e==F&&(W.e=I);var q=B(Y,W.e),$=i(Y+U,W.e);Y=q,U=$-q}n._24Q=1,n.setTall(U),n.setElevation(Y+U*n._anchorElevation),delete n._24Q}}Kq.superClass.fireShapeChange.apply(n,arguments)}});var al=V.SubGraph=function(){tl(al,this)};Lr("SubGraph",Yj,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){al.superClass._8I.call(this),this.eachChild(function(L){be(L)&&L._8I()})}}),C.loadingRefGraph=0;var Ri=V.RefGraph=function(){tl(Ri,this)};Lr("RefGraph",rs,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(m){var q=this._ref;this._ref=m,this.fp("ref",q,m),this.updateRef()},_21I:function(){Ri.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var n=this;if(C.loadingRefGraph++,n.clearChildrenFromDataModel(),C.loadingRefGraph--,n._ref&&n._dataModel){n._xhrLoadHandler&&(n._xhrLoadHandler.cancel=!0);var $=Wn,y=n._xhrLoadHandler=function(p){if(p&&n._dataModel){C.loadingRefGraph++;var W=n._pendingUpdateInfo={needToRestore:$};$&&(W.p3=n.p3(),W.s3=n.s3(),W.r3=n.r3(),W.anchor3d=n.getAnchor3d(),W.scale3d=n.getScale3d()),n.r3(0,0,0),n.setScale3d(1,1,1),n.setAnchor3d(.5,.5,.5),n.p3(0,0,0);var e=C.parse(p),L=n._dataModel.deserialize(e,n,{justDatas:!0});L.each(function(O){O._refGraph=n}),n.checkPendingUpdateInfo(),C.loadingRefGraph--,C.handleRefGraphLoaded(n,L,e)}};y.xhrLoadCalled=!1,C.load(n._ref,function(f){y.cancel||(y.xhrLoadCalled?y(f):Vp(function(){y(f)}))}),y.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var U=this,j=U._pendingUpdateInfo;if(!j)return U.onPendingUpdated&&(C.loadingRefGraph++,U.onPendingUpdated(),C.loadingRefGraph--),void 0;var p=!0;this.eachChild(function(t){(t._pendingCheckImageJSON||t._pendingUpdateInfo)&&(p=!1)}),p&&(C.loadingRefGraph++,U._pendingUpdateInfo=null,U.updateFromChildren(),j.needToRestore&&(U.setAnchor3d(j.anchor3d),U.setScale3d(j.scale3d),U.r3(j.r3),U.p3(j.p3)),this.getParent()instanceof Ri&&this.getParent().checkPendingUpdateInfo(),U.onPendingUpdated&&U.onPendingUpdated(),C.loadingRefGraph--)},getSerializableProperties:function(){var D=Ri.superClass.getSerializableProperties.call(this);return D.ref=1,D}}),V.EdgeGroup=function(a,Y){this._70O=a,this._siblings=Y;for(var S,$,m=0,o=a.size(),J=W[Ue];o>m;m++)if(S=a.get(m).getStyle(Ue,!1),S!=F){J=S;break}J==F&&(J=!0);var u=C.edgeGroupAgentFunc;for(u&&($=u(a),$&&$!==a.get(0)&&(a.remove($),a.add($,0))),m=0;o>m;m++)a.get(m).s(Ue,J)},Lr("EdgeGroup",f,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function($){return this._70O.get($)},indexOf:function(x){return this._70O.indexOf(x)},each:function(f,q){this._70O.each(f,q)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(v,G){this._siblings.each(function(D){D._70O.each(v,G)})}});var Yn=function(d,G,s){var Z=Ng[d]={type:d,action:G};if(s)for(var o in s)Z[o]=s[o]};Xf(C,{setConnectAction:Yn,getConnectAction:function(Y,s){if(!s){if(!Y)return null;s=Y.getCurrentConnectActionType()}return Ng[s]},doConnectAction:function(e,H,$,R){R=R||e.getCurrentConnectActionType();var S=Ng[R];if(!S)return!1;var Z=S.action;return Z?(H instanceof Tl.Group?e.sm().getSelection().each(function(B){Z.call(null,e,B,$)}):Z.call(null,e,H,$),!0):!1},doDeleteConnectionAction:function(i,f,X){X=X||i.getCurrentConnectActionType();var Y=Ng[X];if(!Y||!Y.delete)return!1;var d=Y.delete.action;return d?(f instanceof Tl.Group?i.sm().getSelection().each(function(b){d.call(null,i,b)}):d.call(null,i,f),!0):!1}});var fn=V.JSONSerializer=function(u,R){this.dm=this._dataModel=u,this._hierarchical=C.forceHierarchicalSerialization?!0:R==F?u.isHierarchicalRendering():R};Lr("JSONSerializer",f,{ms_ac:["hierarchical"],serialize:function(D){return C.stringify(this.toJSON(),D)},toJSON:function(){var o=this,L=o.dm,x=L.getRoots(),p=o.json={v:C.getVersion(),p:{},a:{},d:[]},v=L.getSerializableAttrs();L.getInit()&&(p.init=L.getInit()),L.getName()&&(p.p.name=L.getName()),L.getBackground()&&(p.p.background=L.getBackground()),L.getLayers()&&(p.p.layers=L.getLayers()),L.getEnvmap()&&(p.p.envmap=L.getEnvmap()),L.isCubicEnvmap()&&(p.p.cubicEnvmap=L.isCubicEnvmap()),p.p.autoAdjustIndex=L.isAutoAdjustIndex(),p.p.hierarchicalRendering=L.isHierarchicalRendering();for(var i in v){var g=L.a(i);g!==_&&o[Gh](i,g,p.a)}return Xn(p.a)&&delete p.a,o._hierarchical?x.each(o.serializeData,this):L.each(function(u){o.serializeData(u)}),L.fireSerializeEvent({type:"serialize",json:p}),L.getPostProcessingData()&&(p.p.postProcessingData=L.getPostProcessingData()),p},isSerializable:function(){return!0},getProperties:function(O){return O.getSerializableProperties()},getStyles:function(s){return s.getSerializableStyles()},getAttrs:function(K){return K.getSerializableAttrs()},serializeData:function(Q){var o=this;if(o.isSerializable(Q)&&!Q._refGraph){var R,X,T,b,t=nk(Q.getClassName())||Q.getClass(),e=new t,C={c:Q.getClassName(),i:Q.getId(),p:{},s:{},a:{}};o.json.d.push(C),R=o.getProperties(Q);for(X in R)if(/^_/.test(X)){if(T=Q[X],!("_width"!==X&&"_height"!==X||T!=F&&-1!==T)){var K;((Q.s("layout.h")||Q.s("layout.v"))&&Q.getHost()||Q instanceof V.Node&&(K=Q.getParent())&&K instanceof V.Block||Q.s("fullscreen"))&&(T=Q[X]="_width"===X?Q.getWidth():Q.getHeight())}T!==e[X]&&o[Gh](X.substr(1),T,C.p)}else b=Tp(X),Q[b]&&(T=Q[b](),T!==e[b]()&&o[Gh](X,T,C.p));R=o.getStyles(Q);for(X in R)T=Q.s(X),T!==e.s(X)&&o[Gh](X,T,C.s);R=o.getAttrs(Q);for(X in R)T=Q.a(X),T!==e.a(X)&&o[Gh](X,T,C.a);Xn(C.p)&&delete C.p,Xn(C.s)&&delete C.s,Xn(C.a)&&delete C.a}o._hierarchical&&Q.getChildren().each(o.serializeData,o)},serializeValue:function(E,k,V){Tm(k)?k={__a:k._as}:k instanceof Lq?k={__i:k.getId()}:k instanceof ip&&(k={__dm:k.serialize(0)}),V[E]=k},deserialize:function(G,q,T){var w=this;return zq(G)&&/.json$/.test(G)?(C.xhrLoad(G,function(f){w.deserializeImpl(f,q,T)}),void 0):w.deserializeImpl(G,q,T)},deserializeImpl:function(G,u,V){var R=this,A=R.dm;A.setDeserializing(!0),V=yb(V)?{setId:V}:ne(V)?{finishFunc:V}:V||{},G=R.json=zq(G)?C.parse(G):G,!V.justDatas&&G.a&&G.a.onPreDeserialize&&!V.disableOnPreDeserialize&&G.a.onPreDeserialize(G,A,V.view),A.beginTransaction(),Wn++,R._82I={};var j=new _n,h=new _n,P=0,S=G.d.length;if(V.justDatas||(!V.disableInit&&ne(G.init)&&G.init(A),A.setInit(G.init)),!V.justDatas){for(var f in G.a)A.a(f,R[id](G.a[f]));for(var J in G.p)A[Ro(J)](G.p[J])}for(;S>P;P++){var Y=G.d[P],q=nk(Y.c),s=new q,H=Y.i;V.setId&&H!=F&&(s._id=H),R._82I[H]=s,j.add(s),h.add(Y)}for(P=0;S>P;P++)R.deserializeData(j.get(P),h.get(P));return j.each(function(F){u&&!F.getParent()&&F.setParent(u),A.add(F)}),V.__innerHandler__&&V.__innerHandler__(G,A,V.view,j),A.fireSerializeEvent({type:"deserialize",json:G}),Wn--,A.endTransaction(),!V.justDatas&&G.a&&G.a.onPostDeserialize&&!V.disableOnPostDeserialize&&G.a.onPostDeserialize(G,A,V.view,j),V.finishFunc&&V.finishFunc(G,A,V.view,j),A.setDeserializing(!1),j},deserializeData:function(d,T){for(var C in T.p)d[Ro(C)](this[id](T.p[C]));for(C in T.s)d.s(C,this[id](T.s[C]));for(C in T.a)d.a(C,this[id](T.a[C]))},deserializeValue:function(y){if(Dg(y)){var b=y.__i;if(b!=F)return this._82I[b];if(b=y.__dm,b!=F){var t=new V.DataModel;return t.deserialize(b),t}if(b=y.__a,mh(b))return new _n(b)}return y}}),Xf(ip,{serialize:function(o,$){return new fn(this,$).serialize(o)},toJSON:function(x){return new fn(this,x).toJSON()},deserialize:function(s,k,G){return new fn(this).deserialize(s,k,G)}});var Ik=V.OverlappingBox=function(T){this.gv=T,this.boxes={}};Lr("OverlappingBox",f,{clear:function(){var m,J,F=this.boxes;for(m in F)J=F[m],J.length=0},isOverlapping:function(G,S){var I,m,$=this,O=$.boxes,P=O[G];P?(I=P.rects,m=P.length):P=O[G]={rects:I=[],length:m=0};var H,d,S;for(H=0;m>H;H++)if(d=I[H],d.x<S.x+S.w&&d.x+d.w>S.x&&d.y<S.y+S.h&&d.h+d.y>S.y)return!0;return I.length<=m?(I.push(S),P.length++):I[P.length++]=S,!1}}),Xf(C,{fetch:function(c,n){var p="GET",e=!1,k=null,S="";n&&(p=n.method||"GET",e=n.sync,S=n.url,k=n.data||null),c.open(p,S,!e),n.responseType?c.responseType=n.responseType:n.overrideMimeType&&c.overrideMimeType&&c.overrideMimeType(n.overrideMimeType),c.send(k)},convertImageSrc:function(q,V){V&&"function"==typeof V||(V=function(){}),V(q)}});var zi=V.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Lr("Request",f,{_responseType:null,_overrideMimeType:"text/plain",send:function(b){var $=this._xhr,j=this.onload,O=this.onerror;this.getResponseType()?b.responseType=this.getResponseType():this.getOverrideMimeType()&&(b.overrideMimeType=this.getOverrideMimeType()),$.onload=j,$.onerror=O,C.fetch($,b)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(c){this._responseType=c},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(C){this._overrideMimeType=C},getResponseText:function(){var J=this._xhr;return J.response||J.responseText}}),Rp.GraphView=function(N){var $=this;$._24I={},$._34I=new _n,$._25I={},$._56I={},$._view=oj(1,$),$._canvas=ys($._view),$.dm(N?N:new ip),this._coreInteractor=new Jh(this),$.setEditable(!1),$.setScrollBarVisible(C.graphViewScrollBarVisible),$._initView()},qj("GraphView",f,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Mn,pe,_c,Wl,"resettable","editInteractor",bp,"zoomable","pannable","rectSelectable","autoScrollZone",Yd,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:C.graphViewZoomable,_resettable:C.graphViewResettable,_pannable:C.graphViewPannable,_rectSelectable:C.graphViewRectSelectable,_autoScrollZone:C.graphViewAutoScrollZone,_rectSelectBackground:C.graphViewRectSelectBackground,_rectSelectBorderColor:C.graphViewRectSelectBorderColor,_editPointSize:C.graphViewEditPointSize,_editPointBorderColor:C.graphViewEditPointBorderColor,_editPointBackground:C.graphViewEditPointBackground,_scrollBarColor:Nn,_scrollBarSize:Sr,_autoHideScrollBar:iq,_autoMakeVisible:ao,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(Y){this._dataModel.setLayers(Y)},setEditable:function(E){var e=this,r=e.__interactorMap__;if(!r){var S=Rp.XEditInteractor;r=e.__interactorMap__={scrollBar:new ck(e),select:new Kb(e),edit:S?new S(e):new jo(e),text:new rr(e),move:new Wh(e),"default":new vh(e),touch:new Zd(e,{editable:!1})}}E?(e._uieditable=!0,e.setInteractors([r.scrollBar,r.select,r.edit,r.text,r.move,r.default,r.touch])):(e._uieditable=!1,e.setInteractors([r.scrollBar,r.select,r.move,r.default,r.touch]))},getCanvas:function(){return this._canvas},_33I:function(k){var U=k.getUIClass();return U?new U(this,k):F},getDataUI:function(E){var g=this,J=g._25I[E._id];return J===_&&(J=g._33I(E),g._25I[E._id]=J),J},getNodeRect:function(B){return C.getNodeRect(this,B)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(g){var C=this.getDataUI(g);return C?(C._79o(),C._78o):null},getEdgeSourcePosition:function(W){var M=this,L=M.getDataUI(W),q=L.s,N=L._data._40I;return Hl(M,N,q("edge.source.position"),q("edge.source.offset.x"),q("edge.source.offset.y"),q("edge.source.anchor.x"),q("edge.source.anchor.y"))},getEdgeTargetPosition:function(Q){var u=this,s=u.getDataUI(Q),S=s.s,g=s._data._41I;return Hl(u,g,S("edge.target.position"),S("edge.target.offset.x"),S("edge.target.offset.y"),S("edge.target.anchor.x"),S("edge.target.anchor.y"))},invalidateAll:function(q){var e=this;if(q){for(var H in e._25I){var A=e._25I[H];A&&A.dispose()}e._25I={},e._56I={},e._24I={},e._34I.clear(),e.redraw()}else e.dm().each(function(Y){e.invalidateData(Y)})},invalidateSelection:function(){var p=this;p.sm().each(function($){p.invalidateData($)})},invalidateData:function(r){var A=this;A._24I[r._id]=r,A._21Q(r),A.iv()},_21Q:function(H){var i=this,g=i._24I;if(Cm(H)&&nd[H.s(ss)]){var I=H.getSourceAgent();I&&I.getAgentEdges().each(function(s){g[s._id]=s}),I=H.getTargetAgent(),I&&I.getAgentEdges().each(function(I){g[I._id]=I}),i.iv()}},redraw:function(F){var b=this;b._32I||(F?b._34I.add(F):(b._32I=1,b._34I.clear()),b.iv())},each:function(r,f){var w,l,a,n=0,I=this.getLayers(),K=this._dataModel,G=K._datas._as,F=G.length;if(I){for(var P=I.length;P>n;n++)if(a=I[n],Dg(a)&&(a=a.name),K.isHierarchicalRendering()){var N=function($){return $._layer===a?f?r.call(f,$):r($):void 0};if(this._dataModel.eachByHierarchical(N)===!1)return}else for(var t=0;F>t;t++)if(w=G[t],w._layer===a&&(l=f?r.call(f,w):r(w),l===!1))return}else if(K.isHierarchicalRendering())this._dataModel.eachByHierarchical(r,null,f);else for(;F>n;n++)if(w=G[n],l=f?r.call(f,w):r(w),l===!1)return},reverseEach:function(W,O){var Q,J,w,j,I=this._dataModel,R=I._layers,l=I._datas._as,H=l.length;if(R){for(Q=R.length-1;Q>=0;Q--)if(j=R[Q],Dg(j)&&(j=j.name),I.isHierarchicalRendering()){var c=function(d){return d._layer===j?O?W.call(O,d):W(d):void 0};if(I.reverseEachByHierarchical(c)===!1)return}else for(var X=H-1;X>=0;X--)if(J=l[X],J._layer===j&&(w=O?W.call(O,J):W(J),w===!1))return}else if(I.isHierarchicalRendering())I.reverseEachByHierarchical(W,null,O);else for(Q=H-1;Q>=0;Q--)if(J=l[Q],w=O?W.call(O,J):W(J),w===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var p=this,F=p._84I;if(!F){var e=this.dm().a("width"),V=this.dm().a("height");e>0&&V>0?p._84I={x:0,y:0,width:e,height:V}:(p.each(function(d){p.isVisible(d)&&(F=ti(F,p.getDataUIBounds(d)))}),p._84I=F?F:wq)}return p._84I},getScrollRect:function(){return ti(this.getContentRect(),this._29I)},makeCenter:function(h,y,$){var w=this;if(!w.getWidth()||!w.getHeight())return $||Vp(w.makeCenter,w,[h,y,!0],500),void 0;w.makeVisible(h),w.validate();var F=w.getDataUIBounds(h);if(F){var H=w.getWidth(),B=w.getHeight(),m=F.x+F.width/2,P=F.y+F.height/2,a=-m*w._zoom+H/2,k=-P*w._zoom+B/2;w.setTranslate(a,k,y)}},fitData:function($,M,T,K,m){var v=this;if(!v.getWidth()||!v.getHeight())return m||Vp(v.fitData,v,[$,M,T,K,!0],500),void 0;var k=function(){v.makeVisible($),v.validate();var t=v.getDataUIBounds($);t&&(t=Hq(t),ps(t,T==F?20:T),v.fitRect(t,M,K))};M?C.callWhenLoaded(k):k()},fitContent:function(l,B,r,U){var J=this;if(!J.getWidth()||!J.getHeight())return U||Vp(J.fitContent,J,[l,B,r,!0],500),void 0;var G=function(){J.validate();var T=Hq(J.getContentRect());ps(T,B==F?20:B),J.fitRect(T,l,r)};l?C.callWhenLoaded(G):G()},fitRect:function(F,D,X){var G=this,L=G.getWidth(),C=G.getHeight(),e=F.x+F.width/2,A=F.y+F.height/2,r=B(L/F.width,C/F.height),c=G._zoom,K=-e*c+L/2,I=-A*c+C/2;0===r||isNaN(r)||(X&&(r=B(1,r)),D?(G._65I&&(delete G._65I.finishFunc,G._65I.stop(!0)),G._14o&&G._14o.stop(!0),G.setTranslate(K,I,{finishFunc:function(){G.setZoom(r,D)}})):(G.setTranslate(K,I),G.setZoom(r)))},fitSelection:function(j,U,I){var $=this,M=$.sm(),z=null;M.size()&&(M.each(function(u){z=ti($.getDataUIBounds(u),z)}),j&&ps(z,j),$.fitRect(z,U,I))},toCanvas:function(v,e,m){e=e||this._zoom,this.validateImpl();var q=this,l=q.getContentRect();m&&ps(l,m),l.width||(l.width=10),l.height||(l.height=10);var F=ys(),y=l.x*e,V=l.y*e,j=Math.ceil(l.width*e),Z=Math.ceil(l.height*e);Db(F,j,Z,1);var a=Zq(F);return v=v||this._dataModel.getBackground(),v&&Qm(a,0,0,j,Z,v),zg(a,-y,-V),a.scale(e,e),q._42(a),a.restore(),F},toDataURL:function(A,Z,H,S){return this.toCanvas(A,H,S).toDataURL(Z||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(I,A){var Q=this,n=Q.dm().getBackground();if(n){var h=Q.dm().a("width"),P=Q.dm().a("height");h>0&&P>0&&Qm(I,0,0,h,P,n)}var w=Q.__htmlOrderList,X=[],p=Q._forcedLayoutHTML;if(Q._93db(I,A),Q.each(function(x){var t=Q.getDataUI(x);if(t){var Z=Q._56I[x._id],a=t._htmlView;if(Z){var U=t._79o();if(a=t._htmlView,V.HtmlNode&&x instanceof V.HtmlNode)t._42(I);else{var v=Q.getViewRect(),h=a&&a.layoutHTML;!A||Yq(A,U)?(h&&(a.layoutHTML(),t.__outerLayout&&delete t.__outerLayout),t._42(I)):Yq(v,U)||!h||t.__outerLayout&&!p||(a.layoutHTML(),t.__outerLayout=!0)}}a&&(X.push(a),a.getView&&(a=a.getView()),a.style.display=Z?"block":Xd)}}),w&&X.length>0){var g=!1;if(w.length!==X.length)g=!0;else for(var j=0;j<X.length;j++)if(X[j]!==w[j]){g=!0;break}g&&(X.forEach(function(y){y.autoAdjustIndex!==!1&&Q.appendHTML(y,!0)}),this.__htmlOrderList=X)}else this.__htmlOrderList=X;Q._92db(I,A)},validateImpl:function(){this.tryUpdateRootData();var V,h,b,C,T,J=this,$=J.tx(),a=J.ty(),z=J._zoom,R=J._canvas,S=this.getWidth(),o=this.getHeight(),y=J._29I,p={x:-$/z,y:-a/z,width:S/z,height:o/z},n={},l=J._34I,O=J._24I,I=J._32I,E=J._23I;J._24I={},(S!==R.clientWidth||o!==R.clientHeight)&&(Db(R,S,o),I=1,J._forcedLayoutHTML=1),I||wj(p,y)||(I=1,J._forcedLayoutHTML=1),J._29I=p,J.each(function(M){h=M._id;var Y=n[h]=J.isVisible(M);Y!==J._56I[h]&&(O[h]=M,b=J.getDataUI(O[h]),b&&b._84o(Y),J._84o(M,Y))},J);for(h in O)b=J.getDataUI(O[h]),b&&(!I&&J._56I[h]&&(T=b._79o(),T&&l.add(T)),b.invalidate()),J._83I=1;if(J._56I=n,!I)for(h in O)n[h]&&(b=J.getDataUI(O[h]),b&&(T=b._79o(),T&&l.add(T)));if(I?C=p:(l.each(function(K){Yq(p,K)&&(C=ti(C,K))}),C&&(ps(C,i(1,1/z)),C.x=P(C.x*z)/z,C.y=P(C.y*z)/z,C.width=c(C.width*z)/z,C.height=c(C.height*z)/z,C=Qp(p,C))),J._74O=C,C&&0!==C.width&&0!==C.height){V=Zq(R);var j=C.x,u=C.y,W=C.width,B=C.height;j=Math.floor((j*z+$)*nj),u=Math.floor((u*z+a)*nj),W=Math.ceil(W*z*nj)+1,B=Math.ceil(B*z*nj)+1,I||(C.x=(j/nj-$)/z,C.y=(u/nj-a)/z,C.width=W/nj/z,C.height=B/nj/z),V.beginPath(),V.rect(j,u,W,B),V.clip(),V.clearRect(j,u,W,B),Gc(V,$,a,z),J._42(V,C),V.restore(),delete J._74O}if(l.clear(),delete J._32I,delete J._forcedLayoutHTML,E&&S>0&&o>0){var b=J.getDataUI(E);if(b){var T=b._79o(),Y=J._29I,Q=Y.x,v=Y.y,d=Y.width,X=Y.height,z=J._zoom;T&&!Yq(T,Y)&&(T.x+T.width<Q&&J.tx(-T.x*z),T.x>Q+d&&J.tx(-(T.x+T.width-d)*z),T.y+T.height<v&&J.ty(-T.y*z),T.y>v+X&&J.ty(-(T.y+T.height-X)*z))}delete J._23I}J._83I&&(delete J._83I,delete J._84I),J._98O(),J.countFrame(),Xn(J._24I)||Vp(J.iv,J)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var s,b=this.getFullscreenDatas();for(var O in b)s=b[O],this.scaleRootData(s);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(Y){var V=Y.s("fullscreen");if("uniform"===V||"fill"===V){Y.getRotation()&&Y.setRotation(0);var E=Y.s("fullscreen.gap")||0,I=this.getWidth(),J=this.getHeight();if(I&&J){var D,N,y,b=I-2*E,A=J-2*E,U=Y.getAnchor(),h=Y.getScaledSize(),l=h.width,d=h.height,S=Y.s("fullscreen.lock");if(S)return"uniform"===V?b/A>l/d?(D=A/d,l=d*b/A):(D=b/l,d=l*A/b):"v"===S?(D=A/d,l=b/D,Y.getWidth()!==l&&Y.setWidth(l)):(D=b/l,d=A/D,Y.getHeight()!==d&&Y.setHeight(d)),this.setZoom(D),N=E-(Y.getX()-U.x*l)*D,y=E-(Y.getY()-U.y*d)*D,N!==this.tx()&&this.tx(N),y!==this.ty()&&this.ty(y),void 0;N=this.tx(),y=this.ty(),D=this._zoom;var z={x:(-N+E)/D,y:(-y+E)/D,width:b/D,height:A/D};if("uniform"===V){var f=l/d,n=Math.min(z.width,z.height*f),r=n/f;z.x+=.5*(z.width-n),z.y+=.5*(z.height-r),z.width=n,z.height=r}b=z.width/Y.getScaleX(),A=z.height/Y.getScaleY(),(Y.getWidth()!=b||Y.getHeight()!==A)&&Y.setSize(b,A);var T=z.x+U.x*z.width,w=z.y+U.y*z.height,K=Y.getPosition();(T!==K.x||w!==K.y)&&Y.setPosition(T,w)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(G){var o=this;G!==o.isScrollBarVisible()&&(G?(of(o._view,o._79O=ir()),of(o._79O,o._27I=ir()),of(o._79O,o._28I=ir())):(Ol(o._79O),delete o._79O,delete o._27I,delete o._28I),o.fp("scrollBarVisible",!G,G))},getDebugTip:function(){return""},showScrollBar:function(){var u=this;u._79O&&(u._85I||(gr(function(){u._86I()},_b),u.iv()),u._85I=new Date)},_86I:function(){var h=this;if(h._85I){var L=new Date,V=L.getTime();V-h._85I.getTime()>=_b?(delete h._85I,h.iv()):gr(function(){h._86I()},_b)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var p=this,Q=this._27I,k=this._28I;if(p._79O){if(p._autoHideScrollBar&&!p._85I)return Q.style.visibility=td,k.style.visibility=td,void 0;var b=p.getScrollBarColor(),A=p._zoom,l=p.getScrollBarSize(),f=p.getViewRect(),K=p.getScrollRect(),S=f.height*A,x=K.height*A,E=f.width*A-l-2,$=S*((f.y-K.y)*A/x),C=S*(S/x),z=Q.style;x-.5>S?(og>C&&($=$+C/2-og/2,0>$&&($=0),$+og>S&&($=S-og),C=og),mm(Q,E,$,l,C),z.visibility=zn,z.background=b,z.borderRadius=l/2+ke):z.visibility=td;var o=f.width*A,V=K.width*A,$=f.height*A-l-2,E=o*((f.x-K.x)*A/V),q=o*(o/V),z=k.style;V-.5>o?(og>q&&(E=E+q/2-og/2,0>E&&(E=0),E+og>o&&(E=o-og),q=og),mm(k,E,$,q,l),z.visibility=zn,z.background=b,z.borderRadius=l/2+ke):z.visibility=td}},setDataModel:function(k){var u=this,I=u._dataModel,z=u._selectionModel;I!==k&&(I&&(I.ump(u.handleDataModelPropertyChange,u),I.umm(u.handleDataModelChange,u),I.umd(u.handleDataPropertyChange,u),I.removeIndexChangeListener(u._75O,u),I.removeHierarchyChangeListener(u.handleHierarchyChange,u),z||I.sm().ums(u.handleSelectionChange,u)),u._dataModel=k,k.mp(u.handleDataModelPropertyChange,u),k.mm(u.handleDataModelChange,u),k.md(u.handleDataPropertyChange,u),k.addIndexChangeListener(u._75O,u),k.addHierarchyChangeListener(u.handleHierarchyChange,u),z?z._21I(k):k.sm().ms(u.handleSelectionChange,u),u.invalidateAll(!0),u.fp(rd,I,k),u.updateBackground())},getLayersInfo:function(){if(this._layersInfo===_){var g=this.getLayers();g?(this._layersInfo={},g.forEach(function(i){var m=Dg(i)?i.name:i;this._layersInfo[m]=i},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(K,l,j){var z,R,Z=this,w=Z.getDataUI(K),e=ih(w),t=Pb(l,function(F){return jh(e,100*F)},100,.001),G=jh(e,100*t);if(!j){var q=Xe(w),h=new Go(G.x,G.y),C=49/(Z._zoom*Z._zoom);for(z=0,R=q.length;R>z;z++)if(h.distanceToSquared(q[z])<C)return{index:z,point:q[z],distance:Math.sqrt((q[z].x-l.x)*(q[z].x-l.x)+(q[z].y-l.y)*(q[z].y-l.y))}}return{percent:t,point:G,distance:Math.sqrt((G.x-l.x)*(G.x-l.x)+(G.y-l.y)*(G.y-l.y))}},calculateAttachPoint:function(){var c=new Go,$=new Go,H=new Go;return function(I,o){var y=this.getAttachPoints(I);if(!y||!y.length)return null;H.set(o.x,o.y);for(var E,k,C,M,v,n=1/0,z=0,q=y.length;q>z;z++)C=y[z],$.x=C.x,$.y=C.y,c.x=C.offsetX||0,c.y=C.offsetY||0,M=Hl(this,I,0,c.x,c.y,$.x,$.y),k=H.distanceToSquared(M),n>k&&(E=z,n=k,v=M);n=Math.sqrt(n);var f=this.getAttachStyle(I);if("close"===f){var S=I.s("attach.close.threshold")/this._zoom;if(n>S)return null}return{index:E,distance:n,info:y[E],point:v}}}(),getAttachPoints:function(P){var q=P.s("attach.points");if(q)return q;var i=ij(P._image);return i?cs(i.attachPoints,P,this)||null:void 0},getAttachStyle:function(J){var W=J.s("attach.style");if(W)return W;var K=ij(J._image);return K?cs(K.attachStyle,J,this)||"close":void 0},updateLayers:function(){this._layersInfo=_,this.invalidateSelection(),this.redraw()},updateBackground:function(){var f=this.dm().a("width"),M=this.dm().a("height");this._canvas.style.background=f>0&&M>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(z){if("background"===z.property){var T=this._canvas.style.background,G=z.newValue||"";this.updateBackground(),this.fp("canvasBackground",T,G),this.redraw()}else"a:width"===z.property||"a:height"===z.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===z.property?this.updateLayers():"hierarchicalRendering"===z.property&&this.redraw()},handleDataPropertyChange:function(_){this.dm().isHierarchicalRendering()&&"parent"===_.property&&_.data.hasChildren()&&this.redraw(),this.invalidateData(_.data)},onPropertyChanged:function(M){var t=this,m=M.property;if(t.redraw(),"zoom"===m){var f=t.sm().getSelection();f.size()&&f.each(function(y){y.invalidate()})}else"dataModel"===m&&(t._83I=1);Am[m]?t.showScrollBar():m===bp&&t.onCurrentSubGraphChanged(M)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(C){var z=this,$=C.kind,P=C.data;if(z._83I=1,"add"===$)z.invalidateData(P),Cm(P)&&P.getEdgeGroup()&&P.getEdgeGroup().eachSiblingEdge(z.invalidateData,z),P.getHost&&P.getHost()&&P.getHost().updateLayoutAttaches();else if($===xs){z._21Q(P);var m=P._id,E=z._25I[m];if(E){if(z._56I[m]){var x=E._79o();x&&z.redraw(x)}E.dispose(),delete z._25I[m],delete z._24I[m],delete z._56I[m]}P===z._currentSubGraph&&z.setCurrentSubGraph(F)}else $===eo&&(z.invalidateAll(!0),z.setCurrentSubGraph(F))},_75O:function(L){this.invalidateData(L.data)},handleHierarchyChange:function(t){this.dm().isHierarchicalRendering()&&t.data.hasChildren()&&this.redraw(),this.invalidateData(t.data)},adjustIndex:function(v){var D=this;if(D.isVisible(v)){D.dm().beginTransaction();for(var V=v;V._parent&&D.isVisible(V._parent);)V=V._parent;V&&V!==v&&D._dataModel.adjustIndex(V),D._dataModel.adjustIndex(v),D.dm().endTransaction()}},getImage:function(t){return t.getImage?t.getImage():_},getSelectWidth:function(x){var v=ij(this.getImage(x));return v&&cs(v.disableSelectedBorder,x,this)?0:x.s("select.width")},getSelectColor:function(b){return b.s("select.color")},isSelectable:function(I,K){if(this.isSelected(I))return!0;if(!K&&I.getParent()instanceof rs&&this.isSelectable(I.getParent(),!0)&&I.getParent().isSyncSize())return!1;var f=this.getLayersInfo();if(f){var b=f[I._layer];if(b&&b.selectable===!1)return!1}return I.s("2d.selectable")&&this.sm().isSelectable(I)},isMovable:function(K){var d=this;if(Cm(K)&&K.getStyle(ss)!==Gf)return!1;var v=this.getLayersInfo();if(v){var H=v[K._layer];if(H&&H.movable===!1)return!1}return K.s("2d.movable")?d._movableFunc?d._movableFunc(K):!0:!1},isEditable:function(n){var C=this;if(V._uiSerializing)return C._uieditable;if(!C._editInteractor||!C.isSelected(n))return!1;if(Qb(n)){var b=C.getDataUI(n);if(!b||b._88I)return!1}if(Cm(n)&&n.getStyle(ss)!==Gf)return!1;var T=this.getLayersInfo();if(T){var X=T[n._layer];if(X&&X.editable===!1)return!1}return n.s("2d.editable")?C._editableFunc?C._editableFunc(n):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(H){return be(H)&&0!==H.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(H):!0},isRectEditable:function(A){return this._rectEditableFunc?this._rectEditableFunc(A):!0},isAnchorEditable:function(U){return this._anchorEditableFunc?this._anchorEditableFunc(U):!0},isRotationEditable:function(e){return e.setRotation&&e.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(e):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(v){var V=v.getAnchor(),F=v.getScale(),e=this._zoom,k=hm(v.getRotation(),0,-v.getHeight()*F.y*V.y-(F.y<0?-1:1)*(Zk?32:16)/e),q=v.p();return k.x+=q.x,k.y+=q.y,k},getLogicalPoint:function(g){var X=this;return hl(g,X._canvas,X.tx(),X.ty(),X._zoom,X._zoom)},getScreenPoint:function(g,V){var j,M=this;return"object"==typeof g?g.x!==_?(j=g.x,V=g.y):(j=g[0],V=g[1]):j=g,Sm(j,V,M._canvas,M.tx(),M.ty(),M._zoom,M._zoom)},getSelectedDataAt:function(P){var O=this;return this.getDataAt(P,function(T){return O.isSelected(T)})},getDataInfoAt:function(W,j,Q){var g,J=this.lp(W),G=this.getDataAt(J,j,Q);if(G){var d=this.getDataUI(G);g={data:G,ui:d,point:J};var p=d._38o;if(p){var D=p.icons;for(var X in D){var k=D[X],L=p.rects[X];if(L)for(var R=cs(k.names,G,this),U=R?R.length:0,r=L.rotation,E=U-1;E>=0;E--){var q=R[E],M=L[E];if(Hd(M,J,r))return g.part="icons",g.name=X,g.icon=q,g.rect=M,g.index=E,g.rotation=r,g}}}if(this.isNoteVisible(G)){if(d.note2Info&&Hd(d.note2Info.clickRect,J,F,d.note2Info.scale))return g.part="note2",g;if(d.noteInfo&&Hd(d.noteInfo.clickRect,J,F,d.noteInfo.scale))return g.part="note",g}if(this.isLabelVisible(G)){if(d.label2Info&&Hd(d.label2Info.rect,J,d.label2Info.rotation,d.label2Info.scale))return g.part="label2",g;if(d.labelInfo&&Hd(d.labelInfo.rect,J,d.labelInfo.rotation,d.labelInfo.scale))return g.part="label",g}if(G.isInRect&&G.isInRect(J))return g.part="body",g}return g},getDataAt:function(y,T,F){y.target&&(y=this.lp(y));var I,Z=this._zoom;return this.reverseEach(function(w){return(T?T(w):this.isSelectable(w))&&this.rectIntersects(w,ac(y.x,y.y,F,Z))?(I=w,!1):void 0},this),I},getIconInfoAt:function(f,$){var r=this;if(f.target&&(f=r.lp(f)),$||($=r.getDataAt(f)),$){var j=r.getDataUI($);if(j&&j._38o){var H,S=j._38o,N=new _n;for(H in S.icons)N.add(H);for(var G=N.size()-1;G>=0;G--){H=N.get(G);for(var y=S.rects[H],B=y.rotation,s=y.length-1;s>=0;s--){var k=y[s],Z=k.width,W=k.height,I={x:f.x-k.x-Z/2,y:f.y-k.y-W/2};B!=F&&(I=hm(-B,I.x,I.y));var k={x:-Z/2,y:-W/2,width:Z,height:W};if(Hd(k,I))return{key:H,index:s,name:S.icons[H].names[s],rect:y[s],point:f,rotation:B,relativeRect:k,relativePoint:I,data:$}}}}}return F},getDatasInRect:function(E,H,r){r===_&&(r=1);var k=this,Q=new _n;return k.reverseEach(function(q){r&&!k.isSelectable(q)||(H?k.rectIntersects(q,E):k.rectContains(q,E))&&Q.add(q)}),Q},moveSelection:function(c,W){var f=this;f.dm().beginTransaction(),mr(f.sm().toSelection(f.isMovable,f),c,W),f.dm().endTransaction()},moveDatas:function(N,v,y){var A=this;A.dm().beginTransaction(),N instanceof _n||(N=new _n(N)),mr(N,v,y),A.dm().endTransaction()
},getDataUIBounds:function(h){var Q=this.getDataUI(h);return Q?Q._79o():F},drawData:function(T,k,B){var R=this.getDataUI(k);if(R){var L=R._79o();(!B||Yq(B,L))&&(R._42(T),k instanceof V.Block&&k.eachChild(function(u){this.isVisible(u)&&this.drawData(T,u,B)},this))}},getBoundsForGroup:function(x){return x.s($d)?this.getDataUIBounds(x):F},isPixelPerfect:function(R){return R.s("pixelPerfect")},rectIntersects:function(K,Y){this.validate();var J=F;if(this._56I[K._id]){var P=this._25I[K._id];if(P){var O=P._79o();if(gj(Y,O))J=!0;else if((Y=Qp(Y,O))&&(P.rectIntersects&&(J=P.rectIntersects(Y)),J==F)){if(!this.isPixelPerfect(K))return!0;var h=Y.x,s=Y.y,B=Y.width,u=Y.height,I=this._zoom,a=C.hitMaxArea,p=B*u*I*I;if(p>a){var e=Math.sqrt(a/p);I*=e}B*=I,u*=I,2>B&&(B=2),2>u&&(u=2),h*=I,s*=I;var v=af(B,u);zg(v,-h,-s),v.scale(I,I),this._drawForChecking=!0,this.drawData(v,K,Y),this._drawForChecking=!1;try{for(var A=0,Z=v.getImageData(0,0,B,u).data;A<Z.length;A+=4)if(0!==Z[A+3]){J=!0;break}v.restore()}catch(T){dc=F,J=!1}}}}return J?!0:!1},rectContains:function(z,v){if(this._56I[z._id]){var C=this._25I[z._id];if(C)return gj(v,C._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(Z){if(!C.isInput(Z.target)){var r=this,U=r._focusData,l=U&&r._25I[U._id],O=0,F=r._dataModel._datas;if(!(U&&U._enabled&&U._editable&&l&&l.onKeyDown&&l.onKeyDown(Z)===!0))if(9===Z.keyCode&&(U&&(O=F.indexOf(U),er(Z)?-1===--O&&(O=0):++O===F.size()&&(O=0)),r._focusData=U=F.get(O),r.sm().setSelection(U)),Oh(Z)?r.selectAll():pc(Z)&&r.isResettable()&&r.reset(),r.sm().isEmpty()){if(r._editing)return;var H=r.tx(),q=r.ty(),o=!1,D=er()?100:10;Re(Z)&&(H-=D,o=!0),Wk(Z)&&(q-=D,o=!0),se(Z)&&(H+=D,o=!0),mo(Z)&&(q+=D,o=!0),o&&r.setTranslate(H,q)}else{sl(Z)&&r.handleDelete(Z);var d=er()?10:1;Re(Z)&&(r.moveSelection(-d,0),r.fi({kind:"moveLeft"})),Wk(Z)&&(r.moveSelection(0,-d),r.fi({kind:"moveUp"})),se(Z)&&(r.moveSelection(d,0),r.fi({kind:"moveRight"})),mo(Z)&&(r.moveSelection(0,d),r.fi({kind:"moveDown"}))}}},handleScroll:function(e,i){if(Qq(e),this.isZoomable()){if(!this.getEditInteractor()){var N=this.getDataAt(e);if(N){var $=ij(this.getImage(N));if($&&cs($.scrollable,N,this))return}}var W=this.lp(e);i>0?this.scrollZoomIn(W):0>i&&this.scrollZoomOut(W)}},handlePinch:function(y,K,$){this.isZoomable()&&(Math.abs(K-$)<C.pinchZoomThreshold||(K>$?this.pinchZoomIn(y):this.pinchZoomOut(y)))},checkDoubleClickOnNote:function(T,L){var R=this,Z=R.lp(T),$=R.getDataUI(L),w=$.note2Info;return w&&L.s("note2.toggleable")&&Hd(w.clickRect,Z)?(L.s(Op,!L.s(Op)),R.fi({kind:"toggleNote2",event:T,data:L}),!0):(w=$.noteInfo,w&&L.s("note.toggleable")&&Hd(w.clickRect,Z)?(L.s(nh,!L.s(nh)),R.fi({kind:"toggleNote",event:T,data:L}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(L,m){var $=this,z=$.getAutoScrollZone(),D=z/$.getZoom(),t=z/4,N=$._29I,y=$.lp(L),e={x:$.tx(),y:$.ty()};return y&&z>0&&N&&(y.x-N.x<D?$.translate(t,0):N.x+N.width-y.x<D&&$.translate(-t,0),y.y-N.y<D?$.translate(0,t):N.y+N.height-y.y<D&&$.translate(0,-t)),e.x=$.tx()-e.x,e.y=$.ty()-e.y,m&&(m.x+=e.x,m.y+=e.y),e},getMoveMode:function(O,N){var w=N.s("2d.move.mode");return w?w:Wc["88"]?"x":Wc["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(A,k,U){var E=this;return"currentSubGraph"===k?{__i:A.getId()}:U.serializeProperty(A,k,E)},deserializeProperty:function(z,C,e){var G=this;if("currentSubGraph"===C){var W=G.dm(),o=W.__idMap;return o[z.__i]}return e.deserializeProperty(z,C,G)},setDefaultCursor:function(U,l){this._defaultCursor=U,l!==!1&&this.setCursor(U)},setCursor:function(R){"default"===R&&(R=this._defaultCursor||R);var j=this.getView().style;j.cursor=R,j.cursor="-webkit-"+R,j.cursor="-moz-"+R},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(n){return n===F||C.getConnectAction(null,n)?(this._currentActionType=n,this.redraw(),!0):!1},getEditStyle:function(X){var g=this.getEditInteractor();return g?g.getStyle(X):_},setEditStyle:function(H,G,E){var M=this.getEditInteractor();return M?(M.setStyle(H,G,E),!0):!1},isConnectActionVisible:function(T){var M=C.getConnectAction(this);if(!M)return!1;var j=M.visible;return ne(j)&&(j=j(this,T)),j},isInteractive:function(d){if(this._drawForChecking)return!1;var s=ij(this.getImage(d));return s&&cs(s.interactive,d,this)?!0:d.s("interactive")},appendHTML:function(s,G){var M=this.getView();if(!(G||s&&s.parentNode!==M))return!1;var C=s.getView&&s.getView(),y=s.beforeCanvas;if(!G&&C&&C.parentNode===M)return!1;(s.getView||s.isSelfViewEvent)&&(s=s.getView());var I=this.getEditInteractor();return y?M.insertBefore(s,this.getCanvas()):I&&I._canvas?M.insertBefore(s,I._canvas):this.isScrollBarVisible()?M.insertBefore(s,this.getView().lastChild):of(M,s),!0},_layoutHTMLImpl:function($,i,Z){if(arguments.length>1){var f,H=this,C=H._zoom;if(i.getView&&(f=i,i=i.getView()),i.style.position="absolute",Z){var Y=$.getRect();mm(f||i,H.tx()+Y.x*C,H.ty()+Y.y*C,Y.width*C,Y.height*C)}else{var X=new Mm,Y=$.getAnchorRect(),x=$.getPosition(),y=$.getScale(),e=i.style;mm(f||i,Y),X.appendTranslate(H.tx(),H.ty()),X.appendScale(C,C),X.append(new Mm($.getRotation(),x.x,x.y,y.x,y.y)),Rq(e,"transform","matrix("+X.a.toFixed(5)+", "+X.b.toFixed(5)+", "+X.c.toFixed(5)+",\n    "+X.d.toFixed(5)+", "+X.tx.toFixed(5)+", "+X.ty.toFixed(5)+")"),Rq(e,"transformOrigin",(-Y.x).toFixed(5)+"px "+(-Y.y).toFixed(5)+"px"),i.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(Y){return Y instanceof Jj?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(w){var t="state",l=w.s(t);if(l)return l;var i=ij(w._image);return i?cs(i[t],w,this)||null:void 0},getShape:function(Y){return Y.getStyle(eg)}}),f.defineProperties(Rp.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(r){this._layoutHTML=r}}});var $j=function(D,J){var b=this;b.gv=D,b.s=function(B){return J.getStyle(B)},b._data=J,b._87I=new _n};cd($j,f,{_6I:F,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var l=this,A=l.gv.isSelected(l._data);return!A||l.isShadowed()?0:l.gv.getSelectWidth(l._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(H){var p=this._data,S=this.gv.getBodyColor(p);return S?S:H?p.getStyle(H):F},_2Q:function(D){return this.s(D)},_1Q:function(q,g,O,N){var c=this.s,P=c("2d.gray"),E=c(g+".dash.color");if(P&&(E=C.toGrayColor(E)),q.strokeStyle=E,q.lineWidth=O,q.stroke(),c(g+".dash.3d")){var W=c(g+".dash.3d.color");kq(q,E,P?C.toGrayColor(W):W,O,this.gv._zoom,c(g+".dash.3d.accuracy"))}Gk(q,N)},invalidate:function(){this._6I=F},_79o:function(){var j=this;if(!j._6I){var r=j._data,a=j.gv;j.labelInfo=j.label2Info=j.noteInfo=j.note2Info=j._38o=F,j._87I.clear(),j.interactiveInfo=a.isInteractive(r)?{}:F,j._3O(),j._55O=a.isEditable(r)?{_42O:a.isRectEditable(r),_43O:a.isPointEditable(r),_56O:a.isRotationEditable(r)}:F,j._6I=j._81o()}return j._6I},_3O:function(){},getPosition:function(){return wq},_68o:function(y,f){y&&this._87I.add(ue(y,f))},_81o:function(){var x=this,e=x.s;x._24O(Mi,"getLabel"),x._24O(Nb,"getLabel2"),x._26O(Jm,"getNote"),x._26O(Eq,"getNote2"),x._15O(),x._55O&&x._48O();var o;if(x._87I.each(function(k){o=ti(o,k)}),o){var y=x.isShadowed(),s=e("shadow2"),q=Hq(o);s?(q.x+=e("shadow2.offset.x"),q.y+=e("shadow2.offset.y"),ps(q,e("shadow2.blur"))):y&&(q.x+=e("shadow.offset.x"),q.y+=e("shadow.offset.y"),ps(q,e("shadow.blur"))),o=ti(o,q)}return x._87I.clear(),o},_42:function(X){var z=this,h=z._data,E=z.gv,R=z.s,K=R("opacity"),V=this.isShadowed(),Z=R("shadow2");if(V||Z){var O=X.shadowOffsetX,Y=X.shadowOffsetY,D=X.shadowBlur,W=X.shadowColor,T=E.getZoom()*C.devicePixelRatio,w=V?"shadow":"shadow2";X.shadowOffsetX=R(w+".offset.x")*T,X.shadowOffsetY=R(w+".offset.y")*T,X.shadowBlur=R(w+".blur")*T,X.shadowColor=V?z.getSelectColor():R(w+".color")}if(K!=F){var y=X.globalAlpha;X.globalAlpha=K}z._80o(X),E.isLabelVisible(h)&&((!E._drawForChecking||R("label.selectable"))&&Sf(X,z.labelInfo),(!E._drawForChecking||R("label2.selectable"))&&Sf(X,z.label2Info)),E.isNoteVisible(h)&&(Sl(X,z.noteInfo),Sl(X,z.note2Info)),z._99O(X),K!=F&&(X.globalAlpha=y),(V||Z)&&(X.shadowOffsetX=O,X.shadowOffsetY=Y,X.shadowBlur=D,X.shadowColor=W)},_80o:function(){},_47O:function(){},_24O:function(P,D){var v=this,R=v._data,N=v.gv,b=v.s,W=N[D](R);if(W!=F){var m=b(P+".scale"),I=b(P+".max"),E=b(P+".position"),u=v[P+"Info"]={label:W,scale:m,color:N[D+"Color"](R),font:b(P+".font"),opacity:b(P+".opacity"),align:b(P+".align"),rotation:v.getRotation(b(P+".rotation"),!1,E),background:N[D+"Background"](R)},x=Wp(u,W);I>0&&I<x.width&&(u.labelWidth=x.width,x.width=I),1!==m&&(x.width*=m,x.height*=m);var G=v.getPosition(E,b(P+".offset.x"),b(P+".offset.y"),x,b(P+".position.fixed"));if(x.x=G.x-x.width/2,x.y=G.y-x.height/2,v._68o(u.rect=x,u.rotation),1!==m){var B=x.width/m,C=x.height/m;u.rect={x:G.x-B/2,y:G.y-C/2,width:B,height:C}}}},_26O:function(v,p){var f=this,Y=f.gv,M=f._data,L=f.s,H=Y[p](M);if(H!=F){var P,u,o=L(v+".scale"),d=f[v+"Info"]={note:H,scale:o,data:M,view:Y,expanded:L(v+".expanded"),font:L(v+".font"),color:L(v+".color"),opacity:L(v+".opacity"),align:L(v+".align"),icon:L(v+".icon"),backgroundImage:L(v+".backgroundImage"),borderWidth:L(v+".border.width"),borderColor:L(v+".border.color"),background:Y[p+"Background"](M)},C=f.getPosition(L(v+".position"),L(v+".offset.x"),L(v+".offset.y")),w=C.x,X=C.y;if(d.expanded){var l,D=L(v+".max"),m=L(v+".backgroundImage");m?(m=ij(m),l={width:ob(m,M),height:$n(m,M)}):l=Wp(d,H),l.width+=6,l.height+=2,D>0&&D<l.width&&(d.labelWidth=l.width,l.width=D),P=l.width,u=l.height+8,d.clickRect={x:w-P*o/2,y:X-u*o,width:P*o,height:u*o*l.height/u}}else{var S=L(v+".icon");S?(S=ij(S),P=ob(S,M),u=$n(S,M)):(P=12,u=18),d.clickRect={x:w-P*o/2,y:X-u*o,width:P*o,height:u*o}}d.rect={x:w-P/2,y:X-u*o/2-u/2,width:P,height:u};var R=c(d.borderWidth/2)*o;f._68o({x:w-P*o/2-R,y:X-u*o-R,width:P*o+2*R,height:u*o+2*R})}},_48O:function(){},_99O:function(m){var K=this,u=K._38o;if(u){var I=K.gv,s=K._data,M=u.icons,C=K.interactiveInfo;C&&(C._38o={});for(var n in M){var L=M[n],y=u.rects[n];if(y){C&&(C._38o[n]=[]);var S=cs(L.opacity,s,I),B=cs(L.names,s,I),V=B?B.length:0,g=y.rotation;if(S!=F){var b=m.globalAlpha;m.globalAlpha*=S}for(var o=0;V>o;o++){var c=B[o],R=ij(c),t=y[o];if(g){var d=t.x+t.width/2,_=t.y+t.height/2;m.save(),zg(m,d,_),_g(m,g),zg(m,-d,-_)}C&&C._38o[n].push(m.interactiveInfo={compInfos:[],matrix:g?new Mm(g,d,_).appendTranslate(-d,-_):new Mm}),qs(m,R,cs(L.stretch,s,I),t.x,t.y,t.width,t.height,K._data,K.gv),m.interactiveInfo=F,g&&m.restore()}S!=F&&(m.globalAlpha=b)}}}}});var up=function(f,X){tl(up,this,[f,X])};cd(up,$j,{_checkEmptyRect:!0,_40O:function(x,S){var U=this,m=U.s,H=x.rect;(x.borderColor=U.gv.getBorderColor(U._data))&&(x.borderType=m("border.type"),x.borderWidth=m("border.width"),x.borderPadding=m("border.padding"),S=i(S,x.borderPadding+x.borderWidth/2));var l=U._data.getScale(),d=i(1,i(D(l.x),D(l.y)));if(x.selectWidth=U.getSelectWidth()){var y=U.gv._zoom;x.selectType=m("select.type"),x._97o=U.getSelectColor(),x.selectPadding=m("select.padding"),S=i(S,(x.selectPadding+x.selectWidth/2/y)/d)}S>0&&(S*=d,H=Hq(H),ps(H,S)),U._68o(H)},_39O:function(h,W){var x,V=this,o=W.rect;if(W.borderWidth>0&&(x=W.borderPadding,h.strokeStyle=W.borderColor,h.lineWidth=W.borderWidth,Gr(h,W.borderType,{x:o.x-x,y:o.y-x,width:o.width+2*x,height:o.height+2*x}),h.stroke()),W.selectWidth>0){var R=V.gv._zoom;if(x=W.selectPadding,h.strokeStyle=W._97o,h.lineWidth=W.selectWidth/R,W.rotation!=F){h.save(),h.translate(W.position.x,W.position.y),h.rotate(W.rotation);var P=V._data,w=P.getWidth(),f=P.getHeight(),v=W.scale,t=W.anchor;o={x:v.x*-w*t.x,y:v.y*-f*t.y,width:v.x*w,height:v.y*f}}Gr(h,W.selectType,{x:o.x-x,y:o.y-x,width:o.width+2*x,height:o.height+2*x}),W.rotation!=F&&h.restore(),h.stroke()}},dispose:function(){var E=this,B=E._htmlView;up.superClass._3O.call(E),B&&(B.onHTMLRemoved&&B.onHTMLRemoved(),Ol(B))},_3O:function(){var Z,j=this,k=j.s,O=j._data,q=j.gv,f=q.getShape(O),n=j.getBodyColor(),H=k("shape.border.color"),A=j._83o=f?{shape:f,_53o:j.getBodyColor("shape.background"),_27Q:ij(k("shape.repeat.image"),n),shapeGradientPack:k("shape.gradient.pack"),_54o:k("shape.border.width"),_55o:H,shapeBorderRepeatImage:ij(k("shape.border.repeat.image"),H),_56o:k("shape.border.3d"),_57o:k("shape.border.3d.color"),_58o:k("shape.border.3d.accuracy"),shapeGradient:k("shape.gradient"),_59o:k("shape.gradient.color"),_60o:k("shape.border.pattern"),_61o:k("shape.border.cap"),_62o:k("shape.border.join"),shapeForeground:k("shape.foreground"),bodyColor:n,gray:k("2d.gray")}:{img:ij(q.getImage(O),n),bodyColor:n,gray:k("2d.gray"),stretch:k("image.stretch")},w=A.img;w&&w.renderHTML?(j._htmlInfo&&j._htmlInfo.img!==w&&(j._htmlInfo=F),j._htmlInfo||(j._htmlInfo={img:w,cache:{}}),Z=w.renderHTML(O,q,j._htmlInfo.cache)):j._htmlInfo=F,j._htmlView&&j._htmlView!==Z&&(j._htmlView.onHTMLRemoved&&j._htmlView.onHTMLRemoved(),Ol(j._htmlView.getView?j._htmlView.getView():j._htmlView)),(j._htmlView=Z)&&q.appendHTML(Z)&&(Z.onHTMLAddedSync&&Z.onHTMLAddedSync(),Z.onHTMLAdded&&Vp(Z.onHTMLAdded)),A.rect=O.getRect(),A.position=O.p(),A.scale=O.getScale(),A.anchor=O.getAnchor(),A.rotation=O.getRotation(),f===pi&&(A._63o=k("shape.depth"));var d=0;if(f)d=Jb(F,A._54o/2,A._62o),j.s("shape.dash")&&(d=i(d,(j.s("shape.dash.width")||A._54o)/2));else if(w&&w.boundExtend)if(d=cs(w.boundExtend,O,q),w.boundExtendAbsolute){var s=O.getScale();d/=q._zoom*i(1,i(D(s.x),D(s.y)))}else if(!cs(w.fitSize,O,q)){var o=cs(w.width,O,q),a=cs(w.height,O,q);d*=i(O.getWidth()/o,O.getHeight()/a)}j._40O(A,d);var N=ei(O,q.isSelected(O)),x=k("clip.percentage");if(1>x&&(0>x&&(x=0),A.clipRect=un(O.getAnchorRect(),k("clip.direction"),x,N)),f){var B=k("shape.fill.clip.percentage");1>B&&(0>B&&(B=0),A.shapeClipRect=un(O.getAnchorRect(),k("shape.fill.clip.direction"),B,N));var u=k("shape.foreground.clip.percentage");1>u&&(0>u&&(u=0),A.shapeForegroundClipRect=un(O.getAnchorRect(),k("shape.foreground.clip.direction"),u,N))}},getPosition:function(s,w,Y,t){var O=Vf(s,this._83o.rect,t);return O.x+=w,O.y+=Y,O},_80o:function(I){var J=this,t=J.s,N=J.gv,q=J._data,n=J._83o,g=n.rect,B=n.position,e=n.rotation,M=n.anchor,Z=n.scale,h=n.shape,z=n.clipRect;if(!J._checkEmptyRect||g.width>0&&g.height>0){var P=q.getSize();if(P.x=-P.width*M.x,P.y=-P.height*M.y,Lp&&!Mk&&zg(I,P.width,P.height),I.save(),zg(I,B.x,B.y),_g(I,e),qf(I,Z.x,Z.y),z&&(I.beginPath(),I.rect(z.x,z.y,z.width,z.height),I.clip()),N._drawForChecking&&n.img&&cs(n.img.pixelPerfect,q,N)===!1)Qm(I,P.x,P.y,P.width,P.height,"#888888");else if(J.freeDraw)J.freeDraw(I,P,n);else if(h){var b,D,a,s,p=n._60o,V=dl(I,p),A=n._27Q,d=n._54o,k=n.shapeGradientPack,o=n.gray,O=I.lineJoin,$=I.lineCap,T=function(A){return o?C.toGrayColor(A):A};"roundRect"===h?b=t("shape.corner.radius"):"polygon"===h?b=t("shape.polygon.side"):"arc"===h&&(b=t("shape.arc.from"),D=t("shape.arc.to"),a=t("shape.arc.close"),s=t("shape.arc.oval")),I.lineJoin=n._62o,I.lineCap=n._61o;var Y=T(n._53o);if(Y||A||k){var L=n.shapeClipRect;L&&(I.save(),I.beginPath(),I.rect(L.x,L.y,L.width,L.height),I.clip()),Gr(I,h,P,b,D,a,s),k?Th(I,k,function(j){return vo(j,n.bodyColor)}):A?Mq(I,A,T(n.bodyColor),null,q,N):Uf(I,Y,n.shapeGradient,T(n._59o),P),I.fill(),k&&I.restore(),L&&I.restore(),I!==V&&Gr(V,h,P,b,D,a,s)}else Gr(V,h,P,b,D,a,s);var S=n.shapeForeground;if(S){I.save();var j=n.shapeForegroundClipRect;j&&(I.beginPath(),I.rect(j.x,j.y,j.width,j.height),I.clip()),Gr(I,h,P,b,D,a,s),Uf(I,S,t("shape.foreground.gradient"),T(t("shape.foreground.gradient.color")),P),I.fill(),I.restore()}if(d>0){var v=t("shape.border.width.absolute");v&&(I.save(),I.setTransform(1,0,0,1,0,0)),I.lineWidth=d;var G=T(n._55o);n.shapeBorderRepeatImage?hs(I,n.shapeBorderRepeatImage,G,null,q,N):I.strokeStyle=G,I.stroke(),v&&I.restore(),n._56o&&kq(I,G,T(n._57o),d,N._zoom,n._58o)}if(Gk(I,p),t("shape.dash")){var W=t("shape.dash.width")||d;if(W>0){p=t("shape.dash.pattern");var V=dl(I,p,J._2Q("shape.dash.offset"));V!==I&&Gr(V,h,P,b,D,a,s),J._1Q(I,"shape",W,p)}}fs(I,Y,n._63o,P),I.lineJoin=O,I.lineCap=$}else{var r=J.interactiveInfo;r&&(I.interactiveInfo=r.bodyInfo={compInfos:[],matrix:new Mm(e,B.x,B.y,Z.x,Z.y)}),n.gray&&(I.compGray=!0);var i=n.img;i&&i.cacheRule!=F&&(i=zd(I,i,n.stretch,P.width,P.height,q,N,n.bodyColor)),qs(I,i,n.stretch,P.x,P.y,P.width,P.height,q,N,n.bodyColor),I.compGray=!1,I.interactiveInfo=F}I.restore()}J._39O(I,n)},_48O:function(){},_47O:function(){}});var ym=function(P,s){tl(ym,this,[P,s])},Gj=function(n,s,C,g){var m=kj(n,s);return C=g?B(C,m):Yr(C,m),m?C/=m:C=0,{x:n.x+(s.x-n.x)*C,y:n.y+(s.y-n.y)*C}};cd(ym,$j,{_3O:function(){var j,q=this,r=q._data,R=q.gv,w=q.s,S=w(ss),G=r.isLooped(),d=w("edge.width"),Q=q.getBodyColor("edge.color"),V=w("edge.center"),U=w("edge.offset"),y=R.getBorderColor(r),v=y?w("border.width"):0,Z=q.getSelectWidth(),h=r._40I,P=r._41I,J=q._78o=h&&P?{looped:G,type:S,width:d,center:V,color:Q,repeatImage:ij(w("edge.repeat.image"),Q),borderColor:y,borderWidth:v,_97o:Z?q.getSelectColor():F,selectWidth:Z,pattern:w("edge.pattern"),cap:w("edge.cap"),join:w("edge.join"),is3d:w("edge.3d"),_67o:w("edge.3d.color"),_66o:w("edge.3d.accuracy"),gray:w("2d.gray")}:F;if(J){var c=C.getEdgeType(S);if(c){var K=c(r,Ki(q,R,r,G,S),R,q._19Q);K.points&&K.points.size()>1?(J.edgeTypeInfo=K,j=np(J.edgeTypeInfo.points)):K[op]&&K.rect&&(J.edgeTypeInfo=K,j=K.rect)}else{var B=w("edge.source.anchor.x"),E=w("edge.source.anchor.y"),e=w("edge.target.anchor.x"),s=w("edge.target.anchor.y"),M=Lg(R,r,"source"),l=Lg(R,r,"target");if(S===Gf){var L=J.points=w(rn)||En,O=L.size();J.segments=w("edge.segments");var n=B!==_||E!==_||Cm(h),W=e!==_||s!==_||Cm(P);if(!V)if(U)n||(M=Gj(M,O?L.get(0):l,U,O)),W||(l=Gj(l,O?L.get(O-1):M,U,O));else{var t;n||(t=Io(M,O?L.get(0):l,Yc(R,h)),t&&(M={x:t[0],y:t[1]})),W||(t=Io(O?L.get(O-1):M,l,Yc(R,P)),t&&(l={x:t[0],y:t[1]}))}j=ti(np(J.points),np(M,l))}else{var I=Ki(q,R,r,G,S);if(q._19Q||(I=-I),G)M=Hq(M),M.x=R.getNodeRect(h).x,J.radius=I,j={x:M.x-I,y:M.y-I,width:2*I,height:2*I};else{var p=kj(M,l),$=Yr(U,p),o={x:$,y:I},z={x:p-$,y:I},m=ub(l.y-M.y,l.x-M.x),H=J.mat=new Ai(m);if(J.orienAngle=m,J.angle=l.x<M.x?m+Y:m,J.rect={x:o.x,y:o.y,width:z.x-o.x,height:0},J.origin=M,o=H.tf(o),o.x+=M.x,o.y+=M.y,z=H.tf(z),z.x+=M.x,z.y+=M.y,V){var a={x:p,y:0};a=H.tf(a),a.x+=M.x,a.y+=M.y,j=np([M,o,z,a]),J.c1=M,J.c2=a}else j=np(o,z);M=o,l=z}}J.sourcePoint=M,J.targetPoint=l,r._lastSourcePoint=M,r._lastTargetPoint=l}var x=0;w("edge.dash")&&(x=w("edge.dash.width")||d);var g="square"===J.cap?.71:.5;Jb(j,i(x*g,d*g+v+Z),J.join),q._68o(j)}},getRotation:function(e,z,G){e=e||0;var d=this._78o;if(d){var u,i=d.angle,s=d.points,C=d.edgeTypeInfo;if(i!=F)return z?d.orienAngle+e:i+e;if(C&&C[op])return C.getRotation?C.getRotation(this,e,z,G):0;if(C&&C.points){var N=C.points;return u=N.size(),Rd[G]?u&&0===u%2?po(N.get(u/2-1),N.get(u/2),z,e):e:vm[G]?po(N.get(0),N.get(1),z,e):po(N.get(u-2),N.get(u-1),z,e)}if(s)return u=s.size(),Rd[G]?u&&0===u%2?po(s.get(u/2-1),s.get(u/2),z,e):e:vm[G]?po(d.sourcePoint,u?s.get(0):d.targetPoint,z,e):po(u?s.get(u-1):d.sourcePoint,d.targetPoint,z,e)}return e},getPosition:function(T,f,K,k,U){var Q=this._78o;if(Q){var s,L=Q.type,A=Q.points,g=Q.edgeTypeInfo,_=Q.sourcePoint,o=Q.targetPoint;if(!L)return Q.looped?{x:_.x-Q.radius+f,y:_.y+K}:(U&&_&&o&&(_.x>o.x||_.x===o.x&&_.y>o.y)&&(T=xh[T],K=-K),s=Vf(T,Q.rect,k),s.x+=f,s.y+=K,s=Q.mat.tf(s),s.x+=Q.origin.x,s.y+=Q.origin.y,s);if(g&&g[op])return g.getPosition?g.getPosition(this,T,f,K,k,U):{x:(_.x+o.x)/2,y:(_.y+o.y)/2};if(A){var s,p=A.size();if(Rd[T]){if(p){var S=p%2;if(0===S)return Xj(A.get(p/2-1),A.get(p/2),T,f,K,k,U);s=A.get((p-S)/2)}else s={x:(_.x+o.x)/2,y:(_.y+o.y)/2};return s=Vf(T,{x:s.x,y:s.y,width:0,height:0},k),s.x+=f,s.y+=K,s}return vm[T]?Xj(_,p?A.get(0):o,T,f,K,k,U):Xj(p?A.get(p-1):_,o,T,f,K,k,U)}if(g){var R=g.points,p=R.size();if(Rd[T]){var S=p%2;return 0===S?Xj(R.get(p/2-1),R.get(p/2),T,f,K,k,U):(s=R.get((p-S)/2),s=Vf(T,{x:s.x,y:s.y,width:0,height:0},k),s.x+=f,s.y+=K,s)}return vm[T]?Xj(R.get(0),R.get(1),T,f,K,k,U):Xj(R.get(p-2),R.get(p-1),T,f,K,k,U)}}return wq},_42:function(h){this._78o&&ym.superClass._42.call(this,h)},drawPath:function(V,F){V.beginPath();var H=F.type,e=F.points,s=F.segments,f=F.edgeTypeInfo;if(!H||e){var p=F.sourcePoint,i=p.x,o=p.y,$=F.targetPoint,j=$.x,Q=$.y;if(H)if(s){var r=new _n({x:i,y:o});r.addAll(e),r.add({x:j,y:Q}),Mf(V,r,s)}else V.moveTo(i,o),e.each(function(o){V.lineTo(o.x,o.y)}),V.lineTo(j,Q);else F.looped?V.arc(i,o,F.radius,0,E,!0):F.center?(V.moveTo(F.c1.x,F.c1.y),V.lineTo(i,o),V.lineTo(j,Q),V.lineTo(F.c2.x,F.c2.y)):(V.moveTo(i,o),V.lineTo(j,Q))}else f&&(f.points?Mf(V,f.points,f.segments):f[op]&&f[op](V,f))},_80o:function(e){var i=this,c=i.s,q=i._78o,R=q.width,S=q.selectWidth,L=q.borderWidth,H=q.repeatImage,n=e.lineJoin,B=e.lineCap,v=q.gray,r=q.pattern;e.lineJoin=q.join,e.lineCap=q.cap,i.drawPath(dl(e,r),q);var U=c("edge.width.absolute");U&&(e.save(),e.setTransform(1,0,0,1,0,0)),S&&(e.strokeStyle=q._97o,e.lineWidth=R+2*(L+S),e.stroke()),L&&(e.strokeStyle=v?C.toGrayColor(q.borderColor):q.borderColor,e.lineWidth=R+2*L,e.stroke());var M=v?C.toGrayColor(q.color):q.color;if(H?hs(e,H,M,null,i._data,i.gv):e.strokeStyle=M,e.lineWidth=R,e.stroke(),q.is3d){var j=v?C.toGrayColor(q._67o):q._67o;kq(e,M,j,R,i.gv._zoom,q._66o)}if(Gk(e,r),c("edge.dash")){r=c("edge.dash.pattern");var Q=dl(e,r,i._2Q("edge.dash.offset"));Q!==e&&i.drawPath(Q,q),i._1Q(e,"edge",c("edge.dash.width")||R,r)}U&&e.restore(),e.lineJoin=n,e.lineCap=B},_48O:function(){},_47O:function(){}});var Bo=function(_,S){tl(Bo,this,[_,S])};cd(Bo,up,{_3O:function(){var c,L,j=this,i=j.s,y=j._data,W=j.gv;if(j._88I=F,y.isExpanded()&&y.eachChild(function(I){if(be(I)){var $=W.getBoundsForGroup(I);$&&(L||(L=[]),L.push($),c=ti(c,$))}}),c){var B=W.getLabel(y),w=i("group.type"),$=i("group.border.width")||0,I=i("group.border.width.absolute"),T=$/2;I&&($/=W._zoom),c=kf(w,L,c),sr(c,y,"group.padding",1),ps(c,$);var V=j._88I={type:w,rect:c,_64o:c};if(!w&&B!=F){var p,Z=j.labelInfo={label:B,color:i("group.title.color"),font:i("group.title.font"),align:i("group.title.align")},J=Wp(Z,B),N=J.width+$,A=J.height+$,O=i("group.title.align"),t=i("group.title.orientation");if(t===Ob||t===fe?(c.height+=$,N>c.width&&(c.width=N)):(t===aq||t===zc)&&(c.width+=$,N>c.height&&(c.height=N)),p=O===aq?c.x:O===zc?c.x+c.width-N:c.x+c.width/2-N/2,t===fe)V.titleRect={x:c.x,y:c.y+c.height,width:c.width,height:A},V.rect={x:c.x,y:c.y,width:c.width,height:c.height+A},Z.rect={x:p,y:c.y+c.height,width:N,height:A};else if(t===aq){var S=V.titleRect={x:c.x-A,y:c.y,width:A,height:c.height};V.rect={x:c.x-A,y:c.y,width:c.width+A,height:c.height},Z.rect={x:S.x+A/2-c.height/2,y:S.y+c.height/2-A/2,width:c.height,height:A},Z.rotation=-Math.PI/2}else if(t===zc){var S=V.titleRect={x:c.x+c.width,y:c.y,width:A,height:c.height};V.rect={x:c.x,y:c.y,width:c.width+A,height:c.height},Z.rect={x:S.x+A/2-c.height/2,y:S.y+c.height/2-A/2,width:c.height,height:A},Z.rotation=Math.PI/2}else V.titleRect={x:c.x,y:c.y-A,width:c.width,height:A},V.rect={x:c.x,y:c.y-A,width:c.width,height:c.height+A},Z.rect={x:p,y:c.y-A-T,width:N,height:A+$}}j._40O(V,i("group.border.width")/2)}else Bo.superClass._3O.call(j)},getPosition:function(k,X,L,W){var E=this._88I;if(E){var K=Vf(k,E.rect,W);return K.x+=X,K.y+=L,K}return Bo.superClass.getPosition.apply(this,arguments)},_24O:function(Z,u){var A=this._88I;(!A||A.type||"label2"===Z)&&Bo.superClass._24O.call(this,Z,u)},_80o:function(Q){var E=this,l=E._88I;if(l){var d=E._data,V=E.s,n=E.gv,C=l.type,Z=l.rect,q=l._64o,f=l.titleRect,w=E.getBodyColor(),F=ij(V("group.image"),w),m=V("group.image.stretch"),b=E.getBodyColor("group.background"),N=ij(V("group.repeat.image"),w),X=V("group.gradient.pack"),G=V("group.gradient"),D=V("group.gradient.color"),P=V("group.border.width"),$=V("group.border.color"),k=V("group.border.pattern"),g=V("group.title.orientation"),H=V("group.depth"),i=V("group.border.radius"),O=V("group.border.join"),u=V("group.border.cap"),Y=V("group.border.width.absolute");Y&&(P/=n._zoom);var W=$,K=V("group.border.repeat.image");if(K&&(K=ij(K,$))&&(W=jr(Q,K,$,null,d,n)),C){var S=Q.lineJoin,p=Q.lineCap;if(Q.lineJoin=O,Q.lineCap=u,F){if(Q.save(),Gr(Q,C,Z,i),Q.clip(),qs(Q,F,m,Z.x,Z.y,Z.width,Z.height,d,n,w),Q.restore(),P>0){var x=dl(Q,k);Gr(x,C,Z,i),Q.lineWidth=P,Q.strokeStyle=W,Q.stroke(),Gk(Q,k)}}else{var x=dl(Q,k);b||N||X?(Gr(Q,C,Z,i),X?Th(Q,X,function(v){return vo(v,w)}):N?Mq(Q,N,w,null,d,n):Uf(Q,b,G,D,Z),Q.fill(),X&&Q.restore(),Q!==x&&Gr(x,C,Z,i)):Gr(x,C,Z,i),P>0&&(Q.lineWidth=P,Q.strokeStyle=W,Q.stroke()),Gk(Q,k),C===pi&&fs(Q,b,H,Z)}Q.lineJoin=S,Q.lineCap=p}else{var v=V("group.title.background");if((!i||0>i)&&(i=0),F)qs(Q,F,m,q.x,q.y,q.width,q.height,d,n,E.getBodyColor());else if(b||N)if(N?Mq(Q,N,w,null,d,n):Uf(Q,b,G,D,q),0===P)Gr(Q,pi,q),Q.fill(),fs(Q,b,H,q);else{switch(Q.beginPath(),g){case fe:us(Q,q.x,q.y,q.width,q.height,i,i,0,0);break;case aq:us(Q,q.x,q.y,q.width,q.height,0,i,0,i);break;case zc:us(Q,q.x,q.y,q.width,q.height,i,0,i,0);break;case Ob:us(Q,q.x,q.y,q.width,q.height,0,0,i,i)}Q.fill()}if(f&&v)if(0===P)Qm(Q,f.x,f.y,f.width,f.height,v),fs(Q,v,H,f);else{switch(Q.beginPath(),Q.fillStyle=v,g){case fe:us(Q,f.x,f.y,f.width,f.height,0,0,i,i);break;case aq:us(Q,f.x,f.y,f.width,f.height,i,0,i,0);break;case zc:us(Q,f.x,f.y,f.width,f.height,0,i,0,i);break;case Ob:us(Q,f.x,f.y,f.width,f.height,i,i,0,0)}Q.fill()}if(P>0){var x=dl(Q,k);if(Gr(x,"roundRect",Z,i),Q.save(),Q.lineWidth=P,Q.strokeStyle=W,Q.lineJoin=O,Q.lineCap=u,Q.closePath(),Q.stroke(),f&&V("group.splitLine")){var t=f.x,B=f.y,a=f.width,j=f.height;Q.beginPath(),g===fe?(Q.moveTo(t,B),Q.lineTo(t+a,B)):g===aq?(Q.moveTo(t+a,B),Q.lineTo(t+a,B+j)):g===zc?(Q.moveTo(t,B),Q.lineTo(t,B+j)):(Q.moveTo(t,B+j),Q.lineTo(t+a,B+j))}Q.stroke(),Q.restore(),Gk(x,k)}}E._39O(Q,l)}else Bo.superClass._80o.call(E,Q)}});var Td=function(A,B){tl(Td,this,[A,B])};cd(Td,up,{_80o:function(e){this._39O(e,this._83o)}});var Qd=function(Z,d){tl(Qd,this,[Z,d])};cd(Qd,up,{_3O:function(){var C=this,o=C._data,P=C.s,H=C.gv,I=o.getPoints(),a=H.getBorderColor(o),f=a?P("border.width"):0,O=C.getSelectWidth(),k=P("shape.border.width"),d=o.getRect(),g=o.getAnchorRect(),j=H.getBodyColor(o),u=P("shape.border.color"),p=C._99o=I.isEmpty()?F:{rect:d,rotation:o.getRotation(),fillRule:P("shape.fill.rule"),scale:o.getScale(),position:o.p(),points:I,segments:o.getSegments(),bodyColor:j,borderColor:a,borderWidth:f,_94o:P("shape.border.3d"),_95o:P("shape.border.3d.color"),_96o:P("shape.border.3d.accuracy"),_97o:O?C.getSelectColor():F,selectWidth:O,_53o:P("shape.background"),_27Q:ij(P("shape.repeat.image"),j),shapeGradientPack:P("shape.gradient.pack"),_54o:k,_55o:u,shapeBorderRepeatImage:ij(P("shape.border.repeat.image"),u),shapeGradient:P("shape.gradient"),_59o:P("shape.gradient.color"),_60o:P("shape.border.pattern"),_61o:P("shape.border.cap"),_62o:P("shape.border.join"),shapeForeground:P("shape.foreground"),gray:P("2d.gray")};if(p){g.x+=p.position.x,g.y+=p.position.y,p.gradientRect=g;var z=o.getScale(),X=i(1,i(D(z.x),D(z.y)));P("shape.dash")&&P("shape.dash.width")>k&&(k=P("shape.dash.width"));var y,w=P("shape.border.width.absolute");y=w?(k+f+O)/C.gv._zoom/X:k*("square"===p._61o?.71:.5)+f+O/C.gv._zoom/X,y&&(y*=X,d=Hq(d),Jb(d,y,p._62o)),C._68o(d);var J=ei(o,H.isSelected(o)),V=P("clip.percentage");1>V&&(0>V&&(V=0),p.clipRect=un(o.getAnchorRect(),P("clip.direction"),V,J));var M=P("shape.fill.clip.percentage");1>M&&(0>M&&(M=0),p.shapeClipRect=un(o.getAnchorRect(),P("shape.fill.clip.direction"),M,J));var B=P("shape.foreground.clip.percentage");1>B&&(0>B&&(B=0),p.shapeForegroundClipRect=un(o.getAnchorRect(),P("shape.foreground.clip.direction"),B,J))}},getPosition:function(q,a,X,Z){var Y=this._99o;if(Y){var k=Vf(q,Y.rect,Z);return k.x+=a,k.y+=X,k}return wq},_42:function(t){this._99o&&Qd.superClass._42.call(this,t)},_80o:function(L){var u,V=this,w=V.s,D=V._99o,y=D.position,m=D.scale,Z=D.rotation,U=D.borderWidth,g=D.selectWidth/V.gv._zoom,z=D._27Q,J=D.shapeGradientPack,E=D._54o,d=D.clipRect,e=D.shapeClipRect,b=D.points,q=D.segments,F=V._data.isClosePath(),A=D.fillRule,G=D.gray,n=function(T){return G?C.toGrayColor(T):T},i=n(D._53o),T=i||z||J;L.save(),zg(L,y.x,y.y),_g(L,Z),qf(L,m.x,m.y),d&&(L.beginPath(),L.rect(d.x,d.y,d.width,d.height),L.clip()),T&&e&&(L.save(),L.beginPath(),L.rect(e.x,e.y,e.width,e.height),L.clip()),zg(L,-y.x,-y.y);var I=D._60o,l=dl(L,I),B=L.lineJoin,H=L.lineCap;L.lineJoin=D._62o,L.lineCap=D._61o;var P=n(D.bodyColor);T?(Mf(L,b,q,F),J?Th(L,J,function(H){return vo(H,D.bodyColor)}):z?Mq(L,z,P,null,V._data,V.gv):(u=P?P:i,Uf(L,u,D.shapeGradient,n(D._59o),D.gradientRect)),L.fill(A),J&&L.restore(),e&&(L.restore(),zg(L,-y.x,-y.y)),l!==L&&Mf(l,b,q,F)):Mf(l,b,q,F);var Y=D.shapeForeground;if(Y){L.save();var $=D.shapeForegroundClipRect;$&&(zg(L,y.x,y.y),L.beginPath(),L.rect($.x,$.y,$.width,$.height),L.clip(),zg(L,-y.x,-y.y)),Mf(L,b,q,F),Uf(L,Y,w("shape.foreground.gradient"),n(w("shape.foreground.gradient.color")),D.gradientRect),L.fill(A),L.restore()}var t=w("shape.border.width.absolute");if(t&&(L.save(),L.setTransform(1,0,0,1,0,0)),g&&(L.strokeStyle=D._97o,L.lineWidth=E+2*(U+g),L.stroke()),U&&(L.strokeStyle=n(D.borderColor),L.lineWidth=E+2*U,L.stroke()),E&&(u=n(D._55o),D.shapeBorderRepeatImage?hs(L,D.shapeBorderRepeatImage,u,null,V._data,V.gv):(!i&&P&&(u=P),L.strokeStyle=u),L.lineWidth=E,L.stroke(),D._94o&&kq(L,u,n(D._95o),E,V.gv._zoom,D._96o)),Gk(L,I),w("shape.dash")){var _=w("shape.dash.width")||E;if(_>0){I=w("shape.dash.pattern");var l=dl(L,I,V._2Q("shape.dash.offset"));l!==L&&Mf(l,b,q,F),V._1Q(L,"shape",_,I)}}t&&L.restore(),L.lineJoin=B,L.lineCap=H,L.restore()},_48O:function(){},_47O:function(){}});var _q=function(c,O){tl(_q,this,[c,O])};cd(_q,Qd,{getRotation:function(Z,f,l){Z=Z||0;var U=this._data.getPoints(),G=U.size();return G>1?Rd[l]?G&&0===G%2?po(U.get(G/2-1),U.get(G/2),f,Z):Z:vm[l]?po(U.get(0),U.get(1),f,Z):po(U.get(G-2),U.get(G-1),f,Z):Z},getPosition:function(R,M,N,U,E){var t=this._data.getPoints(),I=t.size();if(I>1){if(Rd[R]){var y=I%2;if(0===y)return Xj(t.get(I/2-1),t.get(I/2),R,M,N,U,E);var k=t.get((I-y)/2),q={x:k.x,y:k.y,width:0,height:0};return k=Vf(R,q,U),k.x+=M,k.y+=N,k}return vm[R]?Xj(t.get(0),t.get(1),R,M,N,U,E):Xj(t.get(I-2),t.get(I-1),R,M,N,U,E)}return wq}});var zp=function(g,h){tl(zp,this,[g,h])};cd(zp,up,{_3O:function(){var $=this;zp.superClass._3O.call($);var K=$.s,r=$._83o;$._82o=r.img||r.shape?F:{background:$.getBodyColor("grid.background"),depth:K("grid.depth"),rect:r.rect,_88o:K("grid.cell.depth"),cellBorderColor:K("grid.cell.border.color"),_89o:K("grid.row.count"),_90o:K("grid.column.count"),block:K("grid.block"),_91o:K("grid.block.color"),_92o:K("grid.block.padding"),_93o:K("grid.block.width")}},_80o:function(A){var n=this,e=n._82o;if(!e)return zp.superClass._80o.call(n,A),void 0;var h,X,N=n._data,T=e.background,t=e.rect,u=e.block,$=e._91o,b=e._92o,y=e._93o,V=e._88o,r=e.cellBorderColor,s=e._89o,c=e._90o;if(T)if(Qm(A,t.x,t.y,t.width,t.height,T),fs(A,T,e.depth,t),V)for(h=0;s>h;h++)for(X=0;c>X;X++)t=N.getCellRect(h,X),t&&fs(A,T,V,t);else if(r){for(A.beginPath(),h=0;s>h;h++)for(X=0;c>X;X++)t=N.getCellRect(h,X),t&&A.rect(t.x,t.y,t.width,t.height);A.strokeStyle=r,A.lineWidth=1,A.stroke()
}if("h"===u)for(h=0;s>h;h++)t=ti(N.getCellRect(h,0),N.getCellRect(h,c-1)),ps(t,b),If(A,$,t.x,t.y,t.width,t.height,y);else if("v"===u)for(X=0;c>X;X++)t=ti(N.getCellRect(0,X),N.getCellRect(s-1,X)),ps(t,b),If(A,$,t.x,t.y,t.width,t.height,y);n._39O(A,n._83o)}});var Nm=function(u,Q){tl(Nm,this,[u,Q])};cd(Nm,up,{_checkEmptyRect:!1,_81o:function(){var T=this._data,o=Nm.superClass._81o.call(this),J=T.s("text");if(J!=F){var z,E,h=T.s("text.font"),f=T.s("text.align"),W=T.s("text.vAlign"),a=Tg(h,J),d=a.width,C=a.height,I=T.getAnchor(),Y=T.getWidth(),c=T.getHeight();"left"===f?z=-Y*I.x:"center"===f?z=-Y*I.x+(Y-d)/2:"right"===f&&(z=Y*(1-I.x)-a.width),"top"===W?E=-c*I.y:"middle"===W?E=-c*I.y+(c-C)/2:"bottom"===W&&(E=c*(1-I.y)-a.height);var V,q=T.getMatrix();if(V=np([q.tf(z,E),q.tf(z+d,E),q.tf(z+d,E+C),q.tf(z,E+C)]),o=ti(o,V),o&&T.s("text.shadow")){var D=Hq(o);D.x+=T.s("text.shadow.offset.x"),D.y+=T.s("text.shadow.offset.y"),ps(D,T.s("text.shadow.blur")),o=ti(o,D)}}return o}});var ql=Rp.Interactor=function(p){this.gv=this._graphView=p};qj("Interactor",f,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(B){this.gv.fi(B)},setCursor:function(M){Zk||this.gv.setCursor(M)},startDragging:function(_){var e=this;e._lastClientPoint=ci(_),e._lastLogicalPoint=e.gv.lp(_),$l(e,_)},clearDragging:function(){var Z=this;Z._lastClientPoint=Z._lastLogicalPoint=Z._logicalPoint=F},autoScroll:function(u){return this.gv.autoScroll(u,this._lastClientPoint)}});var Eo=F,lo=function(v){Eo.handleWindowTouchMove(v)},ui=function(C){Eo.handleWindowTouchEnd(C),d(b,df,lo),d(b,Gd,ui),Eo=F},Dj=function(r){Eo.handleWindowMouseMove(r)},Vk=function(r){Eo.handleWindowMouseUp(r),d(b,$p,Dj),d(b,Sn,Vk),Eo=F},Pg=function(w,e){if(w!==Eo){var o=os(e);Eo?o?Eo.handleWindowTouchEnd(e):Eo.handleWindowMouseUp(e):o?(x(b,df,lo),x(b,Gd,ui)):(x(b,$p,Dj),x(b,Sn,Vk)),Eo=w}},Jh=function(b){var Y=this;Y.gv=b,Y._is2d=b instanceof Rp.GraphView,Y._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Hr,"wheel"].forEach(function(z){Y.addListener(z)}),Y.initImageResource()};cd(Jh,ql,{enableVR:function(P){var m=this;!!m._vrEnable!==P&&(m._vrEnable=P,P?m.gv.vr.mp(m.onVRControllerChange,m):m.gv.vr.ump(m.onVRControllerChange,m))},onVRControllerChange:function(z){var W=this,J=z.property,U=z.newValue,S=U.id,$=W.gv.vr.getController(S),m=$.getRay();if(m){m.controllerId=S;var k=W.gv.vr.getRayEventType(m,J,U._62O);switch(k){case"down":W.handle_mousedown(m);break;case"up":Eo&&Vk(m);break;case"move":W.handle_mousemove(m),Eo&&W.handleWindowMouseMove(m)}}},setPreventEventDefault:function(U,f){var m=this,Q=m._eventListeners[U];Q?Q._prevent=f:m._eventListeners[U]=Q={_removal:_,_prevent:f}},removeListener:function(I){var C=this,T=C._eventListeners[I];T&&T._removal&&(T._removal(),T._removal=_)},addListener:function(v){var E=this,I=E._eventListeners[v];if(I||(E._eventListeners[v]=I={_removal:_,_prevent:!0}),!I||!I._removal){var z=function(t){I._prevent&&C.preventDefault(t),E.disabled||("wheel"===v?uo(E,t):E["handle_"+v](t))};x(E.gv.getView(),v,z),I._removal=function(){d(E.gv.getView(),v,z)}}},handleWindowTouchMove:function(v){this.handleWindowMouseMove(v)},handleWindowMouseMove:function(e){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",e):(this.handleDownInfo("onBeginDrag",e),this.isDragging=!0))},handleWindowTouchEnd:function(o){this.handleWindowMouseUp(o)},handleWindowMouseUp:function(k){if(this.isDragging&&(this.handleDownInfo("onEndDrag",k),this.isDragging=!1),this.downInfo){var G=this.handle("onUp",k);if(G&&G.data===this.downInfo.data){this.handleMissingUp(k);var Y=this,b=2===k.button?"onContextMenu":"onClick";if(!Y._dbclickTimer)return Y._dbclickTimer=gr(function(){delete Y._dbclickTimer,Y.handleClick(k,b,G),this.downInfo=F},C.clickDelay),void 0;Iq(Y._dbclickTimer),delete Y._dbclickTimer,b="onDoubleClick",Y.handleClick(k,b,G)}else this.handleDownInfo("onUp",k);this.downInfo=F,this.downComps=F}},handle_mouseleave:function(Y){var E=this,r=E.gv;E._hoverTimer&&(Iq(E._hoverTimer),delete E._hoverTimer);var Q=E.currentInfo?E.currentInfo.data:F;if(Q){Q.s("onLeave")&&Q.s("onLeave")(Y,Q,r),E.fire("data","onLeave",Y,Q);var h=E.currentInfo?E.currentInfo.hits:F;if(h)for(var I in h)E.handleLeave(Y,I);E.currentInfo=F}},handle_mousewheel:function(I){I.scrollDelta=I.wheelDelta/40,this.handle("onScroll",I)},handle_DOMMouseScroll:function(n){n.scrollDelta=2===n.axis?-n.detail:0,this.handle("onScroll",n)},handle_touchstart:function(a){this.handle_mousedown(a)},handle_touchmove:function(B){this.handle("onMove",B)},handle_mousedown:function(W){this.isDragging&&(this.handleDownInfo("onEndDrag",W),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",W),this.downInfo&&Pg(this,W)},handle_mousemove:function(H){var V=this,M=V.gv;if(V._hoverTimer&&(Iq(V._hoverTimer),delete V._hoverTimer),!M._panning&&!M._moving){var i,p,U,v=V.handle("onMove",H),I=this.currentInfo?this.currentInfo.data:F,h=this.currentInfo?this.currentInfo.hits:F;if(v&&(p=v.data,U=v.hits,V._hoverTimer=gr(function(){Iq(V._hoverTimer),delete V._hoverTimer,V.handle("onHover",H,v)},M.getHoverDelay()||C.hoverDelay)),p!==I){if(I&&(I.s("onLeave")&&I.s("onLeave")(H,I,M),this.fire("data","onLeave",H,I)),p&&(p.s("onEnter")&&p.s("onEnter")(H,p,M),this.fire("data","onEnter",H,p)),h)for(i in h)this.handleLeave(H,i);if(U)for(i in U){var t=U[i],A=p._interactPrefix=t.prefix,n=A&&p.a(A+"onEnter")||t.target.onEnter;n&&n.call(t.target,H,p,M,t.point,t.width,t.height),this.fire(t.type,"onEnter",t.event,t.data,t.image,t.comp,t.point,t),p._interactPrefix=null}}else{if(h)for(i in h)U&&U[i]||this.handleLeave(H,i);if(U)for(i in U)if(!h||!h[i]){var t=U[i],A=p._interactPrefix=t.prefix,n=A&&p.a(A+"onEnter")||t.target.onEnter;n&&n.call(t.target,H,p,M,t.point,t.width,t.height),this.fire(t.type,"onEnter",t.event,t.data,t.image,t.comp,t.point,t),p._interactPrefix=null}}this.currentInfo=v}},handle:function(s,B,f){var m,R=this,P=R.gv;if(R._is2d){if(f=f||P.getDataInfoAt(B),!f||!P.isInteractive(f.data))return;if(m=f.ui.interactiveInfo){var j,S=f.data;if(S.s(s)&&S.s(s)(B,S,P),this.fire("data",s,B,S),"body"===f.part&&m.bodyInfo)j="body",f.hits=this.handleImage(j,P.getImage(S),s,B,S,f.point,m.bodyInfo);else if("icons"===f.part&&m._38o){var U=m._38o[f.name];U&&U[f.index]&&(j="icons|"+f.name+"|"+f.index,f.hits=this.handleImage(j,f.icon,s,B,S,f.point,U[f.index]))}}return f}var S,A;if(!f)if(B&&B instanceof V.Math.Ray&&P.isVREnabled()){var X=P.vr.intersectWorld(B);if(S=X.data,A=X.intersect,P.vr.renderRayDuringInteraction(B,S,A),!S)return;var C=P.getData3dUI(S);if(m=C.interactiveInfo,!m)return;f={data:S,part:A.part,ui:C}}else{if(f=P.getDataInfoAt(B),!f)return;f&&(f={data:f.data,part:f.part})}if(P.isInteractive(f.data)){if(!A){S=f.data;var C=P.getData3dUI(S);if(f.ui=C,m=C.interactiveInfo,!m)return f;if(A=P.intersectObject(B,S),!A)return}S.s(s)&&S.s(s)(B,S,P),this.fire("data",s,B,S);var q,z=A.part;return"body"!==z&&(q=S.s(z+".image")||S.s("shape3d."+z+".image")),q||(q=S.s("all.image")||S.s("shape3d.image")),q?(m="object"==typeof q?m[q.uuid]:m[q],m&&m.bodyInfo?(f.part="body",f.interactiveInfo=m,f.point=this._convertUVToPoint(A.uv,m),f.image=q,f.hits=this.handleImage("body",q,s,B,S,f.point,m.bodyInfo),f):f):f}},_handleLeaveOrMissing:function(g,R,G){var S="leave"===g?this.currentInfo:this.downInfo;if(S){var A=S.interactiveInfo||S.ui.interactiveInfo;if(A){var O,I,N=S.data;if(this._is2d){if(I=this.gv.lp(R),"body"===S.part&&A.bodyInfo)O="body","leave"===g?this.handleLeaveImage(G,O,this.gv.getImage(N),R,N,I,A.bodyInfo):this.handleMissingUpImage(O,this.gv.getImage(N),R,N,I,A.bodyInfo);else if("icons"===S.part&&A._38o){var E=A._38o[S.name];E&&E[S.index]&&(O="icons|"+S.name+"|"+S.index,"leave"===g?this.handleLeaveImage(G,O,S.icon,R,N,I,E[S.index]):this.handleMissingUpImage(O,S.icon,R,N,I,E[S.index]))}}else{if(!A.bodyInfo)return;var r=this.gv.intersectObject(R,N);I=r&&r.uv?this._convertUVToPoint(r.uv,A):{x:1/0,y:1/0},"leave"===g?this.handleLeaveImage(G,"body",S.image,R,N,I,A.bodyInfo):this.handleMissingUpImage("body",S.image,R,N,I,A.bodyInfo)}}}},handleClick:function(F,N,J){var U=this,l=this.downInfo;if(l&&J){var P,K=J.interactiveInfo||J.ui.interactiveInfo,S=J.data,g=this.gv;if(S.s(N)&&S.s(N)(F,S,g),U.fire("data",N,F,S),K)if(this._is2d){if(l.part===J.part){var s=g.lp(F);"body"===J.part&&K.bodyInfo&&(P="body",this.handleClickImage(P,g.getImage(S),N,F,S,s,K.bodyInfo,J))}}else{if(!K.bodyInfo)return;var B=g.intersectObject(F,S);if(!B)return;s=this._convertUVToPoint(B.uv,K),this.handleClickImage("body",l.image,N,F,S,s,K.bodyInfo,J)}}},handleDownInfo:function(Q,d){if(this.downInfo){var o=this.downInfo,H=this.gv,n=o.interactiveInfo||o.ui.interactiveInfo;if(n){var t,j=o.data;if(j.s(Q)&&j.s(Q)(d,j,H),this.fire("data",Q,d,j),this._is2d){var _=H.lp(d);if("body"===o.part&&n.bodyInfo)t="body",this.handleDownInfoImage(t,H.getImage(j),Q,d,j,_,n.bodyInfo);else if("icons"===o.part&&n._38o){var V=n._38o[o.name];V&&V[o.index]&&(t="icons|"+o.name+"|"+o.index,this.handleDownInfoImage(t,o.icon,Q,d,j,_,V[o.index]))}}else{if(!n.bodyInfo)return;var m=H.intersectObject(d,j);if(!m)return;_=this._convertUVToPoint(m.uv,n),this.handleDownInfoImage("body",o.image,Q,d,j,_,n.bodyInfo)}}}},fire:function(j,q,K,n,R,S,h,G){this.gv.fi({kind:q,type:j,event:K,data:n,image:R,comp:S,view:this.gv,point:h,width:G?G.width:_,height:G?G.height:_})},handleImage:function(V,x,M,p,H,X,K){var Z={};if(x&&(x=ij(x))){var w=this.gv,a=K.rect,D=this.convertPoint(X,K);D.inRect&&(x[M]&&x[M](p,H,w,D,a.width,a.height),this.fire("image",M,p,H,x,_,D,a),Z[V+"|image"]={target:x,type:"image",image:x,data:H,event:p,point:D,width:a.width,height:a.height});for(var e,I=K.compInfos,o=x,B=I.length-1;B>=0;B--){var U=I[B],W=U.comp;if(D=this.convertPoint(X,U,o,W,w,H),D.inRect){a=U.rect;var q=H._interactPrefix=U.prefix,N=q&&H.a(q+M)||W[M];if(N&&(e=N.call(W,p,H,w,D,a.width,a.height)),this.fire("comp",M,p,H,x,W,D,a),e!==!0&&(x=a.image)&&(x[M]&&(e=x[M](p,H,w,D,a.width,a.height)),this.fire("image",M,p,H,x,_,D,a)),H._interactPrefix=null,Z[V+"|"+B]={target:W,type:"comp",comp:W,image:x,data:H,event:p,point:D,width:a.width,height:a.height,prefix:q},this.downComps&&this.downComps.push(W),x&&(Z[V+"|"+B+"|image"]={target:x,type:"image",image:x,data:H,event:p,point:D,width:a.width,height:a.height,prefix:q}),e===!0)break}}}return Z},handleLeave:function(e,L){return this._handleLeaveOrMissing("leave",e,L)},handleMissingUp:function(i){return this._handleLeaveOrMissing("missing",i)},handleLeaveImage:function(o,Y,c,V,h,g,i){if(c&&(c=ij(c))){var S=this.gv,L=i.rect,b=this.convertPoint(g,i);o===Y+"|image"&&(c.onLeave&&c.onLeave(V,h,S,b,L.width,L.height),this.fire("image","onLeave",V,h,c,_,b,L));for(var W,e=i.compInfos,Q=c,y=e.length-1;y>=0;y--){var H=e[y],u=H.comp;b=this.convertPoint(g,H,Q,u,S,h),L=H.rect;var q=h._interactPrefix=H.prefix;if(o===Y+"|"+y){var t=q&&h.a(q+"onLeave")||u.onLeave;t&&(W=t.call(u,V,h,S,b,L.width,L.height)),this.fire("comp","onLeave",V,h,c,u,b,L)}if(W!==!0&&(c=L.image)&&o===Y+"|"+y+"|image"&&(c.onLeave&&(W=c.onLeave(V,h,S,b,L.width,L.height)),this.fire("image","onLeave",V,h,c,_,b,L)),h._interactPrefix=null,W===!0)break}}},handleMissingUpImage:function(r,F,N,w,v,h){var z="onUp",T=this.downInfo.hits;if(T&&F&&(F=ij(F))){var K=this.gv,u=h.rect,m=this.convertPoint(v,h);!m.inRect&&T[r+"|image"]&&(F[z]&&F[z](N,w,K,m,u.width,u.height),this.fire("image",z,N,w,F,_,m,u));for(var W,$=h.compInfos,b=F,Z=$.length-1;Z>=0;Z--){var Q=$[Z],j=Q.comp;if(m=this.convertPoint(v,Q,b,j,K,w),!m.inRect){u=Q.rect;var l=w._interactPrefix=Q.prefix;if(T[r+"|"+Z]){var H=l&&w.a(l+z)||j[z];H&&(W=H.call(j,N,w,K,m,u.width,u.height)),this.fire("comp",z,N,w,F,j,m,u)}if(W!==!0&&(F=u.image)&&T[r+"|"+Z+"|image"]&&(F[z]&&(W=F[z](N,w,K,m,u.width,u.height)),this.fire("image",z,N,w,F,_,m,u)),w._interactPrefix=null,W===!0)break}}}},handleDownInfoImage:function(n,s,p,B,P,v,W){var j=this.downInfo.hits;if(j&&s&&(s=ij(s))){var A=this.gv,F=W.rect,x=this.convertPoint(v,W);j[n+"|image"]&&(s[p]&&s[p](B,P,A,x,F.width,F.height),this.fire("image",p,B,P,s,_,x,F));for(var C,d=W.compInfos,M=s,G=d.length-1;G>=0;G--){var $=d[G],Y=$.comp;x=this.convertPoint(v,$,M,Y,A,P),F=$.rect;var H=P._interactPrefix=$.prefix,I=["onDrag","onEndDrag"].indexOf(p)>=0;if(!I&&j[n+"|"+G]||I&&this.downComps&&this.downComps.indexOf(Y)>=0){var z=H&&P.a(H+p)||Y[p];z&&(C=z.call(Y,B,P,A,x,F.width,F.height)),this.fire("comp",p,B,P,s,Y,x,F)}if(C!==!0&&(s=F.image)&&j[n+"|"+G+"|image"]&&(s[p]&&(C=s[p](B,P,A,x,F.width,F.height)),this.fire("image",p,B,P,s,_,x,F)),P._interactPrefix=null,C===!0)break}}},handleClickImage:function(Q,M,t,C,m,A,o,J){var V=this.downInfo.hits,u=J.hits;if(V&&M&&(M=ij(M))){var E=this.gv,N=o.rect,Z=this.convertPoint(A,o);V[Q+"|image"]&&(M[t]&&M[t](C,m,E,Z,N.width,N.height),this.fire("image",t,C,m,M,_,Z,N));for(var T,U=o.compInfos,a=M,D=U.length-1;D>=0;D--){var q=U[D],I=q.comp;Z=this.convertPoint(A,q,a,I,E,m),N=q.rect;var k=m._interactPrefix=q.prefix;if(V[Q+"|"+D]&&u[Q+"|"+D]){var z=k&&m.a(k+t)||I[t];z&&(T=z.call(I,C,m,E,Z,N.width,N.height)),this.fire("comp",t,C,m,M,I,Z,N)}if(T!==!0&&(M=N.image)&&V[Q+"|"+D+"|image"]&&(M[t]&&(T=M[t](C,m,E,Z,N.width,N.height)),this.fire("image",t,C,m,M,_,Z,N)),m._interactPrefix=null,T===!0)break}}},initImageResource:function(){C.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(Q,R){if(!Q)return{x:1/0,y:1/0};var v=R.bodyInfo.rect,d=Q.clone(),X=Q.multiply({x:v.width,y:v.height});return X.local=d,X},convertPoint:function(c,t,O,z,i,x){var q=t.rect,s=t.matrix.applyInverse(c).sub(q),j=s.x>=0&&s.y>=0&&s.x<=q.width&&s.y<=q.height;if(!j)return s;if(z&&cs(z.pixelPerfect,x,i)){var q,Y=1;this._is2d?(Y=i.getZoom(),q=ac(c.x,c.y,_,Y)):q=ac(c.x,c.y);var W=!1,$=q.x,G=q.y,D=q.width,J=q.height,g=C.hitMaxArea,p=D*J*Y*Y;if(p>g){var H=Math.sqrt(g/p);Y*=H}D*=Y,J*=Y,2>D&&(D=2),2>J&&(J=2),$*=Y,G*=Y;var E=af(D,J),S=new Mm(0,-$,-G,Y,Y);S.append(t.matrix),i._drawForChecking=!0,z.transform=S,t.refRect&&t.refRect.fitSize&&(z.refRect=t.refRect);var n=O.comps;O.comps=[z],Fp(E,O,0,0,D,J,x,self),O.comps=n,delete z.refRect,delete z.transform,i._drawForChecking=!1;try{for(var P=0,A=E.getImageData(0,0,D,J).data;P<A.length;P+=4)if(0!==A[P+3]){W=!0;break}E.restore()}catch(Q){dc=F,W=!1}s.inRect=W}else s.inRect=!0;return s}});var vh=Rp.DefaultInteractor=function(W){tl(vh,this,[W])};qj("DefaultInteractor",ql,{handle_mousedown:function(J){Qq(J);var w=this,f=w.gv,I=f.getDataAt(J);if(f.setFocus(J)&&!f._editing&&!f._scrolling){gm(J)?f.handleDoubleClick(J,I):f.handleClick(J,I);var O=Gq(J);!pc()&&!O&&I&&(f.isMovable(I)||f._39Q(I))||!f.isPannable()||!Ab(J)&&!O||Ef(J)||(w._tx=f.tx(),w._ty=f.ty(),w.startDragging(J))}},handleWindowMouseUp:function(p){var h=this,H=h.gv;H._panning&&(delete H._panning,H.onPanEnded(),h.fi({kind:"endPan",event:p})),delete h._tx,delete h._ty,h.clearDragging()},handle_mousemove:function(M){var f=this,y=f.gv;f._hoverTimer&&(Iq(f._hoverTimer),delete f._hoverTimer),f._hoverTimer=gr(function(){f.fi({kind:"hover",event:M}),Iq(f._hoverTimer),delete f._hoverTimer},y.getHoverDelay()||C.hoverDelay)},handle_mouseleave:function(){var k=this;k._hoverTimer&&(Iq(k._hoverTimer),delete k._hoverTimer)},handle_touchmove:function(j){this.handle_mousemove(j)},handleWindowMouseMove:function(U){var b=this,_=b.gv;b.fi({kind:_._panning?"betweenPan":"beginPan",event:U}),_._panning=1;var C=Bp(_,U,b._lastClientPoint);_.setTranslate(b._tx+C.x,b._ty+C.y)},handle_mousewheel:function(K){this.gv.handleScroll(K,K.wheelDelta)},handle_DOMMouseScroll:function(w){2===w.axis&&this.gv.handleScroll(w,-w.detail)},handle_keydown:function(_){this.gv.handleKeyDown(_)}});var Kb=Rp.SelectInteractor=function(p){tl(Kb,this,[p])};qj("SelectInteractor",ql,{_42:function(){var H=this,A=H.gv,D=A.getZoom(),S=H.mark,J=H.div;J||(J=H.div=ir(),of(H.getView(),J));var d={};d.x=S.x*D+A.tx(),d.y=S.y*D+A.ty(),d.width=S.width*D,d.height=S.height*D,mm(J,d),this.intersects()?(J.style.border="",J.style.background=A.getRectSelectBackground()):(J.style.background="",J.style.border="1px solid "+A.getRectSelectBorderColor())},handle_mousedown:function(E){var i=this,C=i.gv;if(i._57I=F,i.pendingClickThrough=F,!(C._editing||C._scrolling||pc()||Gq(E))){var g=C.getDataAt(E),K=C.sm();g?Ef(E)?K.co(g)?K.rs(g):K.as(g):K.co(g)?g instanceof rs&&g.isClickThroughEnabled()&&Ab(E)&&(i.pendingClickThrough=ci(E)):K.ss(g):Ef(E)||!C.isPannable()?Ab(E)&&(Ef(E)||K.cs(),C.isRectSelectable()&&(i.startDragging(E),C._77O=1)):Ab(E)&&(i._57I=ci(E))}},handle_mouseup:function(R){var X=this,p=X.gv,G=X._57I;if(G&&(kj(G,ci(R))<=1&&p.sm().cs(),X._57I=F),X.pendingClickThrough){if(kj(X.pendingClickThrough,ci(R))<=1){var T=p.getDataAt(R);if(T instanceof rs&&T.isClickThroughEnabled()){var S=p.getDataAt(R,function(b){var g=b.getParent()===T&&p.isSelectable(b,!0);return g});S&&(R.clickThrough=!0,p.sm().ss(S))}}X.pendingClickThrough=F}},handleWindowMouseUp:function(W){this.clear(W)},handleWindowMouseMove:function(T){var x=this,j=x.gv;x._logicalPoint=j.lp(T),x.mark?(x.fi({kind:"betweenRectSelect",event:T}),j.isPannable()&&x.autoScroll(T),x.redraw()):x.fi({kind:"beginRectSelect",event:T}),x.mark=np(x._lastLogicalPoint,x._logicalPoint),x.redraw()},intersects:function(){var H=this,P=H._lastLogicalPoint,m=H._logicalPoint;return P.x>m.x||P.y>m.y},clear:function(f){var N=this,T=N.gv,C=N.mark;if(N._57I=F,N.pendingClickThrough=F,N._lastLogicalPoint){if(C){if(0!==C.width&&0!==C.height){var o=T.getDatasInRect(C,N.intersects());if(!o.isEmpty()){var u=T.sm(),$=u.toSelection();o.each(function(K){u.co(K)?$.remove(K):$.add(K)}),u.ss($)}}Ol(N.div),delete N.div,delete N.mark,N.redraw(),N.fi({kind:"endRectSelect",event:f}),T.onRectSelectEnded()}N.clearDragging(),delete T._77O}},redraw:function(){var M=this;M._draw||(M._draw=1,gr(function(){M.mark&&M._42(),delete M._draw},16))}});var Wh=Rp.MoveInteractor=function(y){tl(Wh,this,[y])};qj("MoveInteractor",ql,{handle_mousedown:function(d){var U=this,c=U.gv;if(Ab(d)&&!c._editing&&!c._scrolling&&!pc()){var T=c.getSelectedDataAt(d);!T||c._39Q(T)&&!c.isMovable(T)?c._focusData=F:(U._data=T,c.handleMouseDown&&c.handleMouseDown(d,T),U.startDragging(d),c.isMovable(T)&&(c._moving=1))}},handleWindowMouseUp:function(W){var a=this,P=a.gv;P.handleMouseUp&&P.handleMouseUp(W,a._data),a.clear(W)},handleWindowMouseMove:function(d){var U=this,$=U._data,B=U.gv;if((!B._93O||!B._93O(d,$))&&B._moving){U._logicalPoint||U.fi({kind:"prepareMove",event:d});var m=U._logicalPoint?"betweenMove":"beginMove",i={kind:m,event:d},D=U._logicalPoint=B.lp(d);"beginMove"!==m||U._alreadyBeginTransaction||(U._alreadyBeginTransaction=!0,B.getDataModel().beginTransaction());var u=U._calcShift(m,d),G=u.x,t=u.y,O=U.gv.getMoveMode(d,$);O&&("x"===O?t=0:"y"===O?G=0:"xy"!==O&&(G=t=0)),B.moveSelection(G,t),U._lastLogicalPoint=D,U.autoScroll(d),U.fi(i)}},_calcShift:function(){var P=this,I=P._logicalPoint,F=P._lastLogicalPoint,n=I.x-F.x,$=I.y-F.y;return{x:n,y:$}},clear:function(E){var C=this,N=C.gv;C._lastLogicalPoint&&(C._lastLogicalPoint=C._data=N._moving=F,C._logicalPoint&&(C.fi({kind:"endMove",event:E}),N.onMoveEnded()),C.clearDragging()),C._alreadyBeginTransaction&&(C._alreadyBeginTransaction=!1,N.getDataModel().endTransaction())}});var rr=Rp.TextEditInteractor=function(P){tl(rr,this,[P]),this.init()};qj("TextEditInteractor",ql,{init:function(){var w=this,E=this.input=v.createElement("input"),h=E.style;E.text="text",h.border="1px solid #d8d8d8",h.position="absolute",h.padding="2px 3px",h.outline="none",h.marginLeft="-90px",h.marginTop="-16px",h.backgroundColor="rgba(255,255,255, 0.9)",h.fontSize="14px",h.width="180px",h.height="32px",h.boxShadow="0 0 13px rgba(16,142,233, 0.5)",h.textAlign="center",h.boxSizing="border-box",x(E,"keyup",function(D){vb(D)&&w.endTextEdit()}),x(E,"focus",function(){E.select()});var D=this.textarea=v.createElement("textarea"),Q=this.wrap=v.createElement("div");Q.appendChild(D),h=D.style,h.margin=0,h.padding="4px",h.overflow="hidden",h.boxSizing="border-box",h.position="absolute",h.outline="none",h.backgroundColor="transparent",h.resize="none",h.textAlign="center",h.fontSize="14px",h.border="none",h.borderWidth=0,h.width="100%",h.top="50%",h=Q.style,h.boxSizing="border-box",h.margin=0,h.padding=0,h.position="absolute",h.boxShadow="0 0 13px rgba(16,142,233, 0.5)",h.border="1px solid #d8d8d8",h.backgroundColor="rgba(255,255,255, 0.9)",h.width="180px",h.marginLeft="-90px",x(D,"keydown",function(E){return(er()||Ef())&&vb(E)?(w.endTextEdit(),void 0):(w.calculateTextareaHeight(String.fromCharCode(E.keyCode)),void 0)}),x(D,"focus",function(){D.select()});var u=function(J){J.stopPropagation()};x(E,"mousedown",u),x(E,"touchstart",u),x(D,"mousedown",u),x(D,"touchstart",u),w.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],w.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",w.handleWindowClick=function(I){var J=w._editingDOM;if(J){var t=J.getBoundingClientRect(),l=ci(I);Hd(t,l)||w.endTextEdit()}}},handle_mousedown:function(u){var X=this,k=X.gv;if(gm(u)&&!k._editing){var M=k.getDataAt(u);if(M){var W=k.getTextEditInfo(M);W&&(this._editInfo=W,this._editTarget=M,k._editing=!0,W.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var Y=this,D=Y.gv,M=Y._editTarget,O=Y.getTargetValue(),d=Y.textarea,o=Y.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===O||O===_)&&(O=""),d.value=O,Y._editingDOM=d,D.getView().appendChild(o),this.layoutHTML(o,M),this.calculateTextareaHeight(),gr(function(){d.focus(),x(b,"mousedown",Y.handleWindowClick),x(b,"touchstart",Y.handleWindowClick)},10)},handleTextEdit:function(){var j=this,E=j.gv,H=j._editTarget,G=j.getTargetValue(),A=j.input;(null===G||G===_)&&(G=""),A.value=G,j._editingDOM=A,E.getView().appendChild(A),this.layoutHTML(A,H),gr(function(){A.focus(),x(b,"mousedown",j.handleWindowClick),x(b,"touchstart",j.handleWindowClick)},10)},layoutHTML:function(G,b){var J=this.gv,t=J.getZoom();if(b instanceof V.Node){var $=b.getRect();G.style.left=($.x+$.width/2)*t+J.tx()+"px",G.style.top=($.y+$.height/2)*t+J.ty()+"px"}else if(b instanceof V.Edge){var R=J.getDataUI(b),$=R._6I;G.style.left=($.x+$.width/2)*t+J.tx()+"px",G.style.top=($.y+$.height/2)*t+J.ty()+"px"}},endTextEdit:function(){var f=this,p=f._editInfo.isMultiline?f.wrap:f.input,v=f._editInfo.isMultiline?f.textarea:f.input;f.setTargetValue(v.value),f.gv.getView().removeChild(p),f.gv._editing=!1,delete f._editingDOM,d(b,"mousedown",f.handlelick),d(b,"touchstart",f.handleWindowClick)},setTargetValue:function(c){var F=this,W=F._editTarget,p=F._editInfo,U=p.accessType,Z=p.name;if(Z&&U||(U="p",Z="name"),"p"===U){var M=V.Default.setter(Z);W[M](c)}else"a"===U?W.a(Z,c):W.s(Z,c)},getTargetValue:function(){var t=this,j=t._editTarget,p=t._editInfo,A=p.accessType,b=p.name;if(b&&A||(A="p",b="name"),"p"===A){var r=V.Default.getter(b);return j[r]()}return"a"===A?j.a(b):j.s(b)},createHiddenTextarea:function(){this.hiddenTextarea=v.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(o,W){if(W&&this.computedStyleCache)return this.computedStyleCache;var O=this,k=b.getComputedStyle(o),d=k.getPropertyValue("box-sizing")||k.getPropertyValue("-moz-box-sizing")||k.getPropertyValue("-webkit-box-sizing"),z=parseFloat(k.getPropertyValue("padding-bottom"))+parseFloat(k.getPropertyValue("padding-top")),w=parseFloat(k.getPropertyValue("border-bottom-width"))+parseFloat(k.getPropertyValue("border-top-width")),q=O.SIZING_STYLE.map(function(d){return d+":"+k.getPropertyValue(d)}).join(";"),_={sizingStyle:q,paddingSize:z,borderSize:w,boxSizing:d};return W&&(this.computedStyleCache=_),_},calculateTextareaHeight:function(i){i=i||"";var l=this,t=l.textarea,V=l.hiddenTextarea,Y=l.wrap,_=32,N=l.calculateHTMLStyle(t,!1),Z=N.paddingSize,S=N.borderSize,I=N.boxSizing,n=N.sizingStyle;V.setAttribute("style",n+";"+l.HIDDEN_TEXTAREA_STYLE),V.value=t.value+i;var u=V.scrollHeight;"border-box"===I?u+=S:"content-box"===I&&(u-=Z),t.style.height=u+"px",t.style.marginTop=0-.5*u+"px",Y.style.height=Math.max(u,_)+"px",Y.style.marginTop=u*-.5+"px"}});var ck=Rp.ScrollBarInteractor=function(n){tl(ck,this,[n])};qj("ScrollBarInteractor",ql,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(C){var d=this.gv.getViewRect();return this._41o()&&(d.x+d.width-this.gv.lp(C).x)*this.gv.getZoom()<Jq},isH:function(Q){var a=this.gv.getViewRect();return this._40o()&&(a.y+a.height-this.gv.lp(Q).y)*this.gv.getZoom()<Jq},handle_mousemove:function(n){this.handle_touchmove(n)},handle_touchmove:function(Q){if(!Ee&&Ab(Q)&&this.gv.isScrollBarVisible()){var K=this,k=K.isV(Q),o=K.isH(Q);(k||o)&&K.gv.showScrollBar(),K.gv._scrolling=k||o}},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(Y){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=F,this.fi({kind:"endScroll",event:Y})},handle_mousedown:function(s){this.handle_touchstart(s)},handle_touchstart:function(B){var i=this;if(i.gv.setFocus(B),Qq(B),i.handle_touchmove(B),!(_k(B)>1)&&i.gv._scrolling&&i.gv.isScrollBarVisible()){i._cp=ci(B),i._tx=i.gv.tx(),i._ty=i.gv.ty();var r=i.isV(B);i._state=r?"vScroll":"hScroll",$l(i,B),i.fi({kind:"beginScroll",event:B})}},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(d){var C=ci(d),$=this.gv.getViewRect(),u=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-C.y)*u.height/$.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-C.x)*u.width/$.width),this.fi({kind:"betweenScroll",event:d})}});var Zd=Rp.TouchInteractor=function(e,s){s=s||{},s.selectable===_&&(s.selectable=!0),s.movable===_&&(s.movable=!0),s.pannable===_&&(s.pannable=!0),s.pinchable===_&&(s.pinchable=!0),s.editable===_&&(s.editable=!0),this.params=s,tl(Zd,this,[e])};qj("TouchInteractor",ql,{ms_edit:1,setUp:function(){var d=this;Zd.superClass.setUp.call(d),Zk&&d.params.editable&&d.gv.setEditInteractor(d)},tearDown:function(){var $=this;Zd.superClass.tearDown.call($),Zk&&$.params.editable&&$.gv.setEditInteractor(F)},clear:function(Z){var s=this,V=s.gv;V._moving&&(s.fi({kind:"endMove",event:Z}),delete V._moving,V.onMoveEnded(),V.dm().endTransaction()),V._panning&&(s.fi({kind:"endPan",event:Z}),delete V._panning,V.onPanEnded()),V._pinching&&(s.fi({kind:"endPinch",event:Z}),delete V._pinching,V.onPinchEnded()),V._editing&&(s._46O(Z),s._77I=s._node=s._edge=s._shape=s._rect=s._89I=s._index=V._editing=F),s.pendingClickThrough=s._moving=s._panning=s._pinching=s._editing=s._57I=s._data=s._beginHistory=F,s.clearDragging()},handle_touchstart:function(B){var s=this;if(!s.gv._editing){Qq(B),s._57I=F,s.pendingClickThrough=F;var Y=s.params,n=s.gv,J=n.sm(),a=n.getDataAt(B),$=_k(B);if(1===$){if(gm(B))return n.handleDoubleClick(B,a),void 0;n.handleClick(B,a),a&&(n.handleMouseDown&&n.handleMouseDown(B,a),s._data=a),Y.selectable||(a=F),a&&(J.co(a)?a instanceof rs&&a.isClickThroughEnabled()&&(s.pendingClickThrough=ci(B)):J.ss(a),Y.editable&&n.isEditable(a)&&s._79I(B,a,!0)?(s._editing=1,s.startDragging(B)):Y.movable&&n.isMovable(a)&&(s._moving=1,s.startDragging(B))),a&&n.isMovable(a)||(s._57I=ci(B),Y.pannable&&n.isPannable()&&(s._panning=1,s.startDragging(B),s._translate={x:n.tx(),y:n.ty()}))}else if(Y.pinchable&&2===$){if(a&&n._39Q(a))return;s._pinching=1,s.startDragging(B);var v=n.getView(),j=n.getZoom(),G=v.getBoundingClientRect(),z=B.touches[0],S=B.touches[1],r={x:(z.clientX+S.clientX)/2-G.left,y:(z.clientY+S.clientY)/2-G.top};r.x-=n.tx(),r.y-=n.ty(),r.x/=j,r.y/=j,s._p=r,s._d=Ce(B)}}},handle_touchend:function(t){var z=this,n=z.gv,X=z._57I,S=z._data;if(X&&(kj(X,ci(t))<=1&&!n.getDataAt(t)&&n.sm().cs(),z._57I=F),S&&n.handleMouseUp&&n.handleMouseUp(t,S),z.pendingClickThrough){if(kj(z.pendingClickThrough,ci(t))<=1){var S=n.getDataAt(t);if(S instanceof rs&&S.isClickThroughEnabled()){var p=n.getDataAt(t,function(p){var u=p.getParent()===S&&n.isSelectable(p,!0);return u});p&&(t.clickThrough=!0,n.sm().ss(p))}}z.pendingClickThrough=F}},handleWindowTouchEnd:function(j){this.clear(j)},handleWindowTouchMove:function(e){var G=this,R=G.gv,H=_k(e);if(1===H){var p=ci(e),v=Bp(R,p,G._lastClientPoint),F=kj({x:0,y:0},v);if(G._editing&&(G._beginHistory||(G._beginHistory=1,R.dm().beginTransaction()),R._editing=1,G._78I(e)),G._moving){if(!R._moving&&F<C.touchMoveThreshold)return;G._beginHistory||(G._beginHistory=1,R.dm().beginTransaction()),G.handleMove(e)}else if(G._panning){if(!R._panning&&F<C.touchMoveThreshold)return;R.setTranslate(G._translate.x+v.x,G._translate.y+v.y),G.fi({kind:R._panning?"betweenPan":"beginPan",event:e}),R._panning=1}}else if(2===H&&G._pinching){var g=Ce(e);R.handlePinch(G._p,g,G._d),G._d=g,G.fi({kind:R._pinching?"betweenPinch":"beginPinch",event:e}),R._pinching=1}},handleMove:function(m){var E=this,M=E.gv,W=M.lp(m);M._93O&&M._93O(m,E._data)||(M.moveSelection(W.x-E._lastLogicalPoint.x,W.y-E._lastLogicalPoint.y),E._lastLogicalPoint=W,E.autoScroll(m),E.fi({kind:M._moving?"betweenMove":"beginMove",event:m}),M._moving=1)}});var V=b.ht,Tl=V.graph._editor={Math:V.Math,Guide:{}};Tl.getStyle=function(x){var W,c=Tl.StyleMap;return c&&(W=c[x],W!==_)?W:Tl.DefaultStyleMap[x]},Tl.setStyle=function(T,r){var w=Tl.StyleMap;w||(w=Tl.StyleMap={}),w[T]=r},Tl.inEdit=function(l){return l._inXEdit===!0},Tl.startEdit=function(p){p._inXEdit=!0,Tl.Inject.doInject(p)},Tl._46O=function(S){S._inXEdit=!1,Tl.Inject.undoInject(S)},Tl.toScreenPosition=function(j,F){var C=j.tx(),_=j.ty(),Q=j._zoom;return new Tl.Math.Vector2(F.x*Q+C,F.y*Q+_)},Tl.checkHit=function(s,n,w){return s.distanceTo(n)<w?!0:!1},Tl.toWorldPosition=function(K,a){var H=K.tx(),w=K.ty(),k=K._zoom;return{x:(a.x-H)/k,y:(a.y-w)/k}},Tl.setAntialias=function(y,k){for(var I,b=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],z=0,u=b.length;u>z&&(I=b[z],!(I in y));z++);y[I],y[I]=k},Tl.getTargetCornersOnScreen=function(u,G){if(!G)return null;var Y,o=[];if(pf(G,u)){var S=Yc(u,G);Y=[{x:S.x,y:S.y},{x:S.x+S.width,y:S.y},{x:S.x+S.width,y:S.y+S.height},{x:S.x,y:S.y+S.height}]}else{if(!G.getCorners)return null;Y=G.getCorners()}return Y.forEach(function(h){var p=Tl.toScreenPosition(u,h);o.push(p.x,p.y)}),o},Tl.log=function(){};var Zr=Tl.Inject={_modules:[]};Zr.registAsModule=function(p,h){var e={},A={};for(var Y in p){var r=h.prototype[Y];e[Y]=r}p.getBackup=function(b){return e[b]},p.getBackups=function(){return e},A.doInject=function(){for(var j in p)"getBackup"!==j&&(h.prototype[j]=p[j])},A.undoInject=function(){for(var v in p)"getBackup"!==v&&(h.prototype[v]=e[v])},Zr._modules.push(A)},Zr.doInject=function(N){for(var E,d=Zr._modules,_=0,w=d.length;w>_;_++)E=d[_],E.doInject(N)},Zr.undoInject=function(_){for(var B,C=Zr._modules,P=0,O=C.length;O>P;P++)B=C[P],B.undoInject(_)};var ql=V.graph.EditInteractor=function(N){var E=this,C=v.createElement("canvas");C.className="editCanvas",C.style.position="absolute",E._uuid=V.Math.generateUUID(),E._styleMap={},E._canvas=C,E._context=C.getContext("2d"),ql.superClass.constructor.call(E,N),this._editDetail=!1,Tl.setAntialias(E._context,!1),E._subModules=[new Tl.Anchor(E),new Tl.RotateX(E),new Tl.MoveDummy(E),new Tl.Rect(E),new Tl.Curve(E),new Tl.MoveHelper(E)],E._gridGuide=new Tl.Guide.Grid(E),E._rectGuide=new Tl.Guide.Rect(E),E._hoverGuide=new Tl.Guide.Hover(E)
},jo=ql;V.Default.def(ql,V.graph.Interactor,{ms_edit:1,ms_fire:1}),f.defineProperties(ql.prototype,{editDetail:{get:function(){var k=!!this._editDetail;return k},set:function(B){var Z=this,Q=Z._editDetail;Q!==B&&(Z._editDetail=B,Z.gv._editing=B,Z.fp("editDetail",Q,B),Z.fp("pointsEditingMode",Q,B),Z.fi({kind:B?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(K){(!this._editDetail||K)&&(this.gv._editing=K,K||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(G){this._editing=G,this.gvEditing=G}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(G){var A=this;A.editDetail!==G&&(G?A._tryEnterEditDetailMode():A._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var R=this._gridEnabled;if(!R)return!1;var r=this.gv;return r?!0:!0},set:function(k){k!==this._gridEnabled&&(this._gridEnabled=k,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(L){L!==this._agEnabled&&(this._agEnabled=L,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),ql.prototype.getSubModule=function(k){var p,B,I,d=this._subModules;for(B=0,I=d.length;I>B;B++)if(p=d[B],p.catalog===k)return p},ql.prototype.invokeSubModule=function(F,B){for(var r,O,N,k=this,z=k._subModules,i=Array.prototype.slice.call(arguments,2),R=0,Z=z.length;Z>R;R++)if(r=z[R],O=r[F],O&&(N=O.apply(r,i),N!=_&&B))return r},ql.prototype.invokeSubModuleInverse=function(r,p){var z=this,q=z._subModules;if(q)for(var i,d,y,B=Array.prototype.slice.call(arguments,2),U=q.length-1;U>=0;U--)if(i=q[U],d=i[r],d&&(y=d.apply(i,B),y!=_&&p))return i},ql.prototype.setUp=function(){Tl.log("setUp");var p=this,Q=p.gv,f=Q.getView(),l=p._canvas;ql.superClass.setUp.call(p),Q.setEditInteractor(p),Q._79O?f.insertBefore(l,Q._79O):f.appendChild(l),Tl.startEdit(Q),p.invokeSubModule("setUp"),Q.dm().mm(p._onDataModelChanged,p),Q.dm().md(p._onDataPropertyChanged,p)},ql.prototype.tearDown=function(){Tl.log("tearDown");var G=this,e=G.gv,E=e.getView();G._resetCustomCursorStyle(),ql.superClass.tearDown.call(G),e.dm().umm(G._onDataModelChanged,G),e.dm().umd(G._onDataPropertyChanged,G),e.setEditInteractor(null),E.removeChild(G._canvas),G._drawTimer&&(Iq(G._drawTimer),G._drawTimer=null),Tl._46O(e),G.invokeSubModule("tearDown")},ql.prototype._onDataModelChanged=function(e){var q=this;("clear"===e.kind||"remove"===e.kind&&q.editDetail&&e.data===q.getSubModule("Curve").target)&&(q.editDetail=!1,q._42())},ql.prototype._onDataPropertyChanged=function(P){var Q=this;if(Q.editDetail){var O=Q.getSubModule("Curve"),k=P.data;k===O.target&&(k._writing||O._handleDataChanged(P))}},ql.prototype.clear=function(){Tl.log("clear")},ql.prototype.redraw=function(){this._42()},ql.prototype._42=function(){var E=this;E._drawTimer||(E._drawTimer=gr(function(){E._drawTimer=null,E.drawImpl()},0))},ql.prototype.drawImpl=function(){var R;for(R in{_42:!0})break;return function(){var D=this,U=D._canvas,n=D.gv,M=n.getWidth(),H=n.getHeight(),Z=D._context,B=V.Default.getInternal(),L=C.devicePixelRatio;(U.width!==M||U.height!==H)&&B.setCanvas(U,M,H,L),Z.clearRect(0,0,U.width,U.height);var p=D._getValidSelection();Z.save(),Z.scale(L,L),D._gridGuide._42(),D.invokeSubModuleInverse(R,!1,Z,n,p),D._rectGuide._42(),D._hoverGuide._42(),Z.restore()}}(),ql.prototype._getValidSelection=function(){var b=this,o=b.gv,_=o.sm().getSelection(),Z=[];return _.each(function(e){o.isVisible(e)&&o.isEditable(e)&&Z.push(e)}),Z},ql.prototype.handle_touchmove=function(W){return this.handle_mousemove(W)},ql.prototype.handle_mousemove=function(e){if(!V.Default.isDragging()){var t=this;if((t.editDetail||!pc()&&!Gq(e))&&!t.gv._externalEditing)if(t.gvEditing=!1,t._checkEdit(e))t.gvEditing=!0;else{if(!t.getStyle("hoverGuideVisible"))return;t.hoverData=t.gv.getDataAt(e),t._42()}}},ql.prototype.handle_touchstart=function(N){return this.handle_mousedown(N)},ql.prototype.handle_mousedown=function(d){Qq(d);var R=this;if((R.editDetail||!pc()&&!Gq(d))&&!R.gv._externalEditing){if(gm(d)&&!d.clickThrough){if(R.editDetail){if(R._tryQuitEditDetailMode(d))return}else if(R._tryEnterEditDetailMode())return;R.gv.dm().beginTransaction();var m=R.invokeSubModule("handleDoubleClick",!0,d);if(R.gv.dm().endTransaction(),m)return}var T=R._checkEdit(d);T&&(R._downPosition=R._getLogicalPoint(d),R.gv.dm().beginTransaction(),T.startEdit(R,d),R.editing=!0)}},ql.prototype._checkEdit=function(y){var h=this,t=h.gv,d=h._getLogicalPoint(y),X=h.invokeSubModule("check",!0,t,y,d)||null;return h._editMod=X,X},ql.prototype.handleWindowTouchMove=function($){return this.handleWindowMouseMove($)},ql.prototype.handleWindowMouseMove=function(u){var L=this,S=L._downPosition;if(S){var A=L._getLogicalPoint(u);if(A.distanceTo(S)<L.getStyle("moveSensitivity"))return;delete L._downPosition}var i=L._editMod;i&&i.handleEdit(L.gv,u)},ql.prototype._getLogicalPoint=function(K){var j=this,O=V.Default.getLogicalPoint(K,j._canvas);return new Tl.Math.Vector2(O)},ql.prototype.handleWindowTouchEnd=function(A){return this.handleWindowMouseUp(A)},ql.prototype.handleWindowMouseUp=function(){var H;for(H in{_46O:!0})break;return function(C){var j=this;j.editing=!1,j.setCursor("default"),j.invokeSubModule(H,!1,C),j._42(),j.gv.dm().endTransaction()}}(),ql.prototype.handle_mousewheel=function(c){var N=this;Qq(c),N.invokeSubModule("preHandleScroll",!0)||N.gv.handleScroll(c,c.wheelDelta)},ql.prototype.handleDelete=function(){var j=this;if(!j.editDetail){j.gv.dm().beginTransaction();var R=j.invokeSubModule("handleNormalStateDelete",!0);return j.gv.dm().endTransaction(),R||j.gv.removeSelection(),void 0}j.gv.dm().beginTransaction(),j.invokeSubModule("handleDelete",!0),j.gv.dm().endTransaction(),j._42()},ql.prototype.handle_keydown=function(V){var R=this;if((V.metaKey||V.ctrlKey)&&R._42(),pc(V)&&!R.editing)return R.gvEditing=!1,R.setCursor("default"),R._42(),void 0;var M=vb(V);return R.editDetail?((M||dp(V))&&(R.editDetail=!1,R._42()),R.gv.dm().beginTransaction(),R.invokeSubModule("handle_keydown",!0,V),R.gv.dm().endTransaction(),void 0):(R.gv.dm().beginTransaction(),R.invokeSubModule("handleNormalStateKeyDown",!0,V),R.gv.dm().endTransaction(),M&&R._tryEnterEditDetailMode(),void 0)},ql.prototype.handle_keyup=function(B){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,B),this.gv.dm().endTransaction()},ql.prototype._tryEnterEditDetailMode=function(){var f=this;return!f.editDetail&&f.invokeSubModule("canEnterEditDetailMode",!0)&&1===f._getValidSelection().length?(f.editDetail=!0,f._42(),!0):void 0},ql.prototype._tryQuitEditDetailMode=function(i){var Q=this;return Q.editDetail?!i||Q.invokeSubModule("canQuitEditDetailMode",!0,i)?(Q.editDetail=!1,Q._42(),!0):!1:!1},ql.prototype.setStyle=function(s,W,b){var h=this;b?Tl.setStyle(s,W):h._styleMap[s]=W,"baseColor"===s&&(ws=W),h.fp("styleChanged",null,{key:s,value:W,base:b}),h._42()},ql.prototype.getStyle=function(N){var i=this,D=i._styleMap[N];return D!==_?D:Tl.getStyle(N)},ql.prototype.setCursor=function(b){this._resetCustomCursorStyle(),V.graph.EditInteractor.superClass.setCursor.call(this,b)},ql.prototype._drawHostGuide=function(y){var G=this,x=G._context,b=G.gv;Tl.Icons.DrawIcon(G,x,Tl.Icons.NodeHoverGuide,y.corners);var K=y.host;if(K){var U=b.getAttachPoints(K);if(U&&U.length)for(var P=0,n=U.length;n>P;P++){var I=U[P],O=Hl(b,K,0,I.offsetX||0,I.offsetY||0,I.x,I.y);O=Tl.toScreenPosition(b,O),O.isAttach=y.attach===P,Tl.Icons.DrawIcon(G,x,Tl.Icons.AttachPoint,O)}}},ql.prototype._resetCustomCursorStyle=function(){var A=this;if(A._customStyle){var y=this.gv.getView();y.classList&&y.classList.remove&&y.classList.remove(A._customStyle),A._customStyle=null}},ql.prototype._setRotateCursor=function(G){var Y=this,J=Y._cursorFactory;J||(J=Y._cursorFactory=new Tl.CursorFactory(Y));var c=J.getRotateCursor(G),r=Y.gv.getView();Y._resetCustomCursorStyle(),Y._customStyle=c,r.classList&&r.classList.add&&r.classList.add(c)};var Mh=Tl.Group=function(J){var z=this;z._entities=J,z._64O=0,z._position={x:0,y:0},z._scale={x:1,y:1},z._anchor={x:.5,y:.5},z._anchor2={x:.5,y:.5}};Mh.prototype={},Mh.prototype.constructor=Mh;var pj=null,Cd=null;Mh.findOrCreateGroup=function(H,v){if(Cd===v&&pj&&pj.checkIsMe(H))return pj;Cd=v;var s=new Tl.Group(H);return s.getKeyOb()?(pj=s,s):void 0},Mh.prototype.checkIsMe=function(M){var j=this._entities;if(j.length!==M.length)return!1;var L,Z={},U=M.length;for(L=0;U>L;L++)Z[M[L]._id]=!0;for(L=0;U>L;L++)if(!Z[j[L]._id])return!1;return!0},Mh.prototype.getRotation=function(){return this._64O},Mh.prototype.getPosition=function(){return this._position},Mh.prototype.getAnchor=function(){return this._anchor},Mh.prototype.getWidth=function(){return this._width},Mh.prototype.getScale=function(){return this._scale},Mh.prototype.getSize=function(){return{width:this._width,height:this._height}},Mh.prototype.getHeight=function(){return this._height},Mh.prototype.getKeyOb=function(){for(var K=this._entities,v=K.length-1;v>=0;v--){var F=K[v];if(this.isNode(F))return F}},Mh.prototype.getAnchor2=function(){var g=this,O=g.rotateCenter;if(O)return O;var D=g.getKeyOb();if(!D)return g._anchor;var X=g._anchor2,V=D.getMatrix();return V.tf({x:D.getWidth()*(X.x-D.getAnchor().x),y:D.getHeight()*(X.y-D.getAnchor().y)})},Mh.prototype.setAnchor2=function(N,Y){var C=this,x=C.getKeyOb();if(x){var k,i=x.getMatrix();k="number"==typeof N?{x:N,y:Y}:N;var U=i.tfi(k);C._anchor2={x:x.getAnchor().x+U.x/x.getWidth(),y:x.getAnchor().y+U.y/x.getHeight()}}},Mh.prototype.setRotation=function(){},Mh.prototype.beginRotate=function(E){this.rotateCenter=E.pos,this.rotateMode=E.groupRotateMode},Mh.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Mh.prototype.addRotation=function(G,E,P){return"batch"===E?this._addRotationInBatchMode(G,P):"block"===E?this._addRotationInBlockMode(G,P):void 0},Mh.prototype._addRotationInBlockMode=function(V,J){var D=this,j=D.rotateCenter||D.getPosition();D._entities.forEach(function(o){if(D.isNode(o)&&(!J||J(o))){var x=o.getMatrix();x.translate(-j.x,-j.y),x.rotate(V),x.translate(j.x,j.y);var h=Math.sign(o.getScale().x);o.setRotation(ub(x.b*h,x.a*h)),o.setPosition(x.tx,x.ty)}})},Mh.prototype._addRotationInBatchMode=function(q,I){var $=this,i=$._anchor2;$._entities.forEach(function(u){if($.isNode(u)&&(!I||I(u))){var P=u.getAnchor(),n=u.getMatrix(),m=n.tf({x:u.getWidth()*(i.x-P.x),y:u.getHeight()*(i.y-P.y)}),F=new Tl.Math.Matrix2d;F.set(n.a,n.b,n.c,n.d,n.tx,n.ty),F.translate(-m.x,-m.y),F.rotate(q),F.translate(m.x,m.y);var l=Math.sign(u.getScale().x);u.setRotation(ub(F.b*l,F.a*l)),u.setPosition(F.tx,F.ty)}})},Mh.prototype.setPosition=function(G){var B,n,M,P,s=this,m=s._position,Z=G.x-m.x,_=G.y-m.y,X=s._entities;for(n=0,M=X.length;M>n;n++)B=X[n],be(B)&&(P=B.getPosition(),B.setPosition(P.x+Z,P.y+_));s._position=G},Mh.prototype.setScale=function(x,v){var z=this,D=x/z._scale.x,j=v/z._scale.y;z._adjustChildScaleOrSize(D,j,"size"),z._scale={x:x,y:v}},Mh.prototype.getRect=function(){var k=this,Q=k._position,I=k._width,$=k._height;return{x:Q.x-I/2,y:Q.y-$/2,width:I,height:$}},Mh.prototype.setSize=function(Q,i){var H=this,Q=Math.max(1,Q),i=Math.max(1,i),_=Q/H._width,P=i/H._height;H._adjustChildScaleOrSize(_,P,"size"),H._width=Q,H._height=i},Mh.prototype._adjustChildScaleOrSize=function(D,W,Z){var k,V,m,S,u,n,b,x,G,w,g,C,z,A,H=this,v=H._position,X=H._entities,l=new Tl.Math.Matrix2d;for(V=0,m=X.length;m>V;V++)if(k=X[V],H.isNode(k)){if(S=k.getPosition(),u=k.getRotation(),n=k.getWidth(),b=k.getHeight(),x=k.getScale(),g=x.x*n,C=x.y*b,l.identity().scale(g,C).rotate(u).translate(S.x,S.y).translate(-v.x,-v.y).rotate(-H._64O),u=ub(l.b*Math.sign(g),l.a*Math.sign(g)),l.scale(D,W),G=Math.cos(u),w=Math.sin(u),Math.abs(G)<.001?(z=l.b/w,A=-l.c/w):(z=l.a/G,A=l.d/G),"scale"===Z)k.setScale(z/n,A/b);else if("size"===Z){var r=z/x.x,Q=A/x.y;k.setScale(to(z)*Math.abs(x.x),to(A)*Math.abs(x.y)),k.setSize(Math.max(.1,Math.abs(r)),Math.max(.1,Math.abs(Q)))}l.rotate(H._64O).translate(v.x,v.y),k.setPosition(l.tx,l.ty)}},Mh.prototype.getMatrix=function(){var _=this,r=_._position,u=V.Default.getInternal(),T=_._scale;return new u.Mat(_._64O,r.x,r.y,T.x,T.y)},Mh.prototype.toGlobal=function(v){return this.getMatrix().tf(v)},Mh.prototype.getCorners=function(){var G=this,H=G._width,m=G._height,k=G._anchor,o=-H*k.x,W=-m*k.y,q=G.getMatrix();return[q.tf(o,W),q.tf(o,W+m),q.tf(o+H,W+m),q.tf(o+H,W)]},Mh.prototype.calcInfo=function(){var s,t,u,$,Q,O,z=this,m=[],K=z._entities,E=z._64O;for($=0,Q=K.length;Q>$;$++)O=K[$],z.isNode(O)&&O.getCorners&&m.push.apply(m,O.getCorners());if(m.length){var P=Math.cos(-E),k=Math.sin(-E),G=1/0,h=-1/0,l=1/0,a=-1/0;for($=0,Q=m.length;Q>$;$++)u=m[$],s=u.x,t=u.y,u.x=P*s-k*t,u.y=k*s+P*t,G=Math.min(G,u.x),h=Math.max(h,u.x),l=Math.min(l,u.y),a=Math.max(a,u.y);z._width=(h-G)/z._scale.x,z._height=(a-l)/z._scale.y,P=Math.cos(E),k=Math.sin(E);var n=z._anchor;s=G+(h-G)*n.x,t=l+(a-l)*n.y,z._position={x:P*s-k*t,y:k*s+P*t}}},Mh.prototype.isNode=function(S){return be(S)?pf(S)?S.size()?!1:!0:!0:!1},Mh.prototype._42=function(a,C,e){var c,i,r,_,X,m,S,N,g=this,l=g._entities,G=g.rotateMode;for("batch"===G&&(N=g.getKeyOb()),c=0,i=l.length;i>c;c++)r=l[c],g.isNode(r)&&(m=r.getRect(),_=Tl.toScreenPosition(e,{x:m.x,y:m.y}),X=Tl.toScreenPosition(e,{x:m.x+m.width,y:m.y+m.height}),S={min:_,max:X},r===N&&(S.isKeyOb=!0),Tl.Icons.DrawIcon(a,C,Tl.Icons.GroupSubEntityRect,S))};var Wm=Tl.CurveActiving=function(F,C){this._curve=F,this._interactor=F._interactor,this.silent=!0;for(var Y in C)this[Y]=C[Y];delete this.silent};Wm.prototype={},Wm.prototype.constructor=Wm,f.defineProperties(Wm.prototype,{point:{get:function(){return this._point},set:function(W){var r=this;r._point=W,r.editingCtrl||r.silent||r._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(O){var i=this;i._pairs=O,i.editingCtrl&&!i.silent&&i._firePointChange()}}}),Wm.prototype._firePointChange=function(){var T=this,W=T.getCurrentEditingPoint(),G=T._interactor;if(!W)return G.fi({kind:"selectPoint"}),void 0;var h=this._curve.target;if(h){var f=Tl.getDataMatrix(h).invert(),M=W.e;W=f.apply(Tl.toWorldPosition(G.gv,W)),W.e=M;var p=T._lastFirePoint;p&&Math.abs(W.x-p.x)<1e-5&&Math.abs(W.y-p.y)<1e-5&&(W.e==_&&p.e==_||Math.abs(W.e-p.e)<1e-5)||(T._lastFirePoint=W,G.fi({kind:"selectPoint",x:W.x,y:W.y,e:W.e}))}},Wm.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Wm.prototype.getCurrentEditingPoint=function(){var N=this,d=N.editingCtrl;if(d){var J=N.pairs;if(J){var S=J[d.pairId];if(S){var O=S[d.type];if(O)return O}}}return N._point};var rg=Tl.CursorFactory=function($){var U=this;U._interactor=$,U._rotateCursorStyles={}};rg.prototype={},rg.prototype.constructor=rg,rg.prototype.getRotateCursor=function(N){var A=this;0>N&&(N+=2*Math.PI);var K=A._interactor,G=K.getStyle("rotateCursorSize"),r=K.getStyle("rotateCursorRound"),Z=Math.round(180*(N/Math.PI)/r);Z*r>=360&&(Z=0);var g=A._rotateCursorStyles,e="htCustomRotateStyle_"+G+"_"+r+"_"+Z;return g[e]||(A._produceRotateCursor(e,G,r,Z),g[e]=!0),e},rg.prototype._produceRotateCursor=function(X,q,Z,G){var t=this;t._interactor;var V=t._canvas;V||(V=t._canvas=v.createElement("canvas"));var h=C.devicePixelRatio;V.width=V.height=q*h,V.style.width=V.style.height=q+" px";var n=V.getContext("2d");Tl.setAntialias(n,!1),n.scale(h,h);var R,P,Q,g,o,M=Math.round(q/2),J=""+M+" "+M+",auto !important;",F=4;R=Math.PI/180*G*Z,n.clearRect(0,0,q,q),n.save(),n.scale(q/32,q/32),n.translate(16,15),n.rotate(R+Math.PI/2),n.beginPath(),n.moveTo(-8,0),n.lineTo(-8,F),n.lineTo(-8+F,F),n.moveTo(8,0),n.lineTo(8,F),n.lineTo(8-F,F),n.moveTo(-8,F),n.quadraticCurveTo(0,-6,8,F),n.restore(),n.lineCap="round",n.lineJoin="miter",n.strokeStyle="white",n.lineWidth=4,n.stroke(),n.strokeStyle="black",n.lineWidth=2,n.stroke(),P=JSON.stringify(V.toDataURL()),g="cursor:url("+P+")"+J,1!==h&&(Q='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+q+'px" height="'+q+'px"><image xlink:href='+P+' width="'+q+'" height="'+q+'"/></svg>',g+="cursor:url(data:image/svg+xml;base64,"+btoa(Q)+")"+J,g+="cursor:-webkit-image-set(url("+P+")"+h+"x,url("+P+")1x)"+J),o=v.createElement("style"),o.textContent="body."+X+" *, ."+X+"{"+g+"}",v.head.appendChild(o)};var um=Tl.Guide.Grid=function(R){var E=this;E._interactor=R,E._alignmentGuideId=0,E._xAlignmentGuide=[],E._yAlignmentGuide=[]};um.prototype={},um.prototype.constructor=um,f.defineProperties(um.prototype,{gridBlockSize:{get:function(){var t=this;return t._gridBlockSize||t._interactor.getStyle("gridBlockSize")},set:function(V){this._gridBlockSize=V,this._interactor._42()}},gridThickLinesEvery:{get:function(){var Y=this;return Y._gridThickLinesEvery||Y._interactor.getStyle("gridThickLinesEvery")},set:function(B){this._gridThickLinesEvery=B,this._interactor._42()}},gridEnabled:{get:function(){var d=this,X=d._interactor;return X.gridEnabled&&d.isValidGrid()}}}),um.prototype._42=function(){var I=this,c=I._interactor;I.gridEnabled&&I.drawGrid(),c.alignmentGuideEnabled&&I.drawAlignmentGuide()},um.prototype.makeMatrix=function(){var m=this,i=m._interactor.getStyle("gridAngle"),a=m._interactor.getStyle("gridRotation"),Z=new Tl.Math.Matrix2d,e=Math.sin(i),F=Math.cos(i);return Z.set(1,0,F,e,0,0),Z.rotate(a),Z},um.prototype.isValidGrid=function(){var I=this,L=Math.PI,G=I._interactor,q=G.gv;if(q._zoom<G.getStyle("gridZoomThreshold"))return!1;var g=G.getStyle("gridAngle"),k=Math.abs(180*(g%L/L)),N=1-1e-8;return N>k||k>180-N?!1:!0},um.prototype.drawAlignmentGuide=function(){var v=this,_=v._interactor,y=_.gv,Y=_._canvas,$=_._context,p=Y.width,N=Y.height,s=y.tx(),r=y.ty(),D=y._zoom;$.beginPath(),$.strokeStyle=_.getStyle("gridAlignmentGuideColor"),$.lineWidth=1,v._xAlignmentGuide.forEach(function(Z){var U=Z.p*D+s;$.moveTo(U,0),$.lineTo(U,N)}),v._yAlignmentGuide.forEach(function(A){var I=A.p*D+r;$.moveTo(0,I),$.lineTo(p,I)}),$.stroke()},um.prototype.drawGrid=function(){function j(Y,e,a,u){var n=Tl.toScreenPosition(i,z.apply({x:Y,y:e})),N=Tl.toScreenPosition(i,z.apply({x:a,y:u}));G.moveTo(n.x,n.y),G.lineTo(N.x,N.y)}var h=this,m=h._interactor,N=h.gridBlockSize,e=h.gridThickLinesEvery,O=m.getStyle("gridThickColor"),E=m.getStyle("gridLightColor"),i=m.gv,L=m._canvas,G=m._context,f=L.width,F=L.height,z=h.makeMatrix(),U=z.applyInverse(Tl.toWorldPosition(i,{x:0,y:0})),C=z.applyInverse(Tl.toWorldPosition(i,{x:f,y:0})),V=z.applyInverse(Tl.toWorldPosition(i,{x:0,y:F})),B=z.applyInverse(Tl.toWorldPosition(i,{x:f,y:F})),w=Math.min(U.x,C.x,V.x,B.x),H=Math.max(U.x,C.x,V.x,B.x),S=Math.min(U.y,C.y,V.y,B.y),g=Math.max(U.y,C.y,V.y,B.y);f=H-w,F=g-S;var n=Math.ceil(w/N),a=Math.floor(H/N),A=Math.ceil(S/N),R=Math.floor(g/N);i.tx(),i.ty(),i._zoom;var v,Z,s;for(G.save(),G.lineWidth=1,G.beginPath(),G.strokeStyle=O,s=Math.ceil(n/e)*e;a>=s;s+=e)v=s*N,j(v,S,v,g);for(s=Math.ceil(A/e)*e;R>=s;s+=e)Z=s*N,j(w,Z,H,Z);for(G.stroke(),G.beginPath(),G.strokeStyle=E,s=n;a>=s;s++)0!==s%e&&(v=s*N,j(v,S,v,g));for(s=A;R>=s;s++)0!==s%e&&(Z=s*N,j(w,Z,H,Z));G.stroke(),G.restore()},um.prototype.getAlignmentGuides=function(){var N=this;return{x:N._xAlignmentGuide,y:N._yAlignmentGuide}},um.prototype.addAlignmentGuide=function(H,a,F){var y=this,g="x"===H?y._xAlignmentGuide:y._yAlignmentGuide,F=F?F:++y._alignmentGuideId,G={p:a,id:F};if(g.length){var R=y._findClosestAlignmentGuide(G.p,g);R.dis<0?g.splice(R.index+1,0,G):g.splice(R.index,0,G)}else g.push(G);return y._interactor._42(),F},um.prototype.findClosest=function(Q,R,e){var Y=this,v=Y._interactor,s=v.gv;e&&(Q=Tl.toWorldPosition(s,Q));var k,p,V,N=1/0,B=1/0,b=Q.x,q=Q.y;if(Y.gridEnabled){var W=Y.gridBlockSize,m=Y.makeMatrix(),L=m.applyInverse(Q);L=m.apply({x:Math.round(L.x/W)*W,y:Math.round(L.y/W)*W}),N=L.x-b,B=L.y-q,V=!0}if(v.alignmentGuideEnabled&&(k=Y._findClosestAlignmentGuide(b,Y._xAlignmentGuide).dis,p=Y._findClosestAlignmentGuide(q,Y._yAlignmentGuide).dis,Math.abs(k)<Math.abs(N)&&(N=k,V=!0),Math.abs(p)<Math.abs(B)&&(B=p,V=!0)),V){V=!1;var $=s._zoom,r=v.getStyle("smartGuideThreshold")/$,T={};if(Math.abs(N)<r&&"y"!==R&&(T.x=e?N*$:N,V=!0),Math.abs(B)<r&&"x"!==R&&(T.y=e?B*$:B,V=!0),V)return T}},um.prototype._findClosestAlignmentGuide=function(G,D){if(!D.length)return{dis:1/0};for(var Y,v=0,E=D.length-1;E-v>1;)Y=Math.floor((v+E)/2),D[Y].p<G?v=Y:E=Y;var o=D[v].p-G,R=D[E].p-G;return Math.abs(o)<=Math.abs(R)?{line:D[v],dis:o,index:v}:{line:D[E],dis:R,index:E}},um.prototype.removeAllAlignmentGuide=function(Y){var K=this;"y"!==Y&&(K._xAlignmentGuide=[]),"x"!==Y&&(K._yAlignmentGuide=[]),K._interactor._42()},um.prototype.removeAlignmentGuide=function(f){for(var n,A,$,P=this,K=P._xAlignmentGuide,r=0;2>r;r++)for(K=0===r?P._xAlignmentGuide:P._yAlignmentGuide,n=0,A=K.length;A>n;n++)if($=K[n],$.id===f)return K.splice(n,1),P._interactor._42(),{axis:0===r?"x":"y",position:$.p};return!1},um.prototype.adjustAlignmentGuide=function(Y,F){var P=this,p=P.removeAlignmentGuide(Y);return p?(P.addAlignmentGuide(p.axis,F,Y),!0):!1};var Zc=Tl.Guide.Rect=function(R){var L=this;L._interactor=R};Zc.prototype={},Zc.prototype.constructor=Zc,Zc.prototype.gatherRects=function(){var H,u,M,r,B=this,h=B._interactor.gv,y=[],w=[],x={x:y,y:w},P={},G=h.getDataModel(),S=G.a("width"),Z=G.a("height");S&&Z&&(H=0,u=0,M=S,r=Z,y.push({node:G,type:0,p:H},{node:G,type:1,p:H+M/2},{node:G,type:2,p:H+M}),w.push({node:G,type:0,p:u},{node:G,type:1,p:u+r/2},{node:G,type:2,p:u+r}),P[G._id||0]={x:H,y:u,width:M,height:r}),G.each(function(b){if(be(b)&&!h.isSelected(b)&&h.isVisible(b)&&h.isValidGuideLineSource(b)){var D=!1;if(h.sm().getSelection().each(function(g){D||(b.isHostOn(g)?D=!0:b.isDescendantOf(g)&&(D=!0))}),!D){var s=b.getRect();H=s.x,u=s.y,M=s.width,r=s.height,y.push({node:b,type:0,p:H},{node:b,type:1,p:H+M/2},{node:b,type:2,p:H+M}),w.push({node:b,type:0,p:u},{node:b,type:1,p:u+r/2},{node:b,type:2,p:u+r}),P[b._id]=s}}}),y.sort(function(r,G){return r.p-G.p}),w.sort(function(Z,C){return Z.p-C.p}),B._grid=x,B._87I=P},Zc.prototype.gatherLines=function(S,j,D){var q,p,r,_,I,c,V,G,v,d,h,L,s=this,U=[s.findClosest({x:S.x,y:S.y},j),s.findClosest({x:S.x+S.w/2,y:S.y+S.h/2},j),s.findClosest({x:S.x+S.w,y:S.y+S.h},j)],t={},a=s._87I;D=D||255;var f,u;for(s._guideLine=[],q=0;2>q;q++)for(t={},0===q?(_="y",G=S.x,v=G+S.w):(_="x",G=S.y,v=G+S.h),p=0;3>p;p++)I=U[p],I&&isFinite(I[_])&&(f=1<<3*q+p,D&f&&(c=I[_+"Line"],V=c.node,u=V._id||0,t[u]||(t[u]=!0,L=a[u],"y"===_?(d=L.x,h=L.x+L.width):(d=L.y,h=L.y+L.height),r=c.p,s._guideLine.push({type:_,a:G,b:v,c:d,d:h,p:r,center:1===c.type}))))},Zc.prototype._binarySearchClosest=function(B,$){if(!$.length)return{dis:1/0};for(var e,R=0,X=$.length-1;X-R>1;)e=Math.floor((R+X)/2),$[e].p<B?R=e:X=e;var s=$[R].p-B,l=$[X].p-B;return Math.abs(s)<=Math.abs(l)?{line:$[R],dis:s}:{line:$[X],dis:l}},Zc.prototype.findClosest=function(K,O,Q){var P=this,S=P._interactor,I=S.gv,R=P._grid;Q&&(K=Tl.toWorldPosition(I,K));var Y,T=P._binarySearchClosest(K.x,R.x),c=P._binarySearchClosest(K.y,R.y),j=T.dis,X=c.dis,L=I._zoom,C=S.getStyle("smartGuideThreshold")/L,x={};return Math.abs(j)<C&&"y"!==O&&(x.x=Q?j*L:j,x.xLine=T.line,Y=!0),Math.abs(X)<C&&"x"!==O&&(x.y=Q?X*L:X,x.yLine=c.line,Y=!0),Y?x:void 0},Zc.prototype._42=function(){var e=this,o=e._guideLine;if(o&&!V.Default.isCtrlDown()){var q=e._interactor;if(q.getStyle("guideLineVisible")){var z,k,c,i,v,a,x,n,L,r,C,N,S,H,f,b,w,_=q.gv,h=q._context,d=_.tx(),p=_.ty(),j=_._zoom,X=q.getStyle("guideLineTextSpacing");for(z=0,k=o.length;k>z;z++)c=o[z],n=c.type,L=c.p,r=c.a,C=c.b,N=c.c,S=c.d,H=Math.min(r,N),f=Math.max(C,S),"x"===n?(i=L*j+d,v=H*j+p,a=i,x=f*j+p):(i=H*j+d,v=L*j+p,a=f*j+d,x=v),Tl.Icons.DrawIcon(q,h,Tl.Icons.MoveLineGuide,{rect:[i,v,a,x],center:c.center}),S>=r&&C>=N||(H=r>S?S:C,f=r>S?r:N,w=f-H,"x"===n?(c.center2center||(i-=X,a=i),v=H*j+p,x=f*j+p,b=Tl.Icons.MoveLineGuideDistanceV):"y"===n&&(c.center2center||(v-=X,x=v),i=H*j+d,a=f*j+d,b=Tl.Icons.MoveLineGuideDistanceH),Tl.Icons.DrawIcon(q,h,b,{x0:i,y0:v,x1:a,y1:x,dis:w}))}}},Zc.prototype.clear=function(){this._guideLine=null};var cp=Tl.Guide.Hover=function(m){var r=this;r._interactor=m};cp.prototype={},cp.prototype.constructor=cp,f.defineProperties(cp.prototype,{}),cp.prototype._42=function(){var $=this._interactor;if($.getStyle("hoverGuideVisible")&&!$.gvEditing){var G=$.hoverData,I=$.gv;if(!be(G)||I.isSelected(G))return $.hoverData=null,void 0;var _=Yc(I,G),j=Tl.toScreenPosition(I,{x:_.x,y:_.y}),r=Tl.toScreenPosition(I,{x:_.x+_.width,y:_.y+_.height});Tl.Icons.DrawIcon($,$._context,Tl.Icons.HoverDataRect,{min:j,max:r,color:$.getStyle("hoverGuideColor")||$.getStyle("baseColor")})}},Tl.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Ao=Tl.Icons={},Bg=1e4,Fi=null,ws=Tl.DefaultStyleMap.baseColor,yr="rgb(183,232,135)",Eh="rgb(255,204,153)",Ck=6;V.Default.setImage("Icons.RectPoint",{width:Ck,height:Ck,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return ws}},rect:[0,0,Ck,Ck]}]}),Ao.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var e=Ao.GroupSubEntityRect.data;if(!e)return[];var d=e.min,m=e.max;return[d.x,d.y,d.x,m.y,m.x,m.y,m.x,d.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Ao.GroupSubEntityRect.data.isKeyOb?ws:ws}}}]};var Bn=4;Ao.HoverDataRect={comps:[{type:"shape",points:{func:function(){var l=Ao.HoverDataRect.data;if(!l)return[];var b=l.min,t=l.max,S=Bn;return b.x-=S,b.y-=S,t.x+=S,t.y+=S,[b.x,b.y,b.x,t.y,t.x,t.y,t.x,b.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Ao.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},Ao.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Ao.Line.data.P1.x,Ao.Line.data.P1.y],Ck,Ck]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Ao.Line.data.P2.x,Ao.Line.data.P2.y],Ck,Ck]}}}]},Ao.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Ao.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Ao.Rect={comps:[{type:"shape",points:{func:function(){var b=Ao.Rect.data;if(!b)return[];var F=b.LT,p=b.LB,$=b.RB,D=b.RT;return[F.x,F.y,p.x,p.y,$.x,$.y,D.x,D.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return ws}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ao.Rect.data.rotation}},rect:{func:function(){return[[Ao.Rect.data.LT.x,Ao.Rect.data.LT.y],Ck,Ck]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ao.Rect.data.rotation}},rect:{func:function(){return[[Ao.Rect.data.LB.x,Ao.Rect.data.LB.y],Ck,Ck]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ao.Rect.data.rotation}},rect:{func:function(){return[[Ao.Rect.data.RB.x,Ao.Rect.data.RB.y],Ck,Ck]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ao.Rect.data.rotation}},rect:{func:function(){return[[Ao.Rect.data.RT.x,Ao.Rect.data.RT.y],Ck,Ck]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ao.Rect.data.rotation}},visible:{func:function(){return Ao.Rect.data.L?!0:!1}},rect:{func:function(){return[[Ao.Rect.data.L.x,Ao.Rect.data.L.y],Ck,Ck]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ao.Rect.data.rotation}},visible:{func:function(){return Ao.Rect.data.R?!0:!1}},rect:{func:function(){return[[Ao.Rect.data.R.x,Ao.Rect.data.R.y],Ck,Ck]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ao.Rect.data.rotation}},visible:{func:function(){return Ao.Rect.data.T?!0:!1}},rect:{func:function(){return[[Ao.Rect.data.T.x,Ao.Rect.data.T.y],Ck,Ck]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ao.Rect.data.rotation}},visible:{func:function(){return Ao.Rect.data.B?!0:!1}},rect:{func:function(){return[[Ao.Rect.data.B.x,Ao.Rect.data.B.y],Ck,Ck]}}}]};var Zn=16;V.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return ws}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return ws}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Ao.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Ao.Anchor.data.POS.x,Ao.Anchor.data.POS.y],Zn,Zn]}}}]},Ao.TipShiftX=12,Ao.TipShiftY=12;var oi=[8,28];Ao.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Ao.TipHelper.data.helperPos.x,Ao.TipHelper.data.helperPos.y,oi[0]*Ao.TipHelper.data.size,oi[1]]}},background:{func:function(){return Fi.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Ao.TipHelper.data.text}},rect:{func:function(){return[Ao.TipHelper.data.helperPos.x,Ao.TipHelper.data.helperPos.y,oi[0]*Ao.TipHelper.data.size,oi[1]]}},color:{func:function(){return Fi.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var dq=7;Ao.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Ao.ShapePoint.data.dynamicVisible}},rect:{func:function(){var X=Ao.ShapePoint.data.point,v=Ao.ShapePoint.data.size||dq;return[X,v+10,v+10]}},background:{func:function(){var C=Date.now(),l=Ao.ShapePoint.data.dynamicPeriod||1500,V=Math.sin(C%l/l*Math.PI);return"rgba(27,124,22,"+.5*V+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var T=Ao.ShapePoint.data.point,y=Ao.ShapePoint.data.size||dq;return[T,y,y]}},background:{func:function(){var U=Ao.ShapePoint.data.isEnd;return U?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Ao.ShapePoint.data.color||ws}}},{type:"rect",visible:{func:function(){return!!Ao.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return ws}},rect:{func:function(){var N=5;return[Ao.ShapePoint.data.point,N,N]}}}]},Ao.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Ao.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Ao.ShapeBgCurve.data.P}},segments:{func:function(){return Ao.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var _=Date.now(),w=Ao.ShapeBgCurve.data.dynamicPeriod||1500,a=Math.sin(_%w/w*Math.PI);return"rgba(27,124,22,"+.3*a+")"
}}},{type:"shape",points:{func:function(){return Ao.ShapeBgCurve.data.P}},segments:{func:function(){return Ao.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Ao.ShapeBgCurve.data.color||ws}}}]};var Rl=8;Ao.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var c=Ao.ShapeHighlighPoint.data;return[[c.x,c.y],Rl,Rl]}},background:{func:function(){return Fi.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Fl=10;Ao.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var s=Ao.ShapeHighlighRealPoint.data;return[[s.x,s.y],Fl,Fl]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return ws}}}]};var Um=8;Ao.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var b=Ao.ShapeHighlighCtrlPoint.data,h=b.x,g=b.y,E=Um/2;return[h-E,g-E,h-E,g+E,h+E,g+E,h+E,g-E]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Fi.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Fi.getStyle("shapeCtrlPointBorderColor")||ws}}}]};var gb=3;Ao.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Ao.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:gb,borderColor:{func:function(){return Fi.getStyle("curveHighlightColor")}}}]},Ao.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Ao.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Ao.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Ao.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Ao.MoveLineGuide.data.center?yr:Eh}}}]};var Ge=5;Ao.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var b=Ao.MoveLineGuideDistanceH.data,_=b.x0,z=b.y0;return[_,z-Ge,_,z+Ge]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Eh},{type:"shape",points:{func:function(){var A=Ao.MoveLineGuideDistanceH.data,H=A.x1,i=A.y1;return[H,i-Ge,H,i+Ge]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Eh},{type:"text",text:{func:function(){return Math.round(Ao.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var y=Ao.MoveLineGuideDistanceH.data;return[[(y.x0+y.x1)/2,y.y0-10],20,20]}},color:Eh,font:"12px Arial",align:"center"}]},Ao.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var o=Ao.MoveLineGuideDistanceV.data,L=o.x0,S=o.y0;return[L-Ge,S,L+Ge,S]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Eh},{type:"shape",points:{func:function(){var o=Ao.MoveLineGuideDistanceV.data,U=o.x1,K=o.y1;return[U-Ge,K,U+Ge,K]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Eh},{type:"text",text:{func:function(){return Math.round(Ao.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var q=Ao.MoveLineGuideDistanceV.data;return[[q.x0-10,(q.y0+q.y1)/2],20,20]}},color:Eh,font:"12px Arial",align:"center"}]},V.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Ao.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var d=Ao.EdgeElevationGuide.data,N=d.x,R=d.y,p=Fi.getStyle("curveElevationIntersectSize"),S=Fi.getStyle("curveElevationGuideShift");return N+=S[0],R+=S[1],[N-p,R-p,2*p,2*p]}}}]},V.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),V.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Ao.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Ao.ConnectGuide.data.rotation}},rect:{func:function(){var C=Ao.ConnectGuide.data.connect;C.x,C.y;var g=Fi.getStyle("connectGuideIntersectSize");return[[C.x,C.y],2*g,2*g]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var u=Ao.ConnectGuide.data.cursorPos||Ao.ConnectGuide.data.connect,i=Fi.getStyle("connectGuideIntersectSize");return[[u.x,u.y],2*i-2,2*i-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var I=Ao.ConnectGuide.data.connect,y=Ao.ConnectGuide.data.cursorPos||I;return[I.x,I.y,I.x+.5*(y.x-I.x),I.y,y.x+.5*(I.x-y.x),y.y,y.x,y.y]}}}]},V.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),V.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Ao.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var x=Ao.ConnectGuideGarbage.data.hover;return x?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var _=Ao.ConnectGuideGarbage.data,S=Fi.getStyle("connectGuideGarbageIntersectsize");return _.hover&&(S+=5),[[_.x,_.y],2*S,2*S]}}}]};var Nr=6;Ao.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Ao.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var l=Ao.ShapeActivingCtrl.data;return[l.point.x,l.point.y,l.c1.x,l.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return ws}}},{type:"shape",visible:{func:function(){return Ao.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var q=Ao.ShapeActivingCtrl.data;return[q.point.x,q.point.y,q.c2.x,q.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return ws}}},{type:"shape",visible:{func:function(){return Ao.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var V=Ao.ShapeActivingCtrl.data.c1,y=V.x,L=V.y,T=Nr/2;return"c1"===Ao.ShapeActivingCtrl.data.hl&&(T+=.5),[y-T,L-T,y-T,L+T,y+T,L+T,y+T,L-T]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Fi.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Ao.ShapeActivingCtrl.data.hl?Fi.getStyle("shapeCtrlPointHighlightBorder")||ws:Fi.getStyle("shapeCtrlPointBorderColor")||ws}}},{type:"shape",visible:{func:function(){return Ao.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var J=Ao.ShapeActivingCtrl.data.c2,t=J.x,j=J.y,$=Nr/2;return"c2"===Ao.ShapeActivingCtrl.data.hl&&($+=.5),[t-$,j-$,t-$,j+$,t+$,j+$,t+$,j-$]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Fi.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Ao.ShapeActivingCtrl.data.hl?Fi.getStyle("shapeCtrlPointHighlightBorder")||ws:Fi.getStyle("shapeCtrlPointBorderColor")||ws}}}]},Ao.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return ws}},rect:{func:function(){return[[Ao.RoundPoint.data.x,Ao.RoundPoint.data.y],Ck,Ck]}}}]},Ao.AttachPoint={comps:[{type:"rect",background:{func:function(){return Ao.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return ws}},rect:{func:function(){var x=Ao.AttachPoint.data.isAttach?Ck+4:Ck;return[[Ao.AttachPoint.data.x,Ao.AttachPoint.data.y],x,x]}}}]},Ao.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Ao.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Ao.SimpleRect.data.color||ws}},rect:{func:function(){var t=Ao.SimpleRect.data;return[t.x,t.y,t.width,t.height]}}}]},V.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Ao.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var R=Ao.MoveDummy.data;return[[R.pos.x,R.pos.y],2*R.size,2*R.size]}}}]},Tl.Icons.DrawIcon=function(J,O,c,K){c.width=c.height=Bg,c.data=K,Fi=J,V.Default.drawImage(O,c,0,0,Bg,Bg)},Tl.Icons.MapPoints=function(t,J){for(var U=0,z=t.length;z>U;U++)t[U]/=J},Tl.roundTo=function(x,l,D){var c=Math.abs(x%l);return D>c||D>l-c?l*Math.round(x/l):x},Tl.toFixed=function(t){return Math.round(100*t)/100},Tl.getDataMatrix=function(W){if(W instanceof V.Shape){var d=new V.Math.Matrix2d,C=W.getPosition();return d.translate(-C.x,-C.y).scale(W.getScale().x,W.getScale().y).rotate(W.getRotation()).translate(C.x,C.y),d}return W.getMatrix?W.getMatrix():new V.Math.Matrix2d};var Tf=Tl.Math.Curve=function(){this._curves=[]};Tf.prototype={},Tf.prototype.constructor=Tf,Tf.prototype.createFromHtShape=function(J,C,I){C instanceof V.List&&(C=C.toArray());var M,P,w,O,g,x,Z,A=this,D=null,W=null,L=0,H=Tl.Math.Vector2,j=Tl.Math.CubicBezier,h=function(j){return new H(J[j],J[j+1],I?I[j/2]:_)};for(P=0,w=C.length;w>P;P++){switch(O=C[P],g=null,O){case 1:W=h(L),D=W,L+=2;break;case 2:M=h(L),L+=2,g=new j(W,W.clone(),M.clone(),M),W=M;break;case 3:x=h(L),M=h(L+2),L+=4,g=new j(W,x.clone().sub(W).multiplyScalar(2/3).add(W),x.clone().sub(M).multiplyScalar(2/3).add(M),M),W=M;break;case 4:x=h(L),Z=h(L+2),M=h(L+4),L+=6,g=new j(W,x,Z,M),W=M;break;case 5:if(!D)break;g=new j(W,W.clone(),D.clone(),D),W=null,D=null}g&&(g._index=A._curves.length,A._curves.push(g))}},Tf.prototype.checkPoint=function(q,I){var G,W,m,Z,x,w=this,P=w._curves;for(G=0,W=P.length;W>G;G++)if(Z=P[G],x=Z.intersectRect(q,I,I),x.length)return m=0,x.forEach(function(z){m+=z.t}),m/=x.length,q=Z.getPointAt(m),q.t=m,{bezier:Z,intersection:q}},Tf.prototype.insertKnot=function(B,D){var j=B.insertKnot(D),p=this,J=p._curves;J.splice(B._index,1,j[0],j[1])},Tf.prototype._isCloseEnough=function(l,W){return Math.abs(l.x-W.x)<1e-6&&Math.abs(l.y-W.y)<1e-6},Tf.prototype._isSamePoint=function(z,t){return z===t},Tf.prototype.moveRealPoint=function(z,Y){var S=this,I=S._curves,X=Y.clone().sub(z);I.forEach(function(p){var o=p._p1;p._p2,p._p3;var j=p._p4;S._isSamePoint(o,z)&&(p._p2.add(X),p._p1=Y),S._isSamePoint(j,z)&&(p._p3.add(X),p._p4=Y)})},Tf.prototype.moveCtrlDueToRealPointMovement=function(g,V){var z=this,v=z._curves,L=function(J){J.add(V),J.e&&V.e&&(J.e+=V.e)};v.forEach(function(N){var G=N._p1;N._p2,N._p3;var O=N._p4;z._isSamePoint(G,g)&&L(N._p2),z._isSamePoint(O,g)&&L(N._p3)})},Tf.prototype.moveCtrlPoint=function(p,$,D){var i=p[D];if(i){i.e!==_&&($.e=i.e);var H=this,t=H._curves;$.clone().sub(i),t.forEach(function(d){var u;"c2"===D?u="_p2":"c1"===D&&(u="_p3"),H._isSamePoint(d[u],i)&&(d[u]=$)}),p[D]=$}},Tf.prototype.deleteRealPoint=function(n,N){var Y,f,l,R,B,K,h,T=this,i=T._curves,G={},S=[],A=Tl.Math.CubicBezier;for(f=0,l=i.length;l>f;f++)Y=i[f],R=Y._p1,B=Y._p2,K=Y._p3,h=Y._p4,(G[f]||!T._isSamePoint(R,n))&&(T._isSamePoint(h,n)?l>f+1&&T._isSamePoint(i[f+1]._p1,n)&&(N||S.push(new A(R,B,i[f+1]._p3,i[f+1]._p4))):S.push(Y));T._curves=S},Tf.prototype.findPairs=function(L,o){var B,v,E,l,S,N,Q,g,t=this,_=t._curves,V={},d=[];for(v=0,E=_.length;E>v;v++)B=_[v],l=B._p1,S=B._p2,N=B._p3,Q=B._p4,!V[v]&&t._isSamePoint(l,L)&&(o?d.push({point:l,r2:Q}):d.push({point:l,c2:S})),t._isSamePoint(Q,L)&&(g=o?{point:Q,r1:l}:{point:Q,c1:N},E>v+1&&t._isSamePoint(_[v+1]._p1,L)&&(o?g.r2=_[v+1]._p4:g.c2=_[v+1]._p2,V[v+1]=!0),d.push(g));return d},Tf.prototype.toHtShape=function(){var p=this,Z=p._curves,e=[],S=[],C={x:1/0,y:1/0};return Z.forEach(function(_){var O=_._p1,I=_._p2,Y=_._p3,Q=_._p4;return p._isCloseEnough(O,C)||(e.push(1),S.push(O.clone())),C=Q,p._isCloseEnough(O,I)&&p._isCloseEnough(Y,Q)?(e.push(2),S.push(Q.clone()),void 0):(e.push(4),S.push(I.clone(),Y.clone(),Q.clone()),void 0)}),{segments:e,points:S}};var ok=Tl.Math.CubicBezier=function(D,n,x,w){var t=this;t._id=Tl.Math.CubicBezier._globalId++,t._p1=D,t._p2=n,t._p3=x,t._p4=w};ok._globalId=1,ok.prototype={},ok.prototype.constructor=ok,ok.prototype.toString=function(){return this._id},ok.prototype.intersectRect=function(e,r,f){var g=r/2,R=f/2,Y=e.x,Q=e.y,V=Tl.Math.Vector2,h=new V(-g+Y,-R+Q),o=new V(g+Y,R+Q),C=new V(o.x,h.y),F=new V(h.x,o.y),b=this,y=b.intersectLine(h,C),E=b.intersectLine(C,o),k=b.intersectLine(o,F),x=b.intersectLine(F,h),u=y.concat(E).concat(k).concat(x);return u},ok.prototype.intersectLine=function(W,Q){var P,q,g,A,V,r,t,R,n,k,D,z,w,Y=this,y=W.clone().min(Q),d=W.clone().max(Q);A=Y._p1,V=Y._p2,r=Y._p3,t=Y._p4,P=A.clone().multiplyScalar(-1),q=V.clone().multiplyScalar(3),g=r.clone().multiplyScalar(-3),D=P.add(q).add(g).add(t),P=A.clone().multiplyScalar(3),q=V.clone().multiplyScalar(-6),g=r.clone().multiplyScalar(3),k=P.add(q).add(g),P=A.clone().multiplyScalar(-3),q=V.clone().multiplyScalar(3),n=P.add(q),R=A.clone(),w=new Tl.Math.Vector2(W.y-Q.y,Q.x-W.x),z=W.x*Q.y-Q.x*W.y;for(var K=Y.getRoots(w.dot(D),w.dot(k),w.dot(n),w.dot(R)+z),o=new Array,C=0,j=K.length;j>C;C++){var _=K[C];if(!(0>_||_>1)){var s=Y.getPointAt(_);s.t=_,W.x==Q.x?y.y<=s.y&&s.y<=d.y&&o.push(s):W.y==Q.y?y.x<=s.x&&s.x<=d.x&&o.push(s):s.x>=y.x&&s.y>=y.y&&s.x<=d.x&&s.y<=d.y&&o.push(s)}}return o},ok.prototype.solveTForPoint=function(J){var U,P,i,b,m=this;U=m._p1.x-J.x,P=m._p2.x-J.x,i=m._p3.x-J.x,b=m._p4.x-J.x;for(var C=m.getRoots(b-3*i+3*P-U,3*i-6*P+3*U,3*P-3*U,U),V=_,y=1/0,p=0,n=C.length;n>p;p++){var w=C[p];if(!(0>w||w>1)){var F=m.getPointAt(w);F.t=w;var v=Math.abs(F.y-J.y);y>v&&(y=v,V=F)}}return V},ok.prototype.getPointAt=function(W){var L=this,y=L._p1,l=L._p2,n=L._p3,K=L._p4,w=y.clone().lerp(l,W),U=l.clone().lerp(n,W),s=n.clone().lerp(K,W),S=w.lerp(U,W),f=U.lerp(s,W);return S.lerp(f,W)},ok.prototype.getPointByPercentage=function(l){var d=this.length*l,D=this._cacheLength,E=D.length;if(0===d)return D[0].point;if(l>=1)return D[E-1].point;for(var _=0;E>_;_++){var F=D[_];if(!(F.len<d)){var X=D[_-1];return F.point.clone().sub(X.point).setLength(d-X.len).add(X.point)}}},ok.prototype.getTByPercentage=function(z){var G=this.length*z,q=this._cacheLength,F=q.length;if(0===G||0>=z)return q[0].t;if(z>=1)return q[F-1].t;for(var r=0;F>r;r++){var c=q[r];if(!(c.len<G)){var b=q[r-1];return(G-b.len)/(c.len-b.len)*(c.t-b.t)+b.t}}},ok.prototype.getRoots=function(A,N,q,Q){var i,h,V,n,$,d=new Array;if(Math.abs(A)<1e-6){var i=N,h=q/i,V=Q/i,n=h*h-4*V;if(n>0){var $=Math.sqrt(n);d.push(.5*(-h+$)),d.push(.5*(-h-$))}else 0==n&&d.push(.5*-h)}N/=A,q/=A,Q/=A,i=(3*q-N*N)/3,h=(2*N*N*N-9*q*N+27*Q)/27;var F=N/3,o=h*h/4+i*i*i/27,W=h/2;if(Math.abs(o)<=1e-6&&(o=0),o>0){var K,x,$=Math.sqrt(o);K=-W+$,x=K>=0?Math.pow(K,1/3):-Math.pow(-K,1/3),K=-W-$,K>=0?x+=Math.pow(K,1/3):x-=Math.pow(-K,1/3),d.push(x-F)}else if(0>o){var c=Math.sqrt(-i/3),U=Math.atan2(Math.sqrt(-o),-W)/3,a=Math.cos(U),X=Math.sin(U),M=Math.sqrt(3);d.push(2*c*a-F),d.push(-c*(a+M*X)-F),d.push(-c*(a-M*X)-F)}else{var K;K=W>=0?-Math.pow(W,1/3):Math.pow(-W,1/3),d.push(2*K-F),d.push(-K-F)}return d},ok.prototype._70I=function(){var Z=this;return Z._p1.distanceToSquared(Z._p2)<1e-10&&Z._p3.distanceToSquared(Z._p4)<1e-10},ok.prototype.insertKnot=function(j){var B=this,v=B._p1,H=B._p2,Q=B._p3,M=B._p4,i=v.clone().lerp(H,j),m=H.clone().lerp(Q,j),U=Q.clone().lerp(M,j),o=i.clone().lerp(m,j),$=m.clone().lerp(U,j),z=o.clone().lerp($,j);return B._70I()?(v.clone().lerp(M,j),[new Tl.Math.CubicBezier(v,v.clone(),z.clone(),z),new Tl.Math.CubicBezier(z,z.clone(),M.clone(),M)]):[new Tl.Math.CubicBezier(v,i,o,z),new Tl.Math.CubicBezier(z,$,U,M)]},f.defineProperties(ok.prototype,{length:{get:function(){var t=this._cacheLength;if(!t){t=this._cacheLength=[];for(var s=this._p1,h=0,M=0;1>=h;){var E=this.getPointAt(h+=.001);M+=E.clone().sub(s).length(),s=E,t.push({len:M,t:h,point:E.clone()})}}return t[t.length-1].len}},p1:{get:function(){return this._p1},set:function(P){this._p1=P,this._cacheLength=_}},p2:{get:function(){return this._p2},set:function(V){this._p2=V,this._cacheLength=_}},p3:{get:function(){return this._p3},set:function(f){this._p3=f,this._cacheLength=_}},p4:{get:function(){return this._p4},set:function(K){this._p4=K,this._cacheLength=_}}});var ym=V.Default.getInternal().ui().EdgeUI,vp={_47O:function(x){var J=this,H=vp.getBackups()._47O;Tl.inEdit(J.gv)||H.call(J,x)}};Tl.Inject.registAsModule(vp,ym);var up=V.Default.getInternal().ui().NodeUI,jl={_47O:function(e){var F=this,j=jl.getBackups()._47O;Tl.inEdit(F.gv)||j.call(F,e)},getSelectWidth:function(){var c=this,O=c.gv,g=c._data;if(O.isEditable(g)&&Tl.inEdit(O))return 0;var Y=jl.getBackup("getSelectWidth");return Y.call(c)}};Tl.Inject.registAsModule(jl,up);var Ko=V.graph.GraphView,xl={_editPointSize:function(){var I=V.Default.isTouchable,Z=Tl.getStyle("pointSize");return Z[I?0:1]}(),isPointEditable:function(s){var B=this;if(Tl.inEdit(B))return B._pointEditableFunc?B._pointEditableFunc(s):!0;var H=xl.getBackup("isPointEditable");H.call(B,s)},isEditable:function(H){var h,i=this,x=xl.getBackup("isEditable");if(h=H instanceof Tl.Group?!0:x.call(i,H),!Tl.inEdit(i))return h;if(!(H instanceof V.Edge))return h;if(!H.s("2d.editable"))return!1;var q=i.getEditableFunc();return q?q(H):!0},_42:function(q,G){var l=this,m=xl.getBackups()._42;if(m.call(l,q,G),Tl.inEdit(l)){var S=l.getEditInteractor();S.drawImpl()}}};Tl.Inject.registAsModule(xl,Ko);var Qd=V.Default.getInternal().ui().ShapeUI,vs={_47O:function(t){var y=this,z=vs.getBackups()._47O;Tl.inEdit(y.gv)||z.call(y,t)}};Tl.Inject.registAsModule(vs,Qd);var vh=V.graph.DefaultInteractor,Qo={handle_mousewheel:function(I){var O=this,N=Qo.getBackup("handle_mousewheel");Tl.inEdit(O.gv)||N.call(O,I)}};Tl.Inject.registAsModule(Qo,vh);var Wh=V.graph.MoveInteractor,Xi={_calcShift:function(F,m){var X=this,D=Xi.getBackup("_calcShift"),r=X.gv;if(!Tl.inEdit(r))return D.call(X,F,m);var l=r.getEditInteractor(),B=l.getSubModule("Move").calcShift(F,m,X);return B||D.call(X,F,m)},clear:function(K){var d=this,r=Xi.getBackup("clear");r.call(d,K);var S=d.gv;if(Tl.inEdit(S)){var _=S.getEditInteractor();_.getSubModule("Move").clear(K)}}};Tl.Inject.registAsModule(Xi,Wh);var Zc=Tl.Rect=function(P){this.catalog="Rect",this._interactor=P};Zc.prototype={},Zc.prototype.constructor=Zc,Zc.prototype.gatherInfo=function(v,l){var g=this;if(1===l.length){var I=l[0];return I instanceof V.Shape&&I._70I()?g.gatherLine(v,I):pf(I,v)?!1:g.gatherSingleTarget(v,I)}return l.length>1?g.gatherMultiTargets(v,l):!1},Zc.prototype.gatherSingleTarget=function(J,R){if(R.getCorners){var M,k=this,U=k.info;k.target=R,M=k.screenInfo={};var x=R.getCorners();U.LT=new Tl.Math.Vector2(x[0]),U.LB=new Tl.Math.Vector2(x[1]),U.RB=new Tl.Math.Vector2(x[2]),U.RT=new Tl.Math.Vector2(x[3]),U.T=U.LT.clone().add(U.RT).divideScalar(2),U.B=U.LB.clone().add(U.RB).divideScalar(2),U.L=U.LT.clone().add(U.LB).divideScalar(2),U.R=U.RT.clone().add(U.RB).divideScalar(2);for(var T in U)M[T]=Tl.toScreenPosition(J,U[T]);var Y=k._interactor,A=Y.getStyle("checkSize"),s=function(E,R,q){var g=R.clone().sub(E).setLength(-A),y=q.clone().sub(E).setLength(-A),V=g.add(y).add(E);return V};return M.rotLT=s(M.LT,M.RT,M.LB),M.rotLB=s(M.LB,M.LT,M.RB),M.rotRB=s(M.RB,M.LB,M.RT),M.rotRT=s(M.RT,M.LT,M.RB),M.rotT=M.rotLT.clone().add(M.rotRT).divideScalar(2),M.rotB=M.rotLB.clone().add(M.rotRB).divideScalar(2),M.rotL=M.rotLT.clone().add(M.rotLB).divideScalar(2),M.rotR=M.rotRT.clone().add(M.rotRB).divideScalar(2),M.rotation=R.getRotation(),k.gatherConnectInfo(),!0}},Zc.prototype.gatherConnectInfo=function(){var G=this,_=G.target,F=G._interactor,Z=G.screenInfo,X=F.gv;if(X.isConnectActionVisible(_)&&F.getStyle("connectGuideVisible")){var D;_.s&&(D=_.s("connectGuideShift")),D||(D=F.getStyle("connectGuideShift"));var f=_.getAnchor(),U=_.getSize(),c=_.toGlobal({x:U.width*(D[0]-f.x),y:U.height*(D[1]-f.y)});c=Tl.toScreenPosition(X,c),Z.P1?c.add(Z.P2.clone().sub(Z.P1).setLength(D[2])):(c.add(Z.RT.clone().sub(Z.LT).setLength(D[2])),c.add(Z.LB.clone().sub(Z.LT).setLength(D[3]))),Z.connect=c}},Zc.prototype.gatherMultiTargets=function(v,E){var n=Tl.Group.findOrCreateGroup(E,this._interactor._uuid);if(!n)return!1;var T=this;return T.editing&&"rotate"!==T.editing.mode||n.calcInfo(),T.gatherSingleTarget(v,n)},Zc.prototype.gatherLine=function(D,y){this.target=y;var z=this.screenInfo={},p=y.getPoints(),t=Tl.getDataMatrix(y);return z.P1=Tl.toScreenPosition(D,t.apply(p.get(0))),z.P2=Tl.toScreenPosition(D,t.apply(p.get(1))),this.gatherConnectInfo(),!0},Zc.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Zc.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Zc.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Zc.prototype.check=function(a,I,U){if(V.Default.isLeftButton(I)){var y=this;if(y.editing=null,y.tipInfo=null,y.screenInfo){var h=y.target,z=a.isEditable(h),S=y.screenInfo;if(z&&S.connect){var g=y._checkConnect(U);if(g)return g}if(S.P1)return y._checkLine(U);var W,A,x,J=null,Z=y._interactor,p=Z.getStyle("checkSize");if(z&&a.isRectEditable(h))for(A=0;A<Tl.Rect.ResizeKeys.length;A++)if(x=Tl.Rect.ResizeKeys[A],Tl.checkHit(U,S[x],p)){J=x,W="resize";break}if(!J&&z&&a.isRotationEditable(h)&&!Z.getStyle("rotateAsClock")){var L=Z.getStyle("rotateCheckSize");for(A=0;A<Tl.Rect.RotateKeys.length;A++)if(x=Tl.Rect.RotateKeys[A],Tl.checkHit(U,S[x],L)){J=x,W="rotate";break}}if(!J)return Z.setCursor("default"),void 0;if("rotate"===W){var Q,H=a.lp(I);if(h instanceof Tl.Group){var $=Z.getStyle("groupRotateModeKey");"string"==typeof $&&($=[$]);for(var v=!1,G=0,D=$.length;D>G;G++)if(I[$[G]]){v=!0;break}var N=Z.getStyle("groupRotateModeDefault");Q=v?"batch"===N?"block":"batch":N}var M="batch"===Q?h.getAnchor2():h.getPosition(),m=Math.atan2(H.y-M.y,H.x-M.x);Z._setRotateCursor(m),y.editing={mode:W,key:J,pos:M,flipY:h.getScale().y<0,rotation:h.getRotation(),hitRot:m},Q&&(y.editing.groupRotateMode=Q)}else{var s=Tl.Rect.ResizeKeys.indexOf(J),u=Tl.Rect.ResizeDirection[s],e=Math.cos(h.getRotation()),b=Math.sin(h.getRotation()),k=u.x*Math.sign(h.getScale().x),o=u.y*Math.sign(h.getScale().y),C=Math.atan2(-b*k-e*o,e*k-b*o),t=(Math.round(C/(Math.PI/4))+8)%8,i=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][t];this._interactor.setCursor(i);var l=h.getWidth(),w=h.getHeight(),K=h.getAnchor();y.editing={mode:W,key:J,rect:{x:-l*K.x,y:-w*K.y,width:l,height:w},anchor:K,matrix:h.getMatrix()}}return J}}},Zc.prototype._checkLine=function(Z){var E=this;E.screenInfo;var A,d=E._interactor.getStyle("checkSize");if(Tl.checkHit(Z,E.screenInfo.P1,d))A="P1";else{if(!Tl.checkHit(Z,E.screenInfo.P2,d))return this._interactor.setCursor("default"),void 0;A="P2"}return E.editing={mode:"line",key:A},A},Zc.prototype._checkConnect=function(P){var M=this,D=M.screenInfo,a=M._interactor,r=a.getStyle("connectGuideIntersectSize"),I=D.connect,q=P.x,F=I.x;if(F>q&&r>F-q&&Math.abs(I.y-P.y)<r||q>=F&&Tl.checkHit(P,I,r)){var w="connect",g=C.getConnectAction(a.gv);if(M.editing={mode:w},g&&g.delete)if(M.target instanceof Tl.Group){var L=!0;a.gv.sm().getSelection().each(function(X){g.delete.visible.call(null,a.gv,X)||(L=!1)}),M.editing.hasDeleteAction=L}else g.delete.visible.call(null,a.gv,M.target)&&(M.editing.hasDeleteAction=!0);return a.setCursor("default"),w}},Zc.prototype._fireEditEvent=function(x,Y){var s=this._interactor,h=this.editing;if(h){var W=h.mode;W="rotate"===W?"Rotation":"connect"===W?"Connection":"resize"===W?"Rect":W[0].toUpperCase()+W.slice(1),s.fi({kind:x+"Edit"+W,event:Y})}},Zc.prototype.startEdit=function(n,l){n.startDragging(l);var B=this;B._interactor.fi({kind:"prepareEdit",event:l});var L=B.editing,v=B.target;if(L){if(B._fireEditEvent("begin",l),L.started=!0,"rotate"===L.mode)return L.groupRotateMode&&v.beginRotate(L),n._42(),void 0;if("connect"!==L.mode)("line"===L.mode||v&&0===v.getRotation())&&(B._inSmartGuide=!0,B._interactor.rectGuide.gatherRects());else if(L.hasDeleteAction){var C=n.gv,x=B._interactor.getStyle("connectGuideGarbageShift");L.garbageInfo={x:C.getWidth()*x[0]+x[2],y:C.getHeight()*x[1]+x[3],size:B._interactor.getStyle("connectGuideGarbageIntersectsize")},n._42()}}},Zc.prototype._46O=function(g){var R,S,j=this,F=j.editing,Q=j.target;if(F){if("connect"===F.mode&&!F.canceled&&!F.deleted)try{F.garbageInfo&&F.garbageInfo.hover?C.doDeleteConnectionAction(j._interactor.gv,Q):C.doConnectAction(j._interactor.gv,Q,F.target)}catch(r){console.error(r)}S=F.freezeFlag,R=j.editing.groupRotateMode,j._fireEditEvent("end",g),j.editing=null}j.tipInfo=null,j._inSmartGuide&&(j._interactor.rectGuide.clear(),j._inSmartGuide=!1),R&&Q&&Q.endRotate(),Q instanceof V.Block&&(S===_?delete Q._freezeSyncFromChildren:Q._freezeSyncFromChildren=S,Q.updateFromChildren())},Zc.prototype.handleNormalStateDelete=function(){var S=this,t=S.editing;if(t&&"connect"===t.mode&&!t.canceled&&!t.deleted){if(t.garbageInfo){try{C.doDeleteConnectionAction(S._interactor.gv,S.target)}catch(A){console.error(A)}t.garbageInfo=null}return t.cursorPos=null,t.targetCorners=null,t.deleted=!0,S._interactor._42(),!0}},Zc.prototype.handleNormalStateKeyDown=function(g){var W=this,Y=W.editing;return!Y||"connect"!==Y.mode||Y.canceled||Y.deleted?void 0:V.Default.isEsc(g)?(Y.cursorPos=null,Y.targetCorners=null,Y.canceled=!0,W._interactor._42(),!0):void 0},Zc.prototype.handleEdit=function(_,v){var Q=this,P=Q.editing;if(P){var l,A,D,b,Z,i=Q.target,Y=P.key,o=P.mode,y=_.lp(v),f=Q._interactor;if("connect"===o){if(P.canceled)return;if(P.deleted)return;P.cursorPos=f._getLogicalPoint(v);var a=P.garbageInfo;return a&&Tl.checkHit(P.cursorPos,a,a.size)?(a.hover=!0,P.target=null,P.targetCorners=null):(a&&(a.hover=!1),P.target=_.getDataAt(y,function(s){return _.isSelectable(s)?be(s)?!0:!1:!1})||null,P.targetCorners=Tl.getTargetCornersOnScreen(_,P.target)),f._42(),void 0}if("rotate"===o){var k,K,R=P.pos,n=Math.atan2(y.y-R.y,y.x-R.x);if(P.groupRotateMode?K=n-P.hitRot:(k=n-P.hitRot,K=P.rotation+k),K%=2*Math.PI,0>K&&(K+=2*Math.PI),!V.Default.isCtrlDown(v)){var m,S;er(v)?(m=f.getStyle("shiftRotateRound"),S=m/2):(m=f.getStyle("rotateRound"),S=f.getStyle("rotateSensitivity")),K=Tl.roundTo(K,m,S)}P.groupRotateMode?(k=K-(P.lastRotation||0),0!==k&&(i.addRotation(k,P.groupRotateMode,function(p){return _.isRotationEditable(p)}),P.lastRotation=K)):i.setRotation(K),f._setRotateCursor(n),K>Math.PI&&(K-=2*Math.PI);var T=180*(K/Math.PI);T=T.toFixed(2),l=""+T+""}else if("resize"===o){var X=P.rect;D=X.x,b=X.y;var M,E=X.width,g=X.height,p=P.anchor,e=P.matrix,x=i.s&&i.s("keepAspectRatio")||f.getStyle("keepAspectRatio");er(v)&&(x=!x);var G=Q._unionPointMode1,s=Q._unionPointMode2;if(Q._inSmartGuide&&!V.Default.isCtrlDown(v)&&!x){var B;"L"===Y||"R"===Y?B="x":("T"===Y||"B"===Y)&&(B="y"),Q._adsorbedToClosest(y,B),Z=!0}M=e.tfi(y);var C;"LT"===Y?(X=G(M,{x:D+E,y:b+g},E,g,x),C=9):"T"===Y?(X=s({x:D,y:M.y},{x:D+E,y:b+g},E,g,x,"v"),C=1):"RT"===Y?(X=G(M,{x:D,y:b+g},E,g,x),C=33):"L"===Y?(X=s({x:M.x,y:b},{x:D+E,y:b+g},E,g,x,"h"),C=8):"R"===Y?(X=s({x:D,y:b},{x:M.x,y:b+g},E,g,x,"h"),C=32):"LB"===Y?(X=G(M,{x:D+E,y:b},E,g,x),C=12):"B"===Y?(X=s({x:D,y:b},{x:D+E,y:M.y},E,g,x,"v"),C=4):"RB"===Y&&(X=G(M,{x:D,y:b},E,g,x),C=36);var $=e.tf(X.x+X.width*p.x,X.y+X.height*p.y);i instanceof V.Block&&(P.hasOwnProperty("freezeFlag")||(P.freezeFlag=i._freezeSyncFromChildren,i._freezeSyncFromChildren=!0)),i.setPosition($),i.setSize(X.width,X.height),Z&&(A=i.getRect(),f.rectGuide.gatherLines({node:i,x:A.x,y:A.y,w:A.width,h:A.height},B,C)),l=""+Math.round(X.width)+" * "+Math.round(X.height)}else if("line"===o){if(er(v)){var U=i.getPoints(),N="P1"===Y?U.get(1):U.get(0),q={x:y.x-N.x,y:y.y-N.y},d=f.getStyle("shiftLineRotateRound"),r=Q._shiftDirList;
if(!r||Q._shiftRotateRound!==d){Q._shiftRotateRound=d,Q._shiftDirList=r=[];for(var W=0;W<Math.PI;W+=d)r.push({x:u(W),y:L(W)})}for(var J,z=0,j=0,c=r.length;c>j;j++){var H=r[j],t=H.x*q.x+H.y*q.y;Math.abs(t)>Math.abs(z)&&(z=t,J=H)}y={x:N.x+J.x*z,y:N.y+J.y*z},f.rectGuide.clear()}else Q._inSmartGuide&&!V.Default.isCtrlDown(v)&&(Q._adsorbedToClosest(y),Z=!0);var F=Tl.getDataMatrix(i).applyInverse(y);i.setPoint("P1"===Y?0:1,F,!0);var I=i.getPoints(),O=I.get(0),h=I.get(1);D=O.x-h.x,b=O.y-h.y,l=" "+Math.round(Math.sqrt(D*D+b*b))+" ",Z&&(A=i.getRect(),f.rectGuide.gatherLines({node:i,x:A.x,y:A.y,w:A.width,h:A.height}))}if(l){var w=V.Default.getLogicalPoint(v,f._canvas);w.x+=Tl.Icons.TipShiftX,w.y+=Tl.Icons.TipShiftY,Q.tipInfo={helperPos:w,text:l,size:l.length}}Q._fireEditEvent("between",v)}},Zc.prototype._unionPointMode1=function(R,f,A,h,x){if(x&&A&&h){var s=R.x-f.x,E=R.y-f.y;Math.abs(s*h)<Math.abs(E*A)?(E=Math.sign(E)*Math.abs(s*h/A),R.y=f.y+E):(s=Math.sign(s)*Math.abs(E*A/h),R.x=f.x+s)}return V.Default.unionPoint(R,f)},Zc.prototype._unionPointMode2=function(i,K,p,C,Q,B){var d=V.Default.unionPoint(i,K);if(Q&&p&&C){var L;"v"===B?(L=d.x+d.width/2,d.width=p*d.height/C,d.x=L-d.width/2):(L=d.y+d.height/2,d.height=C*d.width/p,d.y=L-d.height/2)}return d},Zc.prototype._adsorbedToClosest=function(V,i){var m=this,C=m._interactor,c=C.rectGuide.findClosest(V,i),W=C.gridGuide.findClosest(V,i),f=1/0,z=1/0;c&&(isFinite(c.x)&&(f=c.x),isFinite(c.y)&&(z=c.y)),W&&(isFinite(W.x)&&Math.abs(W.x)<Math.abs(f)&&(f=W.x),isFinite(W.y)&&Math.abs(W.y)<Math.abs(z)&&(z=W.y)),isFinite(f)&&(V.x+=f),isFinite(z)&&(V.y+=z)},Zc.prototype._42=function(u,G,P){var w=this;w.info={},w.screenInfo=null;var T=w._interactor;if(!T.editDetail&&w.gatherInfo(G,P)){var _=w.editing,x=_?_.groupRotateMode:null,a=w.screenInfo;if("block"!==x||!_||!_.started){if(a.P1?Tl.Icons.DrawIcon(T,u,Tl.Icons.Line,a):Tl.Icons.DrawIcon(T,u,Tl.Icons.Rect,a),a.connect&&(Tl.Icons.DrawIcon(T,u,Tl.Icons.ConnectGuide,{rotation:a.rotation,connect:a.connect,cursorPos:_?_.cursorPos:null}),_)){if(_.targetCorners){for(var k={x:1/0,y:1/0},U={x:-1/0,y:-1/0},f=0,b=_.targetCorners.length;b>f;f+=2)k.x=Math.min(k.x,_.targetCorners[f]),U.x=Math.max(U.x,_.targetCorners[f]),k.y=Math.min(k.y,_.targetCorners[f+1]),U.y=Math.max(U.y,_.targetCorners[f+1]);Tl.Icons.DrawIcon(T,u,Tl.Icons.HoverDataRect,{min:k,max:U,color:T.getStyle("hoverGuideColor")||T.getStyle("baseColor")})}_.garbageInfo&&Tl.Icons.DrawIcon(T,u,Tl.Icons.ConnectGuideGarbage,_.garbageInfo)}T.getStyle("rotateTipVisible")&&w.tipInfo&&Tl.Icons.DrawIcon(T,u,Tl.Icons.TipHelper,w.tipInfo)}w.target instanceof Tl.Group&&w.target._42(T,u,G)}};var nq=Tl.Anchor=function(n){this.catalog="Anchor",this._interactor=n};nq.prototype={},nq.prototype.constructor=nq,nq.prototype.gatherInfo=function(U,p){var R=this;if(1===p.length){var C=p[0];if(!C.getAnchor)return;if(C instanceof V.Shape&&C._70I())return;if(pf(C,U))return;return R.gatherSingleTarget(U,p[0])}return p.length>1?R.gatherMultiTargets(U,p):!1},nq.prototype.gatherSingleTarget=function(A,i){var D=this;return D.info.POS=i.getPosition(),D.screenInfo.POS=Tl.toScreenPosition(A,D.info.POS),D.target=i,!0},nq.prototype.gatherMultiTargets=function(N,m){var o=this,X=Tl.Group.findOrCreateGroup(m,this._interactor._uuid);return X?(o.screenInfo.POS=Tl.toScreenPosition(N,X.getAnchor2()),o.target=X,!0):!1},nq.prototype.isVisible=function(){var y=this,m=y._interactor;if(m.getStyle("anchorVisible")===!1)return!1;var F=y.target;if(F){if(this.editing)return!0;var Z=F.getAnchor(),j=m.getStyle("anchorOutsideVisibleThreshold");if(Z.x<-j||Z.x>1+j||Z.y<-j||Z.y>1+j)return!0;var x=F.getSize(),T=F.getScale(),s=Math.min(Math.abs(x.width*T.x),Math.abs(x.height*T.y));if(s*m.gv._zoom<m.getStyle("anchorHideThreshold"))return!1}return!0},nq.prototype.check=function(N,i,O){if(V.Default.isLeftButton(i)){var J=this,p=J._interactor;if(J.isVisible()&&p.getStyle("anchorMovable")!==!1){J.editing=null,J.tipInfo=null;var u=J.target;if(u&&N.isAnchorEditable(u)&&N.isEditable(u)){var B;if(J.screenInfo&&(B=J.screenInfo.POS)&&Tl.checkHit(O,new Tl.Math.Vector2(B),p.getStyle("checkSize"))){if(u instanceof Tl.Group)return J.editing={},!0;var A=u.getWidth(),$=u.getHeight(),z=u.getAnchor();return J.editing={rect:{x:-A*z.x,y:-$*z.y,width:A,height:$},anchor:z,matrix:u.getMatrix()},!0}}}}},nq.prototype.startEdit=function(O,d){O.startDragging(d),O.fi({kind:"beginEditAnchor",event:d})},nq.prototype._46O=function(Y){var Z=this;Z.editing&&(Z.editing=null,Z._interactor.fi({kind:"endEditAnchor",event:Y})),Z.tipInfo=null},nq.prototype.handleEdit=function(Y,b){var W=this,v=W.target;if(v){var z=W.editing;if(z){var R=Y.lp(b),T=W._interactor;if(v instanceof Tl.Group)return v.setAnchor2(R),T._42(),void 0;var C=z.matrix,N=C.tfi(R),O=z.rect,t=(N.x-O.x)/O.width,q=(N.y-O.y)/O.height;if(!V.Default.isCtrlDown(b)){var i=T.getStyle("anchorRound"),s=T.getStyle("anchorSensitivity");t=Tl.roundTo(t,i,s),q=Tl.roundTo(q,i,s)}v.setAnchor(t,q,!0);var g=V.Default.getLogicalPoint(b,T._canvas);g.x+=Tl.Icons.TipShiftX,g.y+=Tl.Icons.TipShiftY;var F=""+t.toFixed(2)+", "+q.toFixed(2);W.tipInfo={helperPos:g,text:F,size:F.length},T.fi({kind:"betweenEditAnchor",event:b})}}},nq.prototype._42=function(Y,K,N){var d=this;d.info={},d.screenInfo={};var C=d._interactor;C.editDetail||d.gatherInfo(K,N)&&d.isVisible()&&(Tl.Icons.DrawIcon(C,Y,Tl.Icons.Anchor,d.screenInfo),d.tipInfo&&Tl.Icons.DrawIcon(C,Y,Tl.Icons.TipHelper,d.tipInfo))};var Bb=Tl.MoveDummy=function(s){this.catalog="MoveDummy",this._interactor=s};Bb.prototype={},Bb.prototype.constructor=Bb,Bb.prototype.gatherInfo=function(){var S=this,r=this._interactor.getSubModule("Rect");if(r){var K=r.screenInfo;if(K){var q=S._interactor,A=S.getMovableTarget(r.target);if(A){var w=q.getStyle("moveDummyThreshold");if(w!==!1){var D=K.LT||K.P1,L=K.RT||K.P2,v=K.LB||D;if(D){var u=K.P1,g=Math.min(D.distanceTo(v),D.distanceTo(L));if(!(w!==!0&&g>w)){var t=q.getStyle("moveDummyPosition"),P=L.clone().sub(D),p=v.clone().sub(D),G=t[2],c=t[3];if(u){var j=q.getStyle("moveDummyLineExtraShift");j&&(G+=j[0],c+=j[1])}var B=D.clone().add(P.clone().multiplyScalar(t[0])).add(P.setLength(G)).add(p.clone().multiplyScalar(t[1])).add(p.setLength(c));return S.screenInfo.pos=B,S.screenInfo.size=q.getStyle("moveDummySensitivity"),!0}}}}}}},Bb.prototype.getMovableTarget=function(V){var v=this._interactor.gv;if(be(V)){if(v.isMovable(V))return V}else if(V instanceof Tl.Group)for(var o=V._entities,S=o.length-1;S>=0;S--){var A=o[S];if(be(A)&&v.isMovable(A))return A}return null},Bb.prototype.getMoveInteractor=function(){for(var t,e,w,K=this._interactor.gv,L=K.getInteractors(),t=0,e=L.length;e>t;t++)if(w=L.get(t),w instanceof Wh)return w},Bb.prototype.startEdit=function(A,L){A.startDragging(L);var U=this.getMoveInteractor();if(U){var N=this.selectedTarget,r=A.gv;r._moving=1,U._data=N,r.handleMouseDown&&r.handleMouseDown(L,N)}},Bb.prototype._46O=function(g){var y=this,T=y.getMoveInteractor();T&&(T.handleWindowMouseUp(g),y.selectedTarget=null)},Bb.prototype.handleEdit=function(p,K){var P=this.getMoveInteractor();P&&P.handleWindowMouseMove(K)},Bb.prototype.check=function(P,y,f){if(this.selectedTarget=null,V.Default.isLeftButton(y)&&!P._scrolling&&!pc()){var J=this;if(J.screenInfo){var z=J.screenInfo.pos;if(z&&!(f.distanceTo(z)>J.screenInfo.size)){var M=J._interactor;return J.selectedTarget=J.getMovableTarget(M.getSubModule("Rect").target),M.setCursor("default"),!0}}}},Bb.prototype._42=function(Z,A,E){var y=this;y.screenInfo={};var I=y._interactor;I.editDetail||y.gatherInfo(A,E)&&(!I.editing||y.selectedTarget)&&Tl.Icons.DrawIcon(I,Z,Tl.Icons.MoveDummy,y.screenInfo)};var Ok=Tl.RotateX=function(d){this.catalog="RotateX",this._interactor=d};Ok.prototype={},Ok.prototype.constructor=Ok,Ok.prototype.gatherInfo=function(Q,Z){var H=this;if(1===Z.length){var i=Z[0];return i instanceof V.Shape&&i._70I()||pf(i,Q)?!1:H.gatherSingleTarget(Q,i)}return Z.length>1?H.gatherMultiTargets(Q,Z):!1},Ok.prototype.gatherSingleTarget=function(){var W=new V.Math.Vector2,f=new V.Math.Vector2,Q=new V.Math.Vector2,c=new V.Math.Vector2,v=function(S,d){var P=S.x-d.x,M=S.y-d.y;return P*P+M*M};return function(_,P){if(P.getCorners){var U=this,t=P.getCorners(),i=15,R=P.getPosition();W.copy(t[0]),Q.copy(t[1]),c.copy(t[3]),f.copy(W).add(c).divideScalar(2).add(W.sub(Q).setLength(i/_.getZoom()));var x=Math.max(v(R,t[0]),v(R,t[1]),v(R,t[2]),v(R,t[3]));return U.info.POS=f.clone(),U.screenInfo.POS=Tl.toScreenPosition(_,U.info.POS),U.screenInfo.LEN=Math.sqrt(x)*_.getZoom()+i,U.screenInfo.CENTER=Tl.toScreenPosition(_,R),U.target=P,!0}}}(),Ok.prototype.gatherMultiTargets=function(Z,h){var G=this,I=Tl.Group.findOrCreateGroup(h,this._interactor._uuid);if(!I)return!1;var G=this;return G.gatherSingleTarget(Z,I)},Ok.prototype.isVisible=function(){var T=this._interactor;if(!T.getStyle("rotateAsClock"))return!1;var _=this.target;if(!_)return!0;var g=T.gv;return g.isEditable(_)&&g.isRotationEditable(_)?!0:!1},Ok.prototype.check=function(d,$,v){var x=this,X=x._checkImpl(d,$,v);return(X||x._clockPainted)&&x._interactor._42(),X},Ok.prototype._checkImpl=function(F,k,y){if(V.Default.isLeftButton(k)){var Y=this;Y.editing=null,Y.tipInfo=null;var M;if(Y.screenInfo&&(M=Y.screenInfo.POS)&&Y.isVisible()){var i=Y._interactor;if(Tl.checkHit(y,M,i.getStyle("checkSize"))){var l=Y.target,x=F.lp(k),I=l.getPosition(),u=Math.atan2(x.y-I.y,x.x-I.x);return i._setRotateCursor(u),Y.editing={pos:I,rotation:l.getRotation(),hitRot:u,groupRotateMode:"block",screenInfo:{CENTER:Y.screenInfo.CENTER,LEN:Y.screenInfo.LEN}},!0}}}},Ok.prototype.startEdit=function(y,h){y.startDragging(h),y.fi({kind:"beginEditRotation",event:h}),this.target instanceof Tl.Group&&this.target.beginRotate(this.editing)},Ok.prototype._46O=function(i){var W=this;W.editing&&(W.editing=null,W._interactor.fi({kind:"endEditRotation",event:i})),W.target instanceof Tl.Group&&W.target.endRotate(),W.tipInfo=null},Ok.prototype.handleEdit=function(I,n){var p=this,f=p.editing;if(f){var k,B,D=p.target,r=I.lp(n),S=p._interactor,Z=f.pos,d=Math.atan2(r.y-Z.y,r.x-Z.x),G=D instanceof Tl.Group;if(G?B=d-f.hitRot:(k=d-f.hitRot,B=f.rotation+k),B%=2*Math.PI,0>B&&(B+=2*Math.PI),!V.Default.isCtrlDown(n)){var H,q;er(n)?(H=S.getStyle("shiftRotateRound"),q=H/2):(H=S.getStyle("rotateRound"),q=S.getStyle("rotateSensitivity")),B=Tl.roundTo(B,H,q)}G?(k=B-(f.lastRotation||0),0!==k&&(D.addRotation(k,f.groupRotateMode,function(t){return I.isRotationEditable(t)}),f.lastRotation=B)):D.setRotation(B),S._setRotateCursor(d),B>Math.PI&&(B-=2*Math.PI);var t=180*(B/Math.PI),y=""+t.toFixed(2)+"",L=V.Default.getLogicalPoint(n,S._canvas);L.x+=Tl.Icons.TipShiftX,L.y+=Tl.Icons.TipShiftY,p.tipInfo={helperPos:L,text:y,size:y.length},S.fi({kind:"betweenEditRotation",event:n})}},Ok.prototype._42=function(Y,H,S){var I=this;I._clockPainted=!1,I.info={},I.screenInfo={};var p=I._interactor;p.editDetail||I.gatherInfo(H,S)&&I.isVisible()&&(Tl.Icons.DrawIcon(p,Y,Tl.Icons.RoundPoint,I.screenInfo.POS),p.getStyle("rotateTipVisible")&&I.tipInfo&&Tl.Icons.DrawIcon(p,Y,Tl.Icons.TipHelper,I.tipInfo),I.editing&&I.drawClock(Y))},Ok.prototype.drawClock=function(P){P.save();var Y=this;Y._clockPainted=!0;var p=Y.editing||{},r=p.screenInfo||Y.screenInfo,C=r.LEN,_=C+8,d=C+18;P.save(),P.translate(r.CENTER.x,r.CENTER.y),P.beginPath(),P.strokeStyle="rgb(150, 150, 150)";for(var X,c,O,T,Q,e=0;360>e;e++)X=e*Math.PI/180,0===e%5&&(c=L(X)*C,O=u(X)*C,T=L(X)*_,Q=u(X)*_,P.moveTo(c,O),P.lineTo(T,Q)),0===e%45&&(c=L(X)*C,O=u(X)*C,T=L(X)*d,Q=u(X)*d,P.moveTo(c,O),P.lineTo(T,Q));P.stroke(),P.rotate(-$k);var q=p.lastRotation||Y.target.getRotation();P.beginPath(),P.fillStyle="rgba(255, 0, 0, 0.1)",P.strokeStyle="rgb(157, 157, 157)",P.moveTo(0,0),P.arc(0,0,d,0,q,!1),P.fill(),P.beginPath(),P.moveTo(0+d,0),P.arc(0,0,d,0,q,!1),P.stroke(),P.restore()};var Tf=Tl.Curve=function(E){this.catalog="Curve",this._interactor=E};Tf.prototype={},Tf.prototype.constructor=Tf,f.defineProperties(Tf.prototype,{activing:{get:function(){return this._activing},set:function(N){var k=this;if(N)k._activing=new Tl.CurveActiving(this,N),k._activing._firePointChange();else{var J=k._activing;J&&J.dispose(),k._activing=null}}}}),Tf.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Tf.prototype.setUp=function(){var s=this,E=s._interactor;E&&E.gv.mp(s._onGraphviewPropertyChanged,s)},Tf.prototype._onGraphviewPropertyChanged=function(z){("zoom"===z.property||"translateX"===z.property||"translateY"===z.property)&&this._handleDataChanged()},Tf.prototype.tearDown=function(){var k=this,f=k._interactor;f&&f.gv.ump(k._onGraphviewPropertyChanged,k)},Tf.prototype.canEnterEditDetailMode=function(){var A=_i(this._interactor);return A?this.target=A:void 0},Tf.prototype.canQuitEditDetailMode=function(o){var G=this,F=G._interactor._getLogicalPoint(o);return G._checkEditRealPoint(F)?void 0:G._interactor.gv.getDataAt(o)!==G.target?!0:void 0},Tf.prototype.preHandleScroll=function(){var b=this.editing;return b&&b.inEdit?!0:void 0},Tf.prototype.getCurrentSelectintStatus=function(){var m=this;if(m.activing&&!m.activing.selections){if(m.activing.status!=_)return m.activing.status;var q=function(r){var x=m.activing.status;m.activing.status=r,m._interactor.fp("shapePointStatus",x,r)},o=Tl.Curve.PointType,p=m.activing.point,j=m.activing.pairs;if(!j||1!==j.length)return q(o.Mirrored);var T=j[0],L=T.c1&&T.c1.isNearEnough(p),R=T.c2&&T.c2.isNearEnough(p);if(!T.c1||!T.c2)return L||R?q(o.Straight):q(o.Disconnected);if(L&&R)return q(o.Straight);if(L||R)return q(o.Asymmetric);var y=T.c1.clone().sub(p),V=T.c2.clone().sub(p);return Math.abs(y.x*V.y-y.y*V.x)>1e-5||y.x*V.x>0?q(o.Disconnected):Math.abs(y.length()-V.length())>1e-5?q(o.Asymmetric):q(o.Mirrored)}},Tf.prototype.handle_keydown=function(a){var L=this;if(L._interactor.editDetail){var s=Tl.Curve.PointType;"1"===a.key?L._setCurrentSelectionStatus(s.Straight):"2"===a.key?L._setCurrentSelectionStatus(s.Mirrored):"3"===a.key?L._setCurrentSelectionStatus(s.Disconnected):"4"===a.key&&L._setCurrentSelectionStatus(s.Asymmetric)}},Tf.prototype.setCurrentSelectionStatus=function(F){var P=this,G=P._interactor;if(G){var U=G.gv;U.dm().beginTransaction(),this._setCurrentSelectionStatus(F),U.dm().endTransaction()}},Tf.prototype._setCurrentSelectionStatus=function(f){var d=this,H=d.activing;if(H){var u=d.getCurrentSelectintStatus();if(null!==u&&u!==f){H.status=f;var w=d.activing.point,$=d.activing.pairs;if($&&1===$.length){var i=$[0],k=d.screenInfo.curve,l=Tl.Curve.PointType,I=d._interactor,J=function(){d._writeToHt(),I.fp("shapePointStatus",u,f),d.check(I.gv,null,new Tl.Math.Vector2(I._lastLogicalPoint))};if(f===l.Straight)return k.moveCtrlPoint(i,w,"c1"),k.moveCtrlPoint(i,w,"c2"),J(),void 0;if(u===l.Straight){var G=k.findPairs(w,!0),O=G[0],m=O.r1||w,g=O.r2||w,Q=g.clone().sub(m).multiplyScalar(.25);return k.moveCtrlPoint(i,w.clone().sub(Q),"c1"),k.moveCtrlPoint(i,w.clone().add(Q),"c2"),J(),void 0}var E=i.c1,t=i.c2;if(E&&t){if(f===l.Mirrored)return k.moveCtrlPoint(i,w.clone().multiplyScalar(2).sub(t),"c1"),J(),void 0;if(f===l.Asymmetric&&u===l.Disconnected){var e=E.clone().sub(w).length(),Q=w.clone().sub(t).setLength(e).add(w);return k.moveCtrlPoint(i,Q,"c1"),J(),void 0}}H._firePointChange(),I.fp("shapePointStatus",u,f),d.check(I.gv,null,new Tl.Math.Vector2(I._lastLogicalPoint))}}}},Tf.prototype._handleDataChanged=function(){var c="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(W){var t=this;if(t.screenInfo&&t.target){if(W&&c.indexOf(W.property)<0)return;var N=t._interactor;t.gatherSingleTarget(N.gv,t.target,!0),t.check(N.gv,null,new Tl.Math.Vector2(N._lastLogicalPoint)),N._42()}}}(),Tf.prototype.gatherSingleTarget=function(F,S,J){var X,T,s=this;s.screenInfo&&s.screenInfo.curve&&(T=s.screenInfo.curve._curves);var i=s.editing;X=i?s.screenInfo:s.screenInfo={};var b,z,D=S instanceof V.Edge;D?(b=S.s("edge.segments"),z=S.s("edge.points")||new V.List):(b=S._58O,z=S._59O),X.S=b;var H,g=X.P=[],L=Tl.getDataMatrix(S);if(S instanceof V.Polyline||S instanceof V.Edge&&s._interactor.getStyle("edgeElevationEditable"))H=S.getElevation&&S.getElevation()||0,X.E=[];else{var j=!1;z.each(function(x){x.e!==_&&(j=!0)}),j&&(X.E=[])}if(z.each(function(V){X.E&&X.E.push(V.e!=_?V.e:H),V=L.apply(V);var E=Tl.toScreenPosition(F,V);g.push(E.x,E.y)}),D){var x=g.length,B=Tl.toScreenPosition(F,S._lastSourcePoint||(x?{x:g[0],y:g[1]}:{x:0,y:0})),W=Tl.toScreenPosition(F,S._lastTargetPoint||(x?{x:g[x-2],y:g[x-1]}:{x:0,y:0}));if(g.splice(0,0,B.x,B.y),g.push(W.x,W.y),X.E){var M=S.getSource(),Y=S.getTarget();X.E.splice(0,0,((S.s("edge.source.anchor.elevation")||.5)-.5)*M.getTall()+M.getElevation()),X.E.push(((S.s("edge.target.anchor.elevation")||.5)-.5)*Y.getTall()+Y.getElevation())}}if(!X.S||!X.S.size()){X.S=new V.List,X.S.add(1);for(var c=0;c<g.length/2-1;c++)X.S.add(2)}if((!i||J)&&s.convertToCubicBezier(T),s.activing&&(J||!s.editing||"realPoint"===s.editing.type)){var I=X.curve.findPairs(s.activing.point);s.activing.pairs=I}},Tf.prototype._convertToNewPoint=function(F,i,U,x){var X,I,l;for(X=0,I=i.length;I>X;X++){if(l=i[X],l._p1.isNearEnough(F)&&(!x||x.indexOf(l._p1)<0))return l._p1;if(l._p4.isNearEnough(F)&&(!x||x.indexOf(l._p4)<0))return l._p4}if(U)for(X=0,I=Math.min(U.length,I);I>X;X++){if(l=U[X],l._p1===F&&(!x||x.indexOf(i[X]._p1)<0))return i[X]._p1;if(l._p4===F&&(!x||x.indexOf(i[X]._p4)<0))return i[X]._p4}},Tf.prototype.convertToCubicBezier=function(p){var V,C,L=this,T=new Tl.Math.Curve,H=L.screenInfo;if(T.createFromHtShape(H.P,H.S,H.E),H.curve=T,L.activing){var R=T._curves;V=L.activing.point,C=L._convertToNewPoint(V,R,p);var W=[];if(C&&(L.activing.point=C,W.push(C)),L.activing.selections){var O=-1,v=L.activing.selections;v.forEach(function(Z){O++,C=L._convertToNewPoint(Z,R,p,W),C&&(v[O]=C,W.push(C))})}}},Tf.prototype.check=function(X,T,i){if(!T||Ab(T)||Gq(T)){var z=this;if(z._interactor.setCursor("default"),z.editing=null,z.highlight=null,z.tipInfo=null,z.edgeEditResult=null,z.screenInfo){if(pc()||T&&Gq(T))return z._interactor._42(),!0;if(z._checkEditCtrlPoint(i))return z._interactor._42(),!0;if(z._checkEditRealPoint(i))return z._interactor._42(),!0;if(z._checkEditElevation(i))return z._interactor._42(),!0;var q=z.screenInfo.curve,E=q.checkPoint(i,z._interactor.getStyle("curveIntersectSize"));if(E){var U=z.highlight={};U.type="insertKnot",U.bezier=E.bezier,U.point=E.intersection}return z._interactor._42(),!0}}},Tf.prototype.getAdjacentBeziers=function(c){var x=this.screenInfo;if(x){var q,V,b,k=x.curve._curves,M=[],i=_;for(q=0,V=k.length;V>q;q++)if(b=k[q],i===_){if(b._p4.isNearEnough(c)){M.push(b),i=q;continue}}else{if(b._p1.isNearEnough(c))return M.push(b),M;if(b._p4.isNearEnough(c)){M[0]=b,i=q;continue}}}},Tf.prototype.roundCorner=function(i){if(this.activing&&this.screenInfo){var U=this.screenInfo.curve,E=U._curves,g=this.getAdjacentBeziers(this.activing.point),a=g[1],m=a._index;a=a.insertKnot(a.getTByPercentage(i/a.length))[1],E[m]=a;var $=a.p1,X=g[0],r=X._index;X=X.insertKnot(X.getTByPercentage(1-i/X.length))[0],E[r]=X;var W=X.p4,t=this.activing.point,z=new Tl.Math.CubicBezier(W,t.clone().sub(W).multiplyScalar(2/3).add(W),t.clone().sub($).multiplyScalar(2/3).add($),$);E.splice(m,0,z),this._writeToHt(),this.activing=null,this._interactor._42()}},Tf.prototype._checkEditRealPoint=function(I){var t,X,U,E,P,H,D=this,j=D.screenInfo.curve._curves,C=D._interactor.getStyle("curvePointIntersectSize"),_=1/0;for(C*=C,U=0,E=j.length;E>U;U++)t=j[U],P=t._p1,H=I.distanceToSquared(P),_>H&&(_=H,X=P),P=t._p4,H=I.distanceToSquared(P),_>H&&(_=H,X=P);if(_>C)return!1;var W=D.highlight={};return W.type="changeRealPoint",W.point=X,D.editing={type:"realPoint",point:X,shiftGuide:{point:X.clone(),dir:"x",limit:0}},D._interactor.setCursor("crosshair"),!0},Tf.prototype._checkEditElevation=function(c){var b=this;if(!b._interactor.getStyle("curveElevationVisible"))return!1;var G=b.target;if(G instanceof V.Edge&&!b._interactor.getStyle("edgeElevationEditable"))return!1;var d=b.activing;if(!d)return!1;var u=d.getCurrentEditingPoint();if(!u)return!1;var X=b._interactor,n=X.getStyle("curveElevationGuideShift"),y=X.getStyle("curveElevationIntersectSize"),Q=c.distanceToSquared({x:u.x+n[0],y:u.y+n[1]});if(!(Q>y*y)){var h=b.highlight={};h.type="elevation";var Y=new Tl.Math.Vector2(c.x,c.y,u.e);return b.editing={type:"elevation",startPoint:Y},b._interactor.setCursor("crosshair"),!0}},Tf.prototype._checkEditCtrlPoint=function(e){var I=this;if(I.activing&&!I.activing.selections){var u=I.getCurrentSelectintStatus();if(u!==Tl.Curve.PointType.Straight){var Y=I.activing.pairs;if(Y){var x=I._interactor.getStyle("curvePointIntersectSize");x*=x;var n,q,y,k,Z,o,s,D,K,L=1/0;for(s=0,K=Y.length;K>s;s++)for(k=Y[s],D=0;2>D;D++)Z=0===D?"c1":"c2",k[Z]&&(o=e.distanceToSquared(k[Z]),L>o&&(L=o,n=k,q=s,y=Z));if(L>x)return!1;I.activing.hlpair=n,I.activing.hltype=y;var M=I.highlight={};return M.type="changeCtrlPoint",M.point=n[y],I.editing={type:"ctrlPoint",pair:n,pairId:q,ctrlType:y,direction:n[y].clone().sub(I.activing.point).normalize()},I._interactor.setCursor("crosshair"),!0}}}},Tf.prototype.startEdit=function(z,y){z.startDragging(y);var M=this;M.highlight&&"insertKnot"===M.highlight.type&&(M.insertKnot(),M.gatherSingleTarget(M._interactor.gv,M.target),M.activing=null,M._checkEditRealPoint(M._interactor._getLogicalPoint(y)));var N=M._activing;if(N){var U=M.editing?M.editing.type:null;"ctrlPoint"===U?N.editingCtrl={pairId:M.editing.pairId,type:N.hltype}:"realPoint"===U&&(N.editingCtrl=!1)}var x=M.highlight,s=V.Default.isCtrlDown(y);if(!x||pc()||Gq(y)){var a=M._interactor.gv;if(!a.setFocus(y)||a._scrolling)return;return s?M._multiSelect={startPoint:a.lp(y)}:a.isPannable()&&(Ab(y)||Gq(y))&&(M._pan={tx:a.tx(),ty:a.ty()},z.fi({kind:"beginPan",event:y})),void 0}if("changeRealPoint"===x.type){var K,W=M.activing?M.activing.point:null,m=M.activing?M.activing.selections:null;if(s&&M.activing)W===x.point?(m?(M.activing={point:m[0]},m.length>1&&(m.splice(0,1),M.activing.selections=m)):M.activing=null,M.editing=null):m&&(K=m.indexOf(x.point))>=0?(m.length>1?m.splice(K,1):delete M.activing.selections,M.editing=null):m?(m.push(W),M.activing={point:x.point,selections:m}):M.activing={point:x.point,selections:[W]};else if(m)W===x.point||((K=m.indexOf(x.point))>=0?(m.splice(K,1,W),M.activing={point:x.point,selections:m}):M.activing={point:x.point});else{var k;W===x.point&&(k=M.activing.status),M.activing={point:x.point},k&&(M.activing.status=k)}z.fi({kind:"beginEditPoint",event:y})}},Tf.prototype.insertKnot=function(){var o=this,X=o.highlight,u=o.screenInfo.curve;u.insertKnot(X.bezier,X.point.t),o._writeToHt()},Tf.prototype._writeToHt=function(){var $,s,f=this,E=f.screenInfo.curve,y=E.toHtShape(),L=y.points,J=[],i=y.segments,F=f._interactor.gv;F.dm().beginTransaction();var l,q,O=f.target,Y=O instanceof V.Edge,C=Tl.getDataMatrix(O).invert();q=O instanceof V.Polyline||Y&&f._interactor.getStyle("edgeElevationEditable"),q&&(l=O.getElevation&&O.getElevation()||0);for(var W=0,z=L.length;z>W;W++)$=L[W],s=Tl.toWorldPosition(F,$),s=C.apply(s),isFinite($.e)&&$.e!==l&&(s.e=$.e),J.push(s);if(O._writing=!0,Y){O.s("edge.type","points"),O.setStyle("edge.segments",i),O.setStyle("edge.points",J.slice(1,J.length-1)),O.setStyle("edge.source.offset.x",0),O.setStyle("edge.source.offset.y",0),O.setStyle("edge.target.offset.x",0),O.setStyle("edge.target.offset.y",0);var o=f._nextChangeEdgeHost;delete f._nextChangeEdgeHost,o&&("source"===o.type?O.setSource(o.host):O.setTarget(o.host)),f._writeEdgeHostAnchor("source",J[0]),f._writeEdgeHostAnchor("target",J[J.length-1])}else J.length?(O.setSegments(i),O.setPoints(J,!0)):O.removeFromDataModel();F.dm().endTransaction(),delete O._writing},Tf.prototype._writeEdgeHostAnchor=function(v,R){var A=this,K=A.target,$=A._calcHostAnchor(K,v,R);$.index!==_?(K.setStyle("edge."+v+".index",$.index),K.setStyle("edge."+v+".percent",_),K.setStyle("edge."+v+".anchor.x",_),K.setStyle("edge."+v+".anchor.y",_)):$.percent!==_?(K.setStyle("edge."+v+".percent",$.percent),K.setStyle("edge."+v+".index",_),K.setStyle("edge."+v+".anchor.x",_),K.setStyle("edge."+v+".anchor.y",_)):(K.s("edge."+v+".anchor.x",$.x),K.s("edge."+v+".anchor.y",$.y),K.s("edge."+v+".anchor.elevation",$.e),$.offsetX||$.offsetY?(K.s("edge."+v+".offset.x",$.offsetX),K.s("edge."+v+".offset.y",$.offsetY),K.s("edge."+v+".offset.elevation",$.offsetElevation)):(K.s("edge."+v+".offset.x",0),K.s("edge."+v+".offset.y",0),K.s("edge."+v+".offset.elevation",0)))},Tf.prototype._calcHostAnchor=function(y,E,K,R){R||(R="source"===E?y.getSource():y.getTarget());var l=this._interactor.gv,O=l.calculateAttachPoint(R,K);if(O)return O.info;if(Cm(R)){var X=l.calculateEdgePosition(R,K);return X}var W=R.getRotation(),_=R.getAnchor();pf(R,l)&&(W=0);var V=R.getElevation(),I=R.getTall();V=((K.e||0)-V)/I+.5;var S=R.getScale();if(W||S.x<0||S.y<0){var B=R.getMatrix(),H=B.tfi(K),C=R.getSize();return{x:H.x/C.width+_.x,y:H.y/C.height+_.y,e:V}}var F=Yc(l,R),m={x:(K.x-F.x)/F.width,y:(K.y-F.y)/F.height,e:V};return m},Tf.prototype._handlePanning=function(S){var t=this,x=t._pan;if(x){x.started=!0;var X=t._interactor,w=X.gv,Q=X._lastClientPoint,y=ci(S),R=Bp(w,y,Q);w.setTranslate(x.tx+R.x,x.ty+R.y),t.gatherSingleTarget(X.gv,t.target),X._42(),X.fi({kind:"betweenPan",event:S})}},Tf.prototype.handleEdit=function(I,r){var x=this,h=x.editing;if(x._pan)return x._handlePanning(r),void 0;if(x._multiSelect)return x._multiSelect.endPoint=I.lp(r),x._interactor.redraw(),void 0;if(h){h.inEdit=!0;var E,k,H,U=x._interactor._getLogicalPoint(r),g=V.Default.isCtrlDown(r),i=V.Default.isShiftDown(r),j=h.type,T=x.activing;if(x._guideInfo=null,"ctrlPoint"===j&&i){var A=x.editing.direction.clone();E=T.point;var O=A.dot(U.clone().sub(E));U=A.setLength(O).add(E)}else if("ctrlPoint"===j||"realPoint"===j){var A;if("realPoint"===j&&i){var L=x.editing.shiftGuide;k=L.point;var W=Math.abs(U.x-k.x),D=Math.abs(U.y-k.y);W>D&&W>L.limit&&"y"===L.dir&&(L.dir="x"),D>W&&D>L.limit&&"x"===L.dir&&(L.dir="y"),A=L.dir,"x"===A?(U.y=k.y,L.limit=Math.max(L.limit,W)):"y"===A&&(U.x=k.x,L.limit=Math.max(L.limit,D))}var B=x._isEditEdgeSourceTarget();if(B){var z=x._editEdgeSourceTarget(B,U,g);z&&(x.edgeEditResult=z,H=z.tipText)}else if(!g){var N=x._guidingToEdit(U,A),X="realPoint"===j?x._interactor.gridGuide.findClosest(U,A,!0):null,Y=1/0,p=1/0;X&&(X.x&&(Y=X.x),X.y&&(p=X.y));var a=!1;N&&(N.xList&&(Math.abs(N.x)<=Math.abs(Y)?(a=!0,Y=N.x):delete N.xList),N.yList&&(Math.abs(N.y)<=Math.abs(p)?(a=!0,p=N.y):delete N.yList),a&&(x._guideInfo=N)),isFinite(Y)&&(U.x+=Y),isFinite(p)&&(U.y+=p),a&&(N.v=U)}}var y=x.screenInfo.curve;if("realPoint"===h.type){E=h.point,E.e!==_&&(U.e=E.e),y.moveRealPoint(E,U),h.point=U,x.highlight.point=U;var K=T.status,w=T.selections;if(x.activing={point:U,status:K},w){var v=U.clone().sub(E),l=0;w.forEach(function(V){var T=V.clone().add(v);y.moveRealPoint(V,T),w[l++]=T}),x.activing.selections=w}}else if("ctrlPoint"===h.type){var n=T.pairs,C=n[h.pairId];y.moveCtrlPoint(C,U,h.ctrlType);var G=T.status,Z=Tl.Curve.PointType;if((G===Z.Mirrored||G===Z.Asymmetric)&&C.c1&&C.c2){var E=new Tl.Math.Vector2(T.point),Q="c1"===h.ctrlType?"c2":"c1";if(G===Tl.Curve.PointType.Mirrored)y.moveCtrlPoint(C,E.clone().multiplyScalar(2).sub(U),Q);else if(G===Z.Asymmetric){var O=C[Q].clone().sub(E).length(),o=E.clone().sub(C[h.ctrlType]).setLength(O).add(E);isNaN(o.x)||y.moveCtrlPoint(C,o,Q)}}T._firePointChange()}else if("elevation"===h.type){k=h.startPoint;var e=k.e+(k.y-U.y)/I._zoom;x._setCurrentPointImpl("e",e),T._firePointChange(),H="E: "+Tl.toFixed(e)}var R=V.Default.getLogicalPoint(r,x._interactor._canvas);if(R.x+=Tl.Icons.TipShiftX,R.y+=Tl.Icons.TipShiftY,!H){var d=Tl.toWorldPosition(I,U);H=""+Tl.toFixed(d.x)+", "+Tl.toFixed(d.y)}x.tipInfo={helperPos:R,text:H,size:H.length},x._writeToHt(),x._interactor.fi({kind:"betweenEditPoint",event:r})}},Tf.prototype._setCurrentPointImpl=function(a,r){var v=this,b=v._activing;if(!b)return!1;var R=v.target;if(!R)return!1;var F=b.getCurrentEditingPoint();if(!F)return!1;var N=b.editingCtrl;if(!N)var W=F.clone();if("e"===a)F.e=r;else{var w;if("x"===a||"y"===a){var h=b._lastFirePoint;w="x"===a?{x:r,y:h?h.y:0}:{x:h?h.x:0,y:r}}else"object"==typeof a?(w=a,a.e!==_&&(F.e=a.e)):(w={x:arguments[0],y:arguments[1]},arguments[2]!==_&&(F.e=arguments[2]));var S=Tl.getDataMatrix(R);w=Tl.toScreenPosition(v._interactor.gv,S.apply(w)),F.x=w.x,F.y=w.y}if(!N){var T=W.multiplyScalar(-1).add(F);F.e&&W.e&&(T.e=F.e-W.e);var D=v.screenInfo.curve;D.moveCtrlDueToRealPointMovement(F,T);var k=b.selections;if(k){var B=0;k.forEach(function(h){var r=h.clone().add(T);isFinite(T.e)&&(r.e=(isFinite(h.e)?h.e:R.getElevation()||0)+T.e),D.moveRealPoint(h,r),k[B++]=r}),b.selections=k}}return!0},Tf.prototype.setCurrentPoint=function(R,z){return this._setCurrentPointImpl(R,z)?(this._writeToHt(),!0):!1},Tf.prototype._isEditEdgeSourceTarget=function(){var r=this,t=r.target;if(!(t instanceof V.Edge))return!1;var s=r.editing.point,q=r.screenInfo.curve._curves;return s===q[0]._p1?"source":s===q[q.length-1]._p4?"target":!1},Tf.prototype._editEdgeSourceTarget=function(a,L,$){var Q,Y=this,y=Y.target;if(Q="source"===a?y.getSource():y.getTarget()){var T,u=Y._interactor.gv,d=Tl.toWorldPosition(u,L),V=Y._calcHostAnchor(y,a,d,Q);if(T=V.index!==_||V.percent!==_?V.distance*u.getZoom()>Y._interactor.getStyle("edgeHostEdgeMaxDistance"):Y._interactor.getStyle("edgeHostDetectPerFrame")?!0:V.x<0||V.x>1||V.y<0||V.y>1?!0:!1){var e=u.getDataAt(d,function(A){return u.isSelectable(A)?u.isSourceTargetEditable(y,A,a)?y.canSetSourceTarget(A,a)?!0:!1:!1:!1});if(e){var N=Y._calcHostAnchor(y,a,d,e);Q=e,Y._nextChangeEdgeHost={type:a,host:e},V=N}}var g,S,D;if($||V.x===_)(V.percent!==_||V.index!==_)&&(S=V.point);else{var K=Y._interactor.getStyle("anchorRound"),w=Y._interactor.getStyle("anchorSensitivity");g=u.calculateAttachPoint(Q,d),g?V=g.info:(V.x=Tl.roundTo(V.x,K,w),V.y=Tl.roundTo(V.y,K,w)),S=Hl(u,Q,0,V.offsetX||0,V.offsetY||0,V.x,V.y)}S&&(D=Tl.toScreenPosition(u,S),L.x=D.x,L.y=D.y),Y._edgeHostGuideInfo={corners:Tl.getTargetCornersOnScreen(u,Q),attach:g?g.index:-1,host:Q};var Z;return V.percent!==_?Z="percent: "+V.percent.toFixed(2):V.index!==_?Z="index: "+V.index:(Z=""+V.x.toFixed(2)+", "+V.y.toFixed(2),(V.offsetX||V.offsetY)&&(Z+=" offset: "+V.offsetX.toFixed(2)+", "+V.offsetY.toFixed(2))),{host:Q,anchor:V,tipText:Z}}},Tf.prototype._guidingToEdit=function(M,j){var p,R,F=this;if(p=F.screenInfo.curve){R=p._curves;var _,h,t,O,I,z,S,L,x=1/0,D=1/0,P=[];for(F.editing&&"realPoint"===F.editing.type&&(L=F.editing.point),I=0,z=2*R.length;z>I;I++)S=R[Math.floor(I/2)][I%2?"_p4":"_p1"],P.indexOf(S)>=0||(P.push(S),L&&L===S||(t=S.x-M.x,O=S.y-M.y,Math.abs(t)<Math.abs(x)?(x=t,_=[S]):t===x&&_.push(S),Math.abs(O)<Math.abs(D)?(D=O,h=[S]):O===D&&h.push(S)));var A=F._interactor.getStyle("smartGuideThreshold");if((Math.abs(x)>A||"y"===j)&&(_=null),(Math.abs(D)>A||"x"===j)&&(h=null),_||h){var U=!1,v={};if(_&&(U=!0,v.xList=_,v.x=x),h&&(U=!0,v.yList=h,v.y=D),U)return v}}},Tf.prototype._46O=function(n){var a=this;a.editing&&(a.editing=null,a._interactor.fi({kind:"endEditPoint",event:n})),a._guideInfo=null,a._edgeHostGuideInfo=null,a._pan&&(a._pan=null,a._interactor.fi({kind:"endPan",event:n})),a._multiSelect&&(a._handleMultiSelect(a._multiSelect),a._multiSelect=null),a.tipInfo=null,a.edgeEditResult=null},Tf.prototype._handleMultiSelect=function(O){if(O.startPoint&&O.endPoint){var C,c,p,P,K,v=this,e=v._interactor,f=e.gv,k=Tl.toScreenPosition(f,O.startPoint),w=Tl.toScreenPosition(f,O.endPoint),z=V.Default.unionPoint(k,w),I=v.screenInfo.curve._curves,l=[],Y=function(F){F.x>=z.x&&F.y>=z.y&&F.x<=z.x+z.width&&F.y<=z.y+z.height&&l.indexOf(F)<0&&l.push(F)};for(C=0,c=I.length;c>C;C++)K=I[C],Y(K._p1),Y(K._p4);if(l.length){var B=v.activing||{},o=B.selections||[];for(B.point&&o.push(B.point),C=0,c=o.length;c>C;C++)p=o[C],P=l.indexOf(p),P>=0?l[P]=_:l.push(p);var F=l;for(l=[],C=0,c=F.length;c>C;C++)F[C]&&l.push(F[C]);c=l.length,0===c?v.activing=null:1===c?v.activing={point:l[0]}:(p=l[c-1],v.activing={point:p,selections:l.splice(0,c-1)}),e.redraw()
}}},Tf.prototype._canDeletePoint=function(y,G){var z=this.target;if(!(z instanceof V.Edge))return!0;var N=y._curves[0],f=y._curves[y._curves.length-1];return N._p1===G||f._p4===G?!1:!0},Tf.prototype.handleDelete=function(){var R=this;if(R.activing&&R.screenInfo){var s=V.Default.isShiftDown(),a=R.screenInfo.curve;R._canDeletePoint(a,R.activing.point)&&a.deleteRealPoint(R.activing.point,s),R.activing.selections&&R.activing.selections.forEach(function(P){R._canDeletePoint(a,P)&&a.deleteRealPoint(P,s)}),R.activing=null,delete R.editing,delete R.tipInfo,delete R.edgeEditResult,delete R._pan,delete R._multiSelect,R._writeToHt(),R._interactor.fp("deleteShapePoint",!1,!0)}},Tf.prototype.handleDoubleClick=function(q){var p=this,A=p._interactor._getLogicalPoint(q);if(p.screenInfo&&p._checkEditRealPoint(A)){var D=p.getCurrentSelectintStatus(),G=Tl.Curve.PointType;return D=D===G.Mirrored?G.Straight:G.Mirrored,p._setCurrentSelectionStatus(D),p._interactor._42(),!0}},Tf.prototype._drawHighlight=function(b){var N=this,U=N.highlight;if(U){var K=U.bezier,X=N._interactor;K&&Tl.Icons.DrawIcon(X,b,Tl.Icons.ShapeHighlightCurve,[K._p1.x,K._p1.y,K._p2.x,K._p2.y,K._p3.x,K._p3.y,K._p4.x,K._p4.y]);var v=U.point;v&&"insertKnot"===U.type&&Tl.Icons.DrawIcon(X,b,Tl.Icons.ShapeHighlighPoint,v)}},Tf.prototype._drawGuide=function(L){var U=this,r=U._guideInfo;if(r){var E,y,A,h,D=r.v;for(E=0;2>E;E++)if(h=0===E?r.xList:r.yList)for(y=0,A=h.length;A>y;y++)Tl.Icons.DrawIcon(U._interactor,L,Tl.Icons.ShapeGuideLine,[D.x,D.y,h[y].x,h[y].y])}},Tf.prototype._drawCurrentPoint=function(R){var e=this;if(e.activing){var l=e.activing,m=e.getCurrentSelectintStatus(),i=e._interactor;if(m!==Tl.Curve.PointType.Straight){var H=l.pairs;l.hlpair,l.hltype;var p=l.selections,B=l.editingCtrl;if(H&&!p){var d,G,I;for(G=0,I=H.length;I>G;G++)d=H[G],B&&G===B.pairId&&d[B.type]?Tl.Icons.DrawIcon(i,R,Tl.Icons.ShapeActivingCtrl,{point:d.point,c1:d.c1,c2:d.c2,hl:B.type}):Tl.Icons.DrawIcon(i,R,Tl.Icons.ShapeActivingCtrl,d)}}Tl.Icons.DrawIcon(i,R,Tl.Icons.ShapeHighlighRealPoint,e.activing.point),p&&p.forEach(function(A){Tl.Icons.DrawIcon(i,R,Tl.Icons.ShapeHighlighRealPoint,A)})}},Tf.prototype.clear=function(){var J=this;J.editing=null,J._guideInfo=null,J.activing=null,J.highlight=null},Tf.prototype._42=function(Q){var G=this;G.info={},G.editing||(G.screenInfo=null);var f=G._interactor;if(!f.editDetail)return G.clear(),void 0;var D=f.gv;if(!G.target||!D.isSelected(G.target)||!D.isVisible(G.target))return f.editDetail=!1,G.clear(),void 0;if(G.gatherSingleTarget(D,G.target),Tl.Icons.DrawIcon(f,Q,Tl.Icons.ShapeBgCurve,G.screenInfo),G._interactor.getStyle("curveElevationVisible")&&(G.target instanceof V.Polyline||G.target instanceof V.Edge&&G._interactor.getStyle("edgeElevationEditable"))&&G.activing){var x=G.activing.getCurrentEditingPoint();x&&"string"!=typeof x.e&&Tl.Icons.DrawIcon(f,Q,Tl.Icons.EdgeElevationGuide,x)}if(G._drawHighlight(Q),G._drawCurrentPoint(Q),G._getRealPoint().forEach(function(G){Tl.Icons.DrawIcon(f,Q,Tl.Icons.ShapePoint,G)}),G._drawGuide(Q),G.tipInfo&&G._interactor.getStyle("curveTipVisible")&&Tl.Icons.DrawIcon(f,Q,Tl.Icons.TipHelper,G.tipInfo),G._edgeHostGuideInfo&&f._drawHostGuide(G._edgeHostGuideInfo),G.edgeEditResult&&G._drawEdgeHostHighlight(Q,G.edgeEditResult.host,G.edgeEditResult.anchor),G._multiSelect&&G._multiSelect.endPoint){var p=V.Default.unionPoint(Tl.toScreenPosition(D,G._multiSelect.startPoint),Tl.toScreenPosition(D,G._multiSelect.endPoint));p.color=D.getRectSelectBorderColor(),Q.save(),Q.setTransform(1,0,0,1,0,0);var v=C.devicePixelRatio,I=p.borderWidth=Math.round(v);I/=2,p.x=Math.round(p.x*v)+I,p.y=Math.round(p.y*v)+I,p.width=Math.round(p.width*v),p.height=Math.round(p.height*v),Tl.Icons.DrawIcon(f,Q,Tl.Icons.SimpleRect,p),Q.restore()}},Tf.prototype._drawEdgeHostHighlight=function(B,i,D){this.drawEdgeHostHighlight(B,i,D),this._interactor.redraw()},Tf.prototype.drawEdgeHostHighlight=function($,Z,j){if(Cm(Z)){var g,y,z,U,S=this,i=S._interactor,x=i.gv,R=x.getDataUI(Z),W=Pe(R),H=[];for(z=0,U=W.points.length;U>z;z++)y=Tl.toScreenPosition(x,W.points.get(z)),H.push(y.x,y.y);W.segments&&(g=W.segments.toArray());var I=i.getStyle("edgeHostHighlighPeriod"),B=i.getStyle("edgeHostEdgeHighlighColor");Tl.Icons.DrawIcon(i,$,Tl.Icons.ShapeBgCurve,{P:H,S:g,color:B,dynamicVisible:j.index===_,dynamicPeriod:I}),B=i.getStyle("edgeHostPointHighlighColor");var w=Xe(R);for(z=0,U=w.length;U>z;z++){var O=w[z],c=Tl.toScreenPosition(x,O);Tl.Icons.DrawIcon(i,$,Tl.Icons.ShapePoint,{point:{x:c.x,y:c.y},color:B,size:12,dynamicVisible:z===j.index,dynamicPeriod:I})}}},Tf.prototype._getRealPoint=function(){var u,K=this.screenInfo,y=K.P,o=K.S,v=-1,Y=[],r=-1,J=o.length;return o.each(function(Z){r++;var l=1;if(3===Z)l=2;else if(4===Z)l=3;else if(5===Z)return;v+=l,u=r+1>=J?!0:1===o.get(r+1)?!0:!1,Y.push({point:{x:y[2*v],y:y[2*v+1]},segmentIndex:r,pointIndex:v,isEnd:u})}),Y},Tf.prototype.getEditingPointsInfo=function(p){var H=this,z=H.activing;if(!z)return!1;var P=z.point;if(!P)return!1;var X=this._getRealPoint(),f=[{screen:P}];z.selections&&z.selections.forEach(function(s){f.push({screen:s})});var j,n,E=X.length;return f.forEach(function(c){for(j=0;E>j;j++)if(n=X[j],c.screen.isNearEnough(n.point)){c.segmentIndex=n.segmentIndex,c.pointIndex=n.pointIndex,c.point=H.target.getPoints().get(n.pointIndex);break}}),p&&f.sort(function(A,y){return A.segmentIndex-y.segmentIndex}),f};var wf=Tl.MoveHelper=function(J){var s=this;s.catalog="Move",s._interactor=J};wf.prototype={},wf.prototype.constructor=wf,wf.prototype.calcShift=function(Q,$,H){var o,t,B=this,M=B._interactor.gv,g=M.lp($);if("beginMove"===Q&&B._gatherGridInfo(H._lastLogicalPoint||g),o=B._target){var K=o.downPosition;if(K){var y=B._interactor.getStyle("moveSensitivity")/M._zoom;if(K.distanceTo(g)<y)return{x:0,y:0};delete o.downPosition}var p;t=V.Default.isShiftDown($),t&&(g=B._dealShiftDown(g),p=o.shiftGuide.dir);var w,O=o.rawPos={x:o.pos.x+g.x-o.lp.x,y:o.pos.y+g.y-o.lp.y};if(V.Default.isCtrlDown($)){if(w=B._calcShiftByAddon(),B._target.node instanceof Tl.Group){var n=B._target.node;n._position.x+=w.x,n._position.y+=w.y}return w}var k=B._interactor.rectGuide;if(o.node instanceof V.Data&&o.node.s("2d.attachable")){var L=B._calcAttachNodeShift(o.node,O);if(k.clear(),L)return L}for(var x,r=o.x+O.x,C=o.y+O.y,u={x:r,y:C},i={x:r+o.w/2,y:C+o.h/2},j={x:r+o.w,y:C+o.h},J=B._interactor.gridGuide,v=[k.findClosest(u,p),k.findClosest(i,p),k.findClosest(j,p),J.findClosest(u,p),J.findClosest(i,p),J.findClosest(j,p)],a=1/0,E=1/0,I=0,D=v.length;D>I;I++)x=v[I],x&&(r=x.x,C=x.y,isFinite(r)&&Math.abs(r)<Math.abs(a)&&(a=r),isFinite(C)&&Math.abs(C)<Math.abs(E)&&(E=C));if(isFinite(a)||(a=0),isFinite(E)||(E=0),w=B._calcShiftByAddon(a,E),B._target.node instanceof Tl.Group){var n=B._target.node;n._position.x+=w.x,n._position.y+=w.y}var T=o.node;if(!pf(T,M)){var G=O.x+a,q=O.y+E;B._interactor.rectGuide.gatherLines({node:T,x:o.x+G,y:o.y+q,w:o.w,h:o.h},p)}return w}},wf.prototype._calcShiftByAddon=function(M,B){var L=this._target,_=L.rawPos,d=L.node.getPosition();return M=M||0,B=B||0,{x:_.x-d.x+M,y:_.y-d.y+B}},wf.prototype._dealShiftDown=function(z){var f=this,D=f._target.shiftGuide,n=f._target.lp,V=Math.abs(z.x-n.x),c=Math.abs(z.y-n.y);V>c&&V>D.limit&&"y"===D.dir&&(D.dir="x"),c>V&&c>D.limit&&"x"===D.dir&&(D.dir="y");var x=D.dir;return"x"===x?(z.y=n.y,D.limit=Math.max(D.limit,V)):"y"===x&&(z.x=n.x,D.limit=Math.max(D.limit,c)),z},wf.prototype._isAttachableLineShape=function(q){if(!q.getSegments)return!1;var L=q.getSegments();if(!L)return!0;L instanceof V.List&&(L=L.getArray());for(var I=1,Z=L.length;Z>I;I++)if(2!==L[I])return!1;return!0},wf.prototype._calcAttachNodeShift=function(){var V=new Go,r=new Go,q=new Go,X=new Go;return function(j,m){var n=this._interactor.gv,u=j.getHost(),N=n.getDataAt(m,function(y){return y.s("2d.hostable")?!0:!1});if(N&&u!==N&&j.setHost(N),!N)return this._edgeHostGuideInfo=null,j.setHost(null);var T=this._edgeHostGuideInfo={corners:Tl.getTargetCornersOnScreen(n,N),host:N,attach:-1};if(this._isAttachableLineShape(N)){for(var b,w,_,z,K,s,a=N.getPoints(),J=a.size(),p=N.getPointsMatrix2d(),C=1/0,h=0;J>h&&(h!==J-1||N.isClosePath());h++)0!==h?r.copy(q):p.apply(a.get(h),r),p.apply(h===J-1?a.get(0):a.get(h+1),q),V.copy(m).sub(r),X.copy(q).sub(r),b=X.length(),X.divideScalar(b),w=V.dot(X),0>w?w=0:w>b&&(w=b),X.multiplyScalar(w).add(r),_=V.copy(m).sub(X).lengthSq(),C>_&&(C=_,s=h,z=w,K=b);return Math.sqrt(C)*n.getZoom()>this._interactor.getStyle("attachThreshold")?(j.s({"attach.index":-1}),j.setHost(null),void 0):(j.s("attach.offset.opposite")&&(z=K-z),j.s({"attach.index":s,"attach.offset":j.s("attach.offset.relative")?z/K:z}),{x:0,y:0})}var B=n.calculateAttachPoint(N,m);if(B){var o=B.point;return T.attach=B.index,this._calcShiftByAddon(o.x-m.x,o.y-m.y)}}}(),wf.prototype._gatherGridInfo=function(k){var j,N=this,I=N._interactor,F=I._getValidSelection();if(F.length){if(1===F.length){if(j=F[0],!j.getRect)return N._target=null,void 0}else if(j=Tl.Group.findOrCreateGroup(F,I._uuid),!j)return N._target=null,void 0}else{var F=I.gv.sm().getSelection();if(F.length&&(j=F.get(0),!j.getRect))return N._target=null,void 0}if(j){var y=j.getPosition(),E=j.getRect();N._target={node:j,x:E.x-y.x,y:E.y-y.y,w:E.width,h:E.height,lp:{x:k.x,y:k.y},pos:{x:y.x,y:y.y},shiftGuide:{dir:"x",limit:0},downPosition:new Tl.Math.Vector2(k)},I.rectGuide.gatherRects()}},wf.prototype.clear=function(){var B=this;B._edgeHostGuideInfo=null,B._interactor.rectGuide.clear(),B._interactor._42()},wf.prototype._42=function(){var r=this._edgeHostGuideInfo;r&&this._interactor._drawHostGuide(r)};var cn=f.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),xk=function(){function T(d,X){var y=_;return function(){return y||(y=d.getExtension(X)),y}}function z(n,c){c==_&&(c={}),c.version=K&&(n instanceof WebGL2RenderingContext||f.prototype.toString.call(n)===E)?2:1,c.extensions=function(){for(var z={},m=n.getSupportedExtensions(),F=m.length;F--;)z[name]=T(n,m[F]);return z}();for(var Z=f.keys(p),M=0,D=Z.length;D>M;++M){var U=Z[M];c[U]=n.getParameter(p[U])}if(c.version>1){Z=f.keys(Y);for(var M=0,D=Z.length;D>M;++M){var U=Z[M];c[U]=n.getParameter(Y[U])}}return c}var K="undefined"!=typeof WebGL2RenderingContext,E="[object WebGL2RenderingContext]",p={aliasedLineWidthRange:cn.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:cn.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:cn.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:cn.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:cn.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:cn.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:cn.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:cn.MAX_TEXTURE_SIZE,maxVaryingVectors:cn.MAX_VARYING_VECTORS,maxVertexAttribs:cn.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:cn.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:cn.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:cn.MAX_VIEWPORT_DIMS},Y={max3DTextureSize:cn.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:cn.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:cn.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:cn.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:cn.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:cn.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:cn.MAX_DRAW_BUFFERS,maxElementIndex:cn.MAX_ELEMENT_INDEX,maxElementsIndices:cn.MAX_ELEMENTS_INDICES,maxElementsVertices:cn.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:cn.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:cn.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:cn.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:cn.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:cn.MAX_SAMPLES,maxTextureLODBias:cn.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:cn.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:cn.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:cn.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:cn.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:cn.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:cn.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:cn.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:cn.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:cn.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:cn.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(S){var U=S._info;return U||(S._info=U=z(S,U)),U}}}(),Mp=function(){function i(v,o,R){return{def:v,getter:R?function(Z){var s=xk.for(Z);return s.version>1?Z.getParameter(o):v}:function(s){return s.getParameter(o)},setter:R?function(V,O){var W=xk.for(V);W.version>1&&V.pixelStorei(o,O)}:function(V,r){V.pixelStorei(o,r)}}}function M(Z){return"string"==typeof Z?Sj(Z):Z.r!==_?(p[0]=Z.r,p[1]=Z.g,p[2]=Z.b,p[3]=Z.a,p):Z.red!==_?(p[0]=Z.red,p[1]=Z.green,p[2]=Z.blue,p[3]=Z.alpha,p):Z}function y(s){return g(s)?Array.prototype.slice.call(s,0):s}function O(V,c,U){this.gl=c,this._record=U||{},this._branches={},this._leafSync={},this._struct=V;for(var n=V.children,J=n.length;J--;){var u=n[J],f=u.name;u.isLeaf?(this._leafSync[f]=!1,this._record[f]=y(u.desc.def)):this._record[f]={}}}function s(T){function h(_,A){O.call(this,T,_,A);for(var v=L.length;v--;){var F=L[v];this._branches[F._name]=new F._type(_,this._record[F._name])}}function J(T,M){function V(Z,Q){for(var P=i,A=!1;P--;)Z[P]!==Q[P]&&(Z[P]=Q[P],A=!0);return A}var n=T.name,Z=g(T.desc.def),i=Z&&T.desc.def.length;if(T.isLeaf){var W=T.desc.setter,o=T.desc.parse;f.defineProperty(M,n,{configurable:!1,enumerable:!0,get:function(){return this._record[n]},set:Z?function(h){o&&(h=o(h)),(V(this._record[n],h)||!this._leafSync[n])&&(W(this.gl,this._record[n]),this._leafSync[n]=!0)}:function(H){this._record[n]===H&&this._leafSync[n]||(W(this.gl,H),this._record[n]=H,this._leafSync[n]=!0)}})}else L.push({_name:n,_type:s(T)}),f.defineProperty(M,n,{configurable:!1,enumerable:!0,get:function(){return this._branches[n]},set:function(B){this._branches[n].apply(B)}})}var L=[];return Q(h,O),T.forEach(J,h.prototype),h}var p="undefined"!=typeof Float32Array&&new Float32Array(4),n={viewport:{def:[0,0,0/0,0/0],getter:function(q){return q.getParameter(q.VIEWPORT)},setter:function(P,E){var M=E[2]!==E[2]?P.drawingBufferWidth-E[0]:E[2],r=E[3]!==E[3]?P.drawingBufferHeight-E[1]:E[3];P.viewport(E[0],E[1],M,r)}},dither:{def:!1,getter:function(w){return w.isEnabled(w.DITHER)},setter:function(R,U){U?R.enable(R.DITHER):R.disable(R.DITHER)}},rasterizerDiscard:{def:!1,getter:function(T){var v=xk.for(T);return v.version>1&&T.isEnabled(T.RASTERIZER_DISCARD)},setter:function(P,O){var M=xk.for(P);1!==M.version&&(O?P.enable(P.RASTERIZER_DISCARD):P.disable(P.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(H){return H.lineWidth?H.getParameter(H.LINE_WIDTH):1},setter:function(u,X){u.lineWidth&&u.lineWidth(X)}},color:{clear:{def:[0,0,0,0],getter:function(z){return z.getParameter(z.COLOR_CLEAR_VALUE)},setter:function(Q,N){Q.clearColor(N[0],N[1],N[2],N[3])},parse:M},mask:{def:[!0,!0,!0,!0],getter:function(P){return P.getParameter(P.COLOR_WRITEMASK)},setter:function(I,h){I.colorMask(h[0],h[1],h[2],h[3])}}},blend:{enabled:{def:!1,getter:function(T){return T.isEnabled(T.BLEND)},setter:function(Q,I){I?Q.enable(Q.BLEND):Q.disable(Q.BLEND)}},color:{def:[0,0,0,0],getter:function(g){return g.getParameter(g.BLEND_COLOR)},setter:function(v,u){v.blendColor(u[0],u[1],u[2],u[3])},parse:M},equation:{def:[cn.FUNC_ADD,cn.FUNC_ADD],getter:function(J){return[J.getParameter(J.BLEND_EQUATION_RGB),J.getParameter(J.BLEND_EQUATION_ALPHA)]},setter:function(Z,i){Z.blendEquationSeparate(i[0],i[1])},parse:function(i){var y=i.length;return y>1?i:1===y?(p[1]=p[0]=i[0],p):(p[1]=p[0]=i,p)}},func:{def:[cn.ONE,cn.ZERO,cn.ONE,cn.ZERO],getter:function(C){return[C.getParameter(C.BLEND_SRC_RGB),C.getParameter(C.BLEND_DST_RGB),C.getParameter(C.BLEND_SRC_ALPHA),C.getParameter(C.BLEND_DST_ALPHA)]},setter:function(o,c){o.blendFuncSeparate(c[0],c[1],c[2],c[3])},parse:function(g){var m=g.length;return m>3?g:(p[2]=p[0]=g[0],p[3]=p[1]=g[1],p)}}},cullFace:{enabled:{def:!1,getter:function(S){return S.isEnabled(S.CULL_FACE)},setter:function(A,T){T?A.enable(A.CULL_FACE):A.disable(A.CULL_FACE)}},mode:{def:cn.BACK,getter:function(h){return h.getParameter(h.CULL_FACE_MODE)},setter:function(Z,S){Z.cullFace(S)}},frontFace:{def:cn.CCW,getter:function(U){return U.getParameter(U.FRONT_FACE)},setter:function(E,S){E.frontFace(S)}}},scissor:{enabled:{def:!1,getter:function(o){return o.isEnabled(o.SCISSOR_TEST)},setter:function(u,$){$?u.enable(u.SCISSOR_TEST):u.disable(u.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(D){return D.getParameter(D.SCISSOR_BOX)},setter:function(z,U){var K=U[2]!==U[2]?z.drawingBufferWidth-U[0]:U[2],s=U[3]!==U[3]?z.drawingBufferHeight-U[1]:U[3];z.scissor(U[0],U[1],K,s)}}},depth:{enabled:{def:!1,getter:function(n){return n.isEnabled(n.DEPTH_TEST)},setter:function(s,U){U?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST)}},clear:{def:1,getter:function(Z){return Z.getParameter(Z.DEPTH_CLEAR_VALUE)},setter:function(r,u){r.clearDepth(u)}},mask:{def:!0,getter:function(d){return d.getParameter(d.DEPTH_WRITEMASK)},setter:function(B,T){B.depthMask(T)}},range:{def:[-1,1],getter:function(f){return f.getParameter(f.DEPTH_RANGE)},setter:function(O,J){O.depthRange(J[0],J[1])}},func:{def:cn.LESS,getter:function(m){return m.getParameter(m.DEPTH_FUNC)},setter:function(L,p){L.depthFunc(p)}}},stencil:{enabled:{def:!1,getter:function(x){return x.isEnabled(x.STENCIL_TEST)},setter:function(e,E){E?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST)}},clear:{def:0,getter:function(Y){return Y.getParameter(Y.STENCIL_CLEAR_VALUE)},setter:function(k,a){k.clearStencil(a)}},frontMask:{def:255,getter:function(V){return V.getParameter(V.STENCIL_WRITEMASK)},setter:function(l,X){l.stencilMaskSeparate(l.FRONT,X)}},frontOp:{def:[cn.KEEP,cn.KEEP,cn.KEEP],getter:function(J){return[J.getParameter(J.STENCIL_FAIL),J.getParameter(J.STENCIL_PASS_DEPTH_FAIL),J.getParameter(J.STENCIL_PASS_DEPTH_PASS)]},setter:function(v,q){v.stencilOpSeparate(v.FRONT,q[0],q[1],q[2])}},frontFunc:{def:[cn.ALWAYS,0,255],getter:function(c){return[c.getParameter(c.STENCIL_FUNC),c.getParameter(c.STENCIL_REF),c.getParameter(c.STENCIL_VALUE_MASK)]},setter:function(o,m){o.stencilFuncSeparate(o.FRONT,m[0],m[1],m[2])}},backMask:{def:255,getter:function(q){return q.getParameter(q.STENCIL_BACK_WRITEMASK)},setter:function(v,b){v.stencilMaskSeparate(v.BACK,b)}},backOp:{def:[cn.KEEP,cn.KEEP,cn.KEEP],getter:function(B){return[B.getParameter(B.STENCIL_BACK_FAIL),B.getParameter(B.STENCIL_BACK_PASS_DEPTH_FAIL),B.getParameter(B.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(z,R){z.stencilOpSeparate(z.BACK,R[0],R[1],R[2])}},backFunc:{def:[cn.ALWAYS,0,255],getter:function(L){return[L.getParameter(L.STENCIL_BACK_FUNC),L.getParameter(L.STENCIL_BACK_REF),L.getParameter(L.STENCIL_BACK_VALUE_MASK)]
},setter:function(h,C){h.stencilFuncSeparate(h.BACK,C[0],C[1],C[2])}}},hint:{generateMipmap:{def:cn.DONT_CARE,getter:function(V){return V.getParameter(V.GENERATE_MIPMAP_HINT)},setter:function(b,E){b.hint(b.GENERATE_MIPMAP_HINT,E)}},fragmentShaderDerivative:{def:cn.DONT_CARE,getter:function(t){var X=xk.for(t);return 1!==X.version||X.extensions.OES_standard_derivatives?t.getParameter(cn.FRAGMENT_SHADER_DERIVATIVE_HINT):cn.DONT_CARE},setter:function(B,q){var W=xk.for(B);return W.version>1||W.extensions.OES_standard_derivatives?(B.hint(cn.FRAGMENT_SHADER_DERIVATIVE_HINT,q),void 0):void 0}}},pixelStore:{packAlignment:i(4,cn.PACK_ALIGNMENT,!1),unpackAlignment:i(4,cn.UNPACK_ALIGNMENT,!1),unpackFlipY:i(!1,cn.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:i(!1,cn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:i(cn.BROWSER_DEFAULT_WEBGL,cn.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:i(0,cn.PACK_ROW_LENGTH,!0),packSkipPixels:i(0,cn.PACK_SKIP_PIXELS,!0),packSkipRows:i(0,cn.PACK_SKIP_ROWS,!0),unpackRowLength:i(0,cn.UNPACK_ROW_LENGTH,!0),unpackImageHeight:i(0,cn.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:i(0,cn.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:i(0,cn.UNPACK_SKIP_ROWS,!0),unpackSkipImages:i(0,cn.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(R){return R.isEnabled(R.POLYGON_OFFSET_FILL)},setter:function(X,f){f?X.enable(X.POLYGON_OFFSET_FILL):X.disable(X.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(c){return[c.getParameter(c.POLYGON_OFFSET_FACTOR),c.getParameter(c.POLYGON_OFFSET_UNITS)]},setter:function(s,Z){s.polygonOffset(Z[0],Z[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(b){return b.isEnabled(b.SAMPLE_COVERAGE)},setter:function(U,Q){Q?U.enable(U.SAMPLE_COVERAGE):U.disable(U.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(y){return y.isEnabled(y.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(E,h){h?E.enable(E.SAMPLE_ALPHA_TO_COVERAGE):E.disable(E.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(U){return[U.getParameter(U.SAMPLE_COVERAGE_VALUE),U.getParameter(U.SAMPLE_COVERAGE_INVERT)]},setter:function(h,c){h.sampleCoverage(c[0],c[1])}}}},m=Bk.create(n,function(f){return"def"in f});O.prototype.reset=function(){for(var Y=this._struct.children,k=Y.length;k--;){var d=Y[k],O=d.name;d.isLeaf?this[O]=d.desc.def:this._branches[O].reset()}},O.prototype.save=function(f){f==_&&(f={});for(var S=this._struct.children,P=S.length;P--;){var d=S[P],A=d.name;if(d.isLeaf)f[A]=y(this._record[A]);else{var x=f[A];x==_&&(f[A]=x={}),this._branches[A].save(x)}}return f},O.prototype.sync=function(K,z){for(var v=this._struct.children,i=v.length;i--;){var M=v[i],I=M.name;M.isLeaf?(z||!this._leafSync[I])&&(K?(this._record[I]=M.desc.getter(this.gl),this._leafSync[I]=!0):(M.desc.setter(this.gl,this._record[I]),this._leafSync[I]=!0)):this._branches[I].sync(K,z)}},O.prototype.syncLoss=function(){for(var V=this._struct.children,z=V.length;z--;){var q=V[z];q.isLeaf?this._leafSync[q.name]=!1:this._branches[q.name].syncLoss()}},O.prototype.apply=function(o){for(var r=this._struct.children,Q=r.length;Q--;){var l=r[Q],V=l.name;V in o&&(l.isLeaf?this[V]=o[V]:this._branches[V].apply(o[V]))}},O.prototype.append=function(T){var W=this._struct.childMap;for(var f in T){var h=W[f];h&&(h.isLeaf?this[f]=T[f]:this._branches[f].append(T[f]))}};var T=s(m);return function(p){var q=p._state;return q||(p._state=q=new T(p)),q}}(),yp=function(){function N(w,I,c,M){if(w){var q=w.length;if(q!=_)for(var T=0;M>T;++T)I[c+T]=w[T];else w.toArray&&w.toArray(I,c)}else for(var T=0;M>T;++T)I[c+T]=0}function X(A,I,k){var S=A[0];if(0>=S||S>0)return A;var K=I*k,P=s[K];if(P==_&&(s[K]=new Float32Array(K)),0!==I){N(S,P,0,k);for(var h=1,R=0;h!==I;++h)R+=k,N(A[h],P,R,k)}return P}function b($,P){$.uniform1f(this.addr,P)}function W(r,H){r.uniform1fv(this.addr,H)}function c(p,Q){if(Q.x!=_)p.uniform2f(this.addr,Q.x,Q.y);else{var h=s[2];h.set(Q,0),p.uniform2fv(this.addr,h)}}function V(x,l){x.uniform2fv(this.addr,X(l,this.size,2))}function F(S,H){if(H.x!=_)S.uniform3f(this.addr,H.x,H.y,H.z);else if(H.r!=_)S.uniform3f(this.addr,H.r,H.g,H.b);else if(H.red!=_)S.uniform3f(this.addr,H.red,H.green,H.blue);else{var N=s[3];N.set(H,0),S.uniform3fv(this.addr,N)}}function y(r,K){r.uniform3fv(this.addr,X(K,this.size,3))}function A(K,u){if("string"==typeof u&&(u=Sj(u)),u.x!=_)K.uniform4f(this.addr,u.x,u.y,u.z,u.w);else if(u.r!=_)K.uniform4f(this.addr,u.r,u.g,u.b,u.a);else if(u.red!=_)K.uniform4f(this.addr,u.red,u.green,u.blue,u.alpha);else{var S=s[4];S.set(u,0),K.uniform4fv(this.addr,S)}}function q(b,U){b.uniform4fv(this.addr,X(U,this.size,4))}function l(r,Z){r.uniform1i(this.addr,Z)}function J(c,x){c.uniform1iv(this.addr,x)}function i(V,t){V.uniform2iv(this.addr,t)}function P(G,W){G.uniform3iv(this.addr,W)}function M(h,w){h.uniform4iv(this.addr,w)}function a(_,r){_.uniform1i(this.addr,x[r?1:0])}function R(l,v){var T=s[4];T.set(v,0),l.uniformMatrix2fv(this.addr,!1,T)}function k(E,w){E.uniformMatrix2fv(this.addr,!1,X(w,this.size,4))}function w(j,d){var z=s[9];z.set(d,0),j.uniformMatrix3fv(this.addr,!1,z)}function H(_,o){_.uniformMatrix3fv(this.addr,!1,X(o,this.size,9))}function p(p,a){var v=s[16];v.set(a,0),p.uniformMatrix4fv(this.addr,!1,v)}function K(o,m){o.uniformMatrix4fv(this.addr,!1,X(m,this.size,16))}function j(A,j){A.uniform1i(this.addr,this.slots[0]),A.activeTexture(A.TEXTURE0+this.slots[0]),A.bindTexture(A.TEXTURE_2D,j||A._emptyTexture)}function h(U,N){U.uniform1iv(this.addr,this.slots);for(var V=this.slots.length;V--;)U.activeTexture(U.TEXTURE0+this.slots[V]),U.bindTexture(U.TEXTURE_2D,N[V]||U._emptyTexture)}function Y(d,O){d.uniform1i(this.addr,this.slots[0]),d.activeTexture(d.TEXTURE0+this.slots[0]),d.bindTexture(d.TEXTURE_CUBE_MAP,O||d._emptyCubeTexture)}function I(o,k){o.uniform1iv(this.addr,this.slots);for(var $=this.slots.length;$--;)o.activeTexture(o.TEXTURE0+this.slots[$]),o.bindTexture(o.TEXTURE_CUBE_MAP,k[$]||o._emptyCubeTexture)}function B(c,p,$){t[c]=[p,$]}function r(Z,F,E){switch(Z.type){case 35678:case 35680:if("uSampler"===E)return[0];if("uBlendSampler"===E)return[1];for(var G=Z.size,d=new Int32Array(G),n=0;G>n;++n)d[n]=F.usedTextureSlot++;return d}return _}function d(Y,Q,u,F,P){this.name=Y,this.addr=Q,this.size=F?u.size:0,this.activeInfo=u,this.setter=t[u.type][F?1:0],this.slots=r(u,P,Y),Xk(this)}function m(o,j,A,N){var v=o.name,i=v.length;for(E.lastIndex=0;;){var X=E.exec(v),P=E.lastIndex,K=X[1],q="]"===X[2],h=X[3];if(q&&(K=0|K),h===_||"["===h&&P+2===i){A[K]=new d(K,j,o,h!==_,N);break}var L=A[K];L==_&&(A[K]=L={}),A=L}}function C(B,Z,d){this.gl=Z,this._program=d,this._leaves={},this._branches={},this._struct=B}function U(P){function W(F,X){C.call(this,P,F,X);for(var R=o.length;R--;){var N=o[R];this._branches[N._name]=new N._type(F,X)}}function B(j,l){var x=j.name;if(j.isLeaf){var B=z("d.setter(this.gl, v);",["v"],["d"],[j.desc]);f.defineProperty(l,x,{configurable:!1,enumerable:!0,get:function(){return B},set:B})}else o.push({_name:x,_type:U(j)}),f.defineProperty(l,x,{configurable:!1,enumerable:!0,get:function(){return this._branches[x]},set:function(r){this._branches[x].apply(r)}})}var o=[];return Q(W,C),P.forEach(B,W.prototype),W}function T(x,E){for(var l=x.getProgramParameter(E,x.ACTIVE_UNIFORMS),j={},X={usedTextureSlot:2};l--;){var D=x.getActiveUniform(E,l),I=D.name,v=x.getUniformLocation(E,I);m(D,v,j,X)}var N=Bk.create(j,function(m){return"addr"in m}),Z=U(N);return f.defineProperty(Z.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:X.usedTextureSlot}),new Z(x,E)}var s=[];if("function"==typeof Float32Array)for(var G=1;17>G;++G)s[G]=new Float32Array(G);var x=[0,1],t=[];B(cn.FLOAT,b,W),B(cn.FLOAT_VEC2,c,V),B(cn.FLOAT_VEC3,F,y),B(cn.FLOAT_VEC4,A,q),B(cn.INT,l,J),B(cn.INT_VEC2,i,i),B(cn.INT_VEC3,P,P),B(cn.INT_VEC4,M,M),B(cn.BOOL,a,J),B(cn.BOOL_VEC2,i,i),B(cn.BOOL_VEC3,P,P),B(cn.BOOL_VEC4,M,M),B(cn.FLOAT_MAT2,R,k),B(cn.FLOAT_MAT3,w,H),B(cn.FLOAT_MAT4,p,K),B(cn.SAMPLER_2D,j,h),B(cn.SAMPLER_CUBE,Y,I);var E=/([\w\d_]+)(\])?(\[|\.)?/g;return C.prototype.apply=function(F){for(var v=this._struct.children,r=v.length;r--;){var E=v[r],q=E.name;q in F&&(E.isLeaf?this[q]=F[q]:this._branches[q].apply(F[q]))}},C.prototype.append=function(P){var i=this._struct.childMap;for(var g in P){var T=i[g];T&&(T.isLeaf?this[g]=P[g]:this._branches[g].append(P[g]))}},function(b,z){var W=z._uniforms;return W||(z._uniforms=W=T(b,z)),W}}(),sh=function(){function R(x,w,u){w.vertexAttrib1f(x.addr,u)}function Z(H,K,P){if(P.x!=_)K.vertexAttrib2f(H.addr,P.x,P.y);else{var z=j[2];z.set(P,0),K.vertexAttrib2fv(H.addr,z)}}function I(C,$,n){if(n.x!=_)$.vertexAttrib3f(C.addr,n.x,n.y,n.z);else if(n.r!=_)$.vertexAttrib3f(C.addr,n.r,n.g,n.b);else if(n.red!=_)$.vertexAttrib3f(C.addr,n.red,n.green,n.blue);else{var J=j[3];J.set(n,0),$.vertexAttrib3fv(C.addr,J)}}function E(Y,o,t){if("string"==typeof t&&(t=Sj(t)),t.x!=_)o.vertexAttrib4f(Y.addr,t.x,t.y,t.z,t.w);else if(t.r!=_)o.vertexAttrib4f(Y.addr,t.r,t.g,t.b,t.a);else if(t.red!=_)o.vertexAttrib4f(Y.addr,t.red,t.green,t.blue,t.alpha);else{var i=j[4];i.set(t,0),o.vertexAttrib4fv(Y.addr,i)}}function A(r,U,i){i=i.el||i;for(var X=0,B=0;2>X;++X)U.vertexAttrib2f(r.addr,i[B++],i[B++])}function K(U,a,N){N=N.el||N;for(var P=0,V=0;3>P;++P)a.vertexAttrib3f(U.addr,N[V++],N[V++],N[V++])}function V(s,e,I){I=I.el||I;for(var U=0,h=0;4>U;++U)e.vertexAttrib4f(s.addr,I[h++],I[h++],I[h++],I[h++])}function P(n,_,D,q,i,J,Q){_.bindBuffer(_.ARRAY_BUFFER,D),_.vertexAttribPointer(n.addr,1,q||_.FLOAT,!!i,J||0,Q||0),_.bindBuffer(_.ARRAY_BUFFER,null)}function O(I,S,f,A,v,Q,d){S.bindBuffer(S.ARRAY_BUFFER,f),S.vertexAttribPointer(I.addr,2,A||S.FLOAT,!!v,Q||0,d||0),S.bindBuffer(S.ARRAY_BUFFER,null)}function e(Y,U,A,G,n,O,c){U.bindBuffer(U.ARRAY_BUFFER,A),U.vertexAttribPointer(Y.addr,3,G||U.FLOAT,!!n,O||0,c||0),U.bindBuffer(U.ARRAY_BUFFER,null)}function B(k,G,g,v,H,m,u){G.bindBuffer(G.ARRAY_BUFFER,g),G.vertexAttribPointer(k.addr,4,v||G.FLOAT,!!H,m||0,u||0),G.bindBuffer(G.ARRAY_BUFFER,null)}function k(q,X,I,A,O,u,v){var u=u||4,v=v||0;X.bindBuffer(X.ARRAY_BUFFER,I),X.vertexAttribPointer(q.addr,2,A||X.FLOAT,!!O,u,v),X.vertexAttribPointer(q.addr+1,2,A||X.FLOAT,!!O,u,v+2),X.bindBuffer(X.ARRAY_BUFFER,null)}function i(A,X,I,m,o,T,u){var T=T||9,u=u||0;X.bindBuffer(X.ARRAY_BUFFER,I),X.vertexAttribPointer(A.addr,3,m||X.FLOAT,!!o,T,u),X.vertexAttribPointer(A.addr+1,3,m||X.FLOAT,!!o,T,u+3),X.vertexAttribPointer(A.addr+2,3,m||X.FLOAT,!!o,T,u+6),X.bindBuffer(X.ARRAY_BUFFER,null)}function h(T,S,H,$,z,q,P){var q=q||16,P=P||0;S.bindBuffer(S.ARRAY_BUFFER,H),S.vertexAttribPointer(T.addr,4,$||S.FLOAT,!!z,q,P),S.vertexAttribPointer(T.addr+1,4,$||S.FLOAT,!!z,q,P+4),S.vertexAttribPointer(T.addr+2,4,$||S.FLOAT,!!z,q,P+8),S.vertexAttribPointer(T.addr+3,4,$||S.FLOAT,!!z,q,P+12),S.bindBuffer(S.ARRAY_BUFFER,null)}function a(M,o,K){c[M]=function(y,h,L,O,X,i){this.addr==_||this.addr<0||(h==_||h===!1?y.disableVertexAttribArray(this.addr):Ep(h)===S?(y.enableVertexAttribArray(this.addr),K(this,y,h,L,O,X,i)):(y.disableVertexAttribArray(this.addr),o(this,y,h)))}}function C(B,I,b){this.name=B,this.addr=I,this.activeInfo=b,this.setter=c[b.type],Xk(this)}function g(L,m,n){this.gl=m,this.program=n,this._branches={},this._struct=L}function q(k){function W(F,O){g.call(this,k,F,O);for(var v=r.length;v--;){var j=r[v];this._branches[j._name]=new j._type(F,O)}}function T(W,G){var U=W.name;if(W.isLeaf){var l=z("d.setter(this.gl, v);",["v"],["d"],[W.desc]);f.defineProperty(G,U,{configurable:!1,enumerable:!0,get:function(){return l},set:l})}else r.push({_name:U,_type:q(W)}),f.defineProperty(G,U,{configurable:!1,enumerable:!0,get:function(){return this._branches[U]},set:function(O){this._branches[U].apply(O)}})}var r=[];return Q(W,g),k.forEach(T,W.prototype),W}function s(O,p){for(var S=O.getProgramParameter(p,O.ACTIVE_ATTRIBUTES),t={};S--;){var s=O.getActiveAttrib(p,S),G=s.name,H=O.getAttribLocation(p,G);t[G]=new C(G,H,s)}var B=Bk.create(t,function(l){return"addr"in l}),b=q(B);return new b(O,p)}for(var j=[],t=1;17>t;++t)j[t]=new ad(t);var c=[],S="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return a(cn.FLOAT,R,P),a(cn.FLOAT_VEC2,Z,O),a(cn.FLOAT_VEC3,I,e),a(cn.FLOAT_VEC4,E,B),a(cn.FLOAT_MAT2,A,k),a(cn.FLOAT_MAT3,K,i),a(cn.FLOAT_MAT4,V,h),g.prototype.disable=function(){for(var P=this._struct.children,u=P.length;u--;){var z=P[u],i=z.name;z.isLeaf?this.gl.disableVertexAttribArray(z.desc.addr):this._branches[i].disable()}},g.prototype.apply=function(D){for(var X=this._struct.children,j=X.length;j--;){var m=X[j],s=m.name;s in D&&(m.isLeaf?this[s]=D[s]:this._branches[s].apply(D[s]))}},g.prototype.append=function(G){var u=this._struct.childMap;for(var f in G){var e=u[f];e&&(e.isLeaf?this[f]=G[f]:this._branches[f].append(G[f]))}},function(k,u){var Z=u._attribs;return Z||(u._attribs=Z=s(k,u)),Z}}(),zs=function(S){var H=this;f.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:S,writable:!1},glState:{configurable:!1,enumerable:!1,value:Mp(S),writable:!1}}),H._currProgram=_,H._currUniforms=_,H._currAttribs=_,H._sync=!0};f.defineProperties(zs.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(E){var T=this;T._sync&&E===T._currProgram||(T.gl.useProgram(E),T._currProgram=E,T._currUniforms=yp(T.gl,E),T._currAttribs=sh(T.gl,E),T._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var l=this;return l._currProgram&&!l._sync&&(l.gl.useProgram(l._currProgram),l._sync=!0),l._currUniforms},set:function(c){var J=this;J._currUniforms&&(J._currProgram&&!J._sync&&(J.gl.useProgram(J._currProgram),this._sync=!0),J._currUniforms.apply(c))}},attribs:{configurable:!1,enumerable:!1,get:function(){var N=this;return N._currProgram&&!N._sync&&(N.gl.useProgram(N._currProgram),N._sync=!0),N._currAttribs},set:function(z){var r=this;r._currUniforms&&(r._currProgram&&!r._sync&&(r.gl.useProgram(r._currProgram),this._sync=!0),r._currAttribs.apply(z))}}}),zs.prototype.useProgram=function(h){var x=this;x._sync&&h===x._currProgram||(x.gl.useProgram(h),x._currProgram=h,x._currUniforms=yp(x.gl,h),x._currAttribs=sh(x.gl,h),x._sync=!0)},zs.prototype.directState=function(){return this.glState},zs.prototype.directUniforms=function(){return this._currUniforms},zs.prototype.directAttribs=function(){return this._currAttribs},zs.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},zs.for=function(U){var n=U._renderState;return n||(U._renderState=n=new zs(U)),n};var xc="directional",Mb="point",hb="spot",Ae="light.color",kp={},Xq=[],Pj=0,zb=function(w,e){zq(e)&&zm.test(e)?gl(w,e):Dg(e)&&e.modelType?rc(w,e):e===_?delete ep[w]:ep[w]=e},qe=function(R){return R},Ij=function(l){l=C.convertShape3dModelName(l);var o;if(Dg(l)){if(l.modelType){if(l.uuid){if(o=ep[l.uuid])return o}else l.uuid=V.Math.generateUUID();return o===_&&(gc&&gc[l.uuid]||rc(l.uuid,l)),_}return l}return o=ep[l],l&&o===_&&zm.test(l)&&(gc&&gc[l]||gl(l,l)),o},Oo=function(b,v){b.frameStack?b.frameStack.push(v):b.frameStack=[v],b.bindFramebuffer(b.FRAMEBUFFER,v)},sn=function(U){var d=U.frameStack;if(d){if(d.pop(),d.length)return U.bindFramebuffer(U.FRAMEBUFFER,d[d.length-1]),void 0;U.frameStack=null}U.bindFramebuffer(U.FRAMEBUFFER,null)};Xf(C,{graph3dViewAttributes:F,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:Y/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Nf,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:Y,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:Y/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:zb,getShape3dModel:Ij,convertShape3dModelName:qe,getShape3dModelMap:function(){return ep},getCachedShape3dModelMap:function(){return Mo},createMatrix:function(D,f){mh(D)||(D=[D]);for(var w=D.length-1;w>=0;w--){var V=D[w];f=wi(V.mat,V.s3,V.r3,V.rotationMode,V.t3,f)}return f},transformVec:function(q,e){return vr(q,e)},glBindFrame:Oo,glUnbindFrame:sn,createBoxModel:function(){return{vs:tc,ns:Rh,uv:Bs,is:Bj}},createRoundRectModel:function(v,U){return Fb.roundRect(v,U)},createStarModel:function(m,A){return Fb.star(m,A)},createRectModel:function(W,H){return Fb.rect(W,H)},createTriangleModel:function(C,M){return Fb.triangle(C,M)},createRightTriangleModel:function(y,p){return Fb.rightTriangle(y,p)},createParallelogramModel:function(k,n){return Fb.parallelogram(k,n)},createTrapezoidModel:function(S,G){return Fb.trapezoid(S,G)},createSmoothSphereModel:function(m,g,K,a,J,L,y){return Tk(new Hf(m,g,K,a,J,L,y))},createSphereModel:function(q,r,z,h,P,e,M){return q?uh(q,r,z,h,P,e,M):C.createSmoothSphereModel()},createSmoothConeModel:function(A,R,u,L,h){return tb(A,R,u,L,h)},createConeModel:function(t,G,A,S,k,w,b,$){return t?yl(t,G,A,S,k,w,b,$):tb(w)},createSmoothCylinderModel:function(d,L,R,p,G,Y,z,k){return Tk(new ko(d,L,R,p,G,Y,z,k))},createCylinderModel:function(l,X,A,O,d,M,e,s){return l?Ei(l,X,A,O,d,M,e,s):xb(M,e)},createSmoothTorusModel:function(T,p,f,z,W,I){return Tk(new db(T,p,f,z,W,I))},createTorusModel:function(X,A,N,j,S,Q,f,R){return X?oc(X,A,N,j,S,Q,f,R):Ub(Q,f)},createExtrusionModel:function(d,F,K,t,s,b,O,X){return pl(d,F,K,t,s,b,O,X)},createSmoothRingModel:function(H,B,T,s,$,L){for(var c=[],R=0;R<H.length-1;R+=2)c.push({x:H[R],y:H[R+1]});for(H=tg(c,B,T)[0],c=[],R=0;R<H.length;R++){var b=H[R];c.push(new pm(b.x,0,b.y))}return Tk(new wd(c,L,s,$))},createTextGeometry:function(e,Q){return Tk(new Fo(e,Q))},loadFontFace:function(S,H){C.xhrLoad(S,function(S){if(!S)return H();var z;try{z=JSON.parse(S)}catch(w){z=JSON.parse(S.substring(65,S.length-2))}mp.loadFace(z),H&&H(z.familyName.toLowerCase())},H?null:{sync:!0})},getShaderErrorLog:function(){return Xq.join("\n")},createRingModel:function(S,X,J,A,Q,K,Z,d,G,z){for(var I=[],W=0;W<S.length-1;W+=2)I.push({x:S[W],y:S[W+1]});K=K||C.shapeSide,Z=Z||0,d=d||K;var b,O,h,j,r,T,v,p,n,e,W,M,g,l,i,t,c,U,$=[],Y=[],y=G?[]:F,B=G?[]:F,N=z?[]:F,P=z?[]:F,R=A?[]:F,H=A?[]:F,f=Q?[]:F,V=Q?[]:F,S=tg(I,X,J),m=Pm(S),D=0,o=2*Math.PI/K;return S.forEach(function(q){if(h=q.length,h>1){if(j=q[0],A)for(T=j.x,p=j.y,W=Z;d>W;W++)M=W+1,g=W*o,l=M*o,i=L(g),t=u(g),c=L(l),U=u(l),R.push(i*T,p,-t*T,c*T,p,-U*T,0,p,0),H.push(.5-.5*i,.5-.5*t,.5-.5*c,.5-.5*U,.5,.5);for(e=0;h>e;e++){for(r=q[e],T=j.x,v=r.x,p=j.y,n=r.y,b=D/m,D+=kj(j,r),O=D/m,W=Z;d>W;W++)M=W+1,g=W*o,l=M*o,i=L(g),t=u(g),c=L(l),U=u(l),$.push(i*v,n,-t*v,c*v,n,-U*v,i*T,p,-t*T,c*v,n,-U*v,c*T,p,-U*T,i*T,p,-t*T),Y.push(W/K,O,M/K,O,W/K,b,M/K,O,M/K,b,W/K,b),G&&W===Z&&(y.push(0,p,0,0,n,0,i*v,n,-t*v,i*v,n,-t*v,i*T,p,-t*T,0,p,0),B.push(0,.5-p,0,.5-n,2*v,.5-n,2*v,.5-n,2*T,.5-p,0,.5-p)),z&&M===d&&(N.push(0,p,0,c*v,n,-U*v,0,n,0,c*v,n,-U*v,0,p,0,c*T,p,-U*T),P.push(1,.5-p,1-2*v,.5-n,1,.5-n,1-2*v,.5-n,1,.5-p,1-2*T,.5-p));j=r}if(Q)for(T=j.x,p=j.y,W=Z;d>W;W++)M=W+1,g=W*o,l=M*o,i=L(g),t=u(g),c=L(l),U=u(l),f.push(c*T,p,-U*T,i*T,p,-t*T,0,p,0),V.push(.5-.5*c,.5+.5*U,.5-.5*i,.5+.5*t,.5,.5)}}),{vs:$,uv:Y,bottom_vs:f,bottom_uv:V,top_vs:R,top_uv:H,from_vs:y,from_uv:B,to_vs:N,to_uv:P}}},!0),Xf(W,{"3d.move.mode":_,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":_,"edge.gradient.color":_,"edge.source.t3":_,"edge.target.t3":_,"light.type":Mb,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":Y/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":vl,"wf.short":!1,"wf.mat":_,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:_,"transparent.mask":!1,brightness:_,"select.brightness":.7,"repeat.uv.length":_,"shadow.cast":!0,"shadow.receive":!0,bloom:!1,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":_,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Br,"label.t3":_,"label.r3":_,"label.texture.scale":2,"label.rotationMode":re,"label.light":!1,"label.blend":_,"label.reverse.flip":!1,"label.reverse.color":oo,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Br,"label2.t3":_,"label2.r3":_,"label2.texture.scale":2,"label2.rotationMode":re,"label2.light":!1,"label2.blend":_,"label2.reverse.flip":!1,"label2.reverse.color":oo,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Br,"note.t3":_,"note.r3":_,"note.texture.scale":2,"note.rotationMode":re,"note.light":!1,"note.blend":_,"note.reverse.flip":!1,"note.reverse.color":oo,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Br,"note2.t3":_,"note2.r3":_,"note2.texture.scale":2,"note2.rotationMode":re,"note2.light":!1,"note2.blend":_,"note2.reverse.flip":!1,"note2.reverse.color":oo,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:_,"shape3d.color":Bd,"shape3d.top.color":_,"shape3d.bottom.color":_,"shape3d.from.color":_,"shape3d.to.color":_,"shape3d.image":_,"shape3d.image.projection":_,"shape3d.top.image":_,"shape3d.bottom.image":_,"shape3d.from.image":_,"shape3d.to.image":_,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":_,"shape3d.side.to":_,"shape3d.smooth":_,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":_,"shape3d.opacity":_,"shape3d.reverse.flip":!1,"shape3d.reverse.color":oo,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":_,"shape3d.uv.scale":_,"shape3d.uv.rotation":_,"shape3d.top.uv.offset":_,"shape3d.top.uv.scale":_,"shape3d.top.uv.rotation":_,"shape3d.bottom.uv.offset":_,"shape3d.bottom.uv.scale":_,"shape3d.bottom.uv.rotation":_,"shape3d.from.uv.offset":_,"shape3d.from.uv.scale":_,"shape3d.from.uv.rotation":_,"shape3d.to.uv.offset":_,"shape3d.to.uv.scale":_,"shape3d.to.uv.rotation":_,"shape3d.top.cap":_,"shape3d.bottom.cap":_,"shape3d.start.angle":0,"shape3d.sweep.angle":E,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"texture.mipmap.max":_,"texture.filter":_,"texture.filter.min":_,"texture.filter.mag":_,"texture.wrap":_,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":Bd,"all.image":_,"all.blend":_,"all.opacity":_,"all.reverse.flip":!1,"all.reverse.color":oo,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":_,"all.uv.offset":_,"all.uv.scale":_,"all.uv.rotation":_,"all.discard.selectable":!0,mat:_,"left.mat":_,"right.mat":_,"top.mat":_,"bottom.mat":_,"front.mat":_,"back.mat":_,"edge.source.anchor.elevation":_,"edge.target.anchor.elevation":_},!0);var Km,kk=!1,wl=[0,0,0,0],Pc=function(l){return l instanceof Ye},fr=function(G){return[G.x,G.e||0,G.y]},th=function(o,v,j){for(var v=Sj(v||0),k=v[0],A=v[1],B=v[2];j--;)o.push(k,A,B)},Fj=function(e,$,d){for(var $=Sj($||0),w=$[0],M=$[1],h=$[2],I=$[3];d--;)e.push(w,M,h,I)},vd=function(t,I,$){if(I)for(var O,o,u,X=I[0],m=I[1],n=I[2],R=I[4],L=I[5],z=I[6],S=I[8],M=I[9],B=I[10],l=I[12],Z=I[13],c=I[14],P=$.length,Q=0,Q=0;P>Q;Q+=3)O=$[Q],o=$[Q+1],u=$[Q+2],t.push(X*O+R*o+S*u+l,m*O+L*o+M*u+Z,n*O+z*o+B*u+c);else hj(t,$)},Cl=function(Z,k){var z=k.s("light.intensity"),A=Sj(k.s(Ae)),n=A[0],b=A[1],l=A[2];1!==z&&(n*=z,b*=z,l*=z),Z.push(n,b,l,k.s("light.disabled")?1:0)},Zg=function(G,U){var w=zs.for(U),N=w.directUniforms();N.uHeadlightRange=G._headlightRange,N.uHeadlightAmbientIntensity=G._headlightAmbientIntensity;var r=G._headlightIntensity,C=Sj(G._headlightColor);1!==r&&(C=[C[0]*r,C[1]*r,C[2]*r]),N.uHeadlightColor=[C[0],C[1],C[2],G._headlightDisabled?1:0];var T=G._59O,j=G._spots,F=G._dirs;if(T.length){var _=[],S=[],i=[];T.forEach(function(E){Cl(_,E),hj(S,G._transformPointToViewSpace(E.p3())),i.push(E.s("light.range"))}),N.uPointColor=_,N.uPointRange=i,N.uPointPosition=S}if(j.length){var Z=[],E=[],n=[],g=[],K=[],d=[];j.forEach(function(Q){Cl(Z,Q),hj(E,G._transformPointToViewSpace(Q.p3())),hj(K,G._transformDirectionToViewSpace(Q.p3(),Q.s("light.center"))),n.push(Q.s("light.range")),g.push(L(Q.s("light.angle")/2)),d.push(Q.s("light.exponent"))}),N.uSpotColor=Z,N.uSpotRange=n,N.uSpotAngle=g,N.uSpotExponent=d,N.uSpotPosition=E,N.uSpotDirection=K}if(F.length){var H=[],m=[];F.forEach(function(o){Cl(H,o),hj(m,G._transformDirectionToViewSpace(o.p3()))}),N.uDirColor=H,N.uDirDirection=m}},Xh=function(I,L){return Math.max(I.getRotateMinPhi()+Lc,Math.min(I.getRotateMaxPhi()-Lc,L))},ho=function(){return.05+Vo()/2},Jo=function(d,l,k,R){var q,y=d.getEye();return d.isOrtho()?(q=No(d.getCenter(),y),q[0]+=R[0],q[1]+=R[1],q[2]+=R[2]):q=y,Tq(l,k,R,q)},Tq=function(Y,L,R,o){var J=Ze(Y,L),n=No(o,R,!0),M=Ze(n,L);if(D(M)<Lc)return F;var x=(J-Ze(R,L))/M;return[R[0]+n[0]*x,R[1]+n[1]*x,R[2]+n[2]*x]},rk=function(Y,M){return{x:2*Y.x-M.x,y:2*Y.y-M.y}},ak=function(S,N,c,y){var w,v;if(!S)return w=ub(N.y-c.y,c.x-N.x),{x:N.x+y*u(w),y:N.y+y*L(w)};if(!c)return w=ub(S.y-N.y,N.x-S.x),{x:N.x+y*u(w),y:N.y+y*L(w)};var j=No([S.x,S.y,0],[N.x,N.y,0],!0),G=No([c.x,c.y,0],[N.x,N.y,0],!0),M=-(j[0]+G[0])/2,O=-(j[1]+G[1])/2,W=A(M*M+O*O);if(Lc>W)return w=ub(S.y-N.y,N.x-S.x),{x:N.x+y*u(w),y:N.y+y*L(w)};var l=S.x-N.x,g=S.y-N.y,o=c.x-N.x,D=c.y-N.y,m=A(l*l+g*g),h=A(o*o+D*D);w=q(Ze(j,G))/2,v=j[1]*G[0]-j[0]*G[1]>0?-1:1,M/=W,O/=W;var F=y/u(w),s=i(m,h)/L(w);W=Math.min(F,s);var T={x:N.x+v*W*M,y:N.y+v*W*O};return c.b&&F>h/L(w)&&(T.adjust=!0),T},Tc=function(h){var S=h[1],G=h[2],x=h[3],t=h[6],v=h[7],P=h[11];h[1]=h[4],h[2]=h[8],h[3]=h[12],h[4]=S,h[6]=h[9],h[7]=h[13],h[8]=G,h[9]=t,h[11]=h[14],h[12]=x,h[13]=v,h[14]=P},Uo=function(Y){var K=Y[0],R=Y[1],Q=Y[2],A=Y[3],G=Y[4],c=Y[5],$=Y[6],v=Y[7],n=Y[8],y=Y[9],m=Y[10],O=Y[11],P=Y[12],M=Y[13],N=Y[14],e=Y[15],T=K*c-R*G,U=K*$-Q*G,t=K*v-A*G,H=R*$-Q*c,p=R*v-A*c,C=Q*v-A*$,r=n*M-y*P,D=n*N-m*P,l=n*e-O*P,j=y*N-m*M,d=y*e-O*M,q=m*e-O*N,_=T*q-U*d+t*j+H*l-p*D+C*r;return _?(_=1/_,Y[0]=(c*q-$*d+v*j)*_,Y[1]=(Q*d-R*q-A*j)*_,Y[2]=(M*C-N*p+e*H)*_,Y[3]=(m*p-y*C-O*H)*_,Y[4]=($*l-G*q-v*D)*_,Y[5]=(K*q-Q*l+A*D)*_,Y[6]=(N*t-P*C-e*U)*_,Y[7]=(n*C-m*t+O*U)*_,Y[8]=(G*d-c*l+v*r)*_,Y[9]=(R*l-K*d-A*r)*_,Y[10]=(P*p-M*t+e*T)*_,Y[11]=(y*t-n*p-O*T)*_,Y[12]=(c*D-G*j-$*r)*_,Y[13]=(K*j-R*D+Q*r)*_,Y[14]=(M*U-P*H-N*T)*_,Y[15]=(n*H-y*U+m*T)*_,void 0):F},jc=function(n,P){if(P){var H=P[0],J=P[1],V=P[2];n[12]=n[0]*H+n[4]*J+n[8]*V+n[12],n[13]=n[1]*H+n[5]*J+n[9]*V+n[13],n[14]=n[2]*H+n[6]*J+n[10]*V+n[14],n[15]=n[3]*H+n[7]*J+n[11]*V+n[15]}},ul=function(i,q){if(q){var J=q[0],v=q[1],L=q[2];i[0]=i[0]*J,i[1]=i[1]*J,i[2]=i[2]*J,i[3]=i[3]*J,i[4]=i[4]*v,i[5]=i[5]*v,i[6]=i[6]*v,i[7]=i[7]*v,i[8]=i[8]*L,i[9]=i[9]*L,i[10]=i[10]*L,i[11]=i[11]*L}},Si=function(n,L,T){var h=L[0],f=L[1],R=L[2],B=L[3],m=L[4],O=L[5],b=L[6],H=L[7],p=L[8],Z=L[9],e=L[10],S=L[11],U=L[12],u=L[13],I=L[14],g=L[15],E=T[0],V=T[1],k=T[2],K=T[3];return n[0]=E*h+V*m+k*p+K*U,n[1]=E*f+V*O+k*Z+K*u,n[2]=E*R+V*b+k*e+K*I,n[3]=E*B+V*H+k*S+K*g,E=T[4],V=T[5],k=T[6],K=T[7],n[4]=E*h+V*m+k*p+K*U,n[5]=E*f+V*O+k*Z+K*u,n[6]=E*R+V*b+k*e+K*I,n[7]=E*B+V*H+k*S+K*g,E=T[8],V=T[9],k=T[10],K=T[11],n[8]=E*h+V*m+k*p+K*U,n[9]=E*f+V*O+k*Z+K*u,n[10]=E*R+V*b+k*e+K*I,n[11]=E*B+V*H+k*S+K*g,E=T[12],V=T[13],k=T[14],K=T[15],n[12]=E*h+V*m+k*p+K*U,n[13]=E*f+V*O+k*Z+K*u,n[14]=E*R+V*b+k*e+K*I,n[15]=E*B+V*H+k*S+K*g,n},de=function(f,o,B,O){var p,W,L,F,t,C,J,n,h,Z,z=o[0],K=o[1],M=o[2],e=O[0],S=O[1],b=O[2],T=B[0],$=B[1],l=B[2];return D(z-T)<Lc&&D(K-$)<Lc&&D(M-l)<Lc?nm(f):(J=z-T,n=K-$,h=M-l,Z=1/A(J*J+n*n+h*h),J*=Z,n*=Z,h*=Z,p=S*h-b*n,W=b*J-e*h,L=e*n-S*J,Z=A(p*p+W*W+L*L),Z?(Z=1/Z,p*=Z,W*=Z,L*=Z):(p=0,W=0,L=0),F=n*L-h*W,t=h*p-J*L,C=J*W-n*p,Z=A(F*F+t*t+C*C),Z?(Z=1/Z,F*=Z,t*=Z,C*=Z):(F=0,t=0,C=0),f[0]=p,f[1]=F,f[2]=J,f[3]=0,f[4]=W,f[5]=t,f[6]=n,f[7]=0,f[8]=L,f[9]=C,f[10]=h,f[11]=0,f[12]=-(p*z+W*K+L*M),f[13]=-(F*z+t*K+C*M),f[14]=-(J*z+n*K+h*M),f[15]=1,f)},Fe=function(A,c,t,C,k){var x=1/ar(c/2),G=1/(C-k);return A[0]=x/t,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=x,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=(k+C)*G,A[11]=-1,A[12]=0,A[13]=0,A[14]=2*k*C*G,A[15]=0,A},vq=function(M,L,v,U,V,k,s){var b=1/(L-v),R=1/(U-V),E=1/(k-s);return M[0]=-2*b,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=-2*R,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=2*E,M[11]=0,M[12]=(L+v)*b,M[13]=(V+U)*R,M[14]=(s+k)*E,M[15]=1,M},Cn=function(b,a){var S=a[0],C=a[1],f=a[2],H=a[3],G=S*S+C*C+f*f+H*H,Y=G?1/G:0;return b[0]=-S*Y,b[1]=-C*Y,b[2]=-f*Y,b[3]=H*Y,b},eb=function(F,p){var K=p[0]+p[5]+p[10],I=0;return K>0?(I=2*Math.sqrt(K+1),F[3]=.25*I,F[0]=(p[6]-p[9])/I,F[1]=(p[8]-p[2])/I,F[2]=(p[1]-p[4])/I):p[0]>p[5]&p[0]>p[10]?(I=2*Math.sqrt(1+p[0]-p[5]-p[10]),F[3]=(p[6]-p[9])/I,F[0]=.25*I,F[1]=(p[1]+p[4])/I,F[2]=(p[8]+p[2])/I):p[5]>p[10]?(I=2*Math.sqrt(1+p[5]-p[0]-p[10]),F[3]=(p[8]-p[2])/I,F[0]=(p[1]+p[4])/I,F[1]=.25*I,F[2]=(p[6]+p[9])/I):(I=2*Math.sqrt(1+p[10]-p[0]-p[5]),F[3]=(p[1]-p[4])/I,F[0]=(p[8]+p[2])/I,F[1]=(p[6]+p[9])/I,F[2]=.25*I),F},_e=function(O,e,W){var Q=e[0],Z=e[1],g=e[2],p=e[3],o=Q+Q,z=Z+Z,d=g+g,D=Q*o,w=Q*z,f=Q*d,v=Z*z,T=Z*d,y=g*d,V=p*o,j=p*z,B=p*d;return O[0]=1-(v+y),O[1]=w+B,O[2]=f-j,O[3]=0,O[4]=w-B,O[5]=1-(D+y),O[6]=T+V,O[7]=0,O[8]=f+j,O[9]=T-V,O[10]=1-(D+v),O[11]=0,O[12]=W[0],O[13]=W[1],O[14]=W[2],O[15]=1,O},Bc=function(A,k){if(A.isVREnabled()){var E=A.vr.getViewMatrix(k);if(E)return E}return de(k?k:Bf(),A._eye,A._center,A._up)},js=function(U,A){if(U.isVREnabled()){var O=U.vr.getProjectMatrix();if(O)return O}if(!A&&U._computedProjectMatrix)return ds(U._computedProjectMatrix);var y=U.getAspect(),v=U._near,K=U._far,q=Bf();if(U._ortho){var m=U._orthoWidth/2,$=m/y;vq(q,-m,m,-$,$,v,K)}else Fe(q,U._fovy,y,v,K);return q},lk=function(v,w){if(!v)return F;var R=0,p=1,P=2,q=[],X=0,Z=v.length,J=Z/3;if(w){for(;Z>X;X++)q[X]=0;for(X=0;X<w.length;X+=3){var k=[],Q=[],V=[];k[R]=v[3*w[X+1]+R]-v[3*w[X]+R],k[p]=v[3*w[X+1]+p]-v[3*w[X]+p],k[P]=v[3*w[X+1]+P]-v[3*w[X]+P],Q[R]=v[3*w[X+2]+R]-v[3*w[X+1]+R],Q[p]=v[3*w[X+2]+p]-v[3*w[X+1]+p],Q[P]=v[3*w[X+2]+P]-v[3*w[X+1]+P],V[R]=k[p]*Q[P]-k[P]*Q[p],V[p]=k[P]*Q[R]-k[R]*Q[P],V[P]=k[R]*Q[p]-k[p]*Q[R];for(var l=0;3>l;l++)q[3*w[X+l]+R]+=V[R],q[3*w[X+l]+p]+=V[p],q[3*w[X+l]+P]+=V[P]}}else for(X=0;J>X;X+=3){var k=[],Q=[],V=[];k[R]=v[3*(X+1)+R]-v[3*X+R],k[p]=v[3*(X+1)+p]-v[3*X+p],k[P]=v[3*(X+1)+P]-v[3*X+P],Q[R]=v[3*(X+2)+R]-v[3*(X+1)+R],Q[p]=v[3*(X+2)+p]-v[3*(X+1)+p],Q[P]=v[3*(X+2)+P]-v[3*(X+1)+P],V[R]=k[p]*Q[P]-k[P]*Q[p],V[p]=k[P]*Q[R]-k[R]*Q[P],V[P]=k[R]*Q[p]-k[p]*Q[R];
for(var l=0;3>l;l++)q[3*(X+l)+R]=V[R],q[3*(X+l)+p]=V[p],q[3*(X+l)+P]=V[P]}for(X=0;Z>X;X+=3){var s=[];s[R]=q[X+R],s[p]=q[X+p],s[P]=q[X+P];var e=A(s[R]*s[R]+s[p]*s[p]+s[P]*s[P]);0===e&&(e=Lc),s[R]=s[R]/e,s[p]=s[p]/e,s[P]=s[P]/e,q[X+R]=s[R],q[X+p]=s[p],q[X+P]=s[P]}return new ad(q)},yn=function(H,Q,a,d){if(a||(a=H.createTexture()),Q){var E=H.TEXTURE_2D,y=H.REPEAT,P=H.CLAMP_TO_EDGE,$=H.TEXTURE_MIN_FILTER;d=d||Rm;var w=d.minFilter||d.filter||H.LINEAR,O=d.magFilter||d.filter||H.LINEAR;H.activeTexture(H.TEXTURE0),ri(H,a),H.texImage2D(E,0,H.RGBA,H.RGBA,H.UNSIGNED_BYTE,Q),Up(H,H.TEXTURE_MAG_FILTER,O);var e=Q.naturalWidth||Q.width,m=Q.naturalHeight||Q.height;Jr.isPOT(e)&&Jr.isPOT(m)&&!d.clampToEdge&&!Q.clampToEdge?(Up(H,H.TEXTURE_WRAP_S,y),Up(H,H.TEXTURE_WRAP_T,y),Up(H,$,w===H.NEAREST?H.NEAREST_MIPMAP_NEAREST:H.LINEAR_MIPMAP_LINEAR),d.mipmapMaxLevel!==_&&Up(H,H.TEXTURE_MAX_LEVEL,d.mipmapMaxLevel),H.generateMipmap(E)):(Up(H,H.TEXTURE_WRAP_S,P),Up(H,H.TEXTURE_WRAP_T,P),Up(H,$,w)),ri(H,F)}return a},Hc=function(P,K){var E=new Uint8Array(4);return K=K||P.createTexture(),P.activeTexture(P.TEXTURE0),ri(P,K),Up(P,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texImage2D(P.TEXTURE_2D,0,P.RGBA,1,1,0,P.RGBA,P.UNSIGNED_BYTE,E),K},Rr=function(A,b){var t=new Uint8Array(4);return b=b||A.createTexture(),A.activeTexture(A.TEXTURE0),A.bindTexture(A.TEXTURE_CUBE_MAP,b),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_MAG_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,A.RGBA,1,1,0,A.RGBA,A.UNSIGNED_BYTE,t),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,A.RGBA,1,1,0,A.RGBA,A.UNSIGNED_BYTE,t),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,A.RGBA,1,1,0,A.RGBA,A.UNSIGNED_BYTE,t),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,A.RGBA,1,1,0,A.RGBA,A.UNSIGNED_BYTE,t),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,A.RGBA,1,1,0,A.RGBA,A.UNSIGNED_BYTE,t),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,A.RGBA,1,1,0,A.RGBA,A.UNSIGNED_BYTE,t),b},mf=function(c){c._26I&&c._prg&&(c._26I.deleteProgram(c._prg),c._prg=F)},Yb=function(l,i,j,Y){var W=l.createShader(j);return l.shaderSource(W,Y),l.compileShader(W),l.attachShader(i,W),W},mk=function(S){return S.createBuffer()},ri=function(j,b){j.bindTexture(j.TEXTURE_2D,b||j._emptyTexture)},Up=function(e,p,q){e.texParameteri(e.TEXTURE_2D,p,q)},wm=function(v,t){var e=zs.for(v).directState();e.polygonOffset.enabled=!0,e.polygonOffset.value=t},nr=function(q){var X=zs.for(q).directState();X.polygonOffset.enabled=!1},hc=function(Y,x){if(x){var O=zs.for(Y).directState();O.color.clear=Sj(x)}},Ir=function(i){var u=zs.for(i),Q=u.directUniforms(),X=u.directAttribs();Q.uFix=!0,X.aNormal=!1},$e=function(J){var S=zs.for(J),m=S.directUniforms();S.directAttribs(),m.uFix=!1},cb=function(y,e,M,E,w,B,s,I){var j=zs.for(y),C=j.directState(),D=j.directUniforms();y._picking||(M?(D.uBlend=!0,D.uBlendColor=M):D.uBlend=!1,D.uLight=E==F?!0:E,kd(w)&&1!==w&&(D.uPartOpacity=w),D.uReverseFlip=B==F?!1:B,D.uFixPickReverseColor=s||oo),C.cullFace.enabled=I?!0:!1},bh=function(T){if(!T._picking){var W=zs.for(T),g=W.directUniforms();g.uPartOpacity=1}},Wb=function(){var K=new V.Math.Matrix2d,j=[1,0,0,0,1,0,0,0,0];return function(G,t,p,T,R,l,c,v,y,g){var o=zs.for(G),w=o.directUniforms(),f=o.directAttribs();return p?(w.uTexture=!0,w.uDiscardSelectable=yb(T)?T:!0,f.aUv=ge(G,R,l,F,2),g?(w.uBlendTexture=!0,w.uBlendSampler=g):(w.uBlendTexture=!1,w.uBlendSampler=G._emptyBlendTexture),w.uSampler=p,w.uUvMatrix=c||v||y?On(y,c,v,K).toArray9():j,void 0):(w.uSampler=G._emptyTexture,w.uBlendSampler=G._emptyBlendTexture,void 0)}}(),gi=function(t,S,Z){var V=zs.for(t),i=V.directUniforms(),X=V.directAttribs();t.activeTexture(t.TEXTURE0),ri(t,F),t.activeTexture(t.TEXTURE1),ri(t,F),Z&&(X.aUv=!1,i.uTexture=!1,i.uSampler=t._emptyTexture,i.uBlendTexture=!1,i.uBlendSampler=t._emptyBlendTexture)},Kp=function(U,G,z,s,L,X){var I=zs.for(U),N=I.directUniforms(),l=I.directAttribs();!z||Ic||bj||U.lineWidth(z),s&&!U._picking&&(N.uFixPickReverseColor=s),L&&(l.aPosition=ge(U,L,X,F))},Pr=function(I,B,n,z){Km&&(z=I[Km]),I.drawArrays(z==F?I.TRIANGLES:z,B,n);var M=I._renderInfo;M&&(M.calls++,M.vertices+=n,(z==F||z===I.TRIANGLES)&&(M.faces+=n/3),z===I.LINES&&(M.lines+=n/2),z===I.POINTS&&(M.points+=n))},yf=function(B,q,h,u,t){Km&&(u=B[Km]),B.drawElements(u==F?B.TRIANGLES:u,h,t==F?B.UNSIGNED_SHORT:t,q==F?0:2*q);var R=B._renderInfo;R&&(R.calls++,R.vertices+=h,(u==F||u===B.TRIANGLES)&&(R.faces+=h/3),u===B.LINES&&(R.lines+=h/2),u===B.POINTS&&(R.points+=h))},ph=function(g,w,n){var V=g.ARRAY_BUFFER;return g.bindBuffer(V,w),n&&g.bufferData(V,n,g.STATIC_DRAW),w},ge=function(g,u,w,j,U){return w?as(g,g.ARRAY_BUFFER,u,w):ph(g,u,w,j,U)},vc=function(L,$,T){var U=L.ELEMENT_ARRAY_BUFFER;L.bindBuffer(U,$),T&&L.bufferData(U,T,L.STATIC_DRAW)},Rj=function(h,g,D){as(h,h.ELEMENT_ARRAY_BUFFER,g,D)},as=function(X,a,Y,C){var q=C._bufId;q||(q=C._bufId=V.Math.generateIncreasingID());var Y,Z=X._bufPool;return(Y=Z[q])&&Y._buf?X.bindBuffer(a,Y._buf):(Y=Z[q]={_buf:mk(X)},X.bindBuffer(a,Y._buf),X.bufferData(a,C,X.STATIC_DRAW)),Y._fid=X._renderInfo.frame,Y._buf},kb=function(X,g){g!=F&&g>=0&&X.enableVertexAttribArray(g)},Uk=function(r,c){c!=F&&c>=0&&r.disableVertexAttribArray(c)},Yk=function(J,c){var P=J.getGL(),f=zs.for(P),x=f.directUniforms();J._7O=J._8O.pop(),c&&(x.uMVMatrix=J._7O,J._6O=c,x.uNMatrix=c)},ie=function(T,u){return u||(u=Bf()),Gg(u,T),Uo(u),Tc(u),u},pn=function(P,C){var d=P.getGL(),r=P._7O,M=zs.for(d),D=M.directUniforms();C?(P._8O.push(ds(r)),D.uMMatrix=C,Si(r,r,C),P._7O=r):D.uMMatrix=We,D.uMVMatrix=r,D.uNMatrix=ie(r,P._6O)},bk={body:0,label:1,label2:2,note:3,note2:4,symbol:5},Ul=10,jk=function(b,w,o,S,G,Z){var W;if(o){var d=S._pickId;d||(d=S._pickId=w._pickIdUsed,w._pickIdUsed+=Ul);var A,n=bk[G];if(null!=n)A=d+n;else{var z=S._pickExtraPartMap;z||(z=S._pickExtraPartMap={}),(A=z[G])||(A=z[G]=w._pickIdUsed++)}w[A]||(w[A]={data:S,part:G}),W=$f(A)}else W=wl;if(!Z){var U=zs.for(b),u=U.directUniforms();u.uFixPickReverseColor=W}return W},Do=jk,Vg=function(T,J,x){"target"!==x&&(x="source");var I="target"===x?J.getTargetAgent():J.getSourceAgent(),S="edge."+x+".";if(be(I)){var $=J.s(S+"anchor.x"),K=J.s(S+"anchor.elevation"),L=J.s(S+"anchor.y"),y=Vl(I,T.getMat(I)),q=I.getAnchor3d();return vr([($===_?.5:$)-q.x,(K===_?.5:K)-q.y,(L===_?.5:L)-q.z],y)}var j=J.s(S+"index"),Z=T.getData3dUI(I);if(!Z.info||!Z.info.list)return!1;if(j>=0){var D,n,E,u,A,f=Z.info._lastPointsSegments,X=f.points,w=f.segments,C=-1,p=-1;for(E=0,u=w?w.length:X.length;u>E;E++){if(n=w?w.get(E):1,3===n)A=2;else if(4===n)A=3;else{if(5===n)continue;A=1}if(C+=A,p++,p===j){D=X.get(C);break}}return D||(D=X.get(X.length-1)),[D.x,D.e||0,D.y]}var z=J.s(S+"percent")||.5;if(z=Math.max(0,Math.min(z,1)),!Z||!Z.getCache)return!1;var W=Z.getCache(),u=W[W.length-1].length,f=T.getLineOffset(I,z*u),R=f.point;return[R.x,R.y,R.z]},cm=function(){var Q={center:function(t,A,L,d,Q){var u=-A[1]/2,v={x:-A[0]/2,y:u,width:A[0],height:A[1]},h=Vf(t,v,L);return[h.x+d,-h.y-Q,ho()]},front:function(t,P,F,k,g){var O=-P[1]/2,h={x:-P[0]/2,y:O,width:P[0],height:P[1]},W=Vf(t,h,F);return[W.x+k,-W.y-g,P[2]/2+ho()]},back:function(I,e,P,K,u){var i=-e[0]/2,m=-e[1]/2,y={x:i,y:m,width:e[0],height:e[1]},l=Vf(I,y,P);return[-l.x-K,-l.y-u,-e[2]/2-ho()]},left:function(i,z,p,o,r){var Z=-z[1]/2,y={x:-z[2]/2,y:Z,width:z[2],height:z[1]},F=Vf(i,y,p);return[-z[0]/2-ho(),-F.y-r,F.x+o]},right:function($,q,z,C,H){var v=-q[2]/2,G=-q[1]/2,t={x:v,y:G,width:q[2],height:q[1]},e=Vf($,t,z);return[q[0]/2+ho(),-e.y-H,-e.x-C]},top:function(Z,$,W,B,w){var o={x:-$[0]/2,y:-$[2]/2,width:$[0],height:$[2]},v=Vf(Z,o,W);return[v.x+B,$[1]/2+ho(),v.y+w]},bottom:function(Y,X,M,r,p){var L=-X[2]/2,h={x:-X[0]/2,y:L,width:X[0],height:X[2]},l=Vf(Y,h,M);return[l.x+r,-X[1]/2-ho(),-l.y-p]}};return function(I,J,K,T,V,p){return Q[T](I,J,K,V||0,p||0)}}(),Wj=function(q,Q,t,u,H,P,b,y,Z,V){if(H&&(Q[0]+=H[0],Q[1]+=H[1],Q[2]+=H[2]),jc(q,t),y){var N=Bf();if(sp(N,Z,V),vr(Q,N),jc(q,Q),q.auto=y,q.pos=vr([0,0,0],q),P){var p=q.mat2=Bf();sp(p,P,b)}}else sp(q,Z,V),jc(q,Q),u===aq?_p(q,-$k):u===zc?_p(q,$k):u===Ob?xe(q,-$k):u===fe?xe(q,$k):u===Ie&&_p(q,Y),sp(q,P,b);return q},Af=function(E,o){var v=o.auto,L=o.mat2,M=E.gv;if(v){var S,h=Bf(),N=[0,0,0,0];S="string"==typeof v?[v.indexOf("x")<0?M._eye[0]:M._center[0],v.indexOf("y")<0?M._eye[1]:M._center[1],v.indexOf("z")<0?M._eye[2]:M._center[2]]:M._eye,eb(N,de(Bf(),S,M._center,M._up)),_e(h,Cn(N,N),o.pos),L&&Si(h,h,L),pn(M,h)}else pn(M,o)},wg=function(q,c,K,M,T){var E=q.s,L=q.gv,A=L.getGL(),J=L._prg,t=L._buffer,S=L._1O,Z=zs.for(A),C=Z.directAttribs();yn(A,dc,S),Af(q,K),cb(A,J,E(c+".blend"),E(c+".light"),E(c+".opacity"),E(c+".reverse.flip"),E(c+".reverse.color"),E(c+".reverse.cull")),Wb(A,J,S,T,t.uv,Rk),C.aPosition=ge(A,t.vs,M,F),C.aNormal=ge(A,t.ns,$c,F),Rj(A,t.is,Fn),yf(A,0,Fn.length),gi(A,J,S),bh(A,J),Yk(L)},pg=function(g,t,P){var C=g.gv,K=g.data,F=g[t]={blend:C.getBodyColor(K)||C.getFaceBlend(K,t),light:C.getFaceLight(K,t),color:C.getFaceColor(K,t),opacity:C.getFaceOpacity(K,t),transparent:C.getFaceTransparent(K,t),reverseFlip:C.getFaceReverseFlip(K,t),reverseColor:C.getFaceReverseColor(K,t),reverseCull:C.getFaceReverseCull(K,t),texture:C.getFaceImage(K,t),blendTexture:C.getFaceBlendImage(K,t),discardSelectable:C.getFaceDiscardSelectable(K,t)};if("csg"!==t){F.uv=C.getFaceUv(K,t)||P&&P[t+"Uv"],F.uvScale=C.getFaceUvScale(K,t)||P&&P[t+"UvScale"],F.uvOffset=C.getFaceUvOffset(K,t)||P&&P[t+"UvOffset"],F.uvRotation=C.getFaceUvRotation(K,t)||P&&P[t+"uvRotation"];var H=C.getFaceMat(K,t);if(H){var D=Vl(K,H);K.appendAnchorMatrix3d(D),F.mat=D}}return F},tn=function(V,M,p,_,I){var P=V[_];if(P){if(!I(P.transparent))return;var A=V.data,w=V.gv,Y=w._buffer,B=w.getTexture(P.texture,A,_),G=w.getTexture(P.blendTexture,A),k=zs.for(M),j=k.directUniforms(),n=k.directAttribs();Wb(M,p,B,P.discardSelectable,Y.uv,P.tuv,P.uvOffset,P.uvScale,P.uvRotation,G),cb(M,p,P.blend,P.light,P.opacity,P.reverseFlip,P.reverseColor,P.reverseCull),P.cs&&!w._batchColorDisabled?(j.uBatchColor=!0,n.aBatchColor=ge(M,Y.batchColor,P.cs,p.aBatchColor,4)):j.uDiffuse=P.color||W["color.empty"],n.aPosition=ge(M,Y.vs,P.vs,F),n.aNormal=ge(M,Y.ns,P.ns,F),Pr(M,0,P.vs.length/3),P.cs&&!w._batchColorDisabled&&(j.uBatchColor=!1,Uk(M,p.aBatchColor)),bh(M,p),gi(M,p,B)}},Cq=function(X,S,u){mh(X)?X.forEach(function(q){Cq(q,S,u)}):zq(X)?Cq(go(S,X),S,u):Dg(X)?X.shape3d?Cq(X.shape3d,S,u):u.push(X):u.push(X)},Kg=function(){for(var D=50,H=arguments.length,N=[],O=0;H>O;O++)N[O]=arguments[O];Xq[Pj]="Time : "+(new Date).toLocaleString()+", Info :"+N.join(", "),Pj=(Pj+1)%D,console.error("Failed to create shader.")},On=function(){var N=new Jr.Matrix2d;return function($,R,H,r){r||(r=N);var h,C,O,K;return R?(h=R[0],C=R[1]):h=C=0,H?(O=H[0],K=H[1]):O=K=1,r.setFromTransform($||0,h,C,O,K)}}(),Gm=function(q,V,u,W,T,X){var L,H,S,m,x,c,F,b,d,M,G,D=[W-V,T-u],y=q?q.length:0;for(S=0;y>S;S++){for(m=2,L=q[S],x=L[0],c=L[1];m+1<L.length;){if(F=L[m],b=L[m+1],H=Qr(V,u,W,T,x,c,F,b,!0)){d=[F-x,b-c],M=kj(d),d[0]/=M,d[1]/=M,M=Ze(D,d),M=M>0?X:-X,G=[d[0]*M,d[1]*M];break}x=F,c=b,m+=2}if(G)break}if(G)for(W=V+G[0],T=u+G[1],S=0;y>S;S++)for(m=2,L=q[S],x=L[0],c=L[1];m+1<L.length;){if(F=L[m],b=L[m+1],H=Qr(V,u,W,T,x,c,F,b,!0))return[0,0];x=F,c=b,m+=2}return G?G:[W-V,T-u]},Rg=function(h){return"nearest"===h?cn.NEAREST:"linear"===h?cn.LINEAR:h},Mj=V.graph3d={},ld=function(k,O,M){cd(X+".graph3d."+k,O,M)},xr="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",pd="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit!)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!qe!-*!z/f{jTmfyfu!-yyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*!2!-2!.!)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!}}!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!<*!opjujtpQpUuihjm!)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*!sbfObsfnbDxpebit!.!sbGbsfnbDxpebit!)!0!*!sbfObsfnbDxpebit!.!*!opjujtpQpUuihjm!)iuhofm!)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<*!*!1/3!-1/5!)3dfw!+!f{jTqbNxpebit!)!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*!sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*!68/1!-684/1!)3dfw!,!sbobmq!+!*!63/1!-632/1!)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!z/w!)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!z/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!y/w!)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!y/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*!1/1!?!{/w!)!gj!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!{/Wtcb!)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*!Zf{jTmfyfu!+!1/3!.!1/2!)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<*!*!{/Wtcb!-z/Wtcb!)ybn!-y/Wtcb!)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*!w!)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*!Zf{jTmfyfu!ubpmg!-w!4dfw!)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!gjmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!|!*!utfUnvutvsg!)!gj!!!!!!!!!!!!<*!dfWutfUnvutvsg!)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*!1/2!>=!{/esppDxpebit!-nvutvsGoj!)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*!dfWnvutvsGoj!)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*!1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit!)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*!esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*!y/g!-c!-b!)yjn!>!d!ubpmg!!!!!!!!!!!!<*!z/g!-us!-cs!)yjn!>!c!ubpmg!!!!!!!!!!!!<*!z/g!-um!-cm!)yjn!>!b!ubpmg!!!!!!!!!!!!<*!6/1!,!f{jt!+!wv!)udbsg!>!g!3dfw!!!!!!!!!!!!<*!fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*!6/1!,!f{jt!+!wv!)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*!1/2!-1/1!)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt!)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!*!*!wv!-tiuqfe!)E3fsvuyfu!)iuqfEpUBCHSldbqov!-fsbqnpd!)qfut!osvufs!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt!)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!tspudbGldbqoV!-w!)upe!osvufs|!*!w!5dfw!oj!utopd!)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*!/2!-tspudbGldbQ!)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*!/763!!-/763!+!/763!-/763!+!/763!+!/763!)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Xf(C,{setBatchInfo:function(a,r){zf[a]=r},getBatchInfo:function(P){return zf[P]},getBatchInfoMap:function(){return zf},setBatchInfoMap:function(L){zf=L}},!0);var vf=[1,1,1],zr=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$i=[1,0,0,0,0,1,0,1,1,1,1,0],jq=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Yl=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],dm=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Li=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Dr=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],pk=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],an=function(n,w){var q=n._40Q;q.each(function(v){v.ivBatch(w)})},ol=function(R,H,P){var j=P._id,q=H[j];if(q){var I=q.batch,m=R[I],c=m.ds,x=q.index;if(m.invalidate=!0,delete H[j],c.splice(x,1),pq(c))return delete R[I],void 0;for(var O=q.begin,z=q.size,h=3*O,X=3*z,k=4*O,v=4*z,n=m.vs,D=m.ps,A=m.uv,f=m.cs,y=m.bs,s=m.rs,e=m.ns,t=m.ls;x<c.length;x++)q=H[c[x]._id],q.index--,q.begin-=z;n.splice(h,X),D.splice(k,v),A&&A.splice(2*O,2*z),f&&f.splice(k,v),y&&y.splice(h,X),s&&s.splice(O,z),e&&e.splice(h,X),t&&t.splice(O,z)}},Sq=function(T,w,$,O,N){if(!O)return F;var C=w[O];if(!C){var a=N.getBatchInfo(O)||Rm,v=a.image?[]:F;C=w[O]={vs:[],ns:[],uv:v,cs:v?F:a.color?F:[],bs:a.blend?[]:F,ps:[],rs:a.brightness?[]:F,ds:[]}}return C.invalidate=!0,T[$._id]={index:C.ds.length,begin:C.vs.length/3,batch:O},C.ds.push($),C},Zm=function(b,Z){return Z!=F&&1!==Z?[b[0]*Z,b[1]*Z,b[2]*Z,b[3]]:b},gd=function(k){var x=k.shapeModel;x||(x=go(k)),x&&(x._ctlineModel=[],x._lineModel=_)},rh=function(){var F;return function(P,A,w){var b=P.getData3dUI(A),h=b.shapeModel;if(h||(h=go(b)),h||!b.shapeName){var e,r=A.s("wf.combineTriangle");if(w.geometry){if(!h&&(A instanceof V.Node&&!(A instanceof V.Shape)?(F||(F={vs:tc,is:Bj,uv:Bs}),h=F):h=[b.left,b.front,b.right,b.back,b.top,b.bottom],!h))return _;if(r){var f=A.s("wf.normEpsilon");isNaN(f)&&(f=2),r=0|Math.min(3,Math.max(1,isNaN(r)?1:r)),e=Vq[r-1](h,b,180/(Math.PI*f))}else e=rj(h,b);if(!e||0===e.length)return}else e=w.short?gh:Ih;var S=P.getBrightness(A),Q=A.s("bloom"),d=A.s("3d.reflectable"),l=Sj(w.color||"white"),O=l[3]<1,i=Math.ceil(w.width)||1,z=(O?"T":"O")+(Q?"_1":"_0")+(d?"1_":"0_")+i,Y=A.getRenderLayer(),y=P._40Q.get(Y),D=y.wireframeIndexMap,H=y.wireframeModelMap,T=H[z];T||(T=H[z]={vs:[],cs:[],ps:[],ds:[],T:O,B:Q,reflectable:!!d,W:i}),T.invalidate=!0;var s=T.vs,G=T.cs,N=T.ds,W=D[A._id]={index:N.length,begin:s.length/3,batch:z};N.push(A);var K=b.mat;A instanceof V.Edge||!(!K||!w.geometry&&A instanceof V.Shape)||(K=Vl(A,w.mat),A.appendAnchorMatrix3d(K)),vd(s,K,e);var u=W.size=s.length/3-W.begin;Fj(G,Zm(l,S),u)}}}(),ed=function(Q,s,R,t,p,U,c,y,w){var x=Q.getBrightness(s);x==F&&(x=1);var E=Zm(Sj(t),x),I=E[3]<1;U=Math.ceil(U)||1;var h=(I?"T":"O")+U;if(c){var N=c[0],P=(c[1]||N)+N;h+="-"+N+"-"+P,w&&(h+="-"+Bm(w)+"-"+x,w=Zm(Sj(w),x))}var V=s.getRenderLayer(),D=Q._40Q.get(V),l=D.polylineIndexMap,b=D.polylineModelMap,J=b[h];J||(J=b[h]={vs:[],cs:[],ps:[],ds:[],ls:c?[]:F,T:I,W:U},c&&(J.D=N,J.G=P,J.A=w)),J.invalidate=!0;var a,z=J.vs,v=J.cs,M=J.ds,e=J.ls,Z=l[s._id]={index:M.length,begin:z.length/3,batch:h};M.push(s),hj(z,R);var S,Y=Z.size=z.length/3-Z.begin,f=R.length,j=0,A=[];if(c||p)for(a=0;f>a;a+=6)S=kj([R[a],R[a+1],R[a+2]],[R[a+3],R[a+4],R[a+5]]),A.push(S),j+=S;if(j&&p){var n,g=Zm(Sj(p),x),W=[g[0]-E[0],g[1]-E[1],g[2]-E[2],g[3]-E[3]],d=0;for(a=0;f>a;a+=6)n=d/j,Fj(v,[E[0]+W[0]*n,E[1]+W[1]*n,E[2]+W[2]*n,E[3]+W[3]*n],1),d+=A[a/6],n=d/j,Fj(v,[E[0]+W[0]*n,E[1]+W[1]*n,E[2]+W[2]*n,E[3]+W[3]*n],1)}else Fj(v,E,Y);if(c)for(d=y||0,a=0;f>a;a+=6)e.push(d),d+=A[a/6],e.push(d)},Gl=function(B,M,b){if(M){var o=4*M.begin,N=b[M.batch].ps;if(N[o]!==B[0]||N[o+1]!==B[1]||N[o+2]!==B[2]||N[o+3]!==B[3]){for(var C=0;C<M.size;C++)N[o++]=B[0],N[o++]=B[1],N[o++]=B[2],N[o++]=B[3];
N._invalidateThisFrame=!0}}},xq=function(){var s=new V.Math.Vector3,T=new V.Math.Vector3;return function(b,a){var G=a+["32"],A=b[a],v=b[G];if(A){if(C.extractBatchTranslation&&"vs"===a){T.set(0,0,0);for(var P=A.length,X=0;P>X;X+=3)T.add(s.fromArray(A,X));T.divideScalar(P/3);for(var y=T.x,k=T.y,O=T.z,d=new Array(P),X=0;P>X;X+=3)d[X]=A[X]-y,d[X+1]=A[X+1]-k,d[X+2]=A[X+2]-O;A=d,b.translate=[y,k,O]}v&&v.length===A.length?(v.set(A),v._bufId=null):b[G]=new ad(A)}else delete b[G]}}(),Zi=function(O,G,P,R,H,x,e,u){if(mh(P))P.forEach(function(C){Zi(O,G,C,R,H,x,e,u)});else if(zq(P))Zi(O,G,go(R,P),R,H,x,e,u);else if(Dg(P)){var A,S=cs(P.mat,G,O),d=cs(P.s3,G,O),s=cs(P.t3,G,O),r=cs(P.r3,G,O);if((d||r||s||S)&&(A=wi(S,d,r,cs(P.rotationMode,G,O),s),x.push(A)),P.shape3d)Zi(O,G,P.shape3d,R,H,x,e,P);else{var b=R.s;u=u||Rm;var V=x[0],K=x.length,h=b("shape3d.color",P.color,u.color);if(H||(H=b("shape3d.blend",P.blend,u.blend)),K>1){V=ds(V);for(var $=1;K>$;$++)Si(V,V,x[$])}var E=V?ie(V):F;P.vs&&b(Ur,P.visible,u.visible)&&Lm(V,e,P.vs,P.uv,P.is,P.ns,E,H,h),P.top_vs&&b(ai,P.topVisible,u.topVisible)&&Lm(V,e,P.top_vs,P.top_uv,P.top_is,P.top_ns,E,H,b("shape3d.top.color",P.topColor,u.topColor)||h),P.bottom_vs&&b(jb,P.bottomVisible,u.bottomVisible)&&Lm(V,e,P.bottom_vs,P.bottom_uv,P.bottom_is,P.bottom_ns,E,H,b("shape3d.bottom.color",P.bottomColor,u.bottomColor)||h),P.from_vs&&b(fm,P.fromVisible,u.fromVisible)&&Lm(V,e,P.from_vs,P.from_uv,P.from_is,P.from_ns,E,H,b("shape3d.from.color",P.fromColor,u.fromColor)||h),P.to_vs&&b(bn,P.toVisible,u.toVisible)&&Lm(V,e,P.to_vs,P.to_uv,P.to_is,P.to_ns,E,H,b("shape3d.to.color",P.toColor,u.toColor)||h)}A&&x.pop()}},Lm=function(f,$,m,M,w,H,e,a,Z){var X,y=$.cs,p=$.uv,R=$.bs,d=$.ns,z=$.vs;if(H&&0!==H.length||(H=lk(m,w)),w){X=w.length;for(var I=0;X>I;I++){var q=w[I],x=3*q;vd(z,f,[m[x],m[x+1],m[x+2]]),vd(d,e,[H[x],H[x+1],H[x+2]]),p&&hj(p,[M[2*q],M[2*q+1]])}}else X=m.length/3,vd(z,f,m),vd(d,e,H),p&&hj(p,M);y&&Fj(y,Z,X),R&&(a?th(R,a,X):hj(R,vf,X))},Un=function(J,u,w,y){y?Zi(J.gv,J.data,y,J,J.getBodyColor(),[u],w):(Zl(J,aq,u,w),Zl(J,zc,u,w),Zl(J,Br,u,w),Zl(J,Ie,u,w),Zl(J,Ob,u,w),Zl(J,fe,u,w),Zl(J,"csg",u,w))},Zl=function($,N,k,S){var r=$[N];if(r){var m=r.tuv;if(m){var b=r.uvScale,j=r.uvOffset,c=r.uvRotation;if(b||j||c){var I,y,p,H=On(c,j,b),s=H.a,t=H.b,o=H.c,G=H.d,v=H.tx,g=H.ty,f=m.length;for(p=0;f>p;p+=2)I=m[p],y=m[p+1],m[p]=s*I+o*y+v,m[p+1]=t*I+G*y+g}}Lm(k,S,r.vs,m,F,F,k?ie(k):F,r.blend,r.color)}},ug=function(Q,P,L,w,X,R,Y,n){var r,G=L.cs,j=L.uv,g=L.bs,d=L.vs,k=L.ns,c=lk(n);if(Q.getFaceVisible(P,Y)){var V=Q.getFaceMat(P,Y);if(V&&(X=Vl(P,V),R=ie(X)),vd(d,X,n),vd(k,R,c),G&&Fj(G,Q.getFaceColor(P,Y),6),j){var i=Q.getFaceUv(P,Y)||w[Y+"Uv"],K=Q.getFaceUvScale(P,Y)||w[Y+"UvScale"],l=Q.getFaceUvOffset(P,Y)||w[Y+"UvOffset"],F=Q.getFaceUvRotation(P,Y)||w[Y+"UvRotation"];i=i?[i[6],i[7],i[0],i[1],i[2],i[3],i[2],i[3],i[4],i[5],i[6],i[7]]:$i;var Z=i[0],H=i[1],y=i[2],T=i[3],f=i[4],v=i[5],_=i[6],D=i[7],e=i[8],$=i[9],h=i[10],m=i[11];if(K||l||F){var N=On(F,l,K),O=N.a,U=N.b,A=N.c,u=N.d,o=N.tx,s=N.ty;Z=O*Z+A*H+o,H=U*Z+u*H+s,y=O*y+A*T+o,T=U*y+u*T+s,f=O*f+A*v+o,v=U*f+u*v+s,_=O*_+A*D+o,D=U*_+u*D+s,e=O*e+A*$+o,$=U*e+u*$+s,h=O*h+A*m+o,m=U*h+u*m+s}j.push(Z,H,y,T,f,v,_,D,e,$,h,m)}g&&(r=Q.getBodyColor(P)||Q.getFaceBlend(P,Y),r?th(g,r,6):hj(g,vf,6))}},Fc=function(M,T,V,e){var V=M._picking?M.pickColorMap:null,m=M.getGL(),_=M._prg,E=M._buffer;if(!Xn(T)){pn(M,zr),Ir(m,_);for(var I in T){var L=T[I];if(!(e&&!L.T||!e&&L.T||M.isReflecting(m)&&L.reflectable===!1)){L.invalidate?(L.invalidate=!1,xq(L,"vs"),xq(L,"cs"),xq(L,"ls"),xq(L,"ps")):V&&L.ps&&L.ps._invalidateThisFrame&&(L.ps._invalidateThisFrame=!1,xq(L,"ps"));var r=L.translate;r&&pn(M,[1,0,0,0,0,1,0,0,0,0,1,0,r[0],r[1],r[2],1]);var i=L.vs32,U=V?L.ps32:L.cs32;Kp(m,_,L.W,F,E.vs,i);var S=zs.for(m),n=S.directUniforms(),a=S.directAttribs(),H=L.D,d=!M._dashDisabled&&H;n.uAlphaTest=W.alphaTest,m._blooming&&!L.B&&(n.blackout=!0),d&&(n.uDash=!0,n.uDashDistance=H,n.uDashGapDistance=L.G,n.uDiffuse=L.A||W["color.empty"],a.aLineDistance=ge(m,E.lineDistance,L.ls32,F,1));var f=!M._batchColorDisabled;f&&U.length?(n.uBatchColor=!0,a.aBatchColor=ge(m,E.batchColor,U,F,4)):(n.uBatchColor=!1,a.aBatchColor=!1),Wb(m),Pr(m,0,i.length/3,m.LINES),gi(m),f&&(n.uBatchColor=!1,a.aBatchColor=!1),d&&(n.uDash=!1,a.aLineDistance=!1),m._blooming&&!L.B&&(n.blackout=!1),r&&Yk(M)}}$e(m,_),Yk(M)}},ee=function(Y){Y.invalidate=!1,xq(Y,"vs"),xq(Y,"ns"),xq(Y,"cs"),xq(Y,"rs"),xq(Y,"ps"),xq(Y,"bs"),xq(Y,"uv")},bg=function(z,f,l,Q,K){var s,H,q,k,$,V,p,i,t,m,B,Z,l=z._picking?z.pickColorMap:null,O=z.getGL(),S=z._prg,b=zs.for(O),g=b.directUniforms(),j=b.directAttribs(),E=z._buffer;if(!Xn(f)&&!z.drawFilter){pn(z,zr);for(s in f)if(H=z.getBatchInfo(s)||Rm,H.visible!==!1&&!(Q&&!H.transparent||!Q&&H.transparent||z.isReflecting(O)&&H.reflectable===!1)){var o=H.renderLayerMask;if(o==F&&(o=Dp),K==F&&(K=Dp),Eb(K,o)&&(q=f[s],l||!H.transparentMask)){var h=Q&&H.autoSort===!0&&(z._33Q||q.invalidate);if(q.invalidate?ee(q):l&&q.ps&&q.ps._invalidateThisFrame&&(q.ps._invalidateThisFrame=!1,xq(q,"ps")),$=q.vs32,V=l?q.ps32:q.cs32,t=q.uv32,p=q.bs32,i=q.rs32,B=$.length/3,h){var e=fl($,z.getEye(),z);e?(q.is=e.is,q.elementTypeUint=e.useUint32):(q.is=null,q.elementTypeUint=null)}if(B){Z=q.translate,Z&&pn(z,[1,0,0,0,0,1,0,0,0,0,1,0,Z[0],Z[1],Z[2],1]),k=H.light,m=z.getTexture(H.image),cb(O,S,F,H.light,H.opacity,H.reverseFlip,H.reverseColor,H.reverseCull),V?z._batchColorDisabled?(g.uBatchColor=!1,j.aBatchColor=!1):(g.uBatchColor=!0,j.aBatchColor=ge(O,E.batchColor,V,F,4)):(g.uBatchColor=!1,g.uDiffuse=H.color||W["color.empty"]);var v=H.alphaTest;g.uAlphaTest=v===_?W.alphaTest:v,g.shadowReceive=!l&&H.shadowReceive!==!1,O._blooming&&!H.bloom&&(g.blackout=!0),H.envmap!==_?(g.uUseEnvMap=!0,g.uReflectivity=H.envmap):(g.uUseEnvMap=!1,g.uReflectivity=0);var n=p&&!z._batchBlendDisabled;n&&(g.uBatchBlend=!0,j.aBatchBlend=ge(O,E.batchBlend,p,F));var r=i&&!z._batchBrightnessDisabled;r&&(g.uBatchBrightness=!0,j.aBatchBrightness=ge(O,E.batchBrightness,i,F,1)),t?Wb(O,S,m,H.discardSelectable,E.uv,t,H.uvOffset,H.uvScale,H.uvRotation):Wb(O),j.aPosition=ge(O,E.vs,$,F),j.aNormal=ge(O,E.ns,q.ns32,F),q.is?(vc(O,E.is,q.is),yf(O,0,B,null,q.elementTypeUint?O.UNSIGNED_INT:null)):Pr(O,0,B),t?gi(O,S,m):gi(O),V&&!z._batchColorDisabled&&(g.uBatchColor=!1,j.aBatchColor=!1),n&&(g.uBatchBlend=!1,j.aBatchBlend=!1),r&&(g.uBatchBrightness=!1,j.aBatchBrightness=!1),O._blooming&&!H.bloom&&(g.blackout=!1),bh(O,S),Z&&Yk(z)}}}Yk(z)}},fl=function(r,U,y){var B=r.length/3,u=B>65535,z=y._glCapabilities.elementTypeUint&&u;if(!z&&u)return null;for(var P=new Array(B),x=B/3,V=new Array(x),J=0;x>J;J++)V[J]=J;V.sort(function(O,v){var C=9*O,E=[(r[C]+r[C+3]+2*r[C+6])/4,(r[C+1]+r[C+4]+2*r[C+7])/4,(r[C+2]+r[C+5]+2*r[C+8])/4];C=9*v;var X=[(r[C]+r[C+3]+2*r[C+6])/4,(r[C+1]+r[C+4]+2*r[C+7])/4,(r[C+2]+r[C+5]+2*r[C+8])/4],c=kj(U,E)-kj(U,X);return c>0?-1:0>c?1:0});for(var J=0;x>J;J++){var g=3*J,t=3*V[J];P[g]=t,P[g+1]=t+1,P[g+2]=t+2}return{useUint32:z,is:z?new Uint32Array(P):new md(P)}},co={obj:function(g,u){var O={mat:g.mat,s3:g.s3,r3:g.r3,rotationMode:g.rotationMode,t3:g.t3,cube:g.cube==F?!0:g.cube,center:g.center==F?!0:g.center,ignoreMtls:g.ignoreMtls,ignoreTransparent:g.ignoreTransparent,ignoreColor:g.ignoreColor,ignoreImage:g.ignoreImage,ignoreNormal:g.ignoreNormal,prefix:g.prefix,flipY:g.flipY,flipFace:g.flipFace,reverseFlipMtls:g.reverseFlipMtls,finishFunc:function(e,c){if(e){var c=[];for(var P in e){var U=e[P];c.rawS3=U.rawS3,U.center&&(c.center=U.center),c.push(U),g.eachModel&&g.eachModel(P,U)}c.json=g,u(c)}else u()}};C.loadObj(g.obj,g.mtl,O)},bin:function(O,z){var k={finishFunc:function(D){D?z(D):z()}};C.loadBin(O.url,k)}};C.getModelTypeHandlers=function(){return co},C.setModelTypeHandler=function(z,I){co[z]=I},C.getModelTypeHandler=function(t){return co[t]},C.handleModelLoaded=function(){},C.handleUnfoundModel=function(){};var gc=F,kc=F,rm=function(D){gc&&!D._loadingModelView_&&(kc||(kc={}),kc[D._loadingModelView_=Ch()]=D)},gl=function(R,B){gc||(gc={});var P=gc[R];if(P){if(P.url===B)return;P.request.onload=yh,P.request.onerror=yh}if(B.indexOf(".bin")===B.length-4)return rc(R,{modelType:"bin",url:B},B);if(B=C.beforeLoadURL(B),B.data){var h=C.parse(B.data);rc(R,h,B)}else{var k=new zi;gc[R]={request:k,url:B},k.onload=function(){if(200===this.status||0===this.status){delete gc[R];var e=C.parse(k.getResponseText());rc(R,e,B)}else cq(R,C.handleUnfoundModel(R,B)||F)},k.onerror=function(){cq(R,C.handleUnfoundModel(R,B)||F)};var o={};o.url=encodeURI(B),o.sync=!1,k.send(o)}},rc=function(S,d,j){var $=d.modelType;if(!$)return cq(S,d),C.handleModelLoaded(S,d),void 0;var g=C.getModelTypeHandler($);if(g){if(gc||(gc={}),gc[S])return;gc[S]=!0;var G=function(Y){Y?(cq(S,Y),C.handleModelLoaded(S,Y)):cq(S,C.handleUnfoundModel(S,j,d)||F)};g(d,G)}else cq(S,C.handleUnfoundModel(S,j,d)||F)},cq=function(e,H){if(delete gc[e],zq(H)&&zm.test(H))return gl(e,H),void 0;if(ep[e]=H,Xn(gc)&&(gc=F,kc)){for(var E in kc){var T=kc[E];T.invalidateAll&&T.invalidateAll(_,"modelLoaded",e),T.redraw&&T.redraw(),T.iv(),delete T._loadingModelView_}kc=F}if(H&&kc)for(var E in kc){var T=kc[E];T.invalidateAll&&T.invalidateAll(_,"modelLoading",e),T.redraw&&T.redraw(),T.iv()}},Rk=new ad([0,0,0,1,1,1,1,0]),$c=new ad([0,0,1,0,0,1,0,0,1,0,0,1]),Fn=new md([0,1,2,2,3,0]),tc=new ad([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Bj=new md([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Bs=new ad([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Rh=lk(tc,Bj),kg=(new ad([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new md([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[aq,Br,zc,Ie,Ob,fe]),Ih=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],gh=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],uh=function(f,o,A,W,P,g,j){g=g||16,f=f||16,o=o||0,A=A||f;var e,h,p,t,G,_,T,v,r,d=.5,z=[],l=[],I=E/f,N=Y/g;for(e=0;g>e;e++)for(_=e+1,t=e*N,r=_*N,h=o;A>h;h++)T=h+1,p=h*I,v=T*I,z.push(d*u(t)*L(p),d*L(t),-d*u(t)*u(p),d*u(r)*L(v),d*L(r),-d*u(r)*u(v),d*u(t)*L(v),d*L(t),-d*u(t)*u(v),d*u(t)*L(p),d*L(t),-d*u(t)*u(p),d*u(r)*L(p),d*L(r),-d*u(r)*u(p),d*u(r)*L(v),d*L(r),-d*u(r)*u(v)),l.push(h/f,e/g,T/f,_/g,T/f,e/g,h/f,e/g,h/f,_/g,T/f,_/g);if(j){var M=[];for(e=0,G=z.length;G>e;e+=3)M.push(2*z[e],2*z[e+1],2*z[e+2])}if(W){var n=[],x=[];for(p=o*I,e=0;g>e;e++)_=e+1,t=e*N,r=_*N,n.push(0,0,0,d*u(r)*L(p),d*L(r),-d*u(r)*u(p),d*u(t)*L(p),d*L(t),-d*u(t)*u(p)),x.push(0,.5,o/f,_/g,o/f,e/g)}if(P){var c=[],i=[];for(p=A*I,e=0;g>e;e++)_=e+1,t=e*N,r=_*N,c.push(0,0,0,d*u(t)*L(p),d*L(t),-d*u(t)*u(p),d*u(r)*L(p),d*L(r),-d*u(r)*u(p)),i.push(1,.5,A/f,e/g,A/f,_/g)}var Z={vs:z,uv:l,from_vs:n,from_uv:x,to_vs:c,to_uv:i};return j&&(Z.ns=M),Z},Ub=function(Z,l,v){Z=Z||.17,l=l||12,v=v||18,0>Z?Z=0:Z>.25&&(Z=.25);var K,r,d,y,M,j,$,G=.5,W=[],n=[],S=[],o=E/v,H=E/l,b=G-Z;for(r=0;l>=r;r++)for(y=-Y+r*H,j=L(y),M=u(y),K=0;v>=K;K++)d=K*o,$=b+Z*j,W.push(L(d)*$,M*Z,-u(d)*$),n.push(K/v,1-r/l);for(r=0;l>r;r++){var B=r*(v+1),g=(r+1)*(v+1);for(K=0;v>K;K++)S.push(B+K,g+K+1,g+K,B+K,B+K+1,g+K+1)}return{vs:W,uv:n,is:S}},oc=function(i,B,S,G,I,K,N,n){N=N||12,i=i||18,B=B||0,S=S||i,K=K||.17,0>K?K=0:K>.25&&(K=.25);var h,l,p,H,s,C,b,k,$,P,J=.5,j=[],f=[],O=E/i,D=E/N,Z=J-K,o=n?[]:_;for(p=0;N>p;p++)for(H=p+1,b=-Y+p*D,k=-Y+H*D,h=B;S>h;h++)l=h+1,s=h*O,C=l*O,$=Z+K*L(b),P=Z+K*L(k),j.push(L(s)*$,u(b)*K,-u(s)*$,L(C)*$,u(b)*K,-u(C)*$,L(C)*P,u(k)*K,-u(C)*P,L(s)*$,u(b)*K,-u(s)*$,L(C)*P,u(k)*K,-u(C)*P,L(s)*P,u(k)*K,-u(s)*P),f.push(h/i,1-p/N,l/i,1-p/N,l/i,1-H/N,h/i,1-p/N,l/i,1-H/N,h/i,1-H/N),n&&o.push(L(s)*L(b),u(b),-u(s)*L(b),L(C)*L(b),u(b),-u(C)*L(b),L(C)*L(k),u(k),-u(C)*L(k),L(s)*L(b),u(b),-u(s)*L(b),L(C)*L(k),u(k),-u(C)*L(k),L(s)*L(k),u(k),-u(s)*L(k));if(G){var R=[],x=[];for(p=0;N>p;p++)H=p+1,b=-Y+p*D,k=-Y+H*D,s=B*O,$=Z+K*L(b),P=Z+K*L(k),R.push(L(s)*$,u(b)*K,-u(s)*$,L(s)*P,u(k)*K,-u(s)*P,L(s)*Z,0,-u(s)*Z),x.push(.5+.5*L(b),.5-.5*u(b),.5+.5*L(k),.5-.5*u(k),.5,.5)}if(I){var w=[],v=[];for(p=0;N>p;p++)H=p+1,b=-Y+p*D,k=-Y+H*D,s=S*O,$=Z+K*L(b),P=Z+K*L(k),w.push(L(s)*$,u(b)*K,-u(s)*$,L(s)*Z,0,-u(s)*Z,L(s)*P,u(k)*K,-u(s)*P),v.push(.5-.5*L(b),.5-.5*u(b),.5,.5,.5-.5*L(k),.5-.5*u(k))}var g={vs:j,uv:f,from_vs:R,from_uv:x,to_vs:w,to_uv:v};return n&&(g.ns=o),g},xb=function(b,q){for(var H,D,v,n=.5,I=16,x=[],l=[],Y=[],$=E/I,S=0;I>=S;S++)H=S*$,D=L(H)*n,v=u(H)*n,x.push(D,-n,v,D,n,v),l.push(1-S/I,1,1-S/I,0);for(S=0;I>S;S++)Y.push(2*S,2*S+1,2*S+3,2*S,2*S+3,2*S+2);if(q){var A=[],z=[],B=[];for(A.push(0,-n,0),z.push(.5,.5),S=0;I>=S;S++)H=S*$,D=L(H),v=u(H),A.push(D*n,-n,-v*n),z.push(.5+.5*D,.5+.5*v);for(S=0;I>S;S++)B.push(0,S+2,S+1)}if(b){var o=[],Z=[],e=[];for(o.push(0,n,0),Z.push(.5,.5),S=0;I>=S;S++)H=S*$,D=L(H),v=u(H),o.push(D*n,n,-v*n),Z.push(.5+.5*D,.5-.5*v);for(S=0;I>S;S++)e.push(0,S+1,S+2)}return{vs:x,uv:l,is:Y,bottom_vs:A,bottom_uv:z,bottom_is:B,top_vs:o,top_uv:Z,top_is:e}},Ei=function(B,s,r,J,N,b,p,d){B=B||12,s=s||0,r=r||B;for(var l,z,W,U,Q,k,C,V,w,S=.5,G=[],g=[],o=E/B,t=s;r>t;t++)l=t+1,z=t*o,W=l*o,U=L(z)*S,Q=u(z)*S,k=L(W)*S,C=u(W)*S,G.push(U,-S,-Q,k,-S,-C,U,S,-Q,k,-S,-C,k,S,-C,U,S,-Q),g.push(t/B,1,l/B,1,t/B,0,l/B,1,l/B,0,t/B,0);if(d){var i=[];for(t=0,w=G.length;w>t;t+=3)i.push(2*G[t],0,2*G[t+2])}if(p){var A=[],R=[];for(t=s;r>t;t++)z=o*t,W=o*(t+1),U=L(z),Q=u(z),k=L(W),C=u(W),A.push(U*S,-S,-Q*S,0,-S,0,k*S,-S,-C*S),R.push(.5+.5*U,.5+.5*Q,.5,.5,.5+.5*k,.5+.5*C)}if(b){var I=[],a=[];for(t=s;r>t;t++)z=o*t,W=o*(t+1),U=L(z),Q=u(z),k=L(W),C=u(W),I.push(U*S,S,-Q*S,k*S,S,-C*S,0,S,0),a.push(.5+.5*U,.5-.5*Q,.5+.5*k,.5-.5*C,.5,.5)}if(J){var K=[],v=[];z=o*s,U=L(z)*S,Q=u(z)*S,V=s/B,K.push(0,S,0,0,-S,0,U,-S,-Q,U,-S,-Q,U,S,-Q,0,S,0),v.push(0,0,0,1,V,1,V,1,V,0,0,0)}if(N){var T=[],D=[];z=o*r,U=L(z)*S,Q=u(z)*S,V=r/B,T.push(0,-S,0,0,S,0,U,S,-Q,U,S,-Q,U,-S,-Q,0,-S,0),D.push(1,1,1,0,V,0,V,0,V,1,1,1)}var j={vs:G,uv:g,bottom_vs:A,bottom_uv:R,top_vs:I,top_uv:a,from_vs:K,from_uv:v,to_vs:T,to_uv:D};return d&&(j.ns=i),j},tb=function(A,e,X,s,K){e=e||18,X=X||0,s=s==F?E:s,K=K==F?.5:K;for(var w,T,C,t,D,o,d=[0,.5,.75,.875,.9375],l=[],U=[],b=[],r=s/e,O=0;O<d.length;O++){var i=0===O%2?0:.5;for(w=0;e>=w;w++)T=(w+i)*r+X,C=1-d[O],l.push(L(T)*K*C,-K+2*d[O]*K,-u(T)*K*C),U.push((w+i)/e,C)}for(O=0;O<d.length-1;O++){var v=O*(e+1),m=(O+1)*(e+1);for(w=0;e>w;w++)b.push(v+w,m+w+1,m+w,v+w,v+w+1,m+w+1)}for(o=l.length/3-(e+1),w=0;e>w;w++)l.push(0,K,0),U.push((w+.5)/e,0);for(w=0;e>w;w++)b.push(o+w,o+w+1,o+(e+1)+w);if(A){var y=[],P=[],R=[];for(y.push(0,-K,0),P.push(.5,.5),w=0;e>=w;w++)T=w*r+X,t=L(T),D=u(T),y.push(t*K,-K,-D*K),P.push(.5+.5*t,.5+.5*D);for(w=0;e>w;w++)R.push(0,w+2,w+1)}return{vs:l,uv:U,is:b,bottom_vs:y,bottom_uv:P,bottom_is:R}},yl=function(e,Z,U,H,R,j,Q,g){e=e||16,Z=Z||0,U=U||e,Q=Q||1;var A,B,N,$,V,Y,s,v=.5,w=[],x=[],K=E/e,r=Z,q=1/Q,B=new io,N=new io,a=new io,M=new io,f=new io,p=new io,l=new io;for(g&&(A=[],V=new io,Y=new io,s=new io);U>r;r++){var G=r+1,h=K*r,S=K*G;for(B.set(L(h)*v,-v,-u(h)*v),N.set(L(S)*v,-v,-u(S)*v),a.set(0,v,0),g&&(V.set(L(h),.5,-u(h)).normalize(),Y.set(L(S),.5,-u(S)).normalize(),s.copy(V).add(Y).normalize()),M.lerpVectors(a,B,q),f.lerpVectors(a,N,q),w.push(M.x,M.y,M.z,f.x,f.y,f.z,a.x,a.y,a.z),x.push(r/e,q,G/e,q,(r+G)/2/e,0),g&&A.push(V.x,V.y,V.z,Y.x,Y.y,Y.z,s.x,s.y,s.z),$=1;Q>$;$++)M.lerpVectors(a,B,q*($+1)),f.lerpVectors(a,N,q*($+1)),p.lerpVectors(a,B,q*$),l.lerpVectors(a,N,q*$),w.push(M.x,M.y,M.z,f.x,f.y,f.z,p.x,p.y,p.z,p.x,p.y,p.z,f.x,f.y,f.z,l.x,l.y,l.z),x.push(r/e,q*($+1),G/e,q*($+1),r/e,q*$,r/e,q*$,G/e,q*($+1),G/e,q*$),g&&A.push(V.x,V.y,V.z,Y.x,Y.y,Y.z,V.x,V.y,V.z,V.x,V.y,V.z,Y.x,Y.y,Y.z,Y.x,Y.y,Y.z)}if(j){var J=[],k=[];for(r=Z;U>r;r++){h=K*r,S=K*(r+1);var W=L(h),X=u(h),n=L(S),d=u(S);J.push(W*v,-v,-X*v,0,-v,0,n*v,-v,-d*v),k.push(.5+.5*W,.5+.5*X,.5,.5,.5+.5*n,.5+.5*d)}}if(H){var b=[],m=[];h=K*Z,b.push(0,v,0,0,-v,0,L(h)*v,-v,-u(h)*v),m.push(0,0,0,1,Z/e,1)}if(R){var P=[],T=[];h=K*U,P.push(0,-v,0,0,v,0,L(h)*v,-v,-u(h)*v),T.push(1,1,1,0,U/e,1)}var I={vs:w,uv:x,bottom_vs:J,bottom_uv:k,from_vs:b,from_uv:m,to_vs:P,to_uv:T};return g&&(I.ns=A),I},pl=function(j,v,i,U,R,$,O,e){for(var z=[],K=0;K<j.length-1;K+=2)z.push({x:j[K],y:j[K+1]});return Dk(z,v,i,U,R,$,O,e,!1)},Fb={roundRect:function(T,p){return pl([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],T,p,3)},star:function(I,u){return pl([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],I,u)},rect:function(m,X){return pl([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],m,X)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(y,R){return pl([0,-.5,.5,.5,-.5,.5],[1,2,2,5],y,R)},rightTriangle:function(G,U){return pl([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],G,U)},parallelogram:function(X,d){return pl([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],X,d)},trapezoid:function(m,o){return pl([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],m,o)}},De={sphere:1,cylinder:1,cone:1,torus:1},ts={torus:1,sphere:1,cone:1},Gn=Xf(Hq(Fb),{cylinder:1}),lh=Xf(Hq(Fb),{cylinder:1,cone:1}),qo=function(b,s,c){var W,m=cs(b.anchor3d,c,s),B=cs(b.mat,c,s),x=cs(b.s3,c,s),o=cs(b.t3,c,s),u=cs(b.r3,c,s),M=x||u||o||B;if(m||M){W=ds(s._6O);var f=M?wi(B,x,u,cs(b.rotationMode,c,s),o):Bf();m&&jc(f,[.5-m[0],.5-m[1],.5-m[2]]),pn(s,f)}return W},am=function(O,t,R,q,T,I,$){if(mh(R))R.forEach(function(W){am(O,t,W,q,T,I,$)});else if(zq(R))am(O,t,go(q,R),q,T,I,$);else if(Dg(R))if(R.shape3d){var z=qo(R,O,t);am(O,t,R.shape3d,q,T,I,R),z&&Yk(O,z)}else Cc(O,t,R,q.s,T,I,$)},Cc=function(_,Q,G,U,I,O,S){if(S=S||Rm,!O||O(U("shape3d.transparent",G.transparent,S.transparent))){var J=qo(G,_,Q);if(Ji(G)){var l=_.getData3dUI(Q);l.dispatchBoundingBoxChanged()}var t=_._26I,P=_._prg,p=_._buffer,R=U("shape3d.color",G.color,S.color);I||(I=U("shape3d.blend",G.blend,S.blend));var a,d=G.opacity==F?S.opacity:G.opacity,e=U("shape3d.opacity");a=e!=F&&d!=F?d*e:d!=F?d:e,cb(t,P,I,U("shape3d.light",G.light,S.light),a,U("shape3d.reverse.flip",G.reverseFlip,S.reverseFlip),U("shape3d.reverse.color",G.reverseColor,S.reverseColor),U("shape3d.reverse.cull",G.reverseCull,S.reverseCull));var Z=U("polygonOffset",G.polygonOffset,S.polygonOffset);G.vs&&U(Ur,G.visible,S.visible)&&gs(t,P,p,R,_.getTexture(U("shape3d.image",G.image,S.image),Q),U("shape3d.discard.selectable",G.discardSelectable,S.discardSelectable),G.vs,G.uv,G.ns,G.is,U("shape3d.uv.offset",G.uvOffset,S.uvOffset),U("shape3d.uv.scale",G.uvScale,S.uvScale),U("shape3d.uv.rotation",G.uvRotation,S.uvRotation),Z),G.top_vs&&U(ai,G.topVisible,S.topVisible)&&gs(t,P,p,U("shape3d.top.color",G.topColor,S.topColor)||R,_.getTexture(U("shape3d.top.image",G.topImage,S.topImage),Q,"top"),U("shape3d.top.discard.selectable",G.topDiscardSelectable,S.topDiscardSelectable),G.top_vs,G.top_uv,G.top_ns,G.top_is,U("shape3d.top.uv.offset",G.topUvOffset,S.topUvOffset),U("shape3d.top.uv.scale",G.topUvScale,S.topUvScale),U("shape3d.top.uv.rotation",G.topUvRotation,S.topUvRotation),Z),G.bottom_vs&&U(jb,G.bottomVisible,S.bottomVisible)&&gs(t,P,p,U("shape3d.bottom.color",G.bottomColor,S.bottomColor)||R,_.getTexture(U("shape3d.bottom.image",G.bottomImage,S.bottomImage),Q,"bottom"),U("shape3d.bottom.discard.selectable",G.bottomDiscardSelectable,S.bottomDiscardSelectable),G.bottom_vs,G.bottom_uv,G.bottom_ns,G.bottom_is,U("shape3d.bottom.uv.offset",G.bottomUvOffset,S.bottomUvOffset),U("shape3d.bottom.uv.scale",G.bottomUvScale,S.bottomUvScale),U("shape3d.bottom.uv.rotation",G.bottomUvRotation,S.bottomUvRotation),Z),G.from_vs&&U(fm,G.fromVisible,S.fromVisible)&&gs(t,P,p,U("shape3d.from.color",G.fromColor,S.fromColor)||R,_.getTexture(U("shape3d.from.image",G.fromImage,S.fromImage),Q,"from"),U("shape3d.from.discard.selectable",G.fromDiscardSelectable,S.fromDiscardSelectable),G.from_vs,G.from_uv,G.from_ns,G.from_is,U("shape3d.from.uv.offset",G.fromUvOffset,S.fromUvOffset),U("shape3d.from.uv.scale",G.fromUvScale,S.fromUvScale),U("shape3d.from.uv.rotation",G.fromUvRotation,S.fromUvRotation),Z),G.to_vs&&U(bn,G.toVisible,S.toVisible)&&gs(t,P,p,U("shape3d.to.color",G.toColor,S.toColor)||R,_.getTexture(U("shape3d.to.image",G.toImage,S.toImage),Q,"to"),U("shape3d.to.discard.selectable",G.toDiscardSelectable,S.toDiscardSelectable),G.to_vs,G.to_uv,G.to_ns,G.to_is,U("shape3d.to.uv.offset",G.toUvOffset,S.toUvOffset),U("shape3d.to.uv.scale",G.toUvScale,S.toUvScale),U("shape3d.to.uv.rotation",G.toUvRotation,S.toUvRotation),Z),bh(t,P),J&&Yk(_,J)}},gs=function(g,w,d,r,s,X,c,i,j,Q,q,E,h,M){if(c){M&&wm(g,M);var m=zs.for(g),u=m.directUniforms(),O=m.directAttribs();u.uDiffuse=r||W["color.empty"],i?Wb(g,w,s,X,d.uv,i,q,E,h):Wb(g),O.aPosition=ge(g,d.vs,c,F),O.aNormal=ge(g,d.ns,j,F),Q?(Rj(g,d.is,Q),yf(g,0,Q.length,null,Q instanceof Uint32Array?g.UNSIGNED_INT:null)):Pr(g,0,c.length/3),i?gi(g,w,s):gi(g),M&&nr(g)}},go=function(J,B){var p=J.s;if(B||(B=p(Vm)),!B)return F;var l=Ij(B);if(l)return l;if("text"===B){var t={amount:p("shape3d.text.amount"),size:p("shape3d.text.size"),font:p("shape3d.text.font"),style:p("shape3d.text.style"),weight:p("shape3d.text.weight"),fill:p("shape3d.text.fill"),curveSegments:p("shape3d.text.curveSegments"),spacing:p("shape3d.text.spacing")},U=J.gv.getShape3dText(J.data),q=U;for(var n in t)q+="_"+(t[n]===_?"U":t[n]);return J._cachedTextKey===q?J._cachedTextGeometry:(J._cachedTextKey=q,J._cachedTextGeometry=C.createTextGeometry(U,t))}var n=B;if(De[B]){var Q=p("shape3d.side"),R=p("shape3d.side.from"),X=p("shape3d.side.to"),K=p(fm),T=p(bn);3>Q?(Q=0,R=0,X=0,K=!1,T=!1):((R==F||0>R)&&(R=0),(X==F||X>Q)&&(X=Q),0===R&&X===Q&&(K=!1,T=!1));var k=p("shape3d.smooth");n+="-"+Q+"-"+R+"-"+X+"-"+K+"-"+T+(k?1:0)}if(Gn[B]){var I=p(ai);n+="-"+I}if(lh[B]){var W=p(jb);n+="-"+W}if("torus"===B){var j=p("shape3d.torus.radius");0>j?j=0:j>.25&&(j=.25),n+="-"+j}if(ts[B]){var u=p(Il);n+="-"+u}return l=Mo[n],l||("box"===B?l=C.createBoxModel():Fb[B]?l=Fb[B](I,W):"sphere"===B?l=C.createSphereModel(Q,R,X,K,T,u,k):B===ur?l=C.createCylinderModel(Q,R,X,K,T,I,W,k):"cone"===B?l=C.createConeModel(Q,R,X,K,T,W,u,k):"torus"===B&&(l=C.createTorusModel(Q,R,X,K,T,j,u,k)),Mo[n]=l),l},Ji=function(){var c=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],U=["is","top_is","bottom_is","from_is","to_is"];return t=bm(xr.substr(xr.indexOf("^#")+2)),ls(C[Tp(Vc+c[15]+"n"+c[16])]())&&Wg()?function(I){return I&&!I._complete_?(I._complete_=!0,I.vs&&pq(I.ns)&&(I.ns=lk(I.vs,I.is),I.boundingBox=_),I.top_vs&&pq(I.top_ns)&&(I.top_ns=lk(I.top_vs,I.top_is),I.top_boundingBox=_),I.bottom_vs&&pq(I.bottom_ns)&&(I.bottom_ns=lk(I.bottom_vs,I.bottom_is),I.bottom_boundingBox=_),I.from_vs&&pq(I.from_ns)&&(I.from_ns=lk(I.from_vs,I.from_is),I.from_boundingBox=_),I.to_vs&&pq(I.to_ns)&&(I.to_ns=lk(I.to_vs,I.to_is),I.to_boundingBox=_),c.forEach(function(p){var u=I[p];mh(u)&&(I[p]=new ad(u))}),U.forEach(function(w){var T=I[w];mh(T)&&(I[w]=new md(T))}),!0):!1}:void 0}(),Ib=function(r,I){var s=r[I];mh(s)&&(r[I]=new ad(s))};Xf(km,{_25Q:function(g){g._16O=function(b,R,m,V,N,U,t,w,X){var P=this.info;if(P){var c,o,d,J,x,G,f=Bf();if(Rd[R]?(c=P.p3,o=P.c1,d=P.c2):vm[R]?(o=P.s1||P.c1,d=P.s2||P.c2):(o=P.t1||P.c1,d=P.t2||P.c2),c)G=cm(R,Wq,m,V,w,X);else{var Q=No(d,o),$=kj(o,d);J=[0,-ub(Q[2],Q[0]),T(Q[1]/$)],x="zyx",c=[(o[0]+d[0])/2,(o[1]+d[1])/2,(o[2]+d[2])/2],G=cm(R,[$,0,0],m,V,w,X)}return Wj(f,G,c,V,N,U,t,b,J,x)}return We},g._80o=function(I,$,p){var d=this,w=d.shapeModel;if(w){var G=d.gv;pn(G),am(G,d.data,w,d,d.getBodyColor(),p)}},g.createLineModel=function(X,p,_,D,l){var d=this,U=d.s,u=mc(X,p,U(Il)),t=U(D+".color");if(t){for(var z=[],h=0;h<u.length;h++){var K=u[h],s=K.length;if(s>1){var e=K[0];z.push(e.x,e.y,e.z);for(var b=1;s-1>b;b++)e=K[b],z.push(e.x,e.y,e.z),z.push(e.x,e.y,e.z);e=K[s-1],z.push(e.x,e.y,e.z)}}var g,q,J,v=U(l),R=0;v&&(q=U(l+".color"),g=U(l+".pattern"),R=U(l+".offset"),J=t),ed(d.gv,d.data,z,q||t,J?F:U(D+".gradient.color"),_,g||U(D+".pattern"),R,J)}return u},g.createTubeModel=function(M,L,J,y){for(var Q=this,x=Q.s,e=x("shape3d.side")||ib,Z=x("shape3d.start.angle"),A=x("shape3d.sweep.angle"),C=x(ai)?x("shape3d.top.cap"):F,X=x(jb)?x("shape3d.bottom.cap"):F,h="flat"===C,W="flat"===X,O=h&&(y?y.uv:x("shape3d.top.image")),p=W&&(y?y.uv:x("shape3d.bottom.image")),b=y?y.uv:x("shape3d.image"),k=x("shape3d.smooth"),l={vs:[],uv:b?[]:F,ns:k?[]:F,top_vs:h?[]:F,top_uv:O?[]:F,bottom_vs:W?[]:F,bottom_uv:p?[]:F},q=mc(M,L,x(Il),J),Y=0,N=q.length;N>Y;Y++)ro(l,q[Y],x(or),J,e,Z,A,C,X);return y?Zi(Q.gv,Q.data,l,Q,Q.getBodyColor(),Q.mat?[Q.mat]:[],y):Q.shapeModel=l,Q.lineShapeModel=l,q},g.getCache=function(){var N=this.info;if(N){var u=N.list;if(u){var o=N.cache;return o||(o=N.cache=Nj(u)),o}}return F}}});var ll=function(c,w){for(var r,F=0,A=c.length,O=0,S=A-1;S>=O;)if(F=P(O+(S-O)/2),r=c[F].length-w,0>r)O=F+1;else{if(!(r>0)){S=F;break}S=F-1}F=S;var N=c[F],e=N.point;return F===A-1||N.length===w||(e=(new pm).subVectors(c[F+1].point,e).normalize().multiplyScalar(w-N.length).add(e)),{point:e,tangent:N.tangent}},Nj=function(f){for(var p,Y,w=[],o=0,T=0;T<f.length;T++){for(var g=f[T],I=0;I<g.length;I++){p=g[I],Y&&(o+=Y.distanceTo(p));var P=new pm,D=g[I+1];D?P.subVectors(D,p):Y?P.subVectors(p,Y):P.x=1,P.normalize(),w.push({point:p,length:o,tangent:P}),Y=p}Y=null}return w},mc=function(D,J,E,i){E=E||uk;for(var k=[],G=0,Z=D.size();Z>G;G++){var z=D.get(G);k.push(new pm(z.x,z.e||0,z.y))}J&&(Tm(J)&&(J=J._as),J.length||(J=null));for(var $,X,_,W,j,o=[],w=[],h=0,a=0,e=J?J.length:Z;e>a;a++){if(j=J?J[a]:0===a?1:2,1===j)o.push(_=[]),_.push(k[h++]);else if(2===j||5===j)if(W=2===j?k[h++]:_[0],i){var P=J?J[a+1]:e>a+1?2:F;if(2===P||5===P){var v=_[_.length-1],A=2===P?k[h]:_[0],C=(new pm).subVectors(v,W),I=(new pm).subVectors(A,W),K=C.length(),N=I.length();if(K&&N)if(i>K/2&&i>N/2)_.push(W);else for(C.multiplyScalar(B(i,K/2)/K).add(W),I.multiplyScalar(B(i,N/2)/N).add(W),$=new tk(C,W,I).getPoints(E),X=0;E>=X;X++)_.push($[X])}else _.push(W)}else _.push(W);else if(3===j)for($=new tk(_[_.length-1],k[h++],k[h++]).getPoints(E),X=1;E>=X;X++)_.push($[X]);else if(4===j)for($=new en(_[_.length-1],k[h++],k[h++],k[h++]).getPoints(E),X=1;E>=X;X++)_.push($[X]);w.push(o.length,_.length)}return o.indexMark=w,o},vi=function(T){for(var O,N,j=new pm,s=[],I=[],n=[],u=0,A=T.length;A>u;u++)O=T[u],N=T[u+1],N?j.subVectors(N,O):j.subVectors(O,T[u-1]),s.push(j.normalize().clone());var e,G=new pm,w=new pm,W=new bf,E=1e-4,y=s[0],k=I[0]=new pm,U=n[0]=new pm;for(Math.abs(Math.abs(y.y)-1)<E?G.set(1,0,0):G.set(0,1,0),w.crossVectors(y,G).normalize(),k.crossVectors(y,w),U.crossVectors(y,k),u=1;A>u;u++)I[u]=I[u-1].clone(),n[u]=n[u-1].clone(),w.crossVectors(s[u-1],s[u]),w.length()>E&&(w.normalize(),e=q(ag(s[u-1].dot(s[u]),-1,1)),I[u].applyMatrix4(W.makeRotationAxis(w,e))),n[u].crossVectors(s[u],I[u]);return{B:n,T:s,N:I}},ro=function(){var l=function(M){for(var N=1;N<arguments.length;N++){var P=arguments[N];M.push(P.x,P.y,P.z)}},d=function(Y){for(var U=1;U<arguments.length;U++){var T=arguments[U].uv;Y.push(T[0],T[1])}},B=function(s){for(var U=1;U<arguments.length;U++){var B=arguments[U].ns;s.push(B[0],B[1],B[2])}},f=function(V,Q,y,c,D){var k=-c*L(D),A=c*u(D);return new pm(V.x+k*y.x+A*Q.x,V.y+k*y.y+A*Q.y,V.z+k*y.z+A*Q.z)},D=function(e,l,q,u,P,y,s,Z,$){s=s||E;for(var G,L=[],W=s/P,G=$?new io:F,i=0;P>=i;i++){var H=f(e,l,q,u,i*W+y);L.push(H),Z!=F&&(H.uv=[Z,1-i/P]),$&&(H.ns=G.subVectors(H,e).normalize().toArray())}return L},V=function(m,q,c,s,V,_,r,U,J){J=J||E;var S=q?m.top_vs:m.bottom_vs;if(S)for(var Q=q?m.top_uv:m.bottom_uv,R=J/r,v=0;r>v;v++){var d,i;q?(d=v*R+U,i=(v+1)*R+U):(i=v*R+U,d=(v+1)*R+U),l(S,f(c,s,V,_,d),f(c,s,V,_,i),c),Q&&Q.push(.5-.5*L(d),.5-.5*u(d),.5-.5*L(i),.5-.5*u(i),.5,.5)}};return function(b,g,I,Y,p,U,i,N,x){var m=g.length;if(m>1){var v,E,n,W,e,P,o,H=vi(g),G=H.T,R=H.N,q=H.B;"flat"===N&&V(b,!0,g[0],q[0],R[0],Y,p,U,i),"flat"===x&&V(b,!1,g[m-1],q[m-1],R[m-1],Y,p,U,i);var w,J,t=[],L=c(p/2),Z="round"===N,j="round"===x,K=g[0],z=G[0],k=q[0],S=R[0],C=g[m-1],y=G[m-1],f=q[m-1],M=R[m-1];if(Z){for(n=1;L>=n;n++)R.splice(0,0,S),q.splice(0,0,k),G.splice(0,0,z),J=-n/L*Y,g.splice(0,0,z.clone().multiplyScalar(J).add(K)),t[L-n]=A(Y*Y-J*J);m+=L}if(j){for(n=1;L>=n;n++)R.push(M),q.push(f),G.push(y),J=n/L*Y,g.push(y.clone().multiplyScalar(J).add(C)),t[g.length-1]=A(Y*Y-J*J);m+=L}if(b.uv){var s=0,$=0,r=[];for(I&&(s=I),e=g[0],r[0]=0,n=1;m>n;n++)W=g[n],r[n]=e.distanceTo(W),e=W,I||(s+=r[n]);for(w=[],n=0;m>n;n++)$+=r[n],w[n]=s?$/s:0}var T=b.ns?!0:!1;for(n=0;m>n;n++){if(W=g[n],P=q[n],o=R[n],v=D(W,P,o,t[n]===_?Y:t[n],p,U,i,w?w[n]:F,T),E)for(var O=0;p>O;O++){var X=E[O],a=E[O+1]||E[0],u=v[O],h=v[O+1]||v[0];l(b.vs,a,X,u,u,h,a),b.uv&&d(b.uv,a,X,u,u,h,a),T&&B(b.ns,a,X,u,u,h,a)}E=v}}}}();Xf(C,{getLineLength:function(Y){return Y[Y.length-1].length},getLineOffset:function(P,I){return ll(P,I)},getLineCacheInfo:function(j,w,e,$){return Nj(mc(j,w,e,$))}});var Cs=V.graph3d.RenderLite={},Ti=new Array(0),Ed=Cs.Buffer=function(G,q,s,a){this.gl=G,this.buffer=G.createBuffer(),this.type=q||G.ARRAY_BUFFER,this.drawType=a||G.STATIC_DRAW,this.data=Ti,s&&this.upload(s)};Ed.prototype.upload=function(E,b,S){S||this.bind();var y=this.gl;E=E||this.data,b=b||0,this.data.byteLength>=E.byteLength?y.bufferSubData(this.type,b,E):y.bufferData(this.type,E,this.drawType),this.data=E},Ed.prototype.bind=function(){var A=this.gl;A.bindBuffer(this.type,this.buffer)},Ed.createVertexBuffer=function(a,C,d){return new Ed(a,a.ARRAY_BUFFER,C,d)},Ed.createIndexBuffer=function(f,J,F){return new Ed(f,f.ELEMENT_ARRAY_BUFFER,J,F)},Ed.create=function(B,e,c,t){return new Ed(B,e,t)},Ed.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Ak=Cs.Shader=function(W,A,Y){this.gl=W,this.program=Hp(W,A,Y),this.attributes=mn(W,this.program);var E=Sd(W,this.program);this.uniforms=gn(W,E)};Ak.prototype.bind=function(){this.gl.useProgram(this.program)},Ak.prototype.destroy=function(){this.gl};var Hp=function(I,e,v){var R=si(I,I.VERTEX_SHADER,e),N=si(I,I.FRAGMENT_SHADER,v),f=I.createProgram();return I.attachShader(f,R),I.attachShader(f,N),I.linkProgram(f),I.getProgramParameter(f,I.LINK_STATUS)||(Kg("LINK","LITE",I.getProgramParameter(f,I.VALIDATE_STATUS),I.getError(),I.getProgramInfoLog(f)),I.deleteProgram(f),f=null),I.deleteShader(R),I.deleteShader(N),f},si=function(z,m,H){var Y=z.createShader(m);return z.shaderSource(Y,H),z.compileShader(Y),z.getShaderParameter(Y,z.COMPILE_STATUS)?Y:(Kg("COMPILE","LITE",m,z.getError(),z.getShaderInfoLog(Y)),null)},Sd=function(B,D){for(var C={},J=B.getProgramParameter(D,B.ACTIVE_UNIFORMS),x=0;J>x;x++){var V=B.getActiveUniform(D,x),t=V.name.replace(/\[.*?\]/,""),_=Tr(B,V.type);C[t]={type:_,size:V.size,location:B.getUniformLocation(D,t),value:Wo(_,V.size)}}return C},mn=function(e,X){for(var b={},P=e.getProgramParameter(X,e.ACTIVE_ATTRIBUTES),u=0;P>u;u++){var j=e.getActiveAttrib(X,u),d=Tr(e,j.type);b[j.name]={type:d,size:Mg(d),gl:e,location:e.getAttribLocation(X,j.name),pointer:mj}
}return b},mj=function(k,o,A,m,e){var B=this.gl;B.enableVertexAttribArray(this.location),k instanceof Cs.Buffer||(k=Cs.Buffer.createVertexBuffer(B,k)),B.bindBuffer(k.type,k.buffer),B.vertexAttribPointer(this.location,this.size,o||B.FLOAT,A||!1,m||0,e||0)},Mg=function(p){return Dd[p]},Dd={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Tr=function(D,p){if(!$r){var m=f.keys(no);$r={};for(var e=0;e<m.length;++e){var t=m[e];$r[D[t]]=no[t]}}return $r[p]},$r=null,no={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Wo=function(m,P){switch(m){case"float":return 0;case"vec2":return new Float32Array(2*P);case"vec3":return new Float32Array(3*P);case"vec4":return new Float32Array(4*P);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*P);case"ivec3":return new Int32Array(3*P);case"ivec4":return new Int32Array(4*P);case"bool":return!1;case"bvec2":return hp(2*P);case"bvec3":return hp(3*P);case"bvec4":return hp(4*P);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},hp=function(u){for(var T=new Array(u),h=0;h<T.length;h++)T[h]=!1;return T},gn=function(X,v){var z={data:{}};z.gl=X;for(var c=f.keys(v),k=0;k<c.length;k++){var b=c[k],h=b.split("."),i=h[h.length-1],m=Sk(h,z),t=v[b];m.data[i]=t,m.gl=X,f.defineProperty(m,i,{get:Fh(i),set:od(i,t)})}return z},Fh=function(W){var c=hf.replace("%%",W);return new Function(c)},od=function(E,G){var O,o=_f.replace(/%%/g,E);return O=1===G.size?To[G.type]:is[G.type],O&&(o+="\nthis.gl."+O+";"),new Function("value",o)},Sk=function(f,Y){for(var u=Y,k=0;k<f.length-1;k++){var M=u[f[k]]||{data:{}};u[f[k]]=M,u=M}return u},hf=["return this.data.%%.value;"].join("\n"),_f=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),To={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},is={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},tr=function(g){function z(r){if("string"!=typeof r)return 0|r;switch(r){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var X=this;X.enable=!1;var J,o,u=C.graph3dViewShadowType,Q=C.graph3dViewShadowIntensity,s=C.graph3dViewShadowBias,M=C.graph3dViewShadowQuality,B=C.graph3dViewShadowRadius,p=C.graph3dViewShadowDegreeX,K=C.graph3dViewShadowDegreeZ,I=1,A=z(M),L=!1,c=new V.Math.Matrix4,W=new V.Math.Matrix4,S=X.pvMatrix=new V.Math.Matrix4;X.render=function(){if(!g._picking&&X.enable){var h=g.getGL();if(h){L&&X.setupShadowCamera(),g._glCapabilities&&(A=Math.min(A,g._glCapabilities.maxTextureSize)),X.map?J.setSize(A,A):J=X.map=new yd(g,g.getGL(),0,0,{samples:1,minFilter:cn.NEAREST,magFilter:cn.NEAREST,width:A,height:A}),h._shadowShader||(h._shadowShader=new Cs.Shader(h,tr.shaderSrc.vs,tr.shaderSrc.fs));var n=g._frameState,k=n.renderState.glState;k.blend.enabled=!1,k.depth.enabled=!0,k.depth.mask=!0;var l=k.color.clear.slice(0);hc(h,[1,1,1,1]),n.renderState.useProgram(h._shadowShader.program),q(),hc(h,l)}}},X.getShadow=function(){var g={degreeX:p,degreeZ:K,intensity:Q,quality:M,type:u,radius:B,bias:s};return 1!==I&&(g.boundExtend=I),g},X.setShadow=function(W,O){W=!!W;var w=X.enable!==W;X.enable=W,"object"==typeof O&&(O.intensity!==_&&(Q=O.intensity),O.bias!==_&&(s=O.bias),O.radius!==_&&(B=O.radius),O.degreeX!==_&&(p=O.degreeX),O.degreeZ!==_&&(K=O.degreeZ),O.quality!==_&&(M=O.quality),O.type!==_&&u!==O.type&&(u=O.type,w=!0),A=z(M),O.boundExtend!==_&&(I=O.boundExtend)),W&&X.setupShadowCamera(),w&&mf(g),g.iv()},X.refresh=function(){this.enable&&(this.setupShadowCamera(),g.iv())},X.tryUpdateBounding=function(T){var l=this.boundingSphere;if(l){var C=(new bf).fromArray(Vl(T,g.getMat(T))),r=T.getAnchor3d(),e=new io;l.containsPoint(e.set(0-r.x,0-r.y,0-r.z).applyMatrix4(C))&&l.containsPoint(e.set(0-r.x,0-r.y,1-r.z).applyMatrix4(C))&&l.containsPoint(e.set(0-r.x,1-r.y,0-r.z).applyMatrix4(C))&&l.containsPoint(e.set(0-r.x,1-r.y,1-r.z).applyMatrix4(C))&&l.containsPoint(e.set(1-r.x,0-r.y,0-r.z).applyMatrix4(C))&&l.containsPoint(e.set(1-r.x,0-r.y,1-r.z).applyMatrix4(C))&&l.containsPoint(e.set(1-r.x,1-r.y,0-r.z).applyMatrix4(C))&&l.containsPoint(e.set(1-r.x,1-r.y,1-r.z).applyMatrix4(C))||X.setupShadowCamera()}},X.createShadow=function(Z){Z||(Z=g._frameState.renderState.directUniforms()),Z.shadowMatrix=S.toArray(),Z.shadowMap=J.texture,Z.shadowSize=[J.width,J.height],Z.shadowIntensity=Q,Z.shadowBias=s,Z.shadowRadius=B},X.genShaderDefine=function(){var L="#define USE_SHADOWMAP\n";return"hard"===u?L+="#define SHADOWMAP_TYPE_PCF\n":"soft"===u&&(L+=g.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),L};var x;X.setupShadowCamera=function(){o||(o=X.boundingSphere=new V.Math.Sphere),L=!1;var T,Z,_=g.getBoundingBox(g.dm().toDatas(function(l){return l.s("shadow.cast")&&g.isVisible(l)}));_?(T=new io(_.min),Z=new io(_.max)):(T=new io(-256,-256,-256),Z=new io(256,256,256),L=!0),o.set(T.clone().add(Z).multiplyScalar(.5),.5*T.distanceTo(Z)*I);var k,n=o.radius,W=g.getBoundingBox(g.dm().toDatas(function(w){return(w.s("shadow.cast")||w.s("shadow.receive"))&&g.isVisible(w)}));if(W){T.copy(W.min),Z.copy(W.max);var R=.5*T.distanceTo(Z);k=R+Math.min(R,n+o.center.distanceTo(T.add(Z).multiplyScalar(.5)))}else k=2*n;x=vq(Bf(),-n,n,-n,n,k/1e3,k),S.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),S.multiply(c.fromArray(x));var P=Math.tan(-p*Math.PI/180),z=Math.tan(-K*Math.PI/180),Q=n/Math.sqrt(P*P+z*z+1),M=new io(Q*P,Q,Q*z);c.lookAt(M,new io(0,0,0),new io(0,1,0)).setPosition(M.add(o.center)),c.getInverse(c),S.multiply(c)};var q=function(){var z=g.getGL(),D=A,n=A;J.setSize(z,D,n),J.bind(z),z.clear(cn.COLOR_BUFFER_BIT|cn.DEPTH_BUFFER_BIT);var U=g._frameState,y=U.renderState,V=y.directUniforms(),d=y.directAttribs(),W=y.directState();V.projectionMatrix=x;var H=g._viewport;g.setViewport(z,0,0,D,n);var s,f,Z,r;for(s=0,f=qc.length;f>s;s++)if(Z=qc[s],!jj[Z].ignore&&(r=g._40Q.get(Z))){var P=r.batchIndexMap;X.renderItems(z,V,d,W,r.opaque,P),X.renderItems(z,V,d,W,r.transparent,P),X.renderBatch(z,V,d,W,r.batchModelMap,P)}J.unbind(z),g.setViewport(z,H[0],H[1],H[2],H[3])};X._renderDirect=function(p,z,Z,k){Z&&Z.length&&(z.position=ge(p,g._buffer.vs,Z,F),k?(Rj(p,g._buffer.is,k),yf(p,0,k.length,null,k instanceof Uint32Array?p.UNSIGNED_INT:null)):Pr(p,0,Z.length/3))},X.renderShapeModel=function(t,T,Q,f){var e,b,k;if(mh(Q))for(b=0,k=Q.length;k>b;b++)e=Q[b],e&&X.renderShapeModel(t,T,e,f);else zq(Q)?X.renderShapeModel(t,T,go(f,Q),f):Dg(Q)&&(Q.shape3d?X.renderShapeModel(t,T,Q.shape3d,f):X.renderShapeModelImpl(t,T,Q))},X.renderShapeModelImpl=function(f,y,m){Ji(m),X._renderDirect(f,y,m.vs,m.is),X._renderDirect(f,y,m.top_vs,m.top_is),X._renderDirect(f,y,m.bottom_vs,m.bottom_is),X._renderDirect(f,y,m.from_vs,m.from_is),X._renderDirect(f,y,m.to_vs,m.to_is)},X.renderBatch=function(O,i,z,D,C){if(!Xn(C)&&!g.drawFilter){i.modelViewMatrix=W.identity().premultiply(c).toArray();var p,n,j;for(p in C)j=g.getBatchInfo(p)||Rm,j.visible!==!1&&j.shadowCast!==!1&&(n=C[p],n.invalidate&&ee(n),X._renderDirect(O,z,n.vs32,n.is))}},X.renderItems=function(f,n,l,D,F,e){var w,N,Z,t,u,s=F.length;for(w=0;s>w;w++)if(N=F[w],t=N.ui,Z=N.data,!(Pc(Z)||!Z.s("shadow.cast")||Z instanceof Co)&&g.isVisible(Z)&&!e[Z._id]){var q=t.s("3d.clip.direction");if(q){var H=t.s("3d.clip.percentage");if(0===H)continue;var v=t._formatClipUniforms(q,H,Z);n.uClipPercent=v[1],n.uClipDirection=v[0]}else n.uClipDirection=0;u=t.shapeModel||go(t),u||(u=Z instanceof V.Node&&!(Z instanceof V.Shape)?{vs:tc,is:Bj}:[t.left,t.front,t.right,t.back,t.top,t.bottom]),n.modelViewMatrix=(t.mat?W.fromArray(t.mat):W.identity()).premultiply(c).toArray(),D.cullFace.enabled=!!Z.s("shape3d.reverse.cull"),X.renderShapeModel(f,l,u,t)}}};tr.shaderSrc={vs:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},tr.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var Og=function(o){this.gv=o,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Og.Mode.Style,this.type=W["highlight.type"],this.color=W["highlight.color"],this.width=W["highlight.width"],this.glow=W["highlight.glow"],this.strength=W["highlight.strength"]};Og.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},km.ms_highlight=function(d){d.setHighlightMode=function(r){var s;s="selection"===r||"selected"===r?Og.Mode.Selection:"mouseover"===r||"hover"===r?Og.Mode.MouseOver:"style"===r?Og.Mode.Style:Og.Mode.Disable;var q=this.getHighlightMode();this._highlightHelper.mode=s,this.firePropertyChange("highlightMode",q,r)},d.getHighlightMode=function(){var U=this._highlightHelper.mode;return U===Og.Mode.Selection?"selected":U===Og.Mode.MouseOver?"hover":U===Og.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(P){var Z=P.replace(/(^|\.)[a-z]/g,function(k){return k[k.length-1].toUpperCase()});d["getHighlight"+Z]=function(){return this._highlightHelper[P]},d["setHighlight"+Z]=function(B){var k=this._highlightHelper,N=k[P];B!==N&&(k[P]=B,this.firePropertyChange("highlight"+Z,N,B))}})},cd(Og,f,{onMouseOver:function(t){C.preventDefault(t);var A=this.gv.getDataAt(t);A!==this.mouseOverData&&(this.mouseOverData=A,this.gv.iv())},setFetchTargetFunc:function(R){this.fetchTargetFunc=R},_42:function(r,R){var A,y,W=this,M=W._mode,q=W.gv;if(!r._renderInfo.reflectDepth&&M!==Og.Mode.Disable){if(M===Og.Mode.Selection?A=q.sm().getSelection().toArray(function(b){return b.s("highlight.visible")}):M===Og.Mode.MouseOver&&W.mouseOverData&&W.mouseOverData.s("highlight.visible")&&(A=[W.mouseOverData]),W.fetchTargetFunc&&(A=W.fetchTargetFunc(A)),M===Og.Mode.Style)A=A||[],y=function(g){if(A.indexOf(g)>=0)return!1;var R=q.getDataHighlightMode(g);return R===!1?!0:R===!0?!1:"selected"===R?q.isSelected(g)?!1:!0:"hover"===R?g===W.mouseOverData?!1:!0:!0};else{if(!A||!A.length)return;y=function(b){return A.indexOf(b)<0?!0:void 0}}var F=q.isVRPresenting(),S=q.getWidth();if(F){var m=q.getWidth;S/=2,q.getWidth=function(){return S};var H=q.getViewport()}var Z,Y=q.getDevicePixelRatio(),f=Math.floor(S*Y),v=Math.floor(q.getHeight()*Y);(Z=W._renderTarget)?Z.setSize(r,f,v):W._renderTarget=Z=new Mj.RenderTarget(q,r,f,v);var T="soft"===W.type;if(Z.bind(r),T){var V=r.getParameter(r.COLOR_CLEAR_VALUE);hc(r,[1,1,1,1]),r.clear(r.COLOR_BUFFER_BIT),hc(r,V)}else r.clear(r.COLOR_BUFFER_BIT);q.setViewport(r,0,0,f,v),q.drawFilter=y,jk=function(v,W,$,U,s,K){var w=[$?0:1,1,1,1];return K||(zs.for(v).directUniforms().uFixPickReverseColor=w),w},q.renderPickScene(),jk=Do,q.drawFilter=null,Z.unbind(r),Ic&&Uk(r,R.aPosition),Uk(r,R.aNormal),F&&(q.getWidth=m,q.setViewport(r,H[0],H[1],H[2],H[3]));var l=q.getHighlightColor();if(W._lastHighlightColor!==l){var G=Bm(W._lastHighlightColor=l);W._highlightColorData=[G[0]/255,G[1]/255,G[2]/255,G[3]/255]}return T?W.renderSoftOutline(r,f,v):W.renderHardOutline(r,f,v),r.useProgram(R=q._prg),Ic&&kb(r,R.aPosition),!0}},_assureShader:function(P,$){var f=P._compiledShader[$];return f||(f=P._compiledShader[$]=new Cs.Shader(P,Og.CommonShaderVs,Og[$].fs)),f},renderHardOutline:function(Z,H,T){var N=this,t=N.gv,v=t._postProcessing,A=zs.for(Z),e=A.directState();e.blend.enabled=!0,e.depth.enabled=!1,v.blitScreen(null,N._renderTarget.texture,N._assureShader(Z,"HighlightHard"),{textureSize:[H,T],edgeWidth:t.getHighlightWidth(),edgeColor:N._highlightColorData},{clear:!1}),e.blend.enabled=!1,e.depth.enabled=!0},renderSoftOutline:function(A,r,_){var d,z,a,u,E,g=this,B=g.gv,s=B._postProcessing,Q=Math.floor(r/2),y=Math.floor(_/2),X=Math.floor(r/4),H=Math.floor(_/4),f=g._downSampleRenderTarget;f?(d=g._edgeDetectionRenderTarget,z=g._blurV2,a=g._blurH2,u=g._blurV4,E=g._blurH4,(f.width!==Q||f.height!==y)&&(f.setSize(Q,y),d.setSize(Q,y),z.setSize(Q,y),a.setSize(Q,y),u.setSize(X,H),E.setSize(X,H))):(f=g._downSampleRenderTarget=new Mj.RenderTarget(B,A,Q,y),d=g._edgeDetectionRenderTarget=new Mj.RenderTarget(B,A,Q,y),z=g._blurV2=new Mj.RenderTarget(B,A,Q,y),a=g._blurH2=new Mj.RenderTarget(B,A,Q,y),u=g._blurV4=new Mj.RenderTarget(B,A,X,H),E=g._blurH4=new Mj.RenderTarget(B,A,X,H));var q=A.getParameter(A.COLOR_CLEAR_VALUE),Z=B.getViewport(),w=g.width,T=g.strength,Y=g.glow,U=zs.for(A).glState,x=U.depth,k=U.blend,m=x.enabled;hc(A,[1,1,1,1]),x.enabled=!1,k.apply({func:[A.SRC_ALPHA,A.ONE]}),s.blitScreen(f,g._renderTarget.texture),s.blitScreen(d,f.texture,g._assureShader(A,"EdgeDetection"),{texSize:[Q,y],color:g._highlightColorData}),s.blitScreen(a,d.texture,g._assureShader(A,"Blur"),{direction:[1,0],texSize:[Q,y],radius:w}),s.blitScreen(z,a.texture,g._assureShader(A,"Blur"),{direction:[0,1],texSize:[Q,y],radius:w}),s.blitScreen(E,z.texture,g._assureShader(A,"Blur"),{direction:[1,0],texSize:[X,H],radius:w}),s.blitScreen(u,E.texture,g._assureShader(A,"Blur"),{direction:[0,1],texSize:[X,H],radius:w}),k.apply({enabled:!0}),B.setViewport(A,Z[0],Z[1],Z[2],Z[3]),s.blitScreen(null,g._renderTarget.texture,g._assureShader(A,"BlendTogether"),{edgeTexture1:z.texture,edgeTexture2:u.texture,edgeStrength:T*w,edgeGlow:Y},{clear:!1}),k.apply({func:[A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA,A.ONE,A.ONE_MINUS_SRC_ALPHA]}),x.enabled=m,hc(A,q)}}),f.defineProperties(Og.prototype,{mode:{get:function(){return this._mode},set:function(K){var r=this._mode;if(K!==r){this._mode=K;var W=r===Og.Mode.MouseOver||r===Og.Mode.Style,D=K===Og.Mode.MouseOver||K===Og.Mode.Style;D&&W||(W&&d(this.gv.getView(),"mousemove",this.onMouseOver),D&&x(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),Og.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),Og.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Og.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},Og.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},Og.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var Ye=V.Light=function(){tl(Ye,this),this.s(Ae,W[Ae]),this.s(Vm,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Lr("Light",Yj,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(p,Y,$){Ye.superClass.onStyleChanged.apply(this,arguments),p===Ae&&this.s("shape3d.color",$)}});var bb=Mj.FrameState=function(s,q){this.renderState=zs.for(q),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=_,this.projectMatrix=_,this.viewMatrix=_,this.view=s,this.defaultProgram=_,this.pickColorMap=_,this._pvStack=[],this._renderStateStack=[]};bb.prototype.savePV=function(){var T=this.view;this._pvStack.push([ds(this.projectMatrix),ds(this.viewMatrix),T._18Q,ds(T._7O)])},bb.prototype.restorePV=function(){var z=this._pvStack.pop();if(z){var i=this.view;this.projectMatrix=i._projectMatrix=z[0],this.viewMatrix=i._viewMatrix=z[1],i._18Q=z[2],i._7O=z[3]}},bb.prototype.setPV=function(h,r){var Z=this.view,d=!1;if(h&&(this.projectMatrix=Z._projectMatrix=h,d=!0),r&&(this.viewMatrix=Z._viewMatrix=r,Z._7O=ds(r),d=!0),d){var D=Z.getWidth(),R=Z.getHeight(),k=ds(this.projectMatrix);Z._18Q=Si(k,k,r),Z._18Q._wh=D/R}},bb.prototype.syncEnv=function(V){var c=this,m=c.view;c.envmapReflectivity=m._envmapReflectivity||.5,c.cameraPosition=m.getEye(),c.projectMatrix=m._projectMatrix,c.viewMatrix=m._viewMatrix,c.pickColorMap=V,c.picking=m.getGL()._picking},bb.prototype.setGLState=function(){var G=[0,0,0,0],l=[!0,!0,!0,!0],Y=[-1,1],d=[cn.FUNC_ADD,cn.FUNC_ADD],b=[cn.SRC_ALPHA,cn.ONE_MINUS_SRC_ALPHA,cn.ONE,cn.ONE_MINUS_SRC_ALPHA];return function(x,A){var t=this,y=t.renderState.gl,w=t.renderState.glState;w.dither=!1,A?w.color.mask=l:w.color.reset(),w.pixelStore.reset(),w.blend.color=G,w.blend.equation=d,w.blend.func=b,w.cullFace.enabled=!1,w.scissor.enabled=!1,w.depth.enabled=!0,w.depth.clear=1,w.depth.func=y.LEQUAL,w.depth.range=Y,w.stencil.enabled=!1,w.polygonOffset.enabled=!1,x?(w.depth.mask=!1,w.blend.enabled=!0):(w.depth.mask=!0,w.blend.enabled=!1)}}(),bb.prototype.setUniforms=function(z){var c=this,X=c.view,b=c.renderState,A=b.gl,q=b.uniforms;q.uBrightness=1,q.uOpacity=1,q.uPartOpacity=1,q.uPick=c.picking,q.uTexture=!1,q.uBlendTexture=!1,q.uAlphaTest=W.alphaTest,q.uTransparent=!!z,q.uFix=!1,q.uBatchColor=!1,q.uBatchBlend=!1,q.uBatchBrightness=!1,q.uReflectivity=c.envmapReflectivity||.5,q.uCameraPosition=c.cameraPosition,q.uPMatrix=c.projectMatrix,q.uViewMatrix=c.viewMatrix,X.bindEnvMap(A),c.picking||(Zg(X,A,_),X._fogDisabled||(q.uFogColor=X._fogColor,q.uFogDensity=X._fogDensity,q.uFogNear=X._fogNear,q.uFogFar=X._fogFar))},bb.prototype.drawLayer=function(F){return this.view.renderLayers(F,!0)},bb.prototype.drawData=function(L,g,A){var I=this.view;if(I.isVisible(L)){var k=this.renderState,T=k.uniforms,t=I.getData3dUI(L);if(t){var s=k.gl,O=s._picking,z=I._picking,G=L._pickId;A&&(L._pickId=A),T.uPick=s._picking=I._picking=!!A,T.uTransparent=!!g,t._42(k.gl,k.program,g?$:p),T.uPick=s._picking=O,I._picking=z,L._pickId=G}}};var Qn=Mj.Graph3dView=function(A,t){var M=this;M._webGLVersion=1,M._attributes=t||C.graph3dViewAttributes,M._25I={},M._view=oj(1,M);var u=M._canvas=ys(M._view);x(u,"webglcontextlost",function(P){P.preventDefault(),mf(M),M._26I&&M._doBufferGC(M._26I,!0),M._26I=F,M._1o.onContextLost(),M._35O=!0}),x(u,"webglcontextrestored",function(){M._35O=!1,M.iv()}),M._40Q=new Pk,M._43Q={},M._44Q=-1,M._batchIndexMap={},M._batchModelMap={},M._wireframeIndexMap={},M._wireframeModelMap={},M._wireframeIndexMapSwap={},M._wireframeModelMapSwap={},M._polylineIndexMap={},M._polylineIndexMap={},M._polylineIndexMapSwap={},M._polylineIndexMapSwap={},M._8O=[],M._7O=Bf(),M._6O=Bf(),M._1o=new oe(M),M._30O=new br(M),M._31O=new jd(M),M._32O=new Vi(M),M._raycaster=new Is(M),M._highlightHelper=new Og(M),M._postProcessing=new Ss(M),M._41Q=[],M._42Q=0,M._frameRenderOptionStack=[],Mj.VR?(M.vr=new Mj.VR(M),M.isVREnabled=function(){return this.vr.enable},M.isVRPresenting=function(){return this.vr.isPresenting()}):(M.vr={enable:!1,isPresenting:y},M.isVREnabled=y,M.isVRPresenting=y),M.shadowMap=new tr(M),M._33Q=!0,M._eye=Hq(C.graph3dViewEye),M._center=Hq(C.graph3dViewCenter),M._up=Hq(C.graph3dViewUp),M._lightChanged=!1,M._59O=[],M._spots=[],M._dirs=[],M._frameId=0,M._batchInfoMap={},M.overlappingBox=new Ik(M),M.dm(A?A:new ip),M._coreInteractor=new Jh(this),M.setInteractors([new el(M)]),M._initView()},ig={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},_r=0;ld("Graph3dView",f,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",bp,_c,"firstPersonMode",Yd,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",im,Pd,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:C.graph3dViewSortable,_editHelperDisabled:C.graph3dViewEditHelperDisabled,_blockSelectable:C.graph3dViewBlockSelectable,_devicePixelRatio:_,_boundaries:_,_moveStep:C.graph3dViewMoveStep,_rotateStep:C.graph3dViewRotateStep,_rotateMinPhi:C.graph3dViewMinPhi===_?C.graph3dViewRotateMinPhi:C.graph3dViewMinPhi,_rotateMaxPhi:C.graph3dViewMaxPhi===_?C.graph3dViewRotateMaxPhi:C.graph3dViewMaxPhi,_pannable:C.graph3dViewPannable,_rotatable:C.graph3dViewRotatable,_walkable:C.graph3dViewWalkable,_resettable:C.graph3dViewResettable,_zoomable:C.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:C.graph3dViewFirstPersonMode,_mouseRoamable:C.graph3dViewMouseRoamable,_gridVisible:C.graph3dViewGridVisible,_gridSize:C.graph3dViewGridSize,_gridGap:C.graph3dViewGridGap,_gridColor:C.graph3dViewGridColor,_originAxisVisible:C.graph3dViewOriginAxisVisible,_centerAxisVisible:C.graph3dViewCenterAxisVisible,_axisXColor:C.graph3dViewAxisXColor,_axisYColor:C.graph3dViewAxisYColor,_axisZColor:C.graph3dViewAxisZColor,_ortho:C.graph3dViewOrtho,_orthoWidth:C.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:C.graph3dViewSyncEyeWithOrthoWidth,_fovy:C.graph3dViewFovy,_near:C.graph3dViewNear,_far:C.graph3dViewFar,_headlightColor:C.graph3dViewHeadlightColor,_headlightIntensity:C.graph3dViewHeadlightIntensity,_headlightRange:C.graph3dViewHeadlightRange,_headlightAmbientIntensity:C.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:C.graph3dViewHeadlightDisabled,_rectSelectable:C.graph3dViewRectSelectable,_rectSelectBackground:C.graph3dViewRectSelectBackground,_editSizeColor:C.graph3dViewEditSizeColor,_autoMakeVisible:ao,_fogDisabled:C.graph3dViewFogDisabled,_fogMode:C.graph3dViewFogMode,_fogDensity:C.graph3dViewFogDensity,_fogColor:C.graph3dViewFogColor,_fogNear:C.graph3dViewFogNear,_fogFar:C.graph3dViewFogFar,_pickerResolution:C.graph3dViewPickerResolution,_dashDisabled:C.graph3dViewDashDisabled,_batchColorDisabled:C.graph3dViewBatchColorDisabled,_batchBlendDisabled:C.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:C.graph3dViewBatchBrightnessDisabled,addCamera:function(T){var r=this,C=f.freeze({id:r._42Q++,priority:T.priority||0,ignoreInPick:!!T.ignoreInPick,render:T.render});T.switch3DStatus&&(r._43Q[C.id]=!0),r._41Q.push(C),r._41Q.sort(function(R,J){return R.priority!==J.priority?R.priority-J.priority:R.id-J.id})},setEye:function(U,I,n){1===arguments.length&&(I=U[1],n=U[2],U=U[0]);var k=this._eye;k[0]=U,k[1]=I,k[2]=n,this.fp(im,F,k)},setCenter:function(Z,L,D){1===arguments.length&&(L=Z[1],D=Z[2],Z=Z[0]);var y=this._center;y[0]=Z,y[1]=L,y[2]=D,this.fp(Pd,F,y)},setUp:function(g,K,W){1===arguments.length&&(K=g[1],W=g[2],g=g[0]);var C=this._up;C[0]=g,C[1]=K,C[2]=W,this.fp("up",F,C)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||nj},isTransparentMask:function(g){return g.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var a=this,z=a._aspect;return z?z:(z=a.getWidth()/a.getHeight(),z||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(F){var h=this,J=h._dataModel,x=h._selectionModel;J!==F&&(J&&(J.ump(h.handleDataModelPropertyChange,h),J.umm(h.handleDataModelChange,h),J.umd(h.handleDataPropertyChange,h),x||J.sm().ums(h.handleSelectionChange,h)),h._dataModel=F,F.mp(h.handleDataModelPropertyChange,h),F.mm(h.handleDataModelChange,h),F.md(h.handleDataPropertyChange,h),x?x._21I(F):F.sm().ms(h.handleSelectionChange,h),h._postProcessing.handleDataModleChange(J,F),h.invalidateAll(!0),h.invalidateLight(),h.fp(rd,J,F),h._canvas.style.background=F.getBackground()||"")},handleDataModelPropertyChange:function(x){if("background"===x.property){var n=this._canvas.style.background,f=x.newValue||"";this._canvas.style.background=f,this.fp("canvasBackground",n,f)}else"envmap"===x.property?this.iv():"cubicEnvmap"===x.property&&(this._lastEnvMap=_,this.iv())},handleDataPropertyChange:function(j){var L=j.data;this.invalidateData(L),Pc(L)&&"s:light.type"===j.property?this.invalidateLight():"s:shadow.cast"===j.property&&this.shadowMap.tryUpdateBounding(L)},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(S){var v=this,M=S.property;v.iv(),v._18Q=F,"eye"===M?v._33Q=!0:"devicePixelRatio"===M?v._42(v.getDevicePixelRatio()):ig[M]&&mf(v)},_5O:function(A){var Q=A._22Q();return Q?new Q(this,A):F},getData3dUI:function(k){var h=this._25I[k._id];return h===_&&(h=this._5O(k),this._25I[k._id]=h),h},invalidateAll:function(p){var D=this;if(p){for(var O in D._25I){var T=D._25I[O];T&&T.dispose()}D._25I={},D.iv(),an(D)}else an(D),D.dm().each(function(S){D.invalidateData(S)})},invalidateSelection:function(){var H=this;H.sm().each(function(k){H.invalidateData(k)})},invalidateData:function(v){var C=this,u=C.getData3dUI(v);u&&(u.iv(),C.iv()),an(C,v)},getShape3dText:function(l){return l.getStyle("shape3d.text")||this.getLabel(l)},invalidateBatch:function(K){var D=this,m=D._40Q;m.each(function(B){D._invalidateBatch(B.batchModelMap,B.batchIndexMap,B.polylineModelMap,B.polylineIndexMap,B.wireframeModelMap,B.wireframeIndexMap,K),B.markBatchInvalid()})},_invalidateBatch:function(i,$,X,Q,g,s,r){var C=this,P=i[r],S=[],R={};if(P){P.ds.forEach(function(e){var p=C.getData3dUI(e);p&&p.iv(),delete $[e._id],S.push(e._id)}),delete i[r];for(var U,M,z,F,E,d,A,l,Z,j=[g,X],V=[s,Q],e=0;e<j.length;e++){var a=j[e],u=V[e];for(R={},l=0;l<S.length;l++){var D=u[S[l]];if(D){delete u[S[l]],Z=D.batch,U=a[Z];var x=D.begin,w=D.size,I=3*x,W=3*w,T=4*x,c=4*w;for(M=U.ds,z=U.vs,F=U.cs,E=U.ps,d=U.ls,A=D.index,U.invalidate=!0,M[A]=_,A=I;I+W>A;A++)z[A]=_;for(A=T;T+c>A;A++)F[A]=_;for(A=T;T+c>A;A++)E[A]=_;if(d)for(A=I;I+W>A;A++)d[A]=_;R[Z]=!0}}for(Z in R){U=a[Z],M=U.ds,z=U.vs,F=U.cs,E=U.ps,d=U.ls;var K=[];for(A=0;A<M.length;A++)M[A]!==_&&K.push(M[A]);if(0===K.length)delete a[Z];else{for(U.ds=K,K=[],A=0;A<z.length;A++)z[A]!==_&&K.push(z[A]);for(U.vs=K,K=[],A=0;A<F.length;A++)F[A]!==_&&K.push(F[A]);for(U.cs=K,K=[],A=0;A<E.length;A++)E[A]!==_&&K.push(E[A]);if(U.ps=K,d){for(K=[],A=0;A<d.length;A++)d[A]!==_&&K.push(d[A]);U.ls=K}}}}C.iv()}},handleDataModelChange:function(l){var u=this,i=l.kind,T=l.data;if("add"===i)u.invalidateData(T),Cm(T)&&T.getEdgeGroup()&&T.getEdgeGroup().eachSiblingEdge(u.invalidateData,u),Pc(T)&&u.invalidateLight();else if(i===xs){var p=T._id,I=u._25I[p];I&&(I.dispose(),delete u._25I[p],u.iv()),T===u._currentSubGraph&&u.setCurrentSubGraph(F),an(u,T),Pc(T)&&u.invalidateLight()}else i===eo&&(u.invalidateAll(!0),u.setCurrentSubGraph(F),an(u),u.invalidateLight())},toCanvas:function(z,A,V){var s=this,o=s.getGL();if(s.validate(),z){var d=o.getParameter(o.COLOR_CLEAR_VALUE);hc(o,z)}s._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var n=s.getWidth()||1,B=s.getHeight()||1,Y=new Uint8Array(4*n*B),K=ys(),H=K.getContext("2d");o.readPixels(0,0,n,B,o.RGBA,o.UNSIGNED_BYTE,Y),Db(K,n,B,1);for(var G=H.getImageData(0,0,n,B),X=G.data,D=0;D<X.length;D+=4){var e=D/4,i=P(e/n),N=e-i*n;e=4*((B-1-i)*n+N),X[e]=Y[D],X[e+1]=Y[D+1],X[e+2]=Y[D+2],X[e+3]=Y[D+3]
}if(H.putImageData(G,0,0),z&&hc(o,d),s._42(s.getDevicePixelRatio()),A&&V){var w=ys(),j=w.getContext("2d");return Db(w,A,V,1),C.drawImage(j,K,0,0,A,V),w}return K},toDataURL:function(f,g){var n=this,X=n.getGL();if(n.validate(),f){var P=X.getParameter(X.COLOR_CLEAR_VALUE);hc(X,f)}n._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var z=n._canvas.toDataURL(g||"image/png",1);return f&&hc(X,P),n._42(n.getDevicePixelRatio()),z},getGL:function(){var T=this._26I;if(T)return this.acquireProgram(),T;if(!this._35O){var g=this,d=g._canvas,Y=g._attributes;if(!Y||Y.requestWebGL2!==!1)try{T=d.getContext("webgl2",Y)||d.getContext("experimental-webgl2",Y),T&&(g._webGLVersion=2,g._26I=T)}catch(q){}if(!T)try{T=d.getContext("webgl",Y)||d.getContext("experimental-webgl",Y)}catch(q){throw new Error("WebGL not supported")}if(!T)throw new Error("WebGL not supported");g._26I=T;var b=g._frameState=new bb(this,T);g._glExtensions=new J(T),g._glCapabilities=new G(T,g._glExtensions),g._2O={},T._emptyCubeTexture=Rr(T),T._compiledShader={},T._emptyTexture=Hc(T),T._emptyBlendTexture=Hc(T),T._bufPool={},T._id=++_r,b.setGLState(),g._buffer={vs:mk(T),ns:mk(T),is:mk(T),uv:mk(T),batchColor:mk(T),batchBlend:mk(T),batchBrightness:mk(T),lineDistance:mk(T)},g._1O=yn(T);var N=g._cube={vs:mk(T),ns:mk(T),is:mk(T),uv:mk(T)};return ph(T,N.vs,tc),ph(T,N.ns,Rh),ph(T,N.uv,Bs),vc(T,N.is,Bj),g.acquireProgram(),T._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},T}},getGLCapabilities:function(){var V=this.getGL();return V?this._glCapabilities:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<C.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},acquireProgram:function(){var W=this,y=W._26I;if(y){var f=C.getImage(W.getEnvmap()),L=f&&f.tagName?!0:!1,s=W._prg&&W._prg.envMapFlag?!0:!1;if(!W._prg||L!==s){var N=W._prg=y.createProgram();if(!N)return F;N.envMapFlag=L;var r=W._dirs.length,J=W._spots.length,P=W._59O.length,o=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];r&&o.push("uDirColor","uDirDirection"),J&&o.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),P&&o.push("uPointColor","uPointRange","uPointPosition"),kk||(xr=bm(xr.substring(0,xr.indexOf("^#"))),pd=bm(pd),kk=!0);var e=["#define MAX_DIR "+r,"#define MAX_SPOT "+J,"#define MAX_POINT "+P,W._fogDisabled?"":"#define FOG","exp2"===W.getFogMode()?"#define FOG_EXP2":"",W._dashDisabled?"":"#define DASH",L?"#define USE_ENVMAP":"",W.isOrtho()?"#define ORTHOGRAPHIC":"",W._batchColorDisabled?"":"#define BATCHCOLOR",W._batchBlendDisabled?"":"#define BATCHBLEND",W._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",W.shadowMap.enable?W.shadowMap.genShaderDefine():"",""].join("\n"),D=Yb(y,N,y.VERTEX_SHADER,xr.replace("PREFIX",e));y.getShaderParameter(D,y.COMPILE_STATUS)||Kg("COMPILE",y.VERTEX_SHADER,y.getError(),y.getShaderInfoLog(D));var O=Yb(y,N,y.FRAGMENT_SHADER,pd.replace("PREFIX",e));if(y.getShaderParameter(O,y.COMPILE_STATUS)||Kg("COMPILE",y.FRAGMENT_SHADER,y.getError(),y.getShaderInfoLog(O)),Ic?o.push("aPosition"):(N.aPosition=0,y.bindAttribLocation(N,0,"aPosition")),y.linkProgram(N),!y.getProgramParameter(N,y.LINK_STATUS)){var X=y.getProgramInfoLog(N);return W._prg=F,X.indexOf("maximum temp register")>=0&&!W._glTempRegisterLimited?(W._glTempRegisterLimited=!0,y.deleteProgram(N),W.acquireProgram()):(Kg("LINK",y.getProgramParameter(N,y.VALIDATE_STATUS),y.getError(),X),y.deleteProgram(N),F)}o.forEach(function(V){N[V]=/^u/.test(V)?y.getUniformLocation(N,V):y.getAttribLocation(N,V)});var Y=W._frameState;Y.renderState.program=Y.defaultProgram=N,y.deleteShader(D),y.deleteShader(O)}}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(P){var _=P.s("brightness"),E=this.isSelected(P)?P.s("select.brightness"):F;return _==F?E:E==F?_:_*E},getDataHighlightMode:function(b){return b.s("highlight.mode")},bindEnvMap:function(N){var T=this,W=zs.for(N),K=W.directUniforms(),R=T.getEnvmap(),b=C.getImage(R);if(b&&b.tagName){if(R!==T._lastEnvMap){var O={};if(T.dm().isCubicEnvmap()){var y=ob(b),u=$n(b);if(0===y||0===u)return;var c=y/4,D=u/3,m={top:{x:c,y:0},left:{x:0,y:D},front:{x:c,y:D},right:{x:2*c,y:D},back:{x:3*c,y:D},bottom:{x:c,y:2*D}};["top","left","front","right","back","bottom"].forEach(function(e){var B=m[e],y=O[e]=ys();Db(y,c,D,1);var X=Zq(y);X.drawImage(b,B.x,B.y,c,D,0,0,c,D),X.restore(),O[e]=C.resizeImagePOT(y,!0)})}else b=C.resizeImagePOT(b,!0);T._envMapTexture&&N.deleteTexture(T._envMapTexture);var U=T._envMapTexture=N.createTexture();N.activeTexture(N.TEXTURE0),N.bindTexture(N.TEXTURE_CUBE_MAP,U),N.texParameteri(N.TEXTURE_CUBE_MAP,N.TEXTURE_MAG_FILTER,N.LINEAR),N.texParameteri(N.TEXTURE_CUBE_MAP,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,O.right||b),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,O.left||b),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,O.top||b),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,O.bottom||b),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,O.front||b),N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,O.back||b),N.bindTexture(N.TEXTURE_CUBE_MAP,N._emptyCubeTexture),T._lastEnvMap=R}K.uEnvMap=T._envMapTexture}},getWireframe:function(C){var i=C.s("wf.visible"),k=C.s("wf.width");return i===!0||k>0&&"selected"===i&&this.isSelected(C)?{color:C.s("wf.color"),width:k,"short":C.s("wf.short"),mat:C.s("wf.mat")}:void 0},_transformPointToViewSpace:function(i){var d=[i[0],i[1],i[2]];return vr(d,this._viewMatrix),d},_transformDirectionToViewSpace:function(w,J){var o=[w[0],w[1],w[2]];vr(o,this._viewMatrix);var F=J?[J[0],J[1],J[2]]:[0,0,0];vr(F,this._viewMatrix);var u=F[0]-o[0],Z=F[1]-o[1],r=F[2]-o[2],g=Math.sqrt(u*u+Z*Z+r*r);return g?[u/g,Z/g,r/g]:[u,Z,r]},getWireframeGeometry:function(A){return A.s("wf.geometry")?{color:A.s("wf.color"),width:A.s("wf.width"),mat:A.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(N){return N.s("body.color")},getMat:function(N){return N.getMat?N.getMat():N.s("mat")},getFaceMat:function(H,e){return H.getFaceMat?H.getFaceMat(e):H.s(e+".mat")},getFaceBlend:function(s,z){return s.s(z+".blend")||s.s("all.blend")},getFaceColor:function(l,c){return l.s(c+".color")||l.s("all.color")},getFaceImage:function(y,G){return y.s(G+".image")||y.s("all.image")},getFaceBlendImage:function(v,V){return v.s(V+".blend.image")||v.s("all.blend.image")},getFaceDiscardSelectable:function(n,_){var z=n.s(_+".discard.selectable");return z==F?n.s("all.discard.selectable"):z},getFaceUv:function(C,B){return C.s(B+".uv")||C.s("all.uv")},getFaceUvOffset:function(Z,I){return Z.s(I+".uv.offset")||Z.s("all.uv.offset")},getFaceUvScale:function(g,$){return g.s($+".uv.scale")||g.s("all.uv.scale")},getFaceUvRotation:function(E,I){return E.s(I+".uv.rotation")||E.s("all.uv.rotation")},getFaceLight:function(c,W){var R=c.s(W+".light");return R==F?c.s("all.light"):R},getFaceVisible:function(s,R){var B=s.s(R+".visible");return B==F?s.s("all.visible"):B},getFaceOpacity:function(x,Z){var E=x.s(Z+".opacity");return E==F?x.s("all.opacity"):E},getFaceTransparent:function(o,g){var N=o.s(g+".transparent");return N==F?o.s("all.transparent"):N},getFaceReverseColor:function(F,d){return F.s(d+".reverse.color")||F.s("all.reverse.color")},getFaceReverseFlip:function(t,e){var B=t.s(e+".reverse.flip");return B==F?t.s("all.reverse.flip"):B},getFaceReverseCull:function(m,L){var d=m.s(L+".reverse.cull");return d==F?m.s("all.reverse.cull"):d},getTextureMap:function(){return this._2O},deleteTexture:function(U){var h=this;if(h._2O){var R=h._2O[U];R&&(delete h._2O[U],h.getGL().deleteTexture(R))}},renderPickScene:function(){var C=this.getGL();this.syncRenderState(),this._picking=C._picking=!0,this.renderScene(),this._picking=C._picking=!1},invalidateCachedTexture:function(C){var Z=this.getData3dUI(C);Z.invalidateCachedTexture(this.getGL()),this.invalidateData(C)},invalidateShape3dCachedImage:function(M){this.invalidateCachedTexture(M)},invalidateCachedGeometry:function(G){var D=this.getData3dUI(G);D.invalidateCachedGeometry(),this.invalidateData(G)},isInteractive:function(h){return h.s("interactive")},getTexture:function(k,x,W){if(!k)return F;var e=this,u=e.getGL(),h=e._2O[k];if(!h){var w=ij(k),s={};if(!w)return u._emptyTexture;if(x){s.mipmapMaxLevel=x.s("texture.mipmap.max");var g=x.s("texture.wrap");s.clampToEdge="clampToEdge"===g?!0:"repeat"===g?!1:_}if(w.uuid||(w.uuid=V.Math.generateUUID()),w.tagName){if(w.dynamic)return yn(u,w,e._1O,s);h=e._2O[k]=yn(u,w,_,s)}else{var P,n=x&&(x.s("texture.cache")||x.s("shape3d.image.cache")||w.textureCache),R=e.isVRPresenting();if(R&&(x._textureUpdateFrame===u._renderInfo.frame?n=!0:x._textureUpdateFrame=u._renderInfo.frame),n&&(P=e.getData3dUI(x),h=P.getCachedTexture(W),h&&P.interactiveInfo&&h.interactiveInfo&&(P.interactiveInfo[h.interactiveInfo.key]=h.interactiveInfo.info)),!h){var z=u._renderInfo.textureCache;if(n){if(z.time>C.graph3dMaxVectorCacheTime)return e.redraw(),u._emptyTexture;if(!Oe(w,x))return u._emptyTexture}var B;x&&(1!==x.s("texture.scale")?B=x.s("texture.scale"):1!==x.s("shape3d.texture.scale")&&(B=x.s("shape3d.texture.scale"))),B||(B=1);var j=x&&(x.s("fixSizeOnScreen")||x.s("shape3d.fixSizeOnScreen")),q=j?u.NEAREST:u.LINEAR;j?"number"==typeof j&&(B*=0>j?1:j):x&&(x.s("vector.dynamic")||x.s("shape3d.vector.dynamic"))&&(P||(P=e.getData3dUI(x)),j=P.getVectorDynamicSize());var A,i,t,Q=x&&x.s("shape3d");"billboard"===Q?t=x.getTall()/x.getWidth():"plane"===Q&&(t=x.getHeight()/x.getWidth());var K=ob(w,x);if(j){var v;v=n?e._devicePixelRatio||nj:e.getDevicePixelRatio(),A=j[0]>0?j[0]*v:B*K*v,i=j[1]>0?j[1]*v:B*(t?$n(w,x,e,Math.min(4096,K*t)):$n(w,x))*v}else A=B*K,i=B*(t?$n(w,x,e,Math.min(4096,K*t)):$n(w,x));if(A>=1&&i>=1){var c=0;(n||R)&&(c=Date.now());var J=e._glCapabilities.maxTextureSize;A=Math.min(A,J),i=Math.min(i,J);var T=af(A,i);if(!P&&x&&(P=e.getData3dUI(x)),P&&P.interactiveInfo){var H=k;"object"==typeof H&&(H=H.uuid||(H.uuid=V.Math.generateUUID()));var O=P.interactiveInfo[H]={};T.interactiveInfo=O.bodyInfo={compInfos:[],matrix:new Mm,rect:{x:0,y:0,width:A,height:i}}}Fp(T,w,0,0,A,i,x,e),T.interactiveInfo&&(T.interactiveInfo=null),T.restore(),z.count++,z.pixels+=A*i,x?(s.minFilter=Rg(x.s("texture.filter.min")||x.s("texture.filter"))||q,s.magFilter=Rg(x.s("texture.filter.mag")||x.s("texture.filter"))||q):s.minFilter=s.magFilter=q,n||R?(h=yn(u,dc,null,s),P.setCachedTexture(h,W),z.time+=Date.now()-c,O&&(h.interactiveInfo={key:H,info:O}),dc=null):h=yn(u,dc,e._1O,s)}}}}return h},redraw:function(){this.iv()},validateImpl:function(){var s=this;if(s._lightChanged){s._lightChanged=!1;var O=[],p=[],y=[];s.dm().each(function(B){if(Pc(B)){var _=B.s("light.type");_===Mb?O.push(B):_===hb?p.push(B):_===xc&&y.push(B)}}),(O.length!==s._59O.length||p.length!==s._spots.length||y.length!==s._dirs.length)&&mf(s),s._59O=O,s._spots=p,s._dirs=y}var D=s.getAspect();D!==s.__cachedAspect__&&(s._updateSkybox({property:"asceptChanged"}),s.__cachedAspect__=D),s._42(),s._1o.iv()},getRenderInfo:function(){var r=this.getGL();return r?r._renderInfo:void 0},getDebugTip:function(){var $=this,p=$.getRenderInfo();if(p){var X=$.getGL()._validBufCount||0,y="Draw Calls: "+p.calls+"<br/>"+"Vertices: "+p.vertices+"<br/>"+"Faces: "+p.faces+"<br/>"+"Lines: "+p.lines+"<br/>"+(p.points?"Points: "+p.points+"<br/>":"")+"Buffers: "+X+"<br/>"+"Cache Models: "+f.keys(Mo).length+"<br/>"+"Shape3d Models: "+f.keys(ep).length;if($.isVRPresenting()&&(y+="<br/>VR fps: "+$.vr.getFps()),p.textureCache){var i=p.textureCache.count;if(y+="<br/>2D Dynamic Textures: "+p.textureCache.count,i>0){var O,I=p.textureCache.pixels;O=I>1e6?Math.round(I/1e6)+"M":I>1e3?Math.round(I/1e3)+"K":Math.round(I),y+="<br/>2D Dynamic pixels: "+O}}return y}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var W=new V.Math.Box3,X=new V.Math.Matrix4;return function(b){var n=b;if(n instanceof V.Data&&(n=this.getData3dUI(n)),!n.mat)return!0;var v=n.getBoundingBox();W.copy(v).applyMatrix4(X.fromArray(n.mat));var h=this.getFrustum();return h.intersectsBox(W)}}(),updateScene:function(){var M=this;M._81O=F,M.overlappingBox.clear();var z=M._40Q;z.init();var b=M.getGL(),E=M.dm();if(E.isHierarchicalRendering())E.eachByHierarchical(function(i){var A=M.getData3dUI(i);A&&A.update(M,b,z)});else{var G,Y,T,k=E.getDatas().getArray(),c=k.length;for(G=0;c>G;G++)Y=k[G],T=M.getData3dUI(Y),T&&T.update(M,b,z)}z.onUpdated()},_pushFrameRenderOptions:function(z){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=z},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(q){var J=this._currentFrameRenderOptions;return J&&J[q]},renderScene:function(w){function r(x,z){V.setGLState(x,z),V.setUniforms(x),V.renderState.attribs.disable(),y=f.directUniforms(),Q=f.directAttribs(),Q.disable()}function Z(s){for(;n>g;g++){var h=v[g];if(!X||!h.ignoreInPick){if(h.priority>=s)break;(!B._43Q[B._44Q=h.id]||bl[me.length])&&(h.render(o,B,V),r())}}}var B=this;B._pushFrameRenderOptions(w),B.shadowMap.render(),B._44Q=-1;var Q,V=B._frameState,f=V.renderState,L=f.glState,y=f.directUniforms(),o=B.getGL(),N=B._prg;B._projectMatrix=js(B),Bc(B,B._7O),B._viewMatrix=ds(B._7O),Si(B._projScreenMatrix=Bf(),B._projectMatrix,B._viewMatrix),V.syncEnv(this._picking?this.pickColorMap:_),f.useProgram(N),r(!1,!0),o.clear(o.DEPTH_BUFFER_BIT);var X=B._picking,v=this._41Q,g=0,n=v.length;if(Z(C.cameraPriority.skybox),X){var k=L.color.clear.slice(0);hc(o,[0,0,0,0])}else hc(o,[0,0,0,0]),L.blend.enabled=!1,L.depth.enabled=!1,L.depth.mask=!1,B.drawSky(o,N),B.drawReflectors(o)&&(B._projectMatrix=js(B),Bc(B,B._7O),B._viewMatrix=ds(B._7O),V.syncEnv(),r()),L.blend.enabled=!1,L.depth.enabled=!0,L.depth.mask=!0,y.uTransparent=!1,B._getFrameRenderOptions("renderGrid")!==!1&&B._31O._42(o,N);if(!o.textureBatch||bl[(ONE_FRAME_TIME-6)/2]){!X&&B.shadowMap.enable&&B.shadowMap.createShadow(y);for(var q=0,s=qc.length;s>q;q++){var c=qc[q],l=jj[c];if(!l.ignore){var W=l.priority;Z(W),this.renderLayer(c)}}Z(C.cameraPriority.infinity),L.depth.enabled=!1,y.uTransparent=!1,y.shadowReceive=!1,X?B.drawFilter||B._30O._42(o,N):(B._highlightHelper._42(o,N),this._renderAxisAndEditHelper(B._getFrameRenderOptions("renderAxis")!==!1,B._getFrameRenderOptions("renderEdit")!==!1),L.blend.enabled=!1,L.depth.mask=!0),L.depth.enabled=!0,X&&hc(o,k),ph(o,F),vc(o,F),B._44Q=-1,B._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(k,p){if(k||p){var C=this,s=C.getGL(),E=C._prg,f=C._frameState,X=f.renderState,j=X.glState,K=X.directUniforms();f.renderState.attribs.disable(),j.depth.enabled=!1,K.uTransparent=!1,K.shadowReceive=!1,j.blend.enabled=!1,j.depth.mask=!0,K.uPick=C._picking,k&&C._32O._42(s,E),p&&C._30O._42(s,E),ph(s,F),vc(s,F)}},renderLayers:function(u,m){m&&(u=jg(u));for(var w=0,F=u.length;F>w;w++)this.renderLayer(u[w])},addRenderLayerListener:function(i,l,Z){var Y=this;Y._renderLayerNotifier||(Y._renderLayerNotifier=new Zb),Y._renderLayerNotifier.add(i,l,Z)},removeRenderLayerListener:function(u,M){this._renderLayerNotifier&&this._renderLayerNotifier.remove(u,M)},fireRenderLayerEvent:function(a,e){var q=this._renderLayerNotifier;q&&q.fire({layer:a,phase:e})},renderLayer:function(s){var q=this,i=q._picking,n=q._40Q.get(s);if(n){q.fireRenderLayerEvent(s,"prepare");var r=q.getGL(),N=jj[s],C=q._frameState,B=C.renderState,Q=B.glState,W=B.directUniforms();!i&&q.isSortable()&&n.sort(q._sortFunc,q._projScreenMatrix);var U,O,E,Y=n.opaque,t=n.transparent,R=n.batchModelMap,V=n.polylineModelMap,b=n.wireframeModelMap,r=q.getGL(),u=q._prg;i||(Q.blend.enabled=!1,Q.depth.enabled=!0,Q.depth.mask=!0),W.uTransparent=!1,N.clearDepth!==!1&&r.clear(r.DEPTH_BUFFER_BIT);var y=this.drawFilter;if(y)for(E=Y,U=0,O=E.length;O>U;U++)y(E[U].data)!==!0&&E[U].ui._42(r,u,p);else{for(E=Y,U=0,O=E.length;O>U;U++)E[U].ui._42(r,u,p);if(i)for(E=t,U=0,O=E.length;O>U;U++)E[U].ui._46Q(r);bg(q,R),Fc(q,V),Fc(q,b)}if(i||(Q.blend.enabled=!0,Q.depth.mask=!1),q._45Q=W.uTransparent=!0,y)for(E=t,U=0,O=E.length;O>U;U++)y(E[U].data)!==!0&&E[U].ui._42(r,u,$);else{for(E=t,U=0,O=E.length;O>U;U++)E[U].ui._42(r,u,$);bg(q,R,null,!0),Fc(q,V,null,!0),Fc(q,b,null,!0)}q._45Q=null,q.fireRenderLayerEvent(s,"post")}},_42:function(J,O){var i=this;if(!i._35O&&(!Pp||bl(Pp))){var $=i.getWidth(),S=i.getHeight();if($&&S){var T=i.getGL();if(T){var E,z=i._canvas;if(J?E=!0:J=i.getDevicePixelRatio(),!i._picking&&(E||$!==z.clientWidth||S!==z.clientHeight)){Db(z,$,S,J);var R=J;$&&Math.abs(T.drawingBufferWidth-$*J)>1&&(R=Math.min(R,T.drawingBufferWidth/$)),S&&Math.abs(T.drawingBufferHeight-S*J)>1&&(R=Math.min(R,T.drawingBufferHeight/S)),R!==J&&(i.setDevicePixelRatio(J=R),Db(z,$,S,J)),i._18Q=null}T.clear(T.COLOR_BUFFER_BIT);var M=T._renderInfo;M.calls=0,M.vertices=0,M.faces=0,M.lines=0,M.points=0,M.textureCache={time:0,count:0,pixels:0},M.frame=++i._frameId,M.cacheTimeCost=0,M.reflectDepth=0,$*=J,S*=J,this.syncRenderState();do{if(i.isVREnabled()&&i.vr.render(T,$,S,O))break;if(i.updateScene(),i._postProcessing.render(T,$,S,O))break;i.setViewport(T,0,0,$,S),i.renderScene(O)}while(!1);i._33Q=!1,i.countFrame(),i._doBufferGC(T)}}}},syncRenderState:function(){var M,r;(M=this._frameState)&&(r=M.renderState)&&r.syncLoss()},drawReflectors:function($){$._renderInfo.reflectDepth++;var i,X,c,t=this,M=t._dataModel.getReflectors(),L=!1;for(i in M)X=M[i],t.isVisible(X)&&(c=t.getData3dUI(X),c&&c.drawReflector($)&&(L=!0));return $._renderInfo.reflectDepth--,L},isReflecting:function(A){return A._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(a,d){return this._postProcessing.enableModule(a,d)},getPostProcessingModule:function(b){return this._postProcessing.getModule(b)},getPostProcessingValue:function(P,$){var c=this._postProcessing.getModule(P);return c?c[$]:_},setPostProcessingValue:function(p,u,i){var l=this.getPostProcessingValue(p,u),W=this._postProcessing.getModule(p);W&&l!==i&&("enable"===u?this.enablePostProcessing(p,i):W[u]=i,this.firePropertyChange("postProcessing."+p+"."+u,l,i))},setViewport:function(T,H,O,_,Y){this._viewport=[H,O,_,Y],zs.for(T).directState().viewport=this._viewport},getRenderState:function(){return zs.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(o){this._bufferGCInterval=o},_doBufferGC:function(Z,Y){var O,M,e=Z._bufPool,R=0,_=0,h=Z._renderInfo.frame,I=this._bufferGCInterval||10;for(O in e)R++,M=e[O],M&&(Y||h-M._fid>I?(Z.deleteBuffer(M._buf),M._buf=null,e[O]=null):_++);if(R/2>_&&R>128){var j={};for(O in e)e[O]&&(j[O]=e[O]);Z._bufPool=j}Z._validBufCount=_},_swapLineMap:function(){var G=this;Kf=G._polylineModelMap,G._polylineModelMap=G._polylineModelMapSwap,G._polylineModelMapSwap=Kf,Kf=G._wireframeModelMap,G._wireframeModelMap=G._wireframeModelMapSwap,G._wireframeModelMapSwap=Kf,Kf=G._polylineIndexMap,G._polylineIndexMap=G._polylineIndexMapSwap,G._polylineIndexMapSwap=Kf,Kf=G._wireframeIndexMap,G._wireframeIndexMap=G._wireframeIndexMapSwap,G._wireframeIndexMapSwap=Kf},_updateSkybox:function(H){if(this._skybox&&H){var X=H.property,F=!1,C=this._skybox;if("eye"===X||"forceUpdate"===X){var E=this._eye;C.p3(E[0],E[1],E[2]),F=!0}if("near"===X||"far"===X||"forceUpdate"===X||"asceptChanged"===X){var G=C.__cachedS3__;G||(G=C.__cachedS3__=C.getFinalScale3d());var p=Math.sqrt(3),n=1/0,D=-1/0;G.forEach(function(q){q/=2,n=B(q,n),D=i(q,D)}),D*=p;var q=this._near,Z=this._far,d=Math.tan(this.getFovy()/2)*q,O=this.getAspect()*d,l=1.1*Math.sqrt(O*O+d*d+q*q),s=1;if(l>n)s=l/n;else if(D>=Z){var J=Z*Z/(q+Z);s=J/D}if(1!==s){C.__updatingSkybox__=!0;var u=C.getScale3d().map(function(i,X){return i*s*G[X]});C.s3(u),C.setScale3d(1,1,1),F=!0,delete C.__updatingSkybox__}}F&&this.invalidateData(C)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(A){return this.setSkybox(A)},getSkybox:function(){return this._skybox},setSkybox:function(n){var W=this._skybox;if(W===n)return n&&this._updateSkybox({property:"forceUpdate"}),void 0;if(W&&(this._skyboxStyleMap&&W.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&W.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&W.p3(this._skyboxP3),this._skyboxP3=null),this._skybox=n,this.ump(this._updateSkybox,this),n){n.dm()&&n.dm().remove(n),this._skyboxStyleMap=V.Default.clone(n.getStyleMap()),this._skyboxAnchor3d=n.getAnchor3d(),n.setAnchor3d(.5,.5,.5),this._skyboxP3=n.p3().slice(0),n.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var L=n.onPropertyChanged;n.onPropertyChanged=function(P){L.call(n,P),!n.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(P.property)>=0&&(n.__cachedS3__=_)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",W,n)},drawSky:function(H,B){var E=this,s=E._skybox;if(s){var A=zs.for(H).directUniforms(),S=E._headlightIntensity,r=Sj(E._headlightColor),B=E._prg;1!==S&&(r=[r[0]*S,r[1]*S,r[2]*S]),A.uHeadlightColor=[r[0],r[1],r[2],1];var Y=E.getData3dUI(s);if(Y){var b=E.isOrtho(),k=b||this._computedProjectMatrix;if(k){var C=E._projectMatrix;b&&(E._ortho=!1),A.uPMatrix=E._projectMatrix=js(E,!0)}var q=s.p3(),X=this._eye;(q[0]!==X[0]||q[1]!==X[1]||q[2]!==X[2])&&(s._position.x=X[0],s._54O=X[1],s._position.y=X[2]),Y.validate(),Y._42(H,B,I),k&&(b&&(E._ortho=!0),A.uPMatrix=E._projectMatrix=C)}H.clear(H.DEPTH_BUFFER_BIT),A.uHeadlightColor=[r[0],r[1],r[2],E._headlightDisabled?1:0]}},getLogicalPoint:function(W){return hl(W,this._canvas)},isRectOverlapping:function(R){var o=this.getData3dUI(R);return o._rectOverlapping},getHitFaceInfo:function(S){S.target&&(S=this.lp(S));var w=this.getDataInfoAt(S);if(w){var K=this.intersectObject(S,w.data);if(K)return{data:w.data,face:K.part}}return F},unproject:function(E,h){var y=this,S=y.getWidth(),e=y.getHeight(),r=E.target?y.lp(E):E,C=r.x-S/2,D=r.y-e/2,f=2*(C/S),j=2*(-1*D/e);h=h||0;var m=Bf(),a=js(y),t=Bc(y);Si(m,a,t),Uo(m);var g=lr([f,j,h,1],m);return[g[0]/g[3],g[1]/g[3],g[2]/g[3]]},getDataAt:function(K){var z=this.getDataInfoAt(K);return z?z.data:F},getDataInfoAt:function(U,G,t){return U.target&&(U=this.lp(U)),this._1o.get(ac(U.x,U.y,G),!0,t)},getDatasInRect:function(R,T){return this._1o.get(R,!1,T)},setEditable:function(h){var O=this,X=O._editable;O._editable=h,this.fp(ms,X,h)},isEditable:function(E){var n=this;return E?n._editable?be(E)?E.s("3d.editable")?n._editableFunc?n._editableFunc(E):!0:!1:!1:!1:n._editable},isSelectable:function(u){return u.s("3d.selectable")&&this.sm().isSelectable(u)},isMovable:function(v){var k=this;return Cm(v)&&v.getStyle(ss)!==Gf?!1:v.s("3d.movable")?k._movableFunc?k._movableFunc(v):!0:!1},isSizeEditable:function(H){return be(H)?this._sizeEditableFunc?this._sizeEditableFunc(H):!0:!1},isRotationEditable:function(R){return be(R)&&R.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(R):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(F){this.setZoom(Ig,F)},zoomOut:function(d){this.setZoom(1/Ig,d)},setZoom:function(){var L=new io,G=new io,q=new io,S=new io;return function(u,s){if(1!==u){var E=this;E._14o&&E._14o.stop(!0);var e,F=1/u;L.copy(E.getCenter()),G.copy(E.getEye());var c=E._ortho;if(c){if(e=E._orthoWidth,e<E._moveStep&&u>1)return}else if(L.distanceTo(G)<E._moveStep&&1>F)return;var H=!1;return E._zoomToCenter===!1&&E._lastZoomLP&&(q.copy(G).sub(L).normalize(),E._81O=null,S.copy(E.getHitPosition(E._lastZoomLP,L.toArray(),q.toArray())),H=!0,E._lastZoomHit=S),(s=Nk(s))?(s.action=function(f){E.fi({kind:E._zooming?"betweenZoom":"beginZoom"}),E._zooming=1;var Y=(F-1)*f+1;c&&E.setOrthoWidth(e*Y),H?(E.setEye(q.lerpVectors(S,G,Y).toArray()),E.setCenter(q.lerpVectors(S,L,Y).toArray())):c||E.setEye(q.lerpVectors(L,G,Y).toArray())},s._37o=function(){delete E._14o,delete E._zooming,E.fi({kind:"endZoom"}),E.onZoomEnded()},E._14o=$h(s)):(c&&E.setOrthoWidth(e*F),H?(E.setEye(q.lerpVectors(S,G,F).toArray()),E.setCenter(q.lerpVectors(S,L,F).toArray())):c||E.setEye(q.lerpVectors(L,G,F).toArray()),void 0)}}}(),setOrthoZoom:function(O,D){return this.setZoom(O,D)},getPositionInfo:function(Z){var j=this,b=j._eye,$=j._center,a=j.getAspect(),z=Z?Ze(No($,b,!0),No(Z,b)):kj(b,$);if(j._ortho){var D=j._orthoWidth;return{length:z,height:D/a,width:D}}var g=2*ar(j._fovy/2)*z;return{length:z,height:g,width:g*a}},getCenterInfo:function(){var K=this;return K._81O||(K._81O=K.getPositionInfo()),Hq(K._81O)},rotate:function(r,w,C,R){var J=this;if(r||w){R==F&&(R=J._firstPersonMode),J._88O&&J._88O.stop(!0);var v=J._center,s=J._eye,c=J.getCenterInfo().length,H=R?v:s,f=R?s:v,O=No(H,f),j=ub(O[0],O[2]),b=ub(A(O[0]*O[0]+O[2]*O[2]),O[1]),l=R?Pd:im;return R&&(w=-w),(C=Nk(C))?(C.action=function(P){J.fi({kind:J._rotating?"betweenRotate":"beginRotate"}),J._rotating=1;var U=j+r*P,n=b+w*P;n=R?Y-Xh(J,Y-n):Xh(J,n),O[0]=c*u(n)*u(U),O[1]=c*L(n),O[2]=c*u(n)*L(U),H[0]=f[0]+O[0],H[1]=f[1]+O[1],H[2]=f[2]+O[2],J.fp(l,F,H)},C._37o=function(){delete J._88O,delete J._rotating,J.fi({kind:"endRotate"}),J.onRotateEnded()},J._88O=$h(C)):(j+=r,b+=w,b=R?Y-Xh(J,Y-b):Xh(J,b),O[0]=c*u(b)*u(j),O[1]=c*L(b),O[2]=c*u(b)*L(j),H[0]=f[0]+O[0],H[1]=f[1]+O[1],H[2]=f[2]+O[2],J.fp(l,F,H),void 0)}},pan:function(X,R,O,u){if(X||R){var v=this;u==F&&(u=v._firstPersonMode),v._89O&&v._89O.stop(!0);var N=Bc(v),i=[N[0]*X,N[4]*X,N[8]*X],o=[N[1]*R,N[5]*R,N[9]*R],b=i[0]+o[0],c=i[1]+o[1],$=i[2]+o[2],m=v._center,J=v._eye;if(u){var S=Gm(v.getBoundaries(),J[0],J[2],J[0]+b,J[2]+$,A(b*b+$*$));b=S[0],$=S[1]}if(O=Nk(O)){var I=Hq(J),r=Hq(m);return O.action=function(y){v.fi({kind:v._panning?"betweenPan":"beginPan"}),v._panning=1,m[0]=r[0]+b*y,m[1]=r[1]+c*y,m[2]=r[2]+$*y,J[0]=I[0]+b*y,J[1]=I[1]+c*y,J[2]=I[2]+$*y,v.fp(im,F,J),v.fp(Pd,F,m)},O._37o=function(){delete v._89O,delete v._panning,v.fi({kind:"endPan"}),v.onPanEnded()},v._89O=$h(O)}m[0]+=b,m[1]+=c,m[2]+=$,J[0]+=b,J[1]+=c,J[2]+=$,v.fp(im,F,J),v.fp(Pd,F,m)}},walk:function(S,m,k){if(S){var g=this;k==F&&(k=g._firstPersonMode),g._90O&&g._90O.stop(!0);var V=g._center,P=g._eye,i=No(V,P,!0);if(k){var f=Gm(g.getBoundaries(),P[0],P[2],P[0]+i[0]*S,P[2]+i[2]*S,D(S));if(S=kj(f),!S)return;i=[f[0]/S,0,f[1]/S]}if(m=Nk(m)){var $=Hq(P),w=Hq(V);return m.action=function(m){g.fi({kind:g._walking?"betweenWalk":"beginWalk"}),g._walking=1;var U=S*m;P[0]=$[0]+i[0]*U,P[1]=$[1]+i[1]*U,P[2]=$[2]+i[2]*U,V[0]=w[0]+i[0]*U,V[1]=w[1]+i[1]*U,V[2]=w[2]+i[2]*U,g.fp(im,F,P),g.fp(Pd,F,V)},m._37o=function(){delete g._90O,delete g._walking,g.fi({kind:"endWalk"}),g.onWalkEnded()},g._90O=$h(m)}P[0]+=i[0]*S,P[1]+=i[1]*S,P[2]+=i[2]*S,V[0]+=i[0]*S,V[1]+=i[1]*S,V[2]+=i[2]*S,g.fp(im,F,P),g.fp(Pd,F,V)}},handleScroll:function(r,D){Qq(r);var V=this,x=V._moveStep,y=V.getDataInfoAt(r);if(y){var J=y.data;if(J&&V.isInteractive(J)){var q=V.intersectObject(r,J);if(q){var B=q.part,K=ij(J.s(B+".image")||J.s("shape3d."+B+".image")||J.s("all.image")||J.s("shape3d.image"));if(K&&cs(K.scrollable,J,V))return}}}return V.isFirstPersonMode()?(V.isPannable()&&V.pan(0,D>0?x:-x),void 0):(V.isZoomable()&&(V._lastZoomLP=V.lp(r),V.setZoom(0>D?1/Ke:Ke),V._lastZoomLP=V._lastZoomHit=null),void 0)},handlePinch:function(f,K){if(this.isZoomable()){if(Math.abs(f-K)<C.pinchZoomThreshold)return;this.setZoom(K>f?1/wb:wb)}},reset:function(w){this.setUp(C.graph3dViewUp),this.moveCamera(C.graph3dViewEye,C.graph3dViewCenter,w)},moveSelection:function(O,C,N){var S=this;S.dm().beginTransaction(),mr(this.sm().toSelection(this.isMovable,this),O,C,N),S.dm().endTransaction()},getMoveMode:function(U,e){var m=e.s("3d.move.mode");if(m)return m;var r="88",I="89",T="90";return er(U)||Wc[r]&&Wc[I]&&Wc[T]?"xyz":Wc[r]&&Wc[I]?"xy":Wc[r]&&Wc[T]?"xz":Wc[I]&&Wc[T]?"yz":Wc[r]?"x":Wc[I]?"y":Wc[T]?"z":"xz"},handleTick:function(){var y=this,g=!1,j=y._moveStep,D=j,Z=!1,c=!0,d=y._rotateStep*(c?-1:1);if(y.isWalkable()||(D=0),y.isPannable()||(j=0),y.isRotatable()||(d=0),y._32Q){var A=(Ln()-y._32Q)/50;D*=A,j*=A,d*=A}y._31Q&&(Fg(y._31Q),delete y._31Q,delete y._32Q),pp()&&(g=!0,y.pan(-j,0,Z,c)),yq()&&(g=!0,y.pan(j,0,Z,c)),Nc()&&(g=!0,er()?y.pan(0,j,Z,c):y.walk(D,Z,c)),_j()&&(g=!0,er()?y.pan(0,-j,Z,c):y.walk(-D,Z,c)),Re()&&(g=!0,y.rotate(-d,0,Z,c)),se()&&(g=!0,y.rotate(d,0,Z,c)),Wk()&&(g=!0,y.rotate(0,-d/2,Z,c)),mo()&&(g=!0,y.rotate(0,d/2,Z,c)),g&&(y._32Q=Ln(),y._31Q=Vp(y.handleTick,y))},handleKeyDown:function(d){var t=this;!Ef(d)&&Nh[d.keyCode]?t.handleTick():Oh(d)?t.selectAll():sl(d)?t.handleDelete(d):pc(d)&&this.isResettable()&&t.reset()},checkDoubleClickOnNote:function(O,y,E){var k=this;if(E===Jm){if(y.s("note.toggleable"))return y.s(nh,!y.s(nh)),k.fi({kind:"toggleNote",event:O,data:y,part:E}),!0}else if(E===Eq&&y.s("note2.toggleable"))return y.s(Op,!y.s(Op)),k.fi({kind:"toggleNote2",event:O,data:y,part:E}),!0;return!1},checkDoubleClickOnRotation:function(O,B,R){return R===bs?(B.setRotationX(0),!0):R===fb?(B.setRotationY(0),!0):R===Ds?(B.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(X){var q=this;if(q.isOrtho())return q.getWidth()/q.getOrthoWidth();var D=q.getCenter(),f=q.getHeight(),Z=q.getEye(),$=[D[0]-Z[0],D[1]-Z[1],D[2]-Z[2]],S=[X[0]-Z[0],X[1]-Z[1],X[2]-Z[2]],l=Math.sqrt($[0]*$[0]+$[1]*$[1]+$[2]*$[2]),H=1/Math.tan(q.getFovy()/2);return f*l*H/(S[0]*$[0]+S[1]*$[1]+S[2]*$[2])},inViewSpace:function(C){var o,O=this,e=O._transformPointToViewSpace(C),X=O.getAspect(),u=O.getNear(),H=O.getFar();return-e[2]<u||-e[2]>H?!1:O.isOrtho()?(o=O.getOrthoWidth()/2,Math.abs(e[0])<=o&&Math.abs(e[1]*X)<=o):(o=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])*Math.tan(O.getFovy()/2),Math.abs(e[1]<=o)&&Math.abs(e[0])<=o*X)},getPVMatrix:function(){var K,B=this;return(K=B._18Q)||(K=js(B),B._18Q=Si(K,K,Bc(B)),B._18Q._wh=B.getWidth()/2/B.getHeight()),K},getFrustum:function(){var m=new bf,M=new Sg,D=new Array(16);return function(){for(var y=this.getPVMatrix(),$=!1,Q=0;16>Q;Q++)y[Q]!==D[Q]&&($=!0,D[Q]=y[Q]);return $&&M.setFromMatrix(m.fromArray(y)),M}}(),toViewPosition:function(R){var Y=this,z=Y.getWidth()/2,b=Y.getHeight()/2,Z=Y.getPVMatrix();return R=lr([R[0],R[1],R[2],1],Z),{x:z+z*R[0]/R[3],y:b-b*R[1]/R[3],z:R[2]/R[3]}},getHitPosition:function(c,U,H){var v=this,X=v.getWidth(),s=v.getHeight(),Z=c.target?v.lp(c):c,q=Z.x-X/2,k=Z.y-s/2,K=v.getCenterInfo(),x=Bc(v);U=U?U:[0,0,0],H=H?H:[0,1,0],q=q/X*K.width,k=-1*k/s*K.height;var L=[x[0]*q,x[4]*q,x[8]*q],r=[x[1]*k,x[5]*k,x[9]*k],h=[L[0]+r[0],L[1]+r[1],L[2]+r[2]],W=v.getCenter(),$=Jo(v,U,H,[h[0]+W[0],h[1]+W[1],h[2]+W[2]]);return $?$:[0,0,0]},intersectObject:function(q,B){return this._raycaster.intersectObject(q,B)},intersectObjects:function(r,m,b){return this._raycaster.intersectObjects(r,m,b)},getLineLength:function(F){this.validate();var f=this.getData3dUI(F);if(f&&f.getCache){var d=f.getCache();if(d)return d[d.length-1].length}return 0},getLineOffset:function(B,m){var a=this.getData3dUI(B);if(a&&a.getCache){var S=a.getCache();if(S){var e=ll(S,m);
if(!B.r3)return e;var g=B.r3();if(0===g[0]&&0===g[1]&&0===g[2])return e;var i=new io(B.p3()),f=new io(e.point).sub(i),d=new io(e.tangent).add(f),b=(new Cj).setFromEuler(new kn(g,B.getRotationMode(),!0));return f.applyQuaternion(b),d.applyQuaternion(b),{point:f.add(i),tangent:d.sub(f).normalize()}}}return F},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(G,i,Y){var l=this,F=l.getEye();F=[F[0],F[1],F[2]];var H=l.getCenter();if(H=[H[0],H[1],H[2]],G||(G=F),i||(i=H),l._flyAnim&&l._flyAnim.stop(!0),Y=Nk(Y),!Y)return l.setEye(G[0],G[1],G[2]),l.setCenter(i[0],i[1],i[2]),delete l._flyAnim,!0;var _=[G[0]-F[0],G[1]-F[1],G[2]-F[2]],K=[i[0]-H[0],i[1]-H[1],i[2]-H[2]];return Y.action=function(N){l.setCenter(H[0]+K[0]*N,H[1]+K[1]*N,H[2]+K[2]*N),l.setEye(F[0]+_[0]*N,F[1]+_[1]*N,F[2]+_[2]*N)},Y._37o=function(){delete l._flyAnim},l._flyAnim=$h(Y)},flyTo:function(){function j(T,$,M){if(M instanceof V.Node){W.fromArray(Vl(M,$.getMat(M)));var a=M.getAnchor3d();T.push((new io).set(0-a.x,0-a.y,0-a.z).applyMatrix4(W)),T.push((new io).set(0-a.x,0-a.y,1-a.z).applyMatrix4(W)),T.push((new io).set(0-a.x,1-a.y,0-a.z).applyMatrix4(W)),T.push((new io).set(0-a.x,1-a.y,1-a.z).applyMatrix4(W)),T.push((new io).set(1-a.x,0-a.y,0-a.z).applyMatrix4(W)),T.push((new io).set(1-a.x,0-a.y,1-a.z).applyMatrix4(W)),T.push((new io).set(1-a.x,1-a.y,0-a.z).applyMatrix4(W)),T.push((new io).set(1-a.x,1-a.y,1-a.z).applyMatrix4(W))}}var O=new io,R=new io,u=new io,J=new io,W=new bf,H=new V.Math.Quaternion,F=new kn,r=new fq;return function(w,M,Q){var d=this;if(Q!==_)M={animation:M,ratio:Q};else{var $=typeof M;("boolean"===$||"object"===$&&M.duration)&&(M={animation:M})}M=M||{},O.fromArray(d.getEye()),R.fromArray(d.getCenter());var K,C,h=[],T=M.center,f=M.distance===_;if(T&&u.fromArray(T),w||(w=d.dm().getDatas()),1===w.length&&(w=Tm(w)?w.get(0):w[0]),w instanceof V.Node)T||u.fromArray(w.p3()),f&&(j(h,d,w),K=h.length);else{if(!w.length)return;if((f||!T)&&(h=[],w.forEach(function(A){j(h,d,A)}),K=h.length,!K))return;T||(r.setFromPoints(h),u.copy(r.min).add(r.max).multiplyScalar(.5))}if(d.setCenter(u.x,u.y,u.z),J.subVectors(O,R),M.direction||M.worldDirection){!M.worldDirection&&w instanceof V.Node?H.setFromEuler(F.set(w.r3(),w.getRotationMode(),!0)):H.set(0,0,0,1);var l=J.length();J.fromArray(M.worldDirection||M.direction).applyQuaternion(H).setLength(l)}var D=0;if(f){var g,U,A,Q=M.ratio||.8,t=M.xRatio||Q,L=M.yRatio||Q;if(d.isOrtho()){var y=-1/0;for(d._eye[0]=J.x+u.x,d._eye[1]=J.y+u.y,d._eye[2]=J.z+u.z,g=js(d),Si(g,g,Bc(d)),C=0;K>C;C++)A=h[C],U=lr([A.x,A.y,A.z,1],g),y=Math.max(y,Math.max(Math.abs(U[0])/t,Math.abs(U[1])/L));D=d.getOrthoWidth()*y,J.add(u)}else{for(var Z,z,b=d.getNear(),o=10;o--;){for(d._eye[0]=J.x+u.x,d._eye[1]=J.y+u.y,d._eye[2]=J.z+u.z,g=js(d),Si(g,g,Bc(d)),Z=!0,z=-1/0,C=0;K>C;C++){if(A=h[C],U=lr([A.x,A.y,A.z,1],g),U[3]<b&&o){J.multiplyScalar(2),Z=!1;break}z=Math.max(z,Math.max(Math.abs(U[0])/t,Math.abs(U[1])/L)-U[3])}if(Z)break}J.setLength(z+J.length()).add(u)}}else J.setLength(M.distance).add(u);d._flyAnim&&d._flyAnim.stop(!0);var e=Nk(M.animation);if(e){d.setEye(O.x,O.y,O.z),d.setCenter(R.x,R.y,R.z);var B=(new io).subVectors(J,O),E=(new io).subVectors(u,R);if(D)var a=d.getOrthoWidth();var n=new io,I=new io,N=e.action,x=e._37o,v=O.clone(),X=R.clone();return e.action=function(W,h){n.copy(v).addScaledVector(B,W),I.copy(X).addScaledVector(E,W),d.setCenter(I.x,I.y,I.z),d.setEye(n.x,n.y,n.z),D&&d.setOrthoWidth((D-a)*W+a),N&&N(W,h)},e._37o=function(){delete d._flyAnim,x&&x()},{lastEye:O,lastCenter:R,eye:J,center:u,orthoWidth:D,animation:d._flyAnim=$h(e)}}return d.setEye(J.x,J.y,J.z),D&&d.setOrthoWidth(D),delete d._flyAnim,{lastEye:O,lastCenter:R,eye:J,center:u,orthoWidth:D}}}(),getBoundingBox:function(){function O(t,f,r){_.fromArray(Vl(r,f.getMat(r)));var D=r.getAnchor3d();t.push((new io).set(0-D.x,0-D.y,0-D.z).applyMatrix4(_)),t.push((new io).set(0-D.x,0-D.y,1-D.z).applyMatrix4(_)),t.push((new io).set(0-D.x,1-D.y,0-D.z).applyMatrix4(_)),t.push((new io).set(0-D.x,1-D.y,1-D.z).applyMatrix4(_)),t.push((new io).set(1-D.x,0-D.y,0-D.z).applyMatrix4(_)),t.push((new io).set(1-D.x,0-D.y,1-D.z).applyMatrix4(_)),t.push((new io).set(1-D.x,1-D.y,0-D.z).applyMatrix4(_)),t.push((new io).set(1-D.x,1-D.y,1-D.z).applyMatrix4(_))}var _=new bf;return function(j){if(j=j||this.sm().getSelection(),j instanceof V.Node&&(j=[j]),0===j.length)return F;var p=[];j.forEach(function(k){be(k)&&O(p,this,k)},this);var W=[1/0,1/0,1/0],k=[-1/0,-1/0,-1/0];return p.forEach(function(c){W[0]=Math.min(c.x,W[0]),W[1]=Math.min(c.y,W[1]),W[2]=Math.min(c.z,W[2]),k[0]=Math.max(c.x,k[0]),k[1]=Math.max(c.y,k[1]),k[2]=Math.max(c.z,k[2])}),{min:W,max:k}}}(),setBatchInfo:function(h,_){var W=this._batchInfoMap[h];this._batchInfoMap[h]=_,this.fp("batchInfo",W,_)},getBatchInfo:function(f){return this._batchInfoMap[f]||zf[f]},setOrthoWidth:function(g){var V=this._orthoWidth;if(this._orthoWidth=g,this._syncEyeWithOrthoWidth){var X=g/this.getAspect(),J=X/2/ar(this.getFovy()/2),$=(new io).fromArray(this.getEye()),A=(new io).fromArray(this.getCenter());$.sub(A).setLength(J).add(A),this.setEye($.toArray())}this.fp("orthoWidth",V,g)}}),Mj.RenderEnv=function(Z){this.gv=Z,this.enable=!1},f.defineProperties(Mj.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(k){this._debugOn=k,this.capture&&this.capture()}}}),f.assign(Mj.RenderEnv.prototype,{renderEnvToCube:function(t,R,N,q){var G=this,V=G.gv;if(!t||!R||!N)return G.enable=!1,G._42=null,void 0;G.enable=!0;var D=Math.floor(q/t*R),K=V.getGL(),f=G._renderTargets;f?f.length<N&&(f=G._renderTargets=f.concat(new Array(N-f.length))):f=G._renderTargets=new Array(N);for(var O=0;N>O;O++)f[O]?f[O].setSize(K,q,D):f[O]=new Mj.RenderTarget(V,K,q,D);var B=!1;G.capture=function(){B=!0,V._42(),B=!1};var z=new io,_=new io,m=new io,Q=new io,I=(new io).setY(0),L=2*Math.PI/N,c=t/2/Math.tan(Math.PI/N),h=2*Math.atan2(R/2,c),b=t/R;G._42=function(A,v,r,q){var x=G._debugOn;if(!B&&!x)return!1;z.copy(V.getEye()),Q.copy(V.getCenter()).sub(z);var o=Math.atan2(Q.z,Q.x),i=V.getNear(),g=V.getFovy(),u=V.getAspect();_.copy(V.getCenter());for(var k,K=0;N>K;K++)if(k=f[K],I.setZ(Math.cos(o)).setX(Math.sin(o)).multiplyScalar(c),o-=L,m.addVectors(z,I),V.setNear(c),V.setCenter([m.x,m.y,m.z]),V.setFovy(h),V.setAspect(b),x){var $=Math.round(v/N);zs.for(A).glState.viewport=[$*K,0,$,r],q()}else Oo(A,k.frame),zs.for(A).glState.viewport=[0,0,k.width,k.height],A.clear(A.COLOR_BUFFER_BIT),q(),sn(A),k.assureTexture();return V.setNear(i),V.setCenter([_.x,_.y,_.z]),V.setFovy(g),V.setAspect(u),!0},G.capture()},getTextureInfo:function(Q){var d=this._renderTargets;if(!d)return null;var N=this._renderTargets[Q];return N?{index:Q,texture:N.texture,textureName:N.uuid}:null}}),f.assign(Mj.Graph3dView.prototype,{renderEnvToCube:function(k,h,X,J){var P=this;P.envRenderer||(P.envRenderer=new Mj.RenderEnv(P)),P.envRenderer.renderEnvToCube(k,h,X,J)}});var dr=["left","front","right","back","top","bottom"],Vj=Mj._RenderList=function(){function C(){m.length=0,a.length=0,P={}}function d(C){var w,h,O,a,Q=C.gv,M=C.data,g=C.shapeModel;if(g){var b,P,u,A=M.s("shape3d.transparent")||M.s("points.transparent");for(mh(g)||(b=cs(g.transparent,M,Q),g=[g]),O=0,a=g.length;a>O;O++)u=g[O],P=cs(u.transparent,M,Q),P===_&&(P=b),P===_&&(P=A),P?h=!0:w=!0}for(O=0,a=dr.length;a>O;O++){var m=C[dr[O]];m&&(m.transparent?h=!0:w=!0)}Q.isLabelVisible(M)&&(C.labelInfo&&(M.s(Mi+".transparent")?h=!0:w=!0),C.label2Info&&(M.s(Nb+".transparent")?h=!0:w=!0)),Q.isNoteVisible(M)&&(C.noteInfo&&(M.s(Jm+".transparent")?h=!0:w=!0),C.note2Info&&(M.s(Eq+".transparent")?h=!0:w=!0)),C._38o&&(h=w=!0),h||(w=!0),C._renderParams={opaque:w,transparent:h}}function R(J,A){A&&d(J);var S=J.data,T=S._id;if(!P[T]){P[T]=!0;var e=J._renderParams;e&&e.visible!==!1&&(J={ui:J,data:S,z:0,id:T},e.opaque&&m.push(J),e.transparent&&a.push(J))}}function z(K,s){if(a.length>1){for(var g,m=0,v=a.length;v>m;m++)g=a[m].data.p3(),a[m].z=vr(g,s)[2];a.sort(K||M)}}function e(z){z?(ol(H,x,z),ol(U,g,z),ol(p,A,z)):(H=this.batchModelMap={},x=this.batchIndexMap={},U=this.polylineModelMap={},g=this.polylineIndexMap={},p=this.wireframeModelMap={},A=this.wireframeIndexMap={}),this.markBatchInvalid()}function G(n){n?ol(H,x,n):(H=this.batchModelMap={},x=this.batchIndexMap={}),this.markBatchInvalid()}function T(D){D?ol(U,g,D):(U=this.polylineModelMap={},g=this.polylineIndexMap={}),this.markBatchInvalid()}function r(x){x?ol(p,A,x):(p=this.wireframeModelMap={},A=this.wireframeIndexMap={}),this.markBatchInvalid()}function k(){return this._batchInvalid}function f(){this._batchInvalid=!0}function N(){this._batchInvalid=null}var m=[],a=[],H={},x={},U={},g={},p={},A={},P={};return{opaque:m,transparent:a,init:C,push:R,batchModelMap:H,batchIndexMap:x,polylineModelMap:U,polylineIndexMap:g,wireframeModelMap:p,wireframeIndexMap:A,ivBatch:e,ivModelBatch:G,ivPolylineBatch:T,ivWireframeBatch:r,markBatchInvalid:f,isBatchInvalid:k,onUpdated:N,sort:z}},Pk=Mj._RenderLists=function(){function B(){for(var j in N)N[j].init()}function j(){for(var Y in N)N[Y].onUpdated()}function C(l,J){l=l||"main";var y=N[l];return!y&&J&&(y=N[l]=new Vj),y}function $(Y,u){var N=Y.data.getRenderLayer(),V=C(N,!0);V.push(Y,u)}function s(d){for(var n in N)d(N[n])}var N={};return{init:B,onUpdated:j,get:C,push:$,each:s,lists:N}},yd=Mj.RenderTarget=function(I,M,q,g,F){var u=this;F=F||{},F.samples=Math.min(I._glCapabilities.maxSamples,F.samples&&F.samples>1&&2===I._webGLVersion?F.samples:0),u.options=F,u.uuid=V.Math.generateUUID(),u.gv=I,u.init(I,M,F),F.samples&&!I._glCapabilities._maxSamplesChecked?u.setSize(M,q||1,g||1):u.setSize(M,q,g)};f.assign(Mj.RenderTarget.prototype,{bind:function(W){Oo(W,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(x){sn(x),this.options.samples&&(x.bindFramebuffer(x.READ_FRAMEBUFFER,this._MSAAFbo),x.bindFramebuffer(x.DRAW_FRAMEBUFFER,this.frame),x.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,x.COLOR_BUFFER_BIT,x.NEAREST),x.bindFramebuffer(x.READ_FRAMEBUFFER,null),x.bindFramebuffer(x.DRAW_FRAMEBUFFER,null))},init:function(c,v,z){var X=this,f=X.texture=v.createTexture();v.activeTexture(v.TEXTURE0),ri(v,f);var O=z.samples,_=O?v.NEAREST:v.LINEAR;v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,z.minFilter||_),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,z.magFilter||_),ri(v,null),X.render=v.createRenderbuffer(),X.frame=v.createFramebuffer(),c._2O[X.uuid]=f},assureTexture:function(){var I=this,L=I.uuid,Y=I.gv._2O;Y[L]||(Y[L]=I.texture)},setSize:function(i,t,b){var x=this;if(t&&b&&(x.width!==t||x.height!==b)){var _=i.RGBA,h=i.TEXTURE_2D,f=i.RENDERBUFFER,m=i.FRAMEBUFFER,p=x.options.samples;if(i.activeTexture(i.TEXTURE0),ri(i,x.texture),i.texImage2D(h,0,_,t,b,0,_,i.UNSIGNED_BYTE,F),Jr.isPOT(t)&&Jr.isPOT(b)&&!x.options.clampToEdge?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),i.bindRenderbuffer(f,x.render),p){var V=x.gv._glCapabilities;if(V._maxSamplesChecked)i.renderbufferStorageMultisample(f,p,i.DEPTH_COMPONENT16,t,b);else{for(i.getError();p>1&&(i.renderbufferStorageMultisample(f,p,i.DEPTH_COMPONENT16,t,b),i.getError());)p=Math.floor(p>>1);1>=p&&(p=0,i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,x.options.minFilter||i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,x.options.magFilter||i.LINEAR),i.renderbufferStorage(f,i.DEPTH_COMPONENT16,t,b)),V._maxSamplesChecked=!0,V.maxSamples=x.options.samples=p}}else i.renderbufferStorage(f,i.DEPTH_COMPONENT16,t,b);p&&!x._MSAAFbo&&(x._MSAAFbo=i.createFramebuffer(),x._MSAARbO=i.createRenderbuffer()),Oo(i,x.frame),i.framebufferTexture2D(m,i.COLOR_ATTACHMENT0,h,x.texture,0),p||i.framebufferRenderbuffer(m,i.DEPTH_ATTACHMENT,f,x.render),sn(i),p&&(i.bindRenderbuffer(i.RENDERBUFFER,x._MSAARbO),i.renderbufferStorageMultisample(i.RENDERBUFFER,p,i.RGBA8,t,b),Oo(i,x._MSAAFbo),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,x._MSAARbO),i.framebufferRenderbuffer(m,i.DEPTH_ATTACHMENT,f,x.render),sn(i)),ri(i,F),i.bindRenderbuffer(f,F),x.width=t,x.height=b}},toCanvas:function(){var h=this,g=h.gv.getGL();Oo(g,h.frame);var b=h.width,H=h.height,y=new Uint8Array(4*b*H);g.readPixels(0,0,b,H,g.RGBA,g.UNSIGNED_BYTE,y),sn(g);var A=v.createElement("canvas");A.width=b,A.height=H;var I=A.getContext("2d"),F=I.createImageData(b,H);return F.data.set(y),I.putImageData(F,0,0),A}});var rf=Mj.Interactor=function(p){this.gv=this.g3d=p};ld("Interactor",f,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(E){this.gv.fi(E)},startDragging:function(e){$l(this,e)}});var el=Mj.DefaultInteractor=function(j){tl(el,this,[j])};ld("DefaultInteractor",rf,{getState:function(){return this._62O},setState:function(x){this._62O=x},getDataInfoAt:function(S,a){var C=this.gv,p=C.getDataInfoAt(S);if(!C.isBlockSelectable()||!p||!p.data)return p;if(!a&&C.isSelected(p.data))return p;for(var U=p.data;(U=U.getParent())&&U instanceof V.Block&&C.isSelectable(U);){var A=C.isSelected(U);if(A&&a)break;if(p={data:U,part:p.part},A&&!a)break}return p},handle_contextmenu:function(N){Qq(N)},handle_mousewheel:function(M){this.gv.handleScroll(M,M.wheelDelta/40)},handle_DOMMouseScroll:function(E){2===E.axis&&this.gv.handleScroll(E,-E.detail)},handle_keydown:function(w){this.gv.handleKeyDown(w)},handle_mousedown:function($){this.handle_touchstart($)},handle_touchstart:function(e){Qq(e);var S=this,Q=S.gv,b=Ab(e),C=S.getDataInfoAt(e),p=C?C.data:F,G=C?C.part:F,l=Q.sm(),y=xg(e),J=_k(e);Q.setFocus(e)&&(S._62O=F,S._57I=F,S.pendingClickThrough=F,S.__lastClientPoint__=ci(e),p?Ef(e)?l.co(p)?l.rs(p):l.as(p):l.co(p)?p instanceof rs&&p.isClickThroughEnabled()&&Ab(e)&&(S.pendingClickThrough=ci(e)):l.ss(p):b&&(Ef(e)?Q.isRectSelectable()&&(S._62O=kl):S._57I=ci(e)),S._31Q&&(Fg(S._31Q),delete S._31Q,delete S._32Q),S._62O||(Q.isFirstPersonMode()&&(er(e)||Gq(e)||J>2?S._62O="pan":Q.isMouseRoamable()||os(e)?(S._62O="roaming",S.foward=y&&Ab(e),S._32Q=Ln(),S._31Q=Vp(S.tick,S)):b||(S._62O="roaming")),S._62O||(b&&y&&Hs[G]?(S._62O=G,S.p3=p.p3()):b&&y&&be(p)&&Q.isSelected(p)?Q.isMovable(p)?(S._62O="move",S.p3=p.p3(),S.movedata=p):Q._39Q(p)&&(S._62O="none"):os(e)&&(J>2?S._62O="pan":2===J&&(S.dist=Ce(e),S._62O="pinch")))),S.point=Q.lp(e),$l(S,e),gm(e)?Q.handleDoubleClick(e,p,G):Q.handleClick(e,p,G))},tick:function(){var e=this,k=e.gv,S=k._moveStep;e.point&&k.isWalkable()&&(e._32Q&&(S*=(Ln()-e._32Q)/50),k.walk(e.foward?S:-S),e._32Q=Ln(),e._31Q=Vp(e.tick,e))},handle_mouseup:function(k){this.handle_touchend(k)},handle_touchend:function(d){var f=this._57I;if(f&&(kj(f,ci(d))<=1&&this.gv.sm().cs(),this._57I=F),f=this.pendingClickThrough){if(kj(f,ci(d))<=1){var o=this.getDataInfoAt(d);o&&o.data instanceof rs&&o.data.isClickThroughEnabled()&&(o=this.getDataInfoAt(d,!0),o&&(d.clickThrough=!0,this.gv.sm().ss(o.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowTouchMove:function(f){var c,L,B=this,v=B.gv,U=B._62O,n=B.point,X=v.dm(),O=v.lp(f),J=O.x-n.x,N=O.y-n.y,o=v.getWidth(),i=v.getHeight();if(o&&i){var G=ci(f),Q=Bp(v,G,B.__lastClientPoint__),u=kj({x:0,y:0},Q),x=-E*J/o,A=-E*N/i;if("roaming"===U)B.rotate(f,x/2,A/2);else if(U===bs||U===fb||U===Ds)v._86O||X.beginTransaction(),v.fi({kind:v._86O?"betweenEditRotation":"beginEditRotation",event:f}),v._86O=1,v.sm().each(function(o){if(be(o)&&v.isRotationEditable(o)){var L=D(x)>D(A)?x:A;U===bs?o.setRotationX(o.getRotationX()+L):U===fb?o.setRotationY(o.getRotationY()+L):U===Ds&&o.setRotationZ(o.getRotationZ()+L)}});else if("move"===U||Hs[U]){if(U===Es||U===Fs||U===Gs)v._87O||X.beginTransaction(),v.fi({kind:v._87O?"betweenEditScale":"beginEditScale",event:f}),v._87O=1;else{if(!v._moving){if(u<C.touchMoveThreshold)return;X.beginTransaction()}v.fi({kind:v._moving?"betweenMove":"beginMove",event:f}),v._moving=1}var l,m=B.p3,z=v.getPositionInfo(m),S=Bc(v);l=U===Vd?"x":U===Jc?"y":U===Ld?"z":U===Es?"sx":U===Fs?"sy":U===Gs?"sz":v.getMoveMode(f,B.movedata),J=J/o*z.width,N=-1*N/i*z.height;var s,$,e=[S[0]*J,S[4]*J,S[8]*J],g=[S[1]*N,S[5]*N,S[9]*N],Y=e[0]+g[0],W=e[1]+g[1],K=e[2]+g[2],r=[m[0]+Y,m[1]+W,m[2]+K],I=No(v.getEye(),r,!0);if("xyz"===l?(s=r,v.moveSelection(Y,W,K)):"xz"===l?(s=Jo(v,m,[0,1,0],r),s&&v.moveSelection(s[0]-m[0],0,s[2]-m[2])):"xy"===l?(s=Jo(v,m,[0,0,1],r),s&&v.moveSelection(s[0]-m[0],s[1]-m[1],0)):"yz"===l?(s=Jo(v,m,[1,0,0],r),s&&v.moveSelection(0,s[1]-m[1],s[2]-m[2])):"x"===l||"sx"===l?(I[0]=0,s=Jo(v,m,I,r),s&&($=s[0]-m[0],"x"===l?v.moveSelection($,0,0):v.sm().each(function(W){be(W)&&v.isSizeEditable(W)&&(c=W.getScaleX()+$/100,L=c/W.getScaleX(),W.setScaleX(c),er(f)&&(W.setScaleY(W.getScaleY()*L),W.setScaleTall(W.getScaleTall()*L)))}))):"y"===l||"sy"===l?(I[1]=0,s=Jo(v,m,I,r),s&&($=s[1]-m[1],"y"===l?v.moveSelection(0,$,0):v.sm().each(function(l){be(l)&&v.isSizeEditable(l)&&(c=l.getScaleTall()+$/100,L=c/l.getScaleTall(),l.setScaleTall(c),er(f)&&(l.setScaleY(l.getScaleY()*L),l.setScaleX(l.getScaleX()*L)))}))):("z"===l||"sz"===l)&&(I[2]=0,s=Jo(v,m,I,r),s&&($=s[2]-m[2],"z"===l?v.moveSelection(0,0,$):v.sm().each(function(F){be(F)&&v.isSizeEditable(F)&&(c=F.getScaleY()+$/100,L=c/F.getScaleY(),F.setScaleY(c),er(f)&&(F.setScaleX(F.getScaleX()*L),F.setScaleTall(F.getScaleTall()*L)))}))),!s)return;B.p3=s}else if(U===kl){var b=B.div;b||(b=B.div=ir(),of(B.getView(),b),b.op=n,b.style.background=v.getRectSelectBackground()),v.fi({kind:v._rectSelecting?"betweenRectSelect":"beginRectSelect",event:f}),v._rectSelecting=1,b.rect=np(b.op,O),mm(b,b.rect)}else if("pinch"===U&&2===_k(f)){v.fi({kind:v._pinching?"betweenPinch":"beginPinch",event:f}),v._pinching=1;var $=Ce(f);v._lastZoomLP||(v._lastZoomLP=uf(f)),v.handlePinch($,B.dist),B.dist=$}else"pan"===U||er(f)||Gq(f)?B.pan(f,J,N):"none"===U||v.isFirstPersonMode()||B.rotate(f,x,A);B.point=O}},pan:function(k,C,S){var A=this.gv;if(A.isPannable()){var E=A.getWidth(),H=A.getHeight();if(!E||!H)return;var $=A.getCenterInfo(),w=C/E*$.width,o=-1*S/H*$.height;A.fi({kind:A._panning?"betweenPan":"beginPan",event:k}),A._panning=1,A.pan(-w,-o)}},rotate:function(m,P,Q){var B=this.gv;B.isRotatable()&&(B.fi({kind:B._rotating?"betweenRotate":"beginRotate",event:m}),B._rotating=1,B.rotate(P,Q))},handleWindowMouseUp:function(j){this.handleWindowTouchEnd(j)},handleWindowTouchEnd:function(N){var v=this,m=v.gv,t=m.dm(),o=v.div;if(o){var l=m.getDatasInRect(o.rect);if(!l.isEmpty()){var B=m.sm(),c=B.toSelection();l.each(function(m){B.co(m)?c.remove(m):c.add(m)}),B.ss(c)}Ol(o)}m._moving&&(delete m._moving,m.fi({kind:"endMove",event:N}),m.onMoveEnded(),t.endTransaction()),m._panning&&(delete m._panning,m.fi({kind:"endPan",event:N}),m.onPanEnded()),m._rotating&&(delete m._rotating,m.fi({kind:"endRotate",event:N}),m.onRotateEnded()),m._86O&&(delete m._86O,m.fi({kind:"endEditRotation",event:N}),t.endTransaction()),m._87O&&(delete m._87O,m.fi({kind:"endEditScale",event:N}),t.endTransaction()),m._pinching&&(delete m._pinching,m.fi({kind:"endPinch",event:N}),m.onPinchEnded()),m._rectSelecting&&(delete m._rectSelecting,m.fi({kind:"endRectSelect",event:N}),m.onRectSelectEnded()),m._walking&&(delete m._walking,m.fi({kind:"endWalk",event:N}),m.onWalkEnded()),m._lastZoomLP=m._lastZoomHit=null,v.dist=v.point=v._62O=v.p3=v.movedata=v.div=v._57I=v.pendingClickThrough=v._32Q=v._31Q=v.foward=F,v.__lastClientPoint__=F}});var jp=Mj.MapInteractor=function(U){tl(jp,this,[U]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};ld("MapInteractor",rf,{setUp:function(){jp.superClass.setUp.call(this);var t=this.gv;this.__oldMinPhi__=t.getRotateMinPhi(),this.__oldMaxPhi__=t.getRotateMaxPhi(),t.setRotateMinPhi(this._minPhi),t.setRotateMaxPhi(this._maxPhi)},tearDown:function(){jp.superClass.tearDown.call(this);var e=this.gv;e.setRotateMinPhi(this.__oldMinPhi__),e.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function($){Qq($)},handle_mousewheel:function(L){this.gv.handleScroll(L,L.wheelDelta/40)},handle_DOMMouseScroll:function(o){2===o.axis&&this.gv.handleScroll(o,-o.detail)},handle_keydown:function(j){this.gv.handleKeyDown(j)},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(h){Qq(h);var L=this,M=L.gv;if(M.setFocus(h)){var e=M.getDataInfoAt(h),V=e?e.data:F,Z=e?e.part:F,b=L.editing={point:M.lp(h)};os(h)?b.touch=!0:(b.touch=!1,b.clickLeft=Ab(h),b.pan=Gq(h)?!0:"left"===this.panButton===b.clickLeft),V&&M._39Q(V)&&(b.preventDefault=!0),$l(L,h),gm(h)?M.handleDoubleClick(h,V,Z):M.handleClick(h,V,Z)}},handle_mouseup:function(V){this.handle_touchend(V)},handle_touchend:function(){},handleWindowMouseMove:function(w){this.handleWindowTouchMove(w)},handleWindowTouchMove:function(W){var n=this,s=n.gv,e=n.editing;if(e){var T=s.lp(W),q=e.point,k=T.x-q.x,z=T.y-q.y;if(!e.moved){if(Math.abs(k)<n.threshold&&Math.abs(z)<n.threshold&&!(W.touches&&W.touches.length>1))return;e.moved=!0}if(!e.preventDefault)if(e.point=T,e.touch){var v=W.touches.length;if(2!==v)n.pan(W,k,z);else{if(1>=v)return;var o=W.touches,d={x:o[0].clientX,y:o[0].clientY},w={x:o[1].clientX,y:o[1].clientY},H={x:w.x-d.x,y:w.y-d.y},g=e.lastCenter,X=Math.atan2(H.y,H.x),x=e.theta,i=0;x==F?x=e.theta=X:(i=X-x,e.thetaStarted||Math.abs(i)>n.touchRotateThreshold?(e.thetaStarted=!0,e.theta=X):i=0);var y=Y*(d.y+w.y)/2/s.getHeight(),f=e.phi,t=0;f==F?f=e.phi=y:(t=y-f,e.phiStarted||Math.abs(t)>n.touchRotateThreshold?(e.phiStarted=!0,e.phi=y):t=0);var R,G=Math.sqrt(H.x*H.x+H.y*H.y),r=e.vlen;if(r){var C=d.x-g.x,S=d.y-g.y,p=w.x-g.x,V=w.y-g.y,l=Math.sqrt(C*C+S*S),L=Math.sqrt(p*p+V*V),B=r/2,j=n._sign2(l-B),O=n._sign2(L-B);0>j*O||0===j&&0===O?(R=1,e.vlen=G):(R||(R=G/r),e.scaleStarted||Math.abs(R-1)>n.touchScaleThreshold?(e.vlen=G,e.scaleStarted=!0):R=1)}else r=e.vlen=G,R=1;1!==R&&s.setZoom(R),(t||i)&&n.rotate(W,i,-t),e.lastCenter={x:(w.x+d.x)/2,y:(w.y+d.y)/2}}}else if(e.pan)n.pan(W,k,z);else{var b=s.getWidth(),K=s.getHeight();if(!b||!K)return;var h=-E*k/b,N=-E*z/K;n.rotate(W,h,N)}}},_sign2:function(f){return Math.abs(f)<this._touchScaleCheckAccuracy?0:f>0?1:-1},handleWindowMouseUp:function(M){this.handleWindowTouchEnd(M)},getDataInfoAt:function(g,y){var L=this.gv,C=L.getDataInfoAt(g);if(!L.isBlockSelectable()||!C||!C.data)return C;if(!y&&L.isSelected(C.data))return C;for(var Y=C.data,Z=C.part;(Y=Y.getParent())&&Y instanceof V.Block&&L.isSelectable(Y);){var X=L.isSelected(Y);if(X&&y)break;if(C={data:Y,part:Z},X&&!y)break}return C},handleWindowTouchEnd:function(E){var w=this,e=w.editing;if(w.editing=null,e){var m=w.gv;if(e.moved||!e.clickLeft&&!e.touch)m._panning=null,m._rotating=null,m.fi({kind:e.pan?"endPan":"endRotate",event:E});else{var W=w.getDataInfoAt(E),O=W&&W.data;O instanceof rs&&O.isClickThroughEnabled()&&(W=w.getDataInfoAt(E,!0),W&&(O=W.data)),O?m.sm().setSelection([O]):m.sm().clearSelection()}}},pan:function(Q,w,N){var B=this,v=B.gv;if(v.isPannable()){var s=v.getWidth(),J=v.getHeight();if(s&&J){var b=v.getCenterInfo(),j=-w/s*b.width,o=1*N/J*b.height;v.fi({kind:v._panning?"betweenPan":"beginPan",event:Q}),v._panning=1;var M=B.keepHorizon,Y=B.editing.touch;if((Y&&Q.touches&&Q.touches.length>1||!Y&&er(Q))&&(M=!M),!M)return v.pan(j,o);if(j||o){var y=Bc(v),l=[y[0]*j,y[4]*j,y[8]*j],k=[y[1],0,y[9]],H=Math.sqrt(k[0]*k[0]+k[2]*k[2]);H&&(k=[k[0]/H*o,0,k[2]/H*o]);var t=l[0]+k[0],u=l[1]+k[1],L=l[2]+k[2],I=v._center,P=v._eye;I[0]+=t,I[1]+=u,I[2]+=L,P[0]+=t,P[1]+=u,P[2]+=L,v.fp(im,F,P),v.fp(Pd,F,I)}}}},rotate:function(I,f,l){var G=this,M=G.gv;if(M.isRotatable()){var z=M._center,$=M._eye,w=No($,z),t=ub(A(w[0]*w[0]+w[2]*w[2]),w[1]),q=Xh(M,t+l);l=q-t,M.fi({kind:M._rotating?"betweenRotate":"beginRotate",event:I}),M._rotating=1,M.rotate(f,l)}}}),f.defineProperties(jp.prototype,{panButton:{get:function(){return this._panButton},set:function(w){this._panButton=w}},minPhi:{get:function(){return this._minPhi},set:function(r){this.gv.setRotateMinPhi(this._minPhi=r)}},maxPhi:{get:function(){return this._maxPhi},set:function(q){this.gv.setRotateMaxPhi(this._maxPhi=q)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(t){this._keepHorizon=t}},threshold:{get:function(){return this._threshold},set:function(W){this._threshold=W}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(N){this._touchScaleThreshold=N}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(q){this._touchRotateThreshold=q}}});var uc,ej="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Ni=32,Vn=Mj.GlobeInteractor=function(W,U){tl(Vn,this,[W]);var o,X=U.radius||6378137,$=this,q=null;uc||(uc=ir(),uc.style.border="",uc.style.backgroundImage="url("+ej+")");var x=new Cj,B=new io,h=new io,v=new io,l=new Jk,R="number"==typeof X?{x:X,y:X,z:X}:X,D={center:new io(0,0,0),radius:R},I=function(J){W._81O=null;var _=W.getHitPosition(J,W.getCenter(),B.copy(W.getEye()).sub(h.copy(W.getCenter())).toArray());return l.origin.copy(W.getEye()),l.direction.copy(_).sub(l.origin).normalize(),l.intersectEllipsoid(D)},P=function(d,Q){W._81O=null,l.origin.copy(W.getEye());for(var q,T,F=W.getCenter(),p=B.copy(W.getEye()).sub(h.copy(W.getCenter())).toArray(),C=1,x=16,X=0,n=1,E={x:0,y:0};x--;){if(E.x=Q.x+(d.x-Q.x)*C,E.y=Q.y+(d.y-Q.y)*C,q=W.getHitPosition(E,F,p),l.direction.copy(q).sub(l.origin).normalize(),T=l.intersectEllipsoid(D),T&&1===C)return{hit:T};T?X=C:n=C,C=(X+n)/2}return{hit:T,out:1>C}},O=function(r,w){if(q){var O=Date.now();q.deltaTime=q.lastTime?O-q.lastTime:1e3,q.lastTime=O,q.lastAxis=r,q.lastAngle=w}w&&(x.setFromAxisAngle(r,w),W.setEye(B.copy(W.getEye()).applyQuaternion(x).toArray()),W.setCenter(B.copy(W.getCenter()).applyQuaternion(x).toArray()),W.setUp(B.copy(W.getUp()).applyQuaternion(x).toArray()))};$._showCrossIcon=function(K){of($.getView(),uc),mm(uc,{x:K.clientX-Ni/2,y:K.clientY-Ni/2,width:Ni,height:Ni})},$._hideCrossIcon=function(){Ol(uc)},$._scrollImpl=function(s,r){q={point:W.lp(s),screen:ci(s),hit:I(s),type:"right"},q.hitNormalize=q.hit?q.hit.clone().normalize():new io;var T={clientX:q.screen.x,clientY:q.screen.y+10*r};$._handleMoveImpl(T),$._endMoveImpl(T)},$._startMoveImpl=function(Z){o&&(o.stop(!0),o=null),q={point:W.lp(Z),screen:ci(Z),hit:I(Z)},q.hitNormalize=q.hit?q.hit.clone().normalize():new io,os(Z)?1===Z.touches.length?q.hit&&(q.type="left"):2===Z.touches.length&&(q.type="touch2"):(Ab(Z)?q.hit&&(q.type="left"):ae(Z)?q.type="right":Gq(Z)&&q.hit&&(q.type="middle"),!q.hit||"right"!==q.type&&"middle"!==q.type||$._showCrossIcon(Z)),q.type&&$l($,Z)},$._handleMoveImpl=function(z){if(q)switch(q.type){case"left":return $._handleLeft(z);case"right":return $._handleRight(z);case"middle":return $._handleMiddle(z);case"touch2":return $._handleTouch2(z)}},$._endMoveImpl=function(){if(q){if(this._hideCrossIcon(),"left"===q.type||"middle"===q.type){var K=1e3*(q.lastAngle/(q.deltaTime||30)),Y=q.lastAxis,G=q.lastTime,T=function(){var A=Date.now(),k=(A-G)/1e3;return G=A,K*=Math.pow(Math.abs($.decelerationRate),3*k),Math.abs(K)<.01?(K=0,o&&o.stop(),void 0):(O(Y,K*k),void 0)};o=$h({action:function(){T(arguments)},duration:5e3})}q=null}},$._handleLeft=function(I){if(!q.finished){var F=ci(I),Z=P(F,q.lastScreen||q.screen);if(q.lastScreen=F,!Z.hit)return q.finished=!0,$._endMoveImpl(I),void 0;var n=Z.hit;n.normalize();var x=q.hitNormalize,H=Math.acos(n.dot(x)),f=n.cross(x).normalize();O(f,H),Z.out&&(q.finished=!0,$._endMoveImpl(I))}},$._handleRight=function(f){var S=q.lastScreen||q.screen,k=S.y;S=q.lastScreen=ci(f);var V=S.y,N=V-k;if(N){var z=Math.min(.5,N*$.scaleSpeed);B.copy(W.getEye());var n=q.hit;n||(n=B.clone().divide(R).normalize().multiply(R)),h.copy(B).lerp(n,z),W.setEye(h.toArray()),B.copy(W.getUp()),h.normalize();var C=B.clone().cross(h).normalize();if(v.copy(W.getCenter()),v.sub(C.multiplyScalar(v.dot(C))),W.setCenter(v.toArray()),q.hit){var u=I(q.screen),c=q.hitNormalize;if(u){u.normalize();var H=Math.acos(u.dot(c)),d=u.cross(c).normalize();H&&O(d,H)}}}};var M=function(Q){return Math.abs(Q)<.01?0:Q>0?1:-1};$._handleTouch2=function(K){var x=K.touches.length;if(2===x){var p=K.touches,c={x:p[0].clientX,y:p[0].clientY},w={x:p[1].clientX,y:p[1].clientY},b={x:w.x-c.x,y:w.y-c.y},u=q.lastCenter,D=Math.atan2(b.y,b.x),e=q.theta,n=0;e==F?e=q.theta=D:(n=D-e,q.thetaStarted||Math.abs(n)>.03?(q.thetaStarted=!0,q.theta=D):n=0);var P,r=Math.sqrt(b.x*b.x+b.y*b.y),t=q.vlen;if(t){var o=c.x-u.x,k=c.y-u.y,z=w.x-u.x,H=w.y-u.y,s=Math.sqrt(o*o+k*k),A=Math.sqrt(z*z+H*H),S=t/2,j=M(s-S),C=M(A-S);0>j*C||0===j&&0===C?(P=1,q.vlen=r):(P||(P=r/t),q.scaleStarted||Math.abs(P-1)>.05?(q.vlen=r,q.scaleStarted=!0):P=1)}else t=q.vlen=r,P=1;var b=h.copy(W.getEye()).clone();1!==P&&W.setEye(b.setLength((b.length()-X)/P+X).toArray()),n&&O(b.normalize(),n),q.lastCenter={x:(w.x+c.x)/2,y:(w.y+c.y)/2}}},$._handleMiddle=function(l){var P=ci(l),V=q.screen;q.screen=P;var e=(P.y-V.y)/180*Math.PI*$.rollSpeed;h.copy(W.getCenter()).sub(B.copy(W.getEye())).normalize(),B.copy(W.getUp()).cross(h).normalize(),h.copy(W.getEye()).sub(q.hit).applyAxisAngle(B,e).add(q.hit);var Z=h.clone();h.copy(W.getCenter()).sub(q.hit).applyAxisAngle(B,e).add(q.hit);var c=h.clone(),b=h.copy(W.getUp()).applyAxisAngle(B,e).clone(),D=!1;e>0&&(v.copy(b),h.copy(c).sub(Z).normalize(),B.copy(Z).multiplyScalar(-1).normalize(),B.dot(v)-h.dot(v)>0&&(D=!0)),D||v.copy(q.hit).sub(Z).dot(q.hitNormalize)>=0&&(D=!0),D||(W.setEye(Z.toArray()),W.setCenter(c.toArray()),W.setUp(b.toArray()));var U=-(P.x-V.x)/180*Math.PI*$.rotateSpeed;O(q.hitNormalize,U)}};ld("GlobeInteractor",rf,{handle_contextmenu:function(v){Qq(v)},handle_mousewheel:function(e){this._scrollImpl(e,e.wheelDelta/40)},handle_DOMMouseScroll:function(q){2===q.axis&&this._scrollImpl(q,-q.detail)},handle_keydown:function(J){this.gv.handleKeyDown(J)},handle_mousedown:function(i){this.handle_touchstart(i)},handle_touchstart:function(Q){Qq(Q);var p=this.gv;if(p.setFocus(Q)){var D=p.getDataInfoAt(Q),b=D?D.data:F;b&&p.isInteractive(b)||this._startMoveImpl(Q);var r=D?D.part:F;gm(Q)?p.handleDoubleClick(Q,b,r):p.handleClick(Q,b,r)}},handle_mouseup:function(R){this.handle_touchend(R)
},handle_touchend:function(){},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(U){this._handleMoveImpl(U)},handleWindowMouseUp:function(G){this.handleWindowTouchEnd(G)},handleWindowTouchEnd:function(u){this._endMoveImpl(u)}}),f.defineProperties(Vn.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(d){this._rotateSpeed=d}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(q){this._rollSpeed=q}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(C){this._scaleSpeed=C}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(Y){this._decelerationRate=Y}}});var $f=function(a){var p=2147483648|a;return[(255&p>>16)/255,(255&p>>8)/255,(255&p)/255,(255&p>>24)/255]},oe=function(j){this.gv=j,this.gv.pickColorMap={_pickIdUsed:2e3}};cd(oe,f,{_iv:!0,iv:function(){this._iv=!0},get:function(s,e,n){this.validate();var f=this,V=f.gv.getGL();if(!V)return F;var G,a,J=f._resolution,O=Math.round(s.x*J),A=Math.ceil(s.width*J),y=Math.ceil(s.height*J),K=f.height-Math.round(s.y*J)-y,w=P(A/2),U=new Uint8Array(4*A*y),S=0,x=U.length,C=e?F:new _n,$=e?F:{};if(Oo(V,f.frame),V.readPixels(O,K,A,y,V.RGBA,V.UNSIGNED_BYTE,U),sn(V),e){for(;w>=S;S++)for(var D=w-S,c=w+S,H=D;c>=H;H++)for(var W=D;c>=W;W++)if((H===D||H===c||W===D||W===c)&&(G=f.info(U,4*(H*A+W)))){if(n&&n(G)===!1)continue;return G}}else for(;x>S;S+=4)if(G=f.info(U,S)){if(n&&n(G)===!1)continue;a=G.data,$[a._id]||(C.add(a),$[a._id]=a)}return C},info:function(K,U){return this.gv.pickColorMap[(K[U]<<16)+(K[U+1]<<8)+K[U+2]+((127&K[U+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var t=this,l=t.gv,N=l.getGL();if(N){var R=t._resolution=l._pickerResolution*l.getDevicePixelRatio(),X=Math.round(R*l.getWidth()),y=Math.round(R*l.getHeight()),w=N.RGBA,S=N.TEXTURE_2D,v=N.RENDERBUFFER,b=N.FRAMEBUFFER;if(t.texture||(t.texture=yn(N),t.render=N.createRenderbuffer(),t.frame=N.createFramebuffer()),(t.width!==X||t.height!==y)&&(N.activeTexture(N.TEXTURE0),ri(N,t.texture),N.texImage2D(S,0,w,X,y,0,w,N.UNSIGNED_BYTE,F),Up(N,N.TEXTURE_MIN_FILTER,N.LINEAR),N.bindRenderbuffer(v,t.render),N.renderbufferStorage(v,N.DEPTH_COMPONENT16,X,y),Oo(N,t.frame),N.framebufferTexture2D(b,N.COLOR_ATTACHMENT0,S,t.texture,0),N.framebufferRenderbuffer(b,N.DEPTH_ATTACHMENT,v,t.render),ri(N,F),N.bindRenderbuffer(v,F),sn(N),t.width=X,t.height=y),t._iv){t._iv=!1;var L=!1;l._40Q.each(function(m){!L&&m.isBatchInvalid()&&(L=!0)}),L&&l.updateScene(),Oo(N,t.frame),N.clear(N.COLOR_BUFFER_BIT),l.overlappingBox.clear(),l.setViewport(N,0,0,X,y),l.renderPickScene(),sn(N)}}}});var jd=function(J){this.gv=J};cd(jd,f,{gap:0,size:0,_42:function(L,Z){var d=this,H=d.gv,z=H._gridGap,v=H._gridSize;if(H._gridVisible){if(d.gap!==z||d.size!==v){for(var p=[],R=H._gridSize/2,W=z*R,r=0;2*R+1>r;r++){var M=6*r,g=6*(2*R+1)+M;p[M]=-W,p[M+1]=0,p[M+2]=-W+r*z,p[M+3]=W,p[M+4]=0,p[M+5]=-W+r*z,p[g]=-W+r*z,p[g+1]=0,p[g+2]=-W,p[g+3]=-W+r*z,p[g+4]=0,p[g+5]=W}d.vs=new ad(p),d.gap=z,d.size=v}pn(H),Ir(L,Z),Wb(L),Kp(L,Z,1,H._gridColor,H._buffer.vs,d.vs),Pr(L,0,d.vs.length/3,L.LINES),gi(L),$e(L,Z)}else d.vs=d.gap=d.size=F}});var Vi=function(u){this.gv=u};cd(Vi,f,{_42:function(R,d){var E=this.gv,v=E._buffer.vs,Y=E._axisXColor,n=E._axisYColor,f=E._axisZColor,k=E._originAxisVisible,b=E._centerAxisVisible;if(k||b){var A=Ic?R.TRIANGLES:R.TRIANGLE_FAN,X=R.LINES;if(pn(E),Ir(R,d),Wb(R),k){var N=E.getCenterInfo(),u=B(N.width,N.height)/5,D=.8*u,P=.05*u;Kp(R,d,1.5,Y,v,new ad([0,0,0,u,0,0,D,P,0,D,0,P,D,-P,0,D,0,-P,D,P,0,0,0,0,0,u,0,P,D,0,0,D,P,-P,D,0,0,D,-P,P,D,0,0,0,0,0,0,u,P,0,D,0,P,D,-P,0,D,0,-P,D,P,0,D])),Pr(R,0,2,X),Pr(R,1,6,A),Kp(R,d,F,n),Pr(R,7,2,X),Pr(R,8,6,A),Kp(R,d,F,f),Pr(R,14,2,X),Pr(R,15,6,A)}if(b){var o=E._center,W=o[0],Z=o[1],y=o[2],N=E.getPositionInfo(o);u=B(N.width,N.height)/20,Kp(R,d,1.5,Y,v,new ad([W,Z,y,W+u,Z,y,W,Z,y,W,Z+u,y,W,Z,y,W,Z,y+u])),Pr(R,0,2,X),Kp(R,d,F,n),Pr(R,2,2,X),Kp(R,d,F,f),Pr(R,4,2,X)}gi(R),$e(R,d)}}});var br=function(O){this.gv=O},Vd="edit_tx",Jc="edit_ty",Ld="edit_tz",bs="edit_rx",fb="edit_ry",Ds="edit_rz",Es="edit_sx",Fs="edit_sy",Gs="edit_sz",Hs={};Hs[Vd]=101,Hs[Jc]=102,Hs[Ld]=103,Hs[bs]=104,Hs[fb]=105,Hs[Ds]=106,Hs[Es]=107,Hs[Fs]=108,Hs[Gs]=109,cd(br,f,{_42:function(_,P,L){var v=this,O=v.gv,b=O.sm().ld();if(b&&O.isEditable(b)&&!O.isEditHelperDisabled()&&be(b)&&(!O.isFirstPersonMode()||!O.isMouseRoamable()&&!Zk)){pn(O);var X,u=O.isMovable(b),m=O.isRotationEditable(b),R=O.isSizeEditable(b),g=O._axisXColor,M=O._axisYColor,W=O._axisZColor,G=O._editSizeColor,Y=b.p3();if(O.isOrtho()){var f=O.getCenterInfo();X=B(f.width,f.height)/8}else X=kj(O.getEye(),Y)/10;var D,s,e=X/(L?5:10),w=.7*X,j=.4*w,q=Y[0],I=Y[1],c=Y[2];D=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],u&&v._17O(_,P,b,L,Vd,g,D,[q,I-e,c,q+w,I-e,c,q+w,I,c,q+w,I,c,q,I,c,q,I-e,c,q,I-e,c+e,q+w,I-e,c+e,q+w,I-e,c,q+w,I-e,c,q,I-e,c,q,I-e,c+e]),s=q+w,R&&v._17O(_,P,b,L,Es,G,D,[s,I-e,c,s+j,I-e,c,s+j,I,c,s+j,I,c,s,I,c,s,I-e,c,s,I-e,c+e,s+j,I-e,c+e,s+j,I-e,c,s+j,I-e,c,s,I-e,c,s,I-e,c+e]),s+=j,m&&v._17O(_,P,b,L,bs,g,D,[s,I-e,c,s+j,I-e,c,s+j,I,c,s+j,I,c,s,I,c,s,I-e,c,s,I-e,c+e,s+j,I-e,c+e,s+j,I-e,c,s+j,I-e,c,s,I-e,c,s,I-e,c+e]),D=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],u&&v._17O(_,P,b,L,Jc,M,D,[q,I,c,q,I+w,c,q-e,I+w,c,q-e,I+w,c,q-e,I,c,q,I,c,q,I,c,q,I,c-e,q,I+w,c-e,q,I+w,c-e,q,I+w,c,q,I,c]),s=I+w,R&&v._17O(_,P,b,L,Fs,G,D,[q,s,c,q,s+j,c,q-e,s+j,c,q-e,s+j,c,q-e,s,c,q,s,c,q,s,c,q,s,c-e,q,s+j,c-e,q,s+j,c-e,q,s+j,c,q,s,c]),s+=j,m&&v._17O(_,P,b,L,fb,M,D,[q,s,c,q,s+j,c,q-e,s+j,c,q-e,s+j,c,q-e,s,c,q,s,c,q,s,c,q,s,c-e,q,s+j,c-e,q,s+j,c-e,q,s+j,c,q,s,c]),D=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],u&&v._17O(_,P,b,L,Ld,W,D,[q,I,c,q,I,c+w,q,I-e,c+w,q,I-e,c+w,q,I-e,c,q,I,c,q,I-e,c,q-e,I-e,c,q-e,I-e,c+w,q-e,I-e,c+w,q,I-e,c+w,q,I-e,c]),s=c+w,R&&v._17O(_,P,b,L,Gs,G,D,[q,I,s,q,I,s+j,q,I-e,s+j,q,I-e,s+j,q,I-e,s,q,I,s,q,I-e,s,q-e,I-e,s,q-e,I-e,s+j,q-e,I-e,s+j,q,I-e,s+j,q,I-e,s]),s+=j,m&&v._17O(_,P,b,L,Ds,W,D,[q,I,s,q,I,s+j,q,I-e,s+j,q,I-e,s+j,q,I-e,s,q,I,s,q,I-e,s,q-e,I-e,s,q-e,I-e,s+j,q-e,I-e,s+j,q,I-e,s+j,q,I-e,s])}},_17O:function(R,C,d,_,U,r,J,E){var y=this.gv,x=y._buffer,D=zs.for(R),j=D.directUniforms(),h=D.directAttribs();if(y._picking){_=y.pickColorMap;var L=Hs[U];_[L]={data:d,part:U},j.uFixPickReverseColor=$f(L)}cb(R,C,F,!0,F,!0,F,!1),j.uDiffuse=r,h.aPosition=ph(R,x.vs,new ad(E),F),h.aNormal=ph(R,x.ns,new ad(J),F),Wb(R),Pr(R,0,12),gi(R),bh(R,C)}});var Is=V.Raycaster=function(x){this.gv=x,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Lr("Raycaster",f,{intersect:function(D){var z=this,y=z.gv,s=y.getDataAt(D);return s?z.intersectObject(D,s):null},intersectObjects:function(l,F,t){var z,Q,X,d,Z=this,K=1/0,o=l.origin||(new io).fromArray(Z.gv.getEye()),f=Z.maxTriangleTest,y=[];F.forEach(function(L){t&&t(L)===!1||L.s("intersect")!==!1&&y.push(L)});var j=o.distanceToSquared2([0,0,0]);return y.sort(function(k,r){return(k.p3?o.distanceToSquared2(k.p3()):j)-(r.p3?o.distanceToSquared2(r.p3()):j)}),Z.countTriangles=0,y.forEach(function(h){Z.countTriangles>f||(z=Z.intersectObject(l,h),z&&(Q=o.distanceToSquared(z.world),K>Q&&(X=h,d=z,K=Q)))}),Z.countTriangles=0,{data:X,intersect:d}},intersectObject:function(Q,W){if(Q instanceof Jk)return this._intersectObjectImpl(Q,W);var g=this,U=g.gv,h=U.unproject(Q),r=new io,A=U.getEye(),J=new io;if(U.isOrtho()){var o=new io(A);J.copy(U.getCenter()).sub(o).normalize();var G=r.copy(h).sub(o).dot(J);r.copy(J).setLength(-G).add(o.copy(h))}else r.copy(A),J.copy(h).sub(r).normalize();var _=new V.Math.Ray(r,J);return g._intersectObjectImpl(_,W)},_intersectObjectImpl:function(){function t(){var T=new io;return T.subVectors($,c),R.subVectors(i,c),T.cross(R).normalize(),T}function N(f,$,X,z,k,M,O){return kh.barycoordFromPoint(f,$,X,z,B),k.multiplyScalar(B.x),M.multiplyScalar(B.y),O.multiplyScalar(B.z),k.add(M).add(O),k.clone()}var u=new bf,f=new bf,v=new Jk,A=new io,z=new io,g=new io,s=new io,L=new io,i=new io,c=new io,$=new io,F=new Go,m=new Go,U=new Go,R=new io,Q={vs:tc,is:Bj,uv:Bs},B=new io,q=kg.slice(0);return q.push("csg"),function(I,O){var D=this.gv.getData3dUI(O),r=O.mat||D.mat;r?u.fromArray(r):u.identity(),f.getInverse(u),v.copy(I).applyMatrix4(f);var e,y,C,a="body",k=D.shapeModel;if(!k&&(O instanceof V.Polyline||O instanceof V.Edge)&&D.lineShapeModel&&(k=D.lineShapeModel),k||(k=go(D)),k||(V.CSGNode&&O instanceof V.CSGNode||V.CSGShape&&O instanceof V.CSGShape?(C=!0,k=[D.left,D.front,D.right,D.back,D.top,D.bottom,D.csg]):O instanceof V.Node&&!(O instanceof V.Shape)?(e=!0,k=Q):(y=!0,k=[D.left,D.front,D.right,D.back,D.top,D.bottom])),!k)return console.log("Can not find shape model."),null;mh(k)||(k=[k]);var Y,G,Z,l,M,W,J,n,p,w,h,H,j,B,d,K,R=1/0,x=["","top_","bottom_"],P=!1,o=this.backfaceCulling,S=[];for(Cq(k,D,S),Y=0,G=S.length;G>Y;Y++)if(j=S[Y])for(Z=0,l=x.length;l>Z;Z++)if(B=x[Z],J=j[B+"vs"],n=j[B+"is"],p=j[B+"uv"]||j[B+"tuv"],J){if(d=j[B+"boundingBox"]){var h=v.intersectBox(d);if(!h)continue;if(v.origin.distanceTo(h)>R)continue;K=!1}else j[B+"boundingBox"]=d=new V.Math.Box3,K=!0;for(M=0,W=n?n.length:J.length/3;W>M;M+=3)this.countTriangles++,n?(z.fromArray(J,3*n[M]),g.fromArray(J,3*n[M+1]),s.fromArray(J,3*n[M+2])):(z.fromArray(J,3*M),g.fromArray(J,3*(M+1)),s.fromArray(J,3*(M+2))),K&&(d.expandByPoint(z),d.expandByPoint(g),d.expandByPoint(s)),w=v.intersectTriangle(z,g,s,o,A),w&&(H=v.origin.distanceTo(w),R>H&&(R=H,L.copy(w),i.copy(z),c.copy(g),$.copy(s),""!==B?a=B.slice(0,-1):e?a=kg[Math.floor(M/6)]:y?a=kg[Y]:C&&(a=q[Y]),p&&(P=!0,n?(F.fromArray(p,2*n[M]),m.fromArray(p,2*n[M+1]),U.fromArray(p,2*n[M+2])):(F.fromArray(p,2*M),m.fromArray(p,2*(M+1)),U.fromArray(p,2*(M+2))))))}if(!isFinite(R))return null;var E,b=L.clone().applyMatrix4(u);P&&(E=N(L,i,c,$,F,m,U));var _=t(i,c,$),X=t(i.applyMatrix4(u),c.applyMatrix4(u),$.applyMatrix4(u)),T=v.direction.dot(_);return T>0&&(_.multiplyScalar(-1),X.multiplyScalar(-1)),{world:b,local:L.clone(),worldNormal:X,normal:_,uv:E,part:a}}}()});var Js=function(f,t){this.gv=f,this.s=function(A,S,p){return S==F&&(S=p),S==F?t.getStyle(A):cs(S,t,f)},this.data=t};cd(Js,f,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:_,iv:function(){this._iv=!0},update:function(H,i,q){var X=this,h=X.data;if(H||(H=X.gv,i=H.getGL(),q=i._40Q),!X.needValidate(i)||!H.isVisible(h))return q.push(this,!1),void 0;var f,e,Y,B,O,d=h._id,j=X.s("autorotate")||X.s("shape3d.autorotate")||X.s("fixSizeOnScreen")||X.s("shape3d.fixSizeOnScreen")?null:X.s("batch"),w=h.getRenderLayer(),T=q.get(w,!0),r=T.batchIndexMap,t=T.batchModelMap,v=H.getBrightness(h),o=v!=F&&1!==v;f=Sq(r,t,h,j,H);var W=X.validate(f,j?H.getBatchInfo(j)||Rm:F);if(f&&(e=r[d],Y=e.size=f.vs.length/3-e.begin,O=f.rs))for(v=o?v:1,B=0;Y>B;B++)O.push(v);var z=H.getWireframeGeometry(h);if(z)rh(H,h,z);else if(be(h)){var $=H.getWireframe(h);$&&rh(H,h,$)}X.labelInfo=X.label2Info=X.noteInfo=X.note2Info=X._38o=F,X._24O(Mi,"getLabel"),X._24O(Nb,"getLabel2"),X._26O(Jm,"getNote"),X._26O(Eq,"getNote2"),X._15O(),X.interactiveInfo=H.isInteractive(h)?{}:F,T.push(this,!0),W!==!1&&(X._iv=!1)},clearWireframeGeometryCache:function(){var b=this;gd(b),b.data.iv()},_46Q:function(U){var K=this,Z=K.data,Y=K.gv;if(Y.isVisible(Z)){var j=Z._id,R=Y._40Q.get(Z._renderLayer,!0),$=R.batchIndexMap[j],e=R.polylineIndexMap[j],H=R.wireframeIndexMap[j];if($||e||H){var F=jk(U,Y.pickColorMap,Y.isSelectable(Z),Z,Qf,!0);F&&(Gl(F,$,R.batchModelMap),Gl(F,e,R.polylineModelMap),Gl(F,H,R.wireframeModelMap))}}},_42:function(h,B,G){function $(R,C,J){var b=C.getBrightness(J),q=J.s("alphaTest"),Q=J.s("envmap"),m=zs.for(R),s=m.directUniforms();b!=F&&1!==b&&(s.uBrightness=b),s.uAlphaTest=q,s.uUseEnvMap=Q?!0:!1,s.uReflectivity=Q||.01,s.shadowReceive=!K&&J.s("shadow.receive"),s.shadowCull=!K&&!!J.s("shadow.cull");var j=I.s("3d.clip.direction");if(j){var S=I.s("3d.clip.percentage");0===S&&(X=!1);var Y=I._formatClipUniforms(j,S,J);s.uClipPercent=Y[1],s.uClipDirection=Y[0]}else s.uClipDirection=0;R._blooming&&!J.s("bloom")&&(s.blackout=!0)}var I=this,f=I.data,x=I.gv;if(x.isVisible(f)){var v,K=x._picking;if(K)v=x.pickColorMap;else{if(x.isTransparentMask(f)||x.isReflecting(h)&&f.s("3d.reflectable")===!1)return;v=_}if(Js.getTitle===_){Js.getTitle=0;for(var S in C)if(S.length===Nb.length+1&&S[Nb.length]===ml[4].toUpperCase()&&S[Nb.length-1]===ml[Nb.length+1].toUpperCase()){Js.getTitle=Zh;break}}if(!Js.getTitle||bl[Nb.length+2]){if(Js.getHead===_){Js.getHead=0;for(var S in s){var L="box-sizing";6===S.length&&S[0]===ml[4]&&S[3]===L[0]&&S[4]===L[1]&&S[5]===L[2]&&(Js.getHead=Zh)}}if(!Js.getHead||bl[Nb.length]){var P,r,V=f._id,A=x._40Q.get(f._renderLayer,!0),q=A.batchIndexMap,J=A.batchModelMap,T=x.isSelectable(f),c=!1,X=!0,Z=q[V];if(K&&(r=jk(h,v,T,f,Qf,Z),r&&!x._45Q&&(Gl(r,Z,J),Gl(r,A.polylineIndexMap[V],A.polylineModelMap),Gl(r,A.wireframeIndexMap[V],A.wireframeModelMap))),Z||(c||(c=!0,$(h,x,f)),X&&I._80o(h,B,G)),x.isLabelVisible(f)&&((P=I.labelInfo)&&(K&&jk(h,v,T,f,Mi),c||(c=!0,$(h,x,f)),I._28O(P,Mi,G)),(P=I.label2Info)&&(K&&jk(h,v,T,f,Nb),c||(c=!0,$(h,x,f)),I._28O(P,Nb,G))),x.isNoteVisible(f)&&((P=I.noteInfo)&&(K&&jk(h,v,T,f,Jm),c||(c=!0,$(h,x,f)),I._29O(P,Jm,G)),(P=I.note2Info)&&(K&&jk(h,v,T,f,Eq),c||(c=!0,$(h,x,f)),I._29O(P,Eq,G))),(P=I._38o)&&(c||(c=!0,$(h,x,f)),I._99O(h,B,P,v,T,G)),c){var M=zs.for(h).directUniforms();M.uBrightness=1,M.uClipDirection=0,h._blooming&&(M.blackout=!1)}}}}},_formatClipUniforms:function(L,q,K){switch(L){case"left":L=2;break;case"top":L=3;break;case"bottom":L=4;break;case"front":L=5;break;case"back":L=6;break;case"right":default:L=1}if(0===L%2&&(q=1-q),K instanceof V.Shape){var D=K.s3(),W=K.p3(),I=K.getAnchor3d();q=3>L?(q-I.x)*D[0]+W[0]:5>L?(q-I.y)*D[1]+W[1]:(q-I.z)*D[2]+W[2]}else q-=.5;return[L,q]},prepare:function(){var t=this,o=t.data;if(!(o instanceof rs)){var A,p,j,Q,Y,P=t.gv,O=P.getGL(),n=o._id,K=t.s("batch"),g=P._batchIndexMap,e=P._batchModelMap,B=P.getBrightness(o),w=B!=F&&1!==B;if(t.needValidate(O)){if(A=Sq(g,e,o,K,P),t.validate(A,K?P.getBatchInfo(K)||Rm:F),A&&(p=g[n],j=p.size=A.vs.length/3-p.begin,Y=A.rs))for(B=w?B:1,Q=0;j>Q;Q++)Y.push(B);if(be(o)){var b=P.getWireframeGeometry(o);if(b)rh(P,o,b);else{var L=P.getWireframe(o);L&&rh(P,o,L)}}t.labelInfo=t.label2Info=t.noteInfo=t.note2Info=t._38o=F,t._24O(Mi,"getLabel"),t._24O(Nb,"getLabel2"),t._26O(Jm,"getNote"),t._26O(Eq,"getNote2"),t._15O(),t.interactiveInfo=P.isInteractive(o)?{}:F,t._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=_},getBoundingBox:function(){var e,P,n,M,y,u;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;e||(e={vs:tc,is:Bj,uv:Bs},P=new io,n=new io,M=new io,y=new io,u=new io);var s=this,R=s.data,a=s.shapeModel;if(a||R instanceof V.Shape||(a=go(s)),!a&&R instanceof V.Shape&&(s.prepare(),a=s.shapeModel),a||(R instanceof V.Node&&!(R instanceof V.Shape)?a=e:(s.left||s.front||s.right||s.back||s.top||s.bottom)&&(a=[s.left,s.front,s.right,s.back,s.top,s.bottom])),!a)return _;mh(a)||(a=[a]);var H,I,Q,$,C,m,x,Z,o,w,A,c,N=["","top_","bottom_"],W=new V.Math.Box3,D=!1;if(s._needRecoverPosition){y.set.apply(y,R.p3());var d=R.s3();u.set(1/(d[0]||1),1/(d[1]||1),1/(d[2]||1))}else y.set(0,0,0),u.set(1,1,1);for(H=0,I=a.length;I>H;H++)if(o=a[H])for(Q=0,$=N.length;$>Q;Q++)if(w=N[Q],x=o[w+"vs"],Z=o[w+"is"],x){if(c=w+"boundingBox",A=o[c],!A)for(o[c]=A=new V.Math.Box3,C=0,m=Z?Z.length:x.length/3;m>C;C+=3)Z?(P.fromArray(x,3*Z[C]).sub(y).multiply(u),n.fromArray(x,3*Z[C+1]).sub(y).multiply(u),M.fromArray(x,3*Z[C+2]).sub(y).multiply(u)):(P.fromArray(x,3*C).sub(y).multiply(u),n.fromArray(x,3*(C+1)).sub(y).multiply(u),M.fromArray(x,3*(C+2)).sub(y).multiply(u)),!P.isNaN()&&A.expandByPoint(P),!n.isNaN()&&A.expandByPoint(n),!M.isNaN()&&A.expandByPoint(M);W.expandByBox(A),D=!0}return D?(this._cacheBoundingBox=W,f.freeze(W),f.freeze(W.min),f.freeze(W.max),an(s.gv,R),W):_}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return We},_80o:function(){},dispose:function(){var b=this,G=b.data,C=G._pickId;if(C){var X=b.gv.pickColorMap;X[C]&&delete X[C]}},getBodyColor:function($){var V=this.data,b=this.gv.getBodyColor(V);return b?b:$?V.getStyle($):F},getCachedTexture:function(l){var N=this._cachedTextures;return N?N[l||"main"]:null},setCachedTexture:function(S,b){var y=this._cachedTextures;return y||(y=this._cachedTextures={}),y[b||"main"]=S,S},invalidateCachedTexture:function(O){var P=this._cachedTextures;if(P){for(var $ in P)O.deleteTexture(P[$]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(K,l){var j=this,P=j.data,t=j.gv,C=j.s,o=t[l](P);if(o!=F){var z=C(K+".scale"),y=C(K+".max"),p=j[K+"Info"]={label:o,textureScale:C(K+".texture.scale"),color:t[l+"Color"](P),font:C(K+".font"),align:C(K+".align"),background:t[l+"Background"](P)},N=p.rect=Wp(p,o);y>0&&y<N.width&&(p.labelWidth=N.width,N.width=y),N.x=N.y=0,N.width*=z,N.height*=z,p.mat=j._16O(C(K+".autorotate"),C(K+".position"),N,C(K+".face"),C(K+".t3"),C(K+".r3"),C(K+".rotationMode"));var Y=N.width/2,O=N.height/2;p.vs=new ad([-Y,O,0,-Y,-O,0,Y,-O,0,Y,O,0]),N.width/=z,N.height/=z}},_26O:function(C,m){var A=this,D=A.data,d=A.gv,O=A.s,Z=d[m](D);if(Z!=F){var x=O(C+".scale"),w=this[C+"Info"]={note:Z,textureScale:O(C+".texture.scale"),expanded:O(C+".expanded"),font:O(C+".font"),color:O(C+".color"),align:O(C+".align"),borderWidth:O(C+".border.width"),borderColor:O(C+".border.color"),background:d[m+"Background"](D)};if(w.expanded){var q=O(C+".max"),u=Wp(w,Z);u.width+=6,u.height+=2,q>0&&q<u.width&&(w.labelWidth=u.width,u.width=q);var $={x:-u.width/2,y:-8-u.height,width:u.width,height:u.height+8}}else $={x:-6,y:-18,width:12,height:18};w.mat=A._16O(O(C+".autorotate"),O(C+".position"),F,O(C+".face"),O(C+".t3"),O(C+".r3"),O(C+".rotationMode")),w.rect=$,1!==x&&($=Hq($),$.x*=x,$.height*=x,$.y=-$.height,$.width*=x);var l=$.x,I=$.y,E=$.width,v=$.height;w.vs=new ad([l,-I,0,l,-I-v,0,l+E,-I-v,0,l+E,-I,0])}},eachShapeModel:function(D,Z){function $(S){Ji(S),S.vs&&D(S.vs,S.is,S.ns,S.uv),S.top_vs&&D(S.top_vs,S.top_is,S.top_ns,S.top_uv),S.bottom_vs&&D(S.bottom_vs,S.bottom_is,S.bottom_ns,S.bottom_uv),S.from_vs&&D(S.from_vs,S.from_is,S.from_ns,S.from_uv),S.to_vs&&D(S.to_vs,S.to_is,S.to_ns,S.to_uv)}function F(V){var l,T,s;if(mh(V))for(T=0,s=V.length;s>T;T++)l=V[T],l&&F(l);else zq(V)?F(go(_,V),_):Dg(V)&&(V.shape3d?F(V.shape3d):$(V))}var _=this,m=_.data,Z=Z||_.shapeModel||go(_);Z||(Z=m instanceof V.Node&&!(m instanceof V.Shape)?{vs:tc,is:Bj}:[_.left,_.front,_.right,_.back,_.top,_.bottom]),F(Z)},_28O:function(d,l,v){if(v(this.s(l+".transparent"))){var R=d.rect,T=d.textureScale,M=R.width*T,U=R.height*T;if(M>=1&&U>=1){var $=af(M,U);1!==T&&($.translate(R.x,R.y),$.scale(T,T),$.translate(-R.x,-R.y)),Sf($,d),$.restore(),wg(this,l,d.mat,d.vs,!0)}}},_29O:function(U,k,S){if(S(this.s(k+".transparent"))){var G=U.rect,v=U.textureScale,h=G.x,P=G.y,m=G.width*v,s=G.height*v;if(m>=1&&s>=1){G.x=G.y=0;var p=af(m,s);1!==v&&p.scale(v,v),Sl(p,U),p.restore(),G.x=h,G.y=P,wg(this,k,U.mat,U.vs,!1)}}},_99O:function(J,R,s,j,K,N){if(s){var w=this,S=w.gv,X=w.data,_=S._buffer,l=S._1O,y=s.icons,e=zs.for(J),U=e.directAttribs();for(var C in y){var v=y[C],i=s.rects[C];if(i&&N(cs(v.transparent,X,S))){S._picking&&jk(J,j,K,X,C);var u=cs(v.shape3d,X,S),B=u?[u]:cs(v.names,X,S),g=B?B.length:0,r=cs(v.textureScale,X,S)||1,q=cs(v.light,X,S);q==F&&(q=u?!0:!1),cb(J,R,cs(v.blend,X,S),q,cs(v.opacity,X,S),cs(v.reverseFlip,X,S),cs(v.reverseColor,X,S),cs(v.reverseCull,X,S));for(var d=0;g>d;d++){var Q=B[d],z=i[d];if(Af(w,z.mat),u)am(S,X,go(w,u),w);else{var I=ij(Q);if(I){var k=z.width*r,t=z.height*r;if(k>=1&&t>=1){var G=af(k,t);qs(G,I,cs(v.stretch,X,S),0,0,k,t,X,S),G.restore(),yn(J,dc,l),Wb(J,R,l,cs(v.discardSelectable,X,S),_.uv,Rk),U.aPosition=ph(J,_.vs,z.vs,F),U.aNormal=ge(J,_.ns,$c,F),Rj(J,_.is,Fn),yf(J,0,Fn.length),gi(J,R,l)}}}Yk(S)}bh(J,R)}}}}});var Ks=function(s,v){tl(Ks,this,[s,v])};cd(Ks,Js,{_16O:function(j,c,H,G,l,W,V,B,A){var O=this.data,k=O.getFinalScale3d(),w=cm(c,k,H,G,B,A);if(O.hasOwnProperty("_anchor")||O.hasOwnProperty("_anchorElevation")){var Z=O.getAnchor3d();w[0]-=(Z.x-.5)*k[0],w[1]-=(Z.y-.5)*k[1],w[2]-=(Z.z-.5)*k[2]}return Wj(Bf(),w,O.p3(),G,l,W,V,j,O.getFinalRotation3d(),O.getRotationMode())},clear:function(){var j=this;j.faceMat=j.mat=j.shapeModel=j.left=j.right=j.front=j.back=j.top=j.bottom=j.csg=F},needValidate:function(S){if(this._iv)return this._validateFrameId=S._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var r=S._renderInfo.frame;if(this._validateFrameId!==r)return this._validateFrameId=r,!0}return!1},validate:function(y,L){var D=this,x=D.gv,Y=D.data,N=D.shapeName=D.s(Vm),Z=go(D,N);if(D._updateAutoRotation(),D._updateFixSize2d(),D._updateOverlapping(),D.dispatchBoundingBoxChanged(),this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")){var r=Y.getRenderLayer(),s=x._40Q.get(r);s&&s.ivWireframeBatch(Y)}var m=Vl(Y,x.getMat(Y),Z?D.s("shape3d.scaleable"):!0);if(Y.appendAnchorMatrix3d(m),D.clear(),D.mat=Y.mat=m,Z||!N)if(D.shapeModel=Z,y)if(Z)Zi(x,Y,Z,D,D.getBodyColor(),[m],y);else{var H=ie(m);ug(x,Y,y,L,m,H,aq,jq),ug(x,Y,y,L,m,H,zc,Yl),ug(x,Y,y,L,m,H,Ob,dm),ug(x,Y,y,L,m,H,fe,Li),ug(x,Y,y,L,m,H,Br,Dr),ug(x,Y,y,L,m,H,Ie,pk)}else Z||(D._cubeUvs=null,D.vf(aq,0),D.vf(zc,16),D.vf(Br,8),D.vf(Ie,24),D.vf(Ob,32),D.vf(fe,40))},_updateAutoRotation:function(){var D=new kn,T=new bf,P=new io,n=new io,j=new io;return function(){var I=this,M=I.data,p=I.s("autorotate")||I.s("shape3d.autorotate");if(!p)return M._dynamicRotation&&delete M._dynamicRotation,void 0;var s=I.gv;j.copy(I.s("shape3d.autorotate.up")||s._up);var r;r="string"==typeof p?[p.indexOf("x")<0?s._eye[0]:s._center[0],p.indexOf("y")<0?s._eye[1]:s._center[1],p.indexOf("z")<0?s._eye[2]:s._center[2]]:s._eye;var h=s._center,H=M.p3();P.copy(H),n.set(r[0]-h[0],r[1]-h[1],r[2]-h[2]).add(P),T.lookAt(n,P,j),D.set(0,0,0,M.getRotationMode(),!0).setFromRotationMatrix(T);var o=M._dynamicRotation;o&&Math.abs(o[0]-D.x)<1e-5&&Math.abs(o[1]-D.y)<1e-5&&Math.abs(o[2]-D.z)<1e-5||(M._dynamicRotation=[D.x,D.y,D.z])}}(),_updateFixSize2d:function(){var h=this,A=h.data,b=h.s("fixSizeOnScreen")||h.s("shape3d.fixSizeOnScreen");if(!b)return A._dynamicScale3d&&delete A._dynamicScale3d,void 0;var z=h.gv,s=Vl(A,z.getMat(A)),$=vr([0,0,0],s),V=z.toViewPosition($);if(!isNaN(V.x)&&!isNaN(V.y)){var T=vr([1,0,0],s),i=z.toViewPosition(T),r=vr([0,1,0],s),c=z.toViewPosition(r),B=i.x-V.x,k=c.y-V.y;if(B&&k){var q,D,G=A._dynamicScale3d||[1,1,1],w=ij(A.s("shape3d.image"));if(b[0]>0&&(q=b[0]),b[1]>0&&(D=b[1]),!q||!D){var l=b>0?b:1;q||(q=(ob(w,A)||A.getWidth())*l),D||(D=($n(w,A)||A.getTall())*l)}var H=Math.abs(B/q),y=Math.abs(k/D);Math.abs(H-1)<.001&&Math.abs(y-1)<.001||(A._dynamicScale3d=[G[0]/H,G[1]/y,G[2]])}}},_updateOverlapping:function(){var Q=this,x=Q.s("hide.overlapping.group");if(!x)return Q._rectOverlapping&&(Q._rectOverlapping=_),void 0;var p,N,n,D=Q.gv,k=Q.data,A=Vl(k,D.getMat(k)),h=1/0,u=1/0,m=-1/0,t=-1/0,V=k.getAnchor3d(),g=V.x,U=V.y,r=V.z;for(p=0;8>p;p++){if(N=vr([(p>>2)-g,(1&p>>1)-U,(1&p)-r],A),n=D.toViewPosition(N),isNaN(n.x)||isNaN(n.y))return;h=Math.min(h,n.x),m=Math.max(m,n.x),u=Math.min(u,n.y),t=Math.max(t,n.y)}var y={x:h,y:u,w:m-h,h:t-u};Q._rectOverlapping=D.overlappingBox.isOverlapping(x,y)},getVectorDynamicSize:function(){var f,s=this,l=s.s("shape3d"),Y=s.data;if("billboard"===l||"plane"===l||(f=Y._currentCubeElementId)!=F){var g,R,b=s.gv,j=Vl(Y,b.getMat(Y)),N=Y.getAnchor3d(),G=.5-N.x,i=.5-N.y,w=.5-N.z,c=Math.min(s.s("vector.dynamic.maxsize"),b._glCapabilities.maxTextureSize)/b.getDevicePixelRatio(),x=function(x,s){x[0]+=G,x[1]+=i,x[2]+=w,s[0]+=G,s[1]+=i,s[2]+=w;var E=b.toViewPosition(vr(x,j)),H=b.toViewPosition(vr(s,j)),z=E.x-H.x,$=E.y-H.y;return Math.min(c,Math.sqrt(z*z+$*$))};if("billboard"===l)g=x([-.5,0,0],[.5,0,0]),R=x([0,-.5,0],[0,.5,0]);else if("plane"===l)g=x([-.5,0,0],[.5,0,0]),R=x([0,0,-.5],[0,0,.5]);else if(Y._currentCubeElementId!=F){var I=3*Bj[f+1],H=3*Bj[f],K=3*Bj[f+2];g=x([tc[I],tc[I+1],tc[I+2]],[tc[K],tc[K+1],tc[K+2]]),R=x([tc[I],tc[I+1],tc[I+2]],[tc[H],tc[H+1],tc[H+2]])}return[g,R]}},vf:function(u,E){var Y=this;if(Y.gv.getFaceVisible(Y.data,u)){var l=pg(Y,u);l.mat&&(Y.faceMat=!0);var i=l.uv;if(i){var w=Y._cubeUvs;w||(w=Y._cubeUvs=new ad([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var J=0;8>J;J++)w[E+J]=i[J]}return l}},_billboardInView:function(){var m=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],j=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],e=new fq,K=new io,n=new bf;return function(z){var J=this;if(!J.mat)return!0;var _=J.gv.getFrustum(),P="billboard"===z?m:j;e.makeEmpty(),n.fromArray(J.mat);for(var r=0,$=P.length;$>r;r+=3)e.expandByPoint(K.fromArray(P,r).applyMatrix4(n));return _.intersectsBox(e)}}(),_80o:function(a,y,Y){var A=this;if(A._rectOverlapping)return!0;var s=A.shapeModel;if(s||!A.shapeName){var L=A.s("shape3d");if(("billboard"===L||"plane"===L)&&!A._billboardInView(L))return!0;var i=A.gv,p=A.data,j=i._cube,G=zs.for(a),D=G.directAttribs();if(Lp&&!Mk){var v=A.mat;if(v)for(var t=0;t<v.length;t++)A.mat[t]=v[v.length-t-1]}pn(i,A.mat),A.s("shape3d.reflector")&&!a._picking||(s?am(i,p,s,A,A.getBodyColor(),Y):(D.aPosition=ph(a,j.vs,F,F),D.aNormal=ph(a,j.ns,F,F),vc(a,j.is),A._18O(a,y,"left",0,Y),A._18O(a,y,"front",6,Y),A._18O(a,y,"right",12,Y),A._18O(a,y,"back",18,Y),A._18O(a,y,"top",24,Y),A._18O(a,y,"bottom",30,Y))),Yk(i),A.faceMat&&(A._18O(a,y,"left",0,Y,!0),A._18O(a,y,"front",6,Y,!0),A._18O(a,y,"right",12,Y,!0),A._18O(a,y,"back",18,Y,!0),A._18O(a,y,"top",24,Y,!0),A._18O(a,y,"bottom",30,Y,!0))}},_18O:function(i,p,r,l,f,$){var H=this[r];if(H){if(!f(H.transparent))return;if($&&!H.mat||!$&&H.mat)return;var s=this.data.s("polygonOffset");s&&wm(i,s),$&&pn(this.gv,H.mat);var M=this,B=M.data,n=zs.for(i),t=n.directUniforms();B._currentCubeElementId=l;var L=M.gv,h=L.getTexture(H.texture,B,r),G=H.uv,Y=H.uvScale,X=H.uvOffset,q=H.uvRotation,V=H.discardSelectable;h?G?Wb(i,p,h,V,L._buffer.uv,M._cubeUvs,X,Y,q):Wb(i,p,h,V,L._cube.uv,F,X,Y,q):Wb(i),cb(i,p,H.blend,H.light,H.opacity,H.reverseFlip,H.reverseColor,H.reverseCull),t.uDiffuse=H.color||W["color.empty"],yf(i,l,6),bh(i,p),gi(i,p,h),$&&Yk(L),s&&nr(i),B._currentCubeElementId=null}},drawReflector:function(){var n=new io,C=new io,K=new kn,Z=new bf,D=new io,u=new io,M=new io,g=new io,y=new bf,R=new bf,e=new Jp,G=new Zf,N=new Zf,w=function(J,d,I){J[I]=d[0],J[I+1]=d[1],J[I+2]=d[2]},L=function(t,A){w(t,A.getEye(),0),w(t,A.getCenter(),3),w(t,A.getUp(),6)},B=function(n,Y){Y._eye=[n[0],n[1],n[2]],Y._center=[n[3],n[4],n[5]],Y._up=[n[6],n[7],n[8]],Y._18Q=F;var i=Y._skybox;i&&(i.p3([n[0],n[1],n[2]]),Y.getData3dUI(i).iv())};return function(f){var h=this;h._reflectorInfo=null;var j=h.data;if(j._reflecting)return!1;var E=h.gv;if(E._picking)return!1;var x=h._reflectorRenderTarget,p=E._canvas.width,z=E._canvas.height;x?x.setSize(f,p,z):x=h._reflectorRenderTarget=new Mj.RenderTarget(E,f,p,z),n.copy(j.p3()),C.copy(E.getEye()),Z.makeRotationFromEuler(K.set(j.r3(),j.getRotationMode(),!0));var t;if(!h._reflectNormal){var t=go(h,h.s("shape3d"));if(!t)return!1;if(!t.ns&&t.length&&(t=t[0]),!t.ns||!t.vs)return!1;h._reflectNormal=[t.ns[0],t.ns[1],t.ns[2]],h._reflectorVbuffer=Cs.Buffer.createVertexBuffer(f,new Float32Array(t.vs))}if(D.copy(h._reflectNormal),D.applyMatrix4(Z),u.subVectors(n,C),u.dot(D)>0)return!1;u.reflect(D).negate(),u.add(n),M.copy(E.getCenter()).negate().add(n),M.reflect(D).negate(),M.add(n),g.copy(E.getUp()),g.reflect(D);var m=[0,0,0,0,0,0,0,0,0];L(m,E),E._eye=u.toArray(),E._center=M.toArray(),E._up=g.toArray(),E._18Q=F;var d=E._skybox;d&&(d.p3(E._eye),E.getData3dUI(d).iv()),Oo(f,x.frame),E.setViewport(f,0,0,x.width,x.height);var H=j.s("shape3d.reflector.background");if(H){var U=f.getParameter(f.COLOR_CLEAR_VALUE);hc(f,H)}else hc(f,[0,0,0,1]);zs.for(f).glState.depth.mask=!0,f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT);var P=j.s("shape3d.reflector.clip"),w=P===_?.003:P,X=js(E),i=Bc(E);e.setFromNormalAndCoplanarPoint(D,n.add(D.clone().multiplyScalar(w))),e.applyMatrix4(R.fromArray(i)),G.set(e.normal.x,e.normal.y,e.normal.z,e.constant),R.fromArray(X).getInverse(R),N.set(Math.sign(G.x),Math.sign(G.y),1,1).applyMatrix4(R),G.multiplyScalar(2/G.dot(N)),X[2]=G.x-X[3],X[6]=G.y-X[7],X[10]=G.z-X[11],X[14]=G.w-X[15];var b=E._computedProjectMatrix;E._computedProjectMatrix=X,j._reflecting=!0,E.renderScene({renderAxis:!1,renderEdit:!1,renderGrid:!1}),E._computedProjectMatrix=b,y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),y.multiply(R.fromArray(E._projectMatrix)),y.multiply(R.fromArray(E._viewMatrix)),H&&hc(f,U),sn(f),B(m,E);var r=j.s("shape3d.reflector.blur");if(r){var J=E.getPostProcessingModule("Blur");J&&J.drawImpl(f,x,r,r>=3,j.s("shape3d.reflector.blur.iterations"))}var O=f._compiledShader.reflector;O||(O=f._compiledShader.reflector=new Cs.Shader(f,kp.Reflector.vs,kp.Reflector.fs)),O.bind(),f.activeTexture(f.TEXTURE0),ri(f,x.texture),O.uniforms.tDiffuse=0,O.uniforms.color=Sj(j.s("shape3d.reflector.color")||"rgb(128,128,128)"),O.uniforms.textureMatrix=y.toArray(),O.uniforms.modelMatrix=Vl(j),O.uniforms.viewMatrix=Bc(E),O.uniforms.projectionMatrix=js(E),h._reflectorVbuffer.upload(),O.attributes.pos.pointer(h._reflectorVbuffer);var o=this.s("shape3d.transparent");if(o){var S=zs.for(f).glState,a=S.depth.mask;S.depth.mask=!1}return f.drawArrays(f.TRIANGLES,0,6),o&&(S.depth.mask=a),j._reflecting=!1,f.useProgram(E._prg),ri(f,F),!0}}()}),kp.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Ls=function(g,O){tl(Ls,this,[g,O])};cd(Ls,Ks,{_80o:function(){}});var Ms=function(g,T){tl(Ms,this,[g,T])};cd(Ms,Js,{_25Q:1,validate:function(r){var o=this;if(!o.s("geometry.cache")||!o.info){var x=o.gv,U=o.data,K=o.s,D=K("edge.width"),P=U._40I,q=U._41I;if(o.shapeModel=o.info=o.lineShapeModel=F,P&&q){var v,w,e,h,A,X,V,b,E,H,W=U.isLooped(),l=K(ss),I=C.getEdgeType(l);if(I){var S=I(U,Ki(o,x,U,W,l),x,o._19Q);if(!S.points||S.points.isEmpty())return;X=o.info={},V=S.segments,A=S.points,b=A.size();for(var d=P.getElevation(),y=q.getElevation(),G=0;b>G;G++){var i=A.get(G);i.e==F&&(i.e=d+(y-d)*G/(b-1))}E=fr(A.get(0)),H=fr(A.get(b-1));var L=b%2;0===L?(X.c1=fr(A.get(b/2-1)),X.c2=fr(A.get(b/2))):X.p3=fr(A.get((b-L)/2)),X.s1=E,X.s2=fr(A.get(1)),X.t1=fr(A.get(b-2)),X.t2=H}else{A=new _n,X=o.info={};var n=K("edge.offset"),c=K("edge.center"),O=K("edge.source.t3"),f=K("edge.target.t3"),g=Vg(x,U,"source"),N=Vg(x,U,"target");if(!g||!N)return x.invalidateData(U),delete o.info,!1;if(O&&(g[0]+=O[0],g[1]+=O[1],g[2]+=O[2]),f&&(N[0]+=f[0],N[1]+=f[1],N[2]+=f[2]),l===Gf){V=K("edge.segments");var a=X.points=K(rn)||En;if(b=a.size()){E=fr(a.get(0)),H=fr(a.get(b-1)),!c&&n&&(e=No(E,g,!0),n=B(n,kj(g,E)),g=[g[0]+e[0]*n,g[1]+e[1]*n,g[2]+e[2]*n],e=No(N,H,!0),n=B(n,kj(H,N)),N=[N[0]-e[0]*n,N[1]-e[1]*n,N[2]-e[2]*n]);var L=b%2;0===L?(v=fr(a.get(b/2-1)),w=fr(a.get(b/2))):X.p3=fr(a.get((b-L)/2)),X.s1=g,X.s2=E,X.t1=H,X.t2=N
}else!c&&n&&(e=No(N,g,!0),h=kj(g,N),n=Yr(n,h),g=[g[0]+e[0]*n,g[1]+e[1]*n,g[2]+e[2]*n],N=[N[0]-e[0]*n,N[1]-e[1]*n,N[2]-e[2]*n]),v=g,w=N;A.add({x:g[0],y:g[2],e:g[1]}),A.addAll(a),A.add({x:N[0],y:N[2],e:N[1]})}else{var u=Ki(o,x,U,W,l);if(o._19Q||(u=-u),W){var $=g[0],k=g[1],s=g[2],j=P.getTall()/2+u;v=[$-u,k+j,s],w=[$+u,k+j,s],A.add({x:$-u,y:s,e:k}),A.add({x:$-u,y:s,e:k+j}),A.add({x:$+u,y:s,e:k+j}),A.add({x:$+u,y:s,e:k})}else{e=No(N,g,!0),h=kj(g,N);var M={x:g[0],y:g[2]},T={x:N[0],y:N[2]},Y=ak(F,M,T,u),R=Y.x-M.x,Z=Y.y-M.y;n=Yr(n,h),e[0]*=n,e[1]*=n,e[2]*=n,v=[g[0]+e[0]+R,g[1]+e[1],g[2]+e[2]+Z],w=[N[0]-e[0]+R,N[1]-e[1],N[2]-e[2]+Z],c?(A.add({x:g[0],y:g[2],e:g[1]}),A.add({x:v[0],y:v[2],e:v[1]}),A.add({x:w[0],y:w[2],e:w[1]}),A.add({x:N[0],y:N[2],e:N[1]})):(A.add({x:v[0],y:v[2],e:v[1]}),A.add({x:w[0],y:w[2],e:w[1]}))}}X.c1=v,X.c2=w}X._lastPointsSegments={points:A,segments:V},X.list=K(Vm)===ur?o.createTubeModel(A,V,D/2,r):o.createLineModel(A,V,D,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=F}});var Ns=function(M,o){tl(Ns,this,[M,o]),this._needRecoverPosition=!0};cd(Ns,Ks,{_80o:function(b,W,_){var v=this,K=v.mat;if(K){var h=v.gv,C=v.shapeModel;pn(h,K),C?am(h,v.data,C,v,v.getBodyColor(),_):(tn(v,b,W,"left",_),tn(v,b,W,"front",_),tn(v,b,W,"right",_),tn(v,b,W,"back",_),tn(v,b,W,"top",_),tn(v,b,W,"bottom",_)),Yk(h)}},validate:function(q,C){var u,V,m=this,M=m.s,c=m.data,X=c._thickness/2,l=c.isClosePath(),w=c.getPoints(),Q=c.getSegments(),r=M(Il),P=q&&q.uv;if(m.clear(),m.dispatchBoundingBoxChanged(),0>X){try{var W=M("shape3d.image.projection");if(W&&W[4]){var b=c.p3(),x=b[0],s=b[2];W=[x+W[0],W[1]-s,x+W[2],W[3]-s]}V=m.shapeModel=Dk(w,Q,M(ai),M(jb),r,M(or),c.getTall(),c.getShapeElevation(),l,W)}catch(y){V=m.shapeModel={}}M(Ur)?M("shape3d.image")||delete V.uv:(delete V.vs,delete V.ns,delete V.uv),M("shape3d.top.image")||delete V.top_uv,M("shape3d.bottom.image")||delete V.bottom_uv}else if(M(Vm)===ur)u=tg(w,Q,r,l),V=m.shapeModel={vs:[]},M("shape3d.image")&&(V.uv=[],V.sum=M(or)||Pm(u)||1,V.len=0),M(ai)&&!l&&(V.top_vs=[],M("shape3d.top.image")&&(V.top_uv=[])),M(jb)&&!l&&(V.bottom_vs=[],M("shape3d.bottom.image")&&(V.bottom_uv=[])),m._12O(u,X);else{var G,J,k,A,h,i,g,v,p,z;if(u=tg(w,Q,r,l),h=m.vf(Br,P,!1,C),X&&(i=m.vf(Ie,P,!1,C),g=l?F:m.vf(aq,P,!1,C),v=l?F:m.vf(zc,P,!1,C),p=m.vf(Ob,P,!1,C),z=m.vf(fe,P,!1,C)),X){for(var L=0,E=u.length;E>L;L++)u[L]=m._tryRemoveBezierPoints(u[L],X);m._12O(u,X)}else h&&u.forEach(function(U){if(A=U.length,A>0)for(G=U[0],k=1;A>k;k++)J=U[k],m.addV(h.vs,G,J),G=J});m._20Q(u),q||(h&&(h.ns=lk(h.vs),Ib(h,"vs"),Ib(h,Rb)),X&&(i&&(i.ns=lk(i.vs),Ib(i,"vs"),Ib(i,Rb)),g&&(g.ns=lk(g.vs),Ib(g,"vs"),Ib(g,Rb)),v&&(v.ns=lk(v.vs),Ib(v,"vs"),Ib(v,Rb)),p&&(p.ns=lk(p.vs),Ib(p,"vs"),Ib(p,Rb)),z&&(z.ns=lk(z.vs),Ib(z,"vs"),Ib(z,Rb))))}var O=m.mat=c.getPointsMatrix3d().getElements();q&&(Un(m,O,q,V),m.clear())},_20Q:function(l){var E,P,u,M,d,V,n,x=this,S=x.front,_=x.back,v=x.top,J=x.bottom,e=S?S.tuv:F,W=_?_.tuv:F,D=v?v.tuv:F,G=J?J.tuv:F,A=0;(e||W||D||G)&&(E=x.s(or)||Pm(l)||1,l.forEach(function(Y){if(P=Y.length,P>0)for(V=Y[0],u=1;P>u;u++)n=Y[u],M=A/E,A+=kj(V,n),d=A/E,x._14O(S,M,d),x._14O(_,1-d,1-M),x._14O(v,M,d),x._14O(J,M,d),V=n}))},_14O:function(u,C,n){if(u){var r=u.uv,x=u.tuv;if(x){if(r)var t=r[0]+(r[6]-r[0])*C,K=r[1]+(r[7]-r[1])*C,F=r[2]+(r[4]-r[2])*C,N=r[3]+(r[5]-r[3])*C,B=r[2]+(r[4]-r[2])*n,v=r[3]+(r[5]-r[3])*n,j=r[0]+(r[6]-r[0])*n,m=r[1]+(r[7]-r[1])*n;else t=C,K=0,F=C,N=1,B=n,v=1,j=n,m=0;x.push(F,N,B,v,j,m,j,m,t,K,F,N)}}},_13O:function(x){var _=x.uv,e=x.tuv;e&&(_?e.push(_[2],_[3],_[4],_[5],_[6],_[7],_[6],_[7],_[0],_[1],_[2],_[3]):e.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(Q,W){var b=Q.length;if(4>b)return Q;var t,H,L,a,z,R,O=!1,j=function(T){return Q[T]},p=function(T){return Q[b-1-T]};for(z=0;1>=z;z++)for(R=z?p:j,H=R(0),L=R(1),t=2;b-1>t;t++)if(a=R(t),!a.remove)if(a.b){var Z=ak(H,L,a,W);Z.adjust?(a.remove=!0,O=!0):(H=L,L=a)}else H=L,L=a;if(!O)return Q;var r=[];for(t=0;b>t;t++)Q[t].remove||r.push(Q[t]);return r},_12O:function(h,W){var f,G,k,S,B,n=this.s("shape3d.point.epsilon"),r=this;h.forEach(function(s){if(B=s.length,B>0)for(f={p:s[0],n:!0},S=1;B>S;S++)G=s[S],k=B-1>S?s[S+1]:F,k&&Math.abs(G.x-k.x)<n&&Math.abs(G.y-k.y)<n||r.addPoint(f,G,k,W,s)})},addPoint:function(C,u,e,s,g){var P,R,D,$,Z,S,p,J,G,W=this,O=C.p,Y=C.f,Q=C.b,_=W.s("shape3d.side")||ib,w=W.s("shape3d.start.angle"),N=W.s("shape3d.sweep.angle"),r=W.shapeModel,l=W.data.isClosePath();if(C.n&&(C.n=!1,Y=l&&g.length>2?ak(g[g.length-2],O,u,s):ak(F,O,u,s),Q=rk(O,Y),r?r.top_vs&&W._10O(Q,Y,_,w,N,r.top_vs,r.top_uv):(P=W.left)&&(W.addV(P.vs,Q,Y),W._13O(P))),R=e?ak(O,u,e,s):l&&g.length>2?ak(O,u,g[1],s):ak(O,u,F,s),D=rk(u,R),r){var d,T,H=r.vs,y=r.uv,k=r.sum;for(y&&(d=r.len/k,r.len+=kj(O,u),T=r.len/k),S=W._9O(Q,Y,_,w,N),p=W._9O(D,R,_,w,N),J=0;_>J;J++)G=J+1,hj(H,S[G]),hj(H,p[J]),hj(H,S[J]),hj(H,p[J]),hj(H,S[G]),hj(H,p[G]),y&&($=J/_,Z=G/_,y.push(d,Z,T,$,d,$,T,$,d,Z,T,Z));!e&&r.bottom_vs&&W._10O(D,R,_,w,N,r.bottom_vs,r.bottom_uv,!0)}else!e&&(P=W.right)&&(W.addV(P.vs,R,D),W._13O(P)),(P=W.front)&&W.addV(P.vs,Y,R),(P=W.back)&&W.addV(P.vs,D,Q),(P=W.top)&&W.addH(P.vs,Y,R,D,Q,!0),(P=W.bottom)&&W.addH(P.vs,Q,D,R,Y);C.p=u,C.f=R,C.b=D},_10O:function(x,T,V,h,F,t,S,W){var d,q,y=this,G=y.data,m=y._9O(x,T,V,h,F),f=(x.x+T.x)/2,I=(x.y+T.y)/2,D=G.getShapeElevation(),R=0;for(R=0;V>R;R++)W?(hj(t,m[R]),hj(t,m[R+1])):(hj(t,m[R+1]),hj(t,m[R])),hj(t,[f,D,I]),S&&(W?(d=E*(R+1)/V+h,q=E*R/V+h):(d=E*R/V+h,q=E*(R+1)/V+h),S.push(.5-.5*L(q),.5-.5*u(q),.5-.5*L(d),.5-.5*u(d),.5,.5))},_9O:function(v,z,b,d,A){var _,g,R=this,N=R.data,I=[],Z=(v.x+z.x)/2,Y=(v.y+z.y)/2,H=N.getTall()/2,C=N.getShapeElevation(),y=0;for(A==F&&(A=E);b>=y;y++)_=A*y/b+d,g=L(_),I.push([Z+(v.x-Z)*g,C+H*u(_),Y+(v.y-Y)*g]);return I},addV:function($,z,q){var J=z.x,p=z.y,R=q.x,M=q.y,Q=this.data,P=Q.getShapeElevation(),i=Q.getTall()/2;$.push(J,P-i,p,R,P-i,M,R,P+i,M,R,P+i,M,J,P+i,p,J,P-i,p)},addH:function(x,u,a,K,L,P){var $=this.data,H=$.getTall()/2,c=$.getShapeElevation()+(P?H:-H);x.push(u.x,c,u.y,a.x,c,a.y,K.x,c,K.y,K.x,c,K.y,L.x,c,L.y,u.x,c,u.y)},vf:function(_,y,Q,S){var T,q=this,K=q.gv.getFaceVisible(q.data,_);return(Q||K)&&(T=pg(q,_,S),T.vs=[],T.tuv=K&&(T.texture||y)?[]:F,T.visible=K),T}});var Os=function(O,N){tl(Os,this,[O,N])},Ps={},Qs=function(d){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(d)};cd(Os,Ks,{validate:function(){var T=this,z=T.gv,P=T.data,V=T.s,N=Sj(V("points.color")),B=V("points.size"),J=V("points.uv.offset"),l=V("points.image");!l||Qs(l)||Mr.test(l)||(Ps[l]||(Ps[l]=T._createCachedImage(l)),l=Ps[l]);var E,c,n=P._modelDirty,Z=V("points.model");if(Z){if(T._lastShapeModel!==Z||!T.shapeModel){var p=go(T,Z);if(!p)return;var M=[],d={};T.eachShapeModel(function(r){for(var B=0,s=r.length;s>B;B+=3){var f=r[B],S=r[B+1],$=r[B+2],Y=""+f+"_"+S+"_"+$;d[Y]||(d[Y]=!0,M.push(f,S,$))}},p),T._setShapeModelPoints(new ad(M)),T._lastShapeModel=Z,n=!0}E=T.shapeModel.vs.length,c=E/3}else{var $=P.getPoints();if(c=E=$.length,n||P._pointsDirty||!T.shapeModel){for(var L=[],F=0;c>F;F++){var O=$[F];O&&L.push(O.x,O.e,O.y)}T._setShapeModelPoints(new ad(L)),P._pointsDirty=!1,T._lastShapeModel=null,n=!0}}if(T.info={mat:Vl(P),size:B,diffuse:N,opacity:V("points.opacity"),texture:l,alphaTest:V("points.transparent")?0:V("alphaTest"),uvScale:V("points.uv.scale"),uvOffset:J,discardSelectable:V("points.discard.selectable")},n||P._colorsDirty){var X=!1,g=P.getColors();if(g&&g.length>0)for(var r=[],F=0;c>F;F++)for(var x=g[F],t=x?(X=!0,Sj(x)):N,h=4*F,w=0;4>w;w++)r[h+w]=t[w];T.shapeModel.cs=X?new ad(r):null,P._colorsDirty=!1}if(n||P._sizesDirty){var o=!1,I=P.getSizes();if(I&&I.length>0)for(var G,Y=[],F=0;c>F;F++)G=I[F],G>=0?(Y.push(G),o=!0):Y.push(B);T.shapeModel.ss=o?new ad(Y):null,P._sizesDirty=!1}if(n||P._offsetsDirty){var j=!1,C=P.getUvoffsets();if(C&&C.length>0)for(var i,q,W,y=[],F=0;c>F;F++)i=2*F,q=C[i],W=C[i+1],q!=_&&W!=_?(y.push(q,W),j=!0):y.push(J[0],J[1]);T.shapeModel.os=j?new ad(y):null,P._offsetsDirty=!1}if(n||T._lastPointNumber!==c){this.dispose();var v=z.pickColorMap,e=T._startPickId=v._pickIdUsed;v._pickIdUsed=e+c;for(var L=[],F=0;c>F;F++){var R=e+F,A=$f(R);L.push(A[0],A[1],A[2],A[3]),v[R]||(v[R]={data:P,part:F})}T.shapeModel.ps=new ad(L),T._lastPointNumber=c}P._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(s){var F=this,q=F.shapeModel,f=F.shapeModel={vs:s};if(!q)return f;var Q=s.length,e=Math.round(Q/3);return q.cs&&q.cs.length==4*e&&(f.cs=q.cs),q.ss&&q.ss.length==e&&(f.ss=q.ss),q.os&&q.os.length==2*e&&(f.os=q.os),q.ps&&q.ps.length==4*e&&(f.ps=q.ps),f},_createCachedImage:function(a){var h=128,D=ys(),z=D.getContext("2d");Db(D,h,h,1),Fp(z,{width:h,height:h,comps:[{type:a,background:"white",borderWidth:0,rect:[0,0,h,h]}]},0,0,h,h);var o=V.Math.generateUUID();return pr[o]=D,o},_80o:function(L,Y){var i=this,S=i.gv,x=S._picking;if(!x||S.isSelectable(i.data)){var I=i.shapeModel,H=i.info;if(I&&I.vs&&I.vs.length){var h=zs.for(L);h.useProgram(i._asureProgram(L));var b=h.directUniforms(),T=h.directAttribs();b.modelMatrix=H.mat,b.modelViewMatrix=Si([],S._viewMatrix,H.mat),b.projectionMatrix=S._projectMatrix,b.viewMatrix=S._viewMatrix,b.scale=S.getHeight()/2,b.size=H.size,b.diffuse=H.diffuse,b.opacity=H.opacity,b.map=S.getTexture(H.texture,i.data),b.alphaTest=H.alphaTest,b.resolution=S.getDevicePixelRatio(),b.discardSelectable=H.discardSelectable,b.uvScale=H.uvScale,T.uvOffset=!x&&I.os?ge(L,S._buffer.os,I.os,F):H.uvOffset,b.blackout=L._blooming&&!i.data.s("bloom"),T.position=ge(L,S._buffer.vs,I.vs,F),x?(b.picking=!0,T.pickColor=ge(L,S._buffer.ps,I.ps,F),b.useColor=!1,T.color=null):(b.picking=!1,T.pickColor=null,I.cs?(b.useColor=!0,T.color=ge(L,S._buffer.cs,I.cs,F)):(b.useColor=!1,T.color=null)),I.ss?(b.useSizeArray=!0,T.sizeArray=ge(L,S._buffer.ss,I.ss,F)):(b.useSizeArray=!1,T.sizeArray=null),Pr(L,0,I.vs.length/3,L.POINTS),h.useProgram(Y),T.disable(),S.shadowMap.enable&&S.shadowMap.createShadow()}}},_asureProgram:function(E){return E._pointsShader||(E._pointsShader=this.gv._postProcessing.createShader(E,Os.shaderSrc)),E._pointsShader.program},dispose:function(){Os.superClass.dispose.call(this);var f=this._startPickId,j=this._lastPointNumber;if(f&&j){for(var x=this.gv.pickColorMap,J=0;j>J;J++){var z=f+J;x[z]&&delete x[z]}delete this._startPickId,delete this._lastPointNumber}}}),Os.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var Rs=function(_,W){tl(Rs,this,[_,W]),this._needRecoverPosition=!0};cd(Rs,Js,{_25Q:1,validate:function(q){var E=this,L=E.data,r=E.s,U=L.getPoints(),d=U.size();E.dispatchBoundingBoxChanged();var A=L.p3(),w=E.mat=Bf();jc(w,A),sp(w,L.getFinalRotation3d(),L.getRotationMode());var Q=L.getScale3d(),K=L._dynamicScale3d;if(K&&(Q[0]*=K[0],Q[1]*=K[1],Q[2]*=K[2]),ul(w,Q),jc(w,Wd(A)),(!E.s("geometry.cache")||!E.shapeModel)&&(E.shapeModel=E.info=E.lineShapeModel=F,d>1)){var i=E.info={},k=L.getSegments(),_=L.getThickness(),I=fr(U.get(0)),W=fr(U.get(d-1)),c=d%2;0===c?(i.c1=fr(U.get(d/2-1)),i.c2=fr(U.get(d/2))):i.p3=fr(U.get((d-c)/2)),i.s1=I,i.s2=fr(U.get(1)),i.t1=fr(U.get(d-2)),i.t2=W,i.list=r(Vm)===ur?E.createTubeModel(U,k,_/2,q):E.createLineModel(U,k,_,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=F},_80o:function(c,g,P){var W=this,f=W.shapeModel;if(f){var K=W.gv;pn(K,W.mat),am(K,W.data,f,W,W.getBodyColor(),P),Yk(K)}}});var Ss=V.graph3d.PostProcessing=function(h){function L(){if(!Q){var d=h.getGL();Q=new Mj.RenderTarget(h,d,null,null,{samples:W.renderTextureSamples||1,minFilter:d.LINEAR,magFilter:d.LINEAR}),k=new Cs.Shader(d,g.vs,g.fs),V=Cs.Buffer.createIndexBuffer(d,new Uint16Array([0,2,1,1,2,3])),p=Cs.Buffer.createVertexBuffer(d,new Float32Array([0,0,1,0,0,1,1,1]))}}var Q,k,V,p,O=this,$={},n=!1;!function(){f.keys(Ss).forEach(function(y){$[y]=new Ss[y](h)})}(),O.getModule=function(H){return H?$[H]:O},O.getModuleList=function(){return f.keys($)},O._serializable=!0,O.handleDataModleChange=function(Z,W){Z&&(O._serializable&&Z.setPostProcessingData(O.serialize()),Z.removeSerializeListener(O.onDataModelSerialize,O)),W&&(W.addSerializeListener(O.onDataModelSerialize,O),O.deserialize(W))},O.onDataModelSerialize=function(a){"serialize"===a.type?O._serializable&&(h.dm()._postProcessingData=O.serialize()):"deserialize"===a.type&&O.deserialize(h.dm())},O.isDeserializeDisabled=function(h){return!O._serializable||h.a("sceneBloom")!==_},O.isSerializable=function(){return O._serializable},O.setSerializable=function(C){O._serializable=C,C||h.dm().setPostProcessingData(_)},O.serialize=function(){var t,v,x,n,X={};for(v in $)if(x=$[v],n=x.serializeProperties){t={},x.enable&&(t.enable=!0);for(var j in n){var D=x[j];D!=n[j]&&(t[j]=D)}f.keys(t).length&&(X[v.toLowerCase()]=t)}return X},O.deserialize=function(s){var y,q,g,Q,S,e={},k={};for(y in $){g=$[y],Q=g.serializeProperties;var H={},I="scene"+y,d=s.a(I);d!==_&&(H.enable=d);for(var S in Q)d=s.a(I+S[0].toUpperCase()+S.slice(1)),d!==_&&d!==Q[S]&&(H[S]=d);Xn(H)||(k[y[0].toLowerCase()+y.slice(1)]=H)}if(Xn(k)&&(k=s.getPostProcessingData()),k)for(q in k)if(q&&(y=q[0].toUpperCase()+q.slice(1),g=$[y])){e[y]=!0,Q=k[q];var P=!!Q.enable;O.enableModule(y,P),y="scene"+y,s.a(y,P),g.resetProperties&&g.resetProperties();for(S in Q)if("enable"!==S){var d=Q[S];g[S]=d,s.a(y+S[0].toUpperCase()+S.slice(1),d)}}for(y in $)e[y]||(g=$[y],g.enable=!1,g.resetProperties&&g.resetProperties())},O.getRenderTarget=function(){return Q},O.blitScreen=function(c,H,U,t,j){var l=h.getGL();if(l){c&&(c.bind(l),h.setViewport(l,0,0,c.width,c.height)),j&&j.clear===!1||l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),L(),U||(U=k),U.bind(),l.activeTexture(l.TEXTURE0+0),ri(l,H);var O=U.uniforms;O.image=0;var d=1;if(t)for(var Y in t){var s=t[Y];s instanceof WebGLTexture&&(l.activeTexture(l.TEXTURE0+d),ri(l,s),s=d,d++),O[Y]=s}if(V.upload(),p.upload(),U.attributes.pos.pointer(p),l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0),d>1)for(;--d>=0;)l.activeTexture(l.TEXTURE0+d),ri(l,null);else ri(l,null);c&&c.unbind(l)}},O.decodeShader=function(S){var f,C,P,T="",G="";for(P=0;P<S.length;P++)f=S[P],"%"===f?f="'":"a"===f?f='"':"]"===f&&(f="\\"),C=String.fromCharCode(f.charCodeAt(0)-1),P%2?G+=C:T=C+T;return G+T},O.createShader=function(R,q,Q){var m,x;if("string"==typeof q){var i=q.indexOf("^#");m=O.decodeShader(q.substr(0,i)),x=O.decodeShader(q.substr(i+2))}else m=q.vs,x=q.fs;if(Q){var o=Q(m,x);o&&o.vs&&(m=o.vs),o&&o.fs&&(x=o.fs)}return new Cs.Shader(R,m,x)},O.enableModule=function(x,f){var q,z,K,g=x.split(",");for(q=0,z=g.length;z>q;q++)K=g[q].trim(),$[K]&&($[K].enable=f);n=!1;for(K in $)if($[K].enable){n=!0;break}n&&L()};var g=O.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};O.render=function(M,i,x,K){if(n){Q.setSize(M,i,x),Q.bind(M);var W=M.getParameter(M.COLOR_CLEAR_VALUE);W&&0===W[0]&&0===W[1]&&0===W[2]&&0===W[3]?W=null:hc(M,[0,0,0,0]),M.clear(M.COLOR_BUFFER_BIT|M.DEPTH_BUFFER_BIT),h.setViewport(M,0,0,i,x),K=K||{};var D=K.renderAxis!==!1,T=K.renderEdit!==!1;K.renderAxis=K.renderEdit=!1,h.renderScene(K),Q.unbind(M);for(var p=0,o=h._glCapabilities.maxAttributes;o>p;p++)M.disableVertexAttribArray(p);var E,k=Q;for(E in $)k=$[E]._42(M,k)||k;h.setViewport(M,0,0,i,x),W&&hc(M,W);var B=O.getModule("Fxaa");return B&&B.enable?O.blitScreen(null,k.texture,B.getShader(M),{resolution:[1/i,1/x]}):O.blitScreen(null,k.texture),M.useProgram(h._prg),h._renderAxisAndEditHelper(D,T),!0}}},Ts=V.graph3d.PostProcessing.HueSaturation=function(i){function I(){X=!0;var D=i.getGL();y=new Mj.RenderTarget(i,D),e=i._postProcessing.createShader(D,Ts.hueSaturationShader),_=Cs.Buffer.createIndexBuffer(D,new Uint16Array([0,2,1,1,2,3])),w=Cs.Buffer.createVertexBuffer(D,new Float32Array([0,0,1,0,0,1,1,1]))}var _,w,e,y,a=this,n=!1,X=!1,Q=[],N=[],Z=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var H=this.serializeProperties;for(var T in H)this[T]=H[T]},this.resetProperties(),f.defineProperties(a,{enable:{get:function(){return n},set:function(h){!!n!=!!h&&(n=h,h&&!X&&I(),i.iv())}},hue:{get:function(){return Q.map(function(b){return P(180*b)})},set:function(f){if(Q!==f&&7===f.length){for(var $=0;7>$;$++)Q[$]=f[$]/180;i.iv()}}},saturation:{get:function(){return N.map(function(F){return P(100*F)})},set:function(f){if(N!==f&&7===f.length){for(var M=0;7>M;M++)N[M]=f[M]/100;i.iv()}}},lightness:{get:function(){return Z.map(function(y){return P(100*y)})},set:function(t){if(Z!==t&&7===t.length){for(var x=0;7>x;x++)Z[x]=t[x]/100;i.iv()}}}}),a._42=function(J,z){if(n){X||I();var T=z.width,S=z.height;if(T&&S){y.setSize(J,T,S),Oo(J,y.frame),i.setViewport(J,0,0,y.width,y.height),J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT),e.bind(),J.activeTexture(J.TEXTURE0+0),ri(J,z.texture);var a=e.uniforms;return a.image=0,a.hue=Q,a.saturation=N,a.lightness=Z,_.upload(),w.upload(),e.attributes.pos.pointer(w),J.drawElements(J.TRIANGLES,6,J.UNSIGNED_SHORT,0),ri(J,null),sn(J),y}}}};Ts.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var Us=V.graph3d.PostProcessing.Bloom=function(z){function h(){var L=z.getGL();if(L)for(var y=z._postProcessing,R=0;U>R;R++)a[R]=y.createShader(L,Us._35Q,function(O,p){return{fs:p.replace(/DEFINE_VALUE/g,B[R]).replace("%OVERRIDE_ALPHA_DEFINE%",d?"#define OVERRIDE_ALPHA":"")}})}function m(){var u=z.getWidth(),f=z.getHeight();if(u&&f){s=[u,f],E=!0;var Z,x=z.getGL(),K=Math.round(s[0]/2),J=Math.round(s[1]/2);for(e=new Mj.RenderTarget(z,x,K,J),Z=0;U>Z;Z++)k.push(new Mj.RenderTarget(z,x,K,J)),l.push(new Mj.RenderTarget(z,x,K,J)),K=Math.round(K/2),J=Math.round(J/2);var I=z._postProcessing;Y=I.createShader(x,Us._34Q),h(),o=I.createShader(x,Us._36Q,function(X,z){return{fs:z.replace(/NUM_MIPS/g,U)}}),G=I.createShader(x,Us.finalShader),t=Cs.Buffer.createIndexBuffer(x,new Uint16Array([0,2,1,1,2,3])),j=Cs.Buffer.createVertexBuffer(x,new Float32Array([0,0,1,0,0,1,1,1]))}}var c,T,i,d,w,t,j,b,X=this,H=!1,E=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var J=this.serializeProperties;for(var F in J)this[F]=J[F]},f.defineProperties(X,{enable:{get:function(){return H},set:function(q){!!H!=!!q&&(H=q,q&&!E&&m(),z.iv())}},strength:{get:function(){return c},set:function(B){c!==B&&(c=B,z.iv())}},threshold:{get:function(){return T},set:function(J){T!==J&&(T=J,z.iv())}},radius:{get:function(){return i},set:function(k){i!==k&&(i=k,z.iv())}},overrideAlpha:{get:function(){return d},set:function(R){!!d!=!!R&&(d=R,E&&h(),z.iv())}},selective:{get:function(){return w},set:function(e){!!w!=!!e&&(w=!!e,z.iv())}}}),this.resetProperties();var e,Y,o,G,s=[256,256],k=[],l=[],U=5,B=[3,5,7,9,11],a=[];X._42=function($,u){function Q(V,Y,H,M){Oo($,Y.frame),z.setViewport($,0,0,Y.width,Y.height),M?M($):$.clear($.COLOR_BUFFER_BIT|$.DEPTH_BUFFER_BIT),P!==V&&V.bind();var U=0;for(var e in H){var w=H[e];w instanceof WebGLTexture&&($.activeTexture($.TEXTURE0+U),ri($,w),w=U,U++),V.uniforms[e]=w}for(P!==V&&(t.upload(),j.upload(),V.attributes.pos.pointer(j),P=V),$.drawElements($.TRIANGLES,6,$.UNSIGNED_SHORT,0);U--;)$.activeTexture($.TEXTURE0+U),ri($,null);sn($)}if(H&&(E||(m(),E))){var P;if(w){b||(b=new Mj.RenderTarget(z,$)),b.setSize($,u.width,u.height),b.bind($);var y=$.getParameter($.COLOR_CLEAR_VALUE);y&&0===y[0]&&0===y[1]&&0===y[2]&&1===y[3]?y=null:hc($,[0,0,0,1]),$.clear($.COLOR_BUFFER_BIT|$.DEPTH_BUFFER_BIT),z.setViewport($,0,0,u.width,u.height),$._blooming=!0,z.syncRenderState(),z.renderScene(),$._blooming=!1,y&&hc($,y),b.unbind($)}Q(Y,e,{smoothWidth:.01,luminosityThreshold:T,tDiffuse:w?b.texture:u.texture});var q,S=e,R=Math.round(s[0]/2),K=Math.round(s[1]/2);for(q=0;U>q;q++)Q(a[q],k[q],{colorTexture:S.texture,direction:[1,0],texSize:[R,K]}),Q(a[q],l[q],{colorTexture:k[q].texture,direction:[0,1],texSize:[R,K]}),R=Math.round(R/2),K=Math.round(K/2),S=l[q];return Q(o,k[0],{blurTexture1:l[0].texture,blurTexture2:l[1].texture,blurTexture3:l[2].texture,blurTexture4:l[3].texture,blurTexture5:l[4].texture,bloomStrength:c,bloomRadius:i,bloomTintColor:[1,1,1]}),Q(G,u,{image:k[0].texture},function(d){zs.for(d).glState.blend.apply({enabled:!0,equation:d.FUNC_ADD,func:[d.SRC_ALPHA,d.ONE]})}),zs.for($).glState.blend.apply({equation:$.FUNC_ADD,func:[$.SRC_ALPHA,$.ONE_MINUS_SRC_ALPHA,$.ONE,$.ONE_MINUS_SRC_ALPHA]}),u}}};Us._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Us._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",Us._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Us.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Vs=V.graph3d.PostProcessing.Dof=function(O){function j(){R=!0;var f=O.getGL();M=new Mj.RenderTarget(O,f),J=O._postProcessing.createShader(f,Vs._38Q),W=Cs.Buffer.createIndexBuffer(f,new Uint16Array([0,2,1,1,2,3])),A=Cs.Buffer.createVertexBuffer(f,new Float32Array([0,0,1,0,0,1,1,1]))}var M,J,W,A,N,y,v,Z,Q=this,n=!1,R=!1,o=Jr.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var x=this.serializeProperties;for(var E in x)this[E]=x[E]},f.defineProperties(Q,{enable:{get:function(){return n},set:function(T){!!n!=!!T&&(n=T,T&&!R&&j(),O.iv())}},image:{get:function(){return y},set:function(p){y!==p&&(y=p,N&&(O.deleteTexture(o),N=null),O.iv())}},maxblur:{get:function(){return v},set:function(J){v!==J&&(v=J,O.iv())}},aperture:{get:function(){return Z},set:function(X){Z!==X&&(Z=X,O.iv())}}}),this.resetProperties(),Q._42=function(k,L){function U(M,o,H,t){Oo(k,o.frame),O.setViewport(k,0,0,o.width,o.height),t?t(k):k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),m!==M&&M.bind();var X=0;for(var b in H){var V=H[b];V instanceof WebGLTexture&&(k.activeTexture(k.TEXTURE0+X),ri(k,V),V=X,X++),M.uniforms[b]=V}for(m!==M&&(W.upload(),A.upload(),M.attributes.pos.pointer(A),m=M),k.drawElements(k.TRIANGLES,6,k.UNSIGNED_SHORT,0);X--;)k.activeTexture(k.TEXTURE0+X),ri(k,null);sn(k)}if(n){R||j();var m;if(!N){var K=ij(this.image);if(!K||!K.comps&&!K.tagName)return L;V.Default.setImage(o,K),N=O.getTexture(o)}var Z=L.width,Y=L.height;if(Z&&Y)return M.setSize(k,Z,Y),U(J,M,{tColor:L.texture,tDepth:N,aspect:Z/Y,aperture:this.aperture,maxblur:this.maxblur}),M}}};Vs._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";
var Ws=V.graph3d.PostProcessing.Blur=function(c){function x(){z=!0;var T=c.getGL();J=new Mj.RenderTarget(c,T),n=c._postProcessing.createShader(T,Ws.hBlurShader),i=c._postProcessing.createShader(T,Ws.vBlurShader)}var n,i,J,N,T,k,B,D,u,v=this,p=!1,z=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var C=this.serializeProperties;for(var B in C)this[B]=C[B]},f.defineProperties(v,{enable:{get:function(){return p},set:function(R){!!p!=!!R&&(p=R,R?c.addRenderLayerListener(M,this):c.removeRenderLayerListener(M,this),R&&!z&&x(),c.iv())}},downSample:{get:function(){return B},set:function(v){B!==v&&(B=v,c.iv)}},value:{get:function(){return k},set:function(M){k!==M&&(k=M,c.iv())}},iterations:{get:function(){return D},set:function(L){D!==L&&(D=L,c.iv())}},layer:{get:function(){return u},set:function(z){u!==z&&(u=z,c.iv())}}}),this.resetProperties();var M=function(d){if(p&&d.layer===u&&"post"===d.phase){var Y=c.getGL();if(!c._picking&&!c.isReflecting(Y)){var g=c._postProcessing.getRenderTarget();g.unbind(Y);for(var b=0,L=c._glCapabilities.maxAttributes;L>b;b++)Y.disableVertexAttribArray(b);v.drawImpl(Y,g),g.bind(Y),Y.useProgram(c._prg)}}};v._42=function(){},v.drawImpl=function(O,d,j,e,g){z||x();var W,v;if(d?(W=d.width,v=d.height):(W=c._viewport[2],v=c._viewport[3]),W&&v){var q=c._postProcessing;"boolean"!=typeof e&&(e=B),j==F&&(j=k),g==F&&(g=D),g=Math.max(1,Math.round(g));var o=zs.for(O).glState.depth,U=o.enabled;if(o.enabled=!1,e){j/=2;var K=[W,v];W/=2,v/=2,N||(N=new Mj.RenderTarget(c,O),T=q.createShader(O,Ws.downSampleShader)),N.setSize(O,W,v),q.blitScreen(N,d.texture,T,{texelSize:[1/K[0],1/K[1]]}),d.setSize(O,W,v)}else N&&N.setSize(0,0);J.setSize(O,W,v);for(var S=[],u=0;g>u;u++)S.push(j),j=Math.max(1,Math.floor(j/2));for(var u=0;g>u;u++){var H=S[g-u-1],L=e&&0===u?N.texture:d.texture;q.blitScreen(J,L,n,{value:H/W}),e&&u===g-1&&d.setSize(O,K[0],K[1]),q.blitScreen(d,J.texture,i,{value:H/v})}return o.enabled=U,d}}};Ws.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",Ws.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",Ws.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var Xs=V.graph3d.PostProcessing.Fxaa=function(l){var Y,k=this,X=!1;f.defineProperties(k,{enable:{get:function(){return X},set:function(h){!!X!=!!h&&(X=h,l.iv())}}}),k.getShader=function(w){if(Y)return Y;var v=l.getPostProcessingModule();return Y=v.createShader(w,{vs:v.blitScreenShaderSrc.vs,fs:v.decodeShader(Xs.ShaderSourceFs)})},k._42=function(){}};Xs.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",Xf(C,{accordionViewExpandIcon:Od(xn),accordionViewCollapseIcon:Od(xn,!0),accordionViewLabelColor:Dn,accordionViewLabelFont:di,accordionViewTitleBackground:Vb,accordionViewSelectBackground:vl,accordionViewSelectWidth:3,accordionViewSeparatorColor:_,splitViewDividerSize:1,splitViewDividerBackground:Vb,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:$g,rect:[2,2,12,12],background:xn}]},propertyViewLabelColor:rl,propertyViewLabelSelectColor:Dn,propertyViewLabelFont:di,propertyViewExpandIcon:Od(qr),propertyViewCollapseIcon:Od(qr,!0),propertyViewBackground:Jd,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Fq,propertyViewColumnLineColor:Fq,propertyViewSelectBackground:vl,listViewLabelColor:rl,listViewLabelSelectColor:Dn,listViewLabelFont:di,listViewRowLineVisible:!1,listViewRowLineColor:Fq,listViewSelectBackground:vl,treeViewLabelColor:rl,treeViewLabelSelectColor:Dn,treeViewLabelFont:di,treeViewExpandIcon:Od(jm),treeViewCollapseIcon:Od(jm,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Fq,treeViewSelectBackground:vl,treeViewDoubleClickToToggle:!0,tableViewLabelColor:rl,tableViewLabelSelectColor:Dn,tableViewLabelFont:di,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Fq,tableViewColumnLineColor:Fq,tableViewSelectBackground:vl,treeTableViewLabelColor:rl,treeTableViewLabelSelectColor:Dn,treeTableViewLabelFont:di,treeTableViewExpandIcon:Od(jm),treeTableViewCollapseIcon:Od(jm,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Fq,treeTableViewColumnLineColor:Fq,treeTableViewSelectBackground:vl,tableHeaderLabelColor:rl,tableHeaderLabelFont:di,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:oh,tableHeaderBackground:Jd,tableHeaderMoveBackground:Qi,tableHeaderInsertColor:vl,tableHeaderSortDescIcon:yg(qr,!0),tableHeaderSortAscIcon:yg(qr),tabViewTabGap:1,tabViewLabelColor:Dn,tabViewLabelFont:di,tabViewTabBackground:Vb,tabViewSelectWidth:3,tabViewSelectBackground:vl,tabViewMoveBackground:Qi,tabViewInsertColor:vl,toolbarLabelColor:rl,toolbarLabelSelectColor:Dn,toolbarLabelFont:di,toolbarBackground:Jd,toolbarSelectBackground:vl,toolbarItemGap:8,toolbarSeparatorColor:Ff},!0);var Ys={translateX:1,sortColumn:1},Zs={sortable:1,sortOrder:1,sortFunc:1},$s={focusData:1},_s={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},at={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},bt=function(L,Z){Z.add(L),L.hasChildren()&&L.eachChild(function(v){bt(v,Z)})},ct=function(R,x,V,z,B,d,O,D,b,W,s){var v,a=V.getValueType(W),w=V.getAlign(W);if(V.getEnumValues(W)){var M=V.toEnumLabel(x,W),L=rp||0,m=0,y=d,K=C.getTextSize(z,M).width;return v=ij(V.toEnumIcon(x,W)),v&&(m=d+rp/2,"center"===w?m+=(D-(L+K))/2:"right"===w&&(m=m+D-(L+K)),Lf(R,v,m,O+b/2,W,s),y=m+rp/2),M!=F&&(v?Je(R,M,z,B,y,O,D-(y-d),b):Je(R,M,z,B,d,O,D,b,w)),void 0}return x=V.formatValue(x),x!=F?a===Kn?(Qm(R,d,O,D,b,x),void 0):a===Qe||!a&&yb(x)?(v=ij(x?wc:$q),Lf(R,v,d+D/2,O+b/2,W,s),void 0):(Je(R,x,z,B,d,O,D,b,w),void 0):void 0},dt=function(K,W){var e=W.view,w=Wr(K),S=W.column||W.property;e.getDataModel().beginTransaction(),W.editor=K,K.info=W,e.setCurrentEditor(K),e.getView().insertBefore(w,e._79O),mm(K,W.editorRect),K.setFocus?K.setFocus():fj(K),K.commitValue=function(g,j){K._17Q&&(K=K._17Q),j||e.setValue(W.data,S,K.getValue?K.getValue():K.value),K.close&&K.close(),Ol(w)},S.onEditorCreated&&S.onEditorCreated(W)},et=function(A,Q,g,n,N){var R=uj(A,g),f=Q.value,m=Q.view,s=N.getValueType(Q.data);return R.onblur=R.onchange=function(){m.endEditing()},"input"===A?(f=N.formatValue(f),f!=F&&(R.value=f),R.onkeydown=function(W){vb(W)?m.endEditing():dp(W)&&m.endEditing(!0)},(s===Vc||s===Lh)&&x(R,dk,C.numberListener)):A===kl&&n.forEach(function(W){var t=v.createElement("option");t.innerHTML=N.toEnumLabel(W),t.value=W,N.isEnumEqual(f,W)&&(t.selected=!0),of(R,t)}),dt(R,Q),R},ft=V.widget={},gt=function(V,Y,L){cd(X+".widget."+V,Y,L)};Xf(km,{ms_value:function(d){d.getValue=function(e){var q=this.getItemById(e),N=q.element;return zq(N)?N:N?N.getValue?N.getValue():N.value:q.selected},d.setValue=function($,g){var q=this.getItemById($);if(q){var r=q.element;r&&!zq(r)?r.setValue?r.setValue(g):r.value=g:yb(g)?(q.selected=g,this.iv()):(q.element=g,this.iv())}},d.v=function(x,S){var D=this;if(2===arguments.length)D.setValue(x,S);else{if(!Dg(x))return D.getValue(x);for(var T in x)D.setValue(T,x[T])}return D}},_46o:function($){$._icon=F,$._accessType=F,$._valueType=F,$._editable=!1,$._batchEditable=!0,$._align=aq,$._nullable=!0,$._emptiable=!1,$.setParent=sf,$.formatValue=function(O){var u=this,N=u._valueType;return u.getEnumValues()?u.toEnumLabel(O):N===Qe?!!O:O!=F&&N===Vc?U(O):O},$.setEnum=function(Q,M,o,c,I,L,m){var H=this;Q&&!mh(Q)&&Q.values&&(c=Q.editable,o=Q.icons,M=Q.labels,I=Q.strict,L=Q.maxHeight,m=Q.dropDownWidth,Q=Q.values),Tm(Q)&&(Q=Q._as),Tm(M)&&(M=M._as),Tm(o)&&(o=o._as),H._enumValues=Q,H._enumLabels=M,H._enumIcons=o,H._enumEditable=c,H._enumStrict=I==F?!0:I,H._enumMaxHeight=L,H._enumDropDownWidth=m,Q&&Q.length&&kd(Q[0])&&(H._valueType=Lh),H.fp("enum",!1,!0)},$.getEnumDropDownWidth=function(){return this._enumDropDownWidth},$.getEnumMaxHeight=function(){return this._enumMaxHeight},$.isEnumEditable=function(){return this._enumEditable},$.getEnumValues=function(){return this._enumValues},$.getEnumLabels=function(){return this._enumLabels},$.getEnumIcons=function(){return this._enumIcons},$.isEnumStrict=function(){return this._enumStrict},$.isEnumEqual=function(t,R){return this._enumStrict?t===R:t==R},$.toEnumLabel=function(Q,b){var v=this,F=v.getEnumValues(b),d=v.getEnumLabels(b);if(F&&d)for(var E=0;E<F.length;E++)if(v.isEnumEqual(Q,F[E]))return d[E];return Q},$.toEnumIcon=function(j,m){var r=this,R=r.getEnumValues(m),q=r.getEnumIcons(m);if(R&&q)for(var D=0;D<R.length;D++)if(r.isEnumEqual(j,R[D]))return q[D];return _}},_45o:function(Z){Z._87o=function(B,j,y,a,w,M){if(B){var e=this,z=e._90I,P=ir(1);e._columnLineVisible&&(w-=1),e._rowLineVisible&&(M-=1),0>=w||0>=M||(e._90I||(z=e._90I={}),z[j]||(z[j]=new _n),mm(P,e.tx()+y,e.ty()+a,w,M),of(P,B),e._view.insertBefore(P,e._79O),B.onParentAdded&&B.onParentAdded(P),z[j].add(P))}},Z._76o=function(){var i=this,R=i._90I;if(R){for(var t in R)R[t].each(function(Y){Ol(Y)});delete i._90I}},Z._77o=function(M){var j=this;if(j._90I){var p=j._90I[M];p&&(p.each(function(Q){Ol(Q)}),delete j._90I[M])}}},_47o:function(O){O.getValue=function(i,$){return $.getValue?$.getValue(i,$,this):Zh(i,$.getAccessType(),$.getName())},O.setValue=function(Y,t,j){if(t.isEmptiable(Y)||""!==j||(j=_),t.isNullable(Y)||j!=F){var s=this,P=t.getName(Y),$=t.getAccessType(Y),v=t.getValueType(Y);v===Vc&&zq(j)?j=Pq(j):v===Lh&&zq(j)?j=parseFloat(j):v===Qe&&zq(j)&&(j="true"===j),s._batchEditable&&t._batchEditable&&s.isSelected(Y)?s.sm().each(function(K){t.setValue?t.setValue(K,t,j,s):Sc(K,$,P,j)}):t.setValue?t.setValue(Y,t,j,s):Sc(Y,$,P,j)}},O.setCurrentEditor=function(Z){this.endEditing(),this._currentEditor=Z,this.redraw()},O.isEditing=function(e,L){var k=this,O=k._currentEditor;if(!O)return!1;if(L){var B=O.info;return B?(B.column||B.property)===L&&B.data===e:!1}return!0},O.endEditing=function($){var N=this,m=N._currentEditor;m&&(delete N._currentEditor,m.commitValue&&m.commitValue(m.info,$),N.redraw(),N.getDataModel().endTransaction())},O.beginEditing=function(L){this.endEditing();var I=this,K=L.column||L.property;if(K.beginEditing)K.beginEditing(L);else{var E=L.data,s=L.value,i=I.getSelectBackground(E),X=K.getEnumValues(E),W=K.getSlider(E),Y=K.getColorPicker(E);if(W){var c=Ud(ft.Slider,W);return c.setValue(s),c.getView().onblur=function(){I.endEditing()},c.isInstant()&&(c.onValueChanged=function(){I.setValue(E,K,c.getValue())}),dt(c,L),void 0}if(Y||K.getValueType(E)===Kn){var T=Ud(ft.ColorPicker,Y);return T.setValue(s),T.onClosed=function(){I.endEditing()},T.isInstant()&&(T.onValueChanged=function(P,M){I.setValue(E,K,M)}),dt(T,L),T.open(),void 0}if(X){if(ft.ComboBox){var S=new ft.ComboBox;S.setValue(s),S.setValues(X),S.setLabels(K.getEnumLabels(E)),S.setIcons(K.getEnumIcons(E)),S.setEditable(K.isEnumEditable(E)),S.setStrict(K.isEnumStrict(E)),S.setMaxHeight(K.getEnumMaxHeight(E)),S.setDropDownWidth(K.getEnumDropDownWidth(E)),S.onClosed=function(){I.endEditing()},dt(S,L),S.open()}else et(kl,L,i,X,K);return}var Q=K.getValueType(E);if(Q===Qe||yb(s))return I.setValue(E,K,!s),void 0;if(K.getItemEditor(E)){var q=nk(K.getItemEditor(E)),G=new q(E,K,I,L),Z=G.getView();return Z._17Q=G,G.setValue(s),qm(Z),dt(Z,L),G.editBeginning&&G.editBeginning(),void 0}et("input",L,i,F,K)}}},_44o:function(N){N.init=function(F){var d=this,t=d.th=new vt(F),z=d._view=oj(1,d);d.tv=d._tableView=F,of(z,t.getView()),of(z,F.getView()),t.mp(function(n){n.property===je&&d.iv()}),d.iv()},N.getTableView=function(){return this.tv},N.getTableHeader=function(){return this.th},N.getDataModel=function(){return this.tv.dm()},N.getColumnModel=function(){return this.tv.getColumnModel()},N.setColumns=function(S){this.tv.setColumns(S)},N.addColumns=function(Z){this.tv.addColumns(Z)},N.endEditing=function(){this.tv.endEditing()},N.validateImpl=function(){var L=this,G=L.th,M=Cr(G),y={x:0,y:0,width:L.getWidth(),height:M};mm(G,y),y.y=M,y.height=i(0,L.getHeight()-M),mm(L.tv,y)}},ms_vs:function(S){S._41o=function(){return this._29I.height<this._59I},S._43o=function(){var p=this;p._41o()&&(p._58I||(gr(function(){p._94O()},_b),p.iv()),p._58I=new Date)},S._94O=function(){var $=this;if($._58I){var c=new Date;c.getTime()-$._58I.getTime()>=_b?(delete $._58I,$.iv()):gr(function(){$._94O()},_b)}},S._93I=function(){var B=this,R=B._27I;if(B._58I||!B._autoHideScrollBar){R||of(B._79O,R=B._27I=ir());var U=B._29I,W=U.height,c=B._59I,r=B.getScrollBarSize(),f=U.width-r-2,C=W*(-B.ty()/c),F=W*(W/c),g=R.style;c>W?(og>F&&(C=C+F/2-og/2,0>C&&(C=0),C+og>W&&(C=W-og),F=og),g.visibility=zn,g.background=B.getScrollBarColor(),g.borderRadius=r/2+ke,mm(R,f,C,r,F)):g.visibility=td}else R&&(R.style.visibility=td)}},ms_hs:function(k){k._40o=function(){return this._29I.width<this._91I},k._42o=function(){var A=this;A._40o()&&(A._95O||(gr(function(){A._94I()},_b),A.iv()),A._95O=new Date)},k._94I=function(){var U=this;if(U._95O){var z=new Date;z.getTime()-U._95O.getTime()>=_b?(delete U._95O,U.iv()):gr(function(){U._94I()},_b)}},k._92I=function(){var G=this,B=G._28I;if(G._95O||!G._autoHideScrollBar){B||of(G._79O,B=G._28I=ir());var N=G._29I,H=N.width,M=G._91I,F=G.getScrollBarSize(),$=N.height-F-2,A=H*(-G.tx()/M),R=H*(H/M),Z=B.style;M>H?(og>R&&(A=A+R/2-og/2,0>A&&(A=0),A+og>H&&(A=H-og),R=og),Z.visibility=zn,Z.background=G.getScrollBarColor(),Z.borderRadius=F/2+ke,mm(B,A,$,R,F)):Z.visibility=td}else B&&(B.style.visibility=td)}}}),Se(wc,$m(16,16,[{type:pi,rect:[1,1,14,14],background:vl},{type:ii,rect:[1,1,14,14],width:1,color:Mc},{type:eg,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Se($q,$m(16,16,{type:ii,rect:[1,1,14,14],width:1,color:Mc})),Se(lp,$m(16,16,[{type:ef,rect:[2,2,12,12],borderWidth:1,borderColor:Mc,background:"#FFF"},{type:ef,rect:[4,4,8,8],background:vl}])),Se(Yp,$m(16,16,{type:ef,rect:[2,2,12,12],borderWidth:1,borderColor:Mc})),km._15Q=function(r){r._29I=wq,r._59I=0,r._91I=0,r._5o=function(q){var W=this;W._30I=new _n,W._rows=new _n,W._rowMap={},W._31I=0,W._14I=0,W._view=oj(1,W),W._canvas=ys(W._view),of(W._view,W._79O=ir()),W.dm(q?q:new ip)},r.getCheckIcon=function(L){var w=this.sm(),g=w.co(L);return w.sg()?ij(g?lp:Yp):ij(g?wc:$q)},r.checkData=function(l){var M=this.sm(),L=M.co(l);M.sg()&&L||(this._32o=1,L?M.rs(l):M.as(l),delete this._32o)},r.getDataAt=function(t){t.target&&(t=this.lp(t));var V=P(t.y/this._rowHeight),J=this._rows;return 0>V||V>=J.size()?F:J.get(V)},r.onDataDoubleClicked=function(){},r.onDataClicked=function(){},r.adjustTranslateX=function(){return 0},r.adjustTranslateY=function($){var l=this.getHeight()-this._59I;return l>$&&($=l),$>0?0:U($)},r.onPropertyChanged=function(B){var F=this,z=B.property;_s[z]?F.ivm():$s[z]||F.redraw(),z===Ec?F._42o():z===ln&&F._43o()},r.getLabel=function(c){return c.toLabel()},r.getLabelFont=function(){return this._labelFont},r.getLabelColor=function(g){var p=this;if(p.isCheckMode()){if(p._focusData===g)return p._labelSelectColor}else if(p.isSelected(g))return p._labelSelectColor;return p._labelColor},r.getStartRowIndex=function(){return this._31I},r.getEndRowIndex=function(){return this._14I},r.getRowDatas=function(){return this._rows},r.getRowIndex=function(X){return this._rowMap[X._id]},r.getRowSize=function(){return this._rows.size()},r.getViewRect=function(){return Hq(this._29I)},r.isVisible=function(U){return this._visibleFunc?this._visibleFunc(U):!0},r.getCurrentSortFunc=function(){return this._sortFunc},r.setDataModel=function($){var s=this,m=s._dataModel,k=s._selectionModel;m!==$&&(m&&(m.umm(s.handleDataModelChange,s),m.umd(s.handleDataPropertyChange,s),m.umh(s.handleHierarchyChange,s),k||m.sm().ums(s.handleSelectionChange,s)),s._dataModel=$,$.mm(s.handleDataModelChange,s),$.md(s.handleDataPropertyChange,s),$.mh(s.handleHierarchyChange,s),k?k._21I($):$.sm().ms(s.handleSelectionChange,s),s.fp("dataModel",m,$))},r.validateModel=function(){var j=this;j._rows.clear(),j._rowMap={},j.buildChildren(j._dataModel._roots);var P=j._rows=j._rows.toList(j.isVisible,j),k=0,B=j.getCurrentSortFunc(),d=P.size();for(B&&P.sort(B);d>k;k++)j._rowMap[P.get(k)._id]=k},r.buildChildren=function(h){var B=this;h.each(function(x){B._rows.add(x),B.buildChildren(x._children)})},r.handleDataModelChange=function(){this.ivm()},r.handleDataPropertyChange=function(J){"parent"===J.property?this.ivm():this.invalidateData(J.data)},r.handleHierarchyChange=function(){this.ivm()},r.handleSelectionChange=function(Y){Y.datas.each(this.invalidateData,this),this.onSelectionChanged(Y)},r.onSelectionChanged=function(o){var u=this,e=u.sm();!u.isAutoMakeVisible()||1!==e.size()||"set"!==o.kind&&"append"!==o.kind||u._32o||u.makeVisible(e.ld())},r.handleBackgroundClick=function(g){Ab(g)&&!this.isCheckMode()&&this.sm().cs()},r.makeVisible=function(i){i&&(this._23I=i,this.iv())},r.scrollToIndex=function(L){var E=this,V=E._29I,H=V.height,P=E._rowHeight,K=P*L;L>=0&&L<E._rows.size()&&H>0&&(K+P>V.y+H?E.ty(-K+H-P):K<V.y&&E.ty(-K))},r.autoScroll=function(Z,I){var i=this,a=i._rowHeight,T=a,p=a/4,N=i._29I,g=i.lp(Z),t={x:i.tx(),y:i.ty()};return a>0&&N&&(g.x-N.x<T?i.translate(p,0):N.x+N.width-g.x<T&&i.translate(-p,0),g.y-N.y<T?i.translate(0,p):N.y+N.height-g.y<T&&i.translate(0,-p)),t.x=i.tx()-t.x,t.y=i.ty()-t.y,I&&(I.x+=t.x,I.y+=t.y),t},r.getTopRowOrderSelection=function(){var t=this.sm().getTopSelection(),E={},v=new _n;return t.each(function(K){E[K._id]=K}),this._rows.each(function(V){E[V._id]&&v.add(V)}),v},r.getRowOrderSelection=function(){var Q=new _n;return this._rows.each(function(V){this.isSelected(V)&&Q.add(V)},this),Q},r.ivm=function(){this.invalidateModel()},r.invalidateModel=function(){var z=this;z._96I||(z._96I=1,z._32I=1,delete z._24I),z.iv()},r.redraw=function(){var Y=this;Y._32I||(Y._32I=1,delete Y._24I,Y.iv())},r.invalidateData=function(C){var P=this;Zo?P.redraw():P._32I||(P._24I||(P._24I={}),P._24I[C._id]=C,P.iv())},r.getFocusData=function(){return this._focusData},r.setFocusDataById=function(H){this.setFocusData(this.dm().getDataById(H))},r.setFocusData=function($){var m=this,p=m._focusData;p!==$&&(m._focusData=$,m.fp("focusData",p,$),p&&m.invalidateData(p),$&&(m.invalidateData($),m.isAutoMakeVisible()&&m.makeVisible($)))},r.drawRowBackground=function(x,W,w,p,h,L,H){var a=this,D=a.isCheckMode();(W===a._focusData&&D||w&&!D)&&Qm(x,p,h,L,H,a.getSelectBackground(W))},r.drawData=function(g,N,R){var Z=this,P=Z._rowHeight,D=P*R,r=Z._29I,j=r.x,E=r.width;g.save(),g.beginPath(),g.rect(j,D,E,P),g.clip(),Z._87o(Z.drawRow(g,N,Z.isSelected(N),j,D,E,P),R,j,D,E,P),g.restore(),Z._rowLineVisible&&Qm(g,j,D+P-1,E,1,Z._rowLineColor)},r._12I=function(R){var h=this,$=h._31I,n=h._29I,q=n.x,M=n.y,V=n.width,D=n.height;for(R.beginPath(),R.rect(q,M,V,D),R.clip(),R.clearRect(q,M,V,D),h._76o(),h._93db(R);$<h._14I;$++)h.drawData(R,h._rows.get($),$);h._92db(R)},r._13I=function(z){for(var U,A=this,G=A._rowHeight,R=A._29I,S=R.x,m=R.width,$=A._31I,o=A._30I;$<A._14I;$++)U=A._rows.get($),A._24I[U._id]&&o.add({data:U,index:$});o.isEmpty()||(z.beginPath(),o.each(function(W){z.rect(S,W.index*G,m,G)}),z.clip(),o.each(function(R){z.clearRect(S,R.index*G,m,G)}),o.each(function(I){A._77o(I.index)}),A._93db(z),o.each(function(d){A.drawData(z,d.data,d.index)}),A._92db(z),o.clear())},r.preValidateModel=function(){this.endEditing&&this.endEditing()},r.validateImpl=function(){var l=this,o=l._canvas,L=l.getWidth(),h=l.getHeight(),S=l._rowHeight,H=l._32I;(L!==o.clientWidth||h!==o.clientHeight)&&(Db(o,L,h),H=1),l._96I&&(l.preValidateModel(),l.validateModel());var g=l._29I,f={x:-l.tx(),y:-l.ty(),width:L,height:h},z=l._rows.size(),w=Zq(o),i=l._23I;H||wj(f,g)||(H=1),l._29I=f,l._59I=z*S,l._31I=P(f.y/S),l._14I=c((f.y+f.height)/S),l._31I<0&&(l._31I=0),l._14I>z&&(l._14I=z),l._99I&&H&&l._99I();var d=l.tx(),I=l.ty();(l._40o()||l._41o())&&(l._59I+=l.getScrollBarSize(),l._99I&&H&&(l._91I+=l.getScrollBarSize())),Lp&&!Mk&&(w.save(),Gc(w,L/ur.length,h/ur.length,1)),Gc(w,d,I,1),H?l._12I(w):l._24I&&l._13I(w),l._93I(),l._92I(),w.restore(),l._32I=l._24I=l._96I=F,i&&(l.scrollToIndex(l.getRowIndex(i)),delete l._23I),l.tx(l.tx()),l.ty(l.ty())},r.canHandleSelectMode=function(){return!0}},km._48o=function(e){e._rootVisible=!0,e._rootData=F,e._35o=function(){this._expandMap={},this._levelMap={}},e.validateModel=function(){var $=this,D=$._rootData;$._rows.clear(),$._levelMap={},$._rowMap={},$._currentLevel=0,D?$._rootVisible?$.isVisible(D)&&$.buildData(D):$.buildChildren(D):$.buildChildren(),delete $._currentLevel},e.buildData=function(l){var j=this,X=l._id,I=j._rows;j._rowMap[X]=I.size(),I.add(l),j._levelMap[X]=j._currentLevel,j.isExpanded(l)&&(j._currentLevel++,j.buildChildren(l),j._currentLevel--)},e.buildChildren=function(l){var n=this,R=l?l._children:n._dataModel._roots,F=n.getCurrentSortFunc();F&&n.isChildrenSortable(l)?R.toList(n.isVisible,n).sort(F).each(n.buildData,n):R.each(function(Z){n.isVisible(Z)&&n.buildData(Z)})},e.getLevel=function(J){return this._levelMap[J._id]},e.getToggleIcon=function(b){var $=this,a=$._loader,x=$._collapseIcon;return a&&!a.isLoaded(b)?x:b.hasChildren()?$.isExpanded(b)?$._expandIcon:x:F},e.isCheckMode=function(){return this._checkMode!=F},e.isChildrenSortable=function(){return!0},e.handleDataModelChange=function(w){var F=this;w.kind===xs?delete F._expandMap[w.data._id]:w.kind===eo&&(F._expandMap={}),F.ivm()},e.toggle=function(w){var V=this;V.isExpanded(w)?V.collapse(w):V.expand(w)},e.isExpanded=function(L){return 1===this._expandMap[L._id]},e.expand=function(K){var r=this,V=r._loader;r.isExpanded(K)||(V&&!V.isLoaded(K)&&V.load(K),r._expandMap[K._id]=1,r.ivm(),r.onExpanded(K))},e.onExpanded=function(){},e.collapse=function(n){var S=this;S.isExpanded(n)&&(delete S._expandMap[n._id],S.ivm(),S.onCollapsed(n))},e.onCollapsed=function(){},e.expandAll=function(L){if(L)this.expand(L),L.eachChild(function(D){this.expandAll(D)},this);else{var A=this;A._dataModel.each(function(C){C.hasChildren()&&(A._expandMap[C._id]=1)}),A.ivm()}},e.collapseAll=function(){this._expandMap={},this.ivm()
},e.makeVisible=function(u){if(u){var q=this;if(!q._rootData||u.isDescendantOf(q._rootData)){for(var g=u._parent;g;)q.expand(g),g=g._parent;q._23I=u,q.iv()}}},e.checkData=function(H){var w,i=this,E=i._checkMode,J=i.sm(),K=J.co(H);if(!J.sg()||!K){if(i._32o=1,E===gq)K?J.rs(H):J.as(H);else if(E===_o)w=new _n(H),w.addAll(H._children);else if("descendant"===E)w=new _n,bt(H,w);else if("all"===E&&(w=new _n,bt(H,w),!K))for(var Y=H._parent;Y;)w.add(Y),Y=Y._parent;w&&(K?J.rs(w):J.as(w)),delete i._32o}},e.drawTree=function(b,a,M,$,k,c,D){var B=this,E=B._indent,w=B._levelMap[a._id],V=B.getIconWidth(a),P=ij(B.getToggleIcon(a));P?($+=E*w,Lf(b,P,$+E/2,k+D/2,a,B),$+=E):$+=E*(w+1),B._checkMode&&(Lf(b,B.getCheckIcon(a),$+E/2,k+D/2,a,B),$+=E),B.drawIcon(b,a,$,k,V,D),B.drawLabel(b,a,$+V,k,D)}},km._14Q=function(M){M.getIcon=function($){return $.getIcon()},M.getIconWidth=function(L){return this.getIcon(L)?this._indent:0},M.drawIcon=function(J,n,W,R,U,E){if(U){var S=this,H=S.getBodyColor(n),b=ij(S.getIcon(n),H);b&&(E-=S.isRowLineVisible()?1:0,qs(J,b,sq,W,R,U,E,n,S,H),If(J,S.getBorderColor(n),W,R,U,E))}},M.drawLabel=function(s,R,$,k,e){var h=this;Je(s,h.getLabel(R),h.getLabelFont(R),h.getLabelColor(R),$,k,0,e)}},km._50o=function(K){K._98I=function(){var q=this,x=q._39o=new ip;q._60I=new _n,x.mm(q._17o,q),x.md(q._18o,q),x.mh(q._19o,q)},K.setColumns=function(i){this._39o.clear(),this.addColumns(i)},K.addColumns=function(J){var o=this._39o;J.forEach(function(W){if(!(W instanceof it)){var Q=nk(W.className);W=Ud(Q?Q:it,W)}o.add(W)})},K.onColumnClicked=function(){},K.onCheckColumnClicked=function(){},K._3Q=function(N){for(var a,U=0,l=this._60I,Z=l.size();Z>U;U++)if(a=l.get(U),a.column===N)return a;return F},K.getColumnAt=function(M){var U=this._4Q(M);return U?U.column:F},K._4Q=function(u){for(var M=this,p=u.target?M.lp(u).x:u.x,P=M._60I,D=0;D<P.size();D++){var n=P.get(D),l=n.startX;if(p>=l&&p<l+n.column.getWidth())return n}return F},K.getToolTip=function(L){var o=this,X=o.getDataAt(L),P=o.getColumnAt(L);return X&&P?P.getToolTip(X,o):F},K.adjustTranslateX=function(k){var l=this.getWidth()-this._91I;return l>k&&(k=l),k>0?0:U(k)},K._99I=function(){var P=this,d=P._29I,v=P._60I;v.clear(),P._91I=0,P._39o._roots.each(function(Q){if(Q.isVisible()){var O=P._91I+Q.getWidth();P._91I<=d.x+d.width&&O>=d.x&&v.add({column:Q,startX:P._91I}),P._91I=O}})},K.drawData=function(X,i,E){var $=this,Z=$._rowHeight,L=Z*E,y=$.isSelected(i),M=$._29I,F=M.x,U=M.width;$.drawRowBackground(X,i,y,F,L,U,Z),$._60I.each(function(H){var x=H.column,s=H.startX,B=x.getWidth();B>0&&!$.isEditing(i,x)&&(X.save(),X.beginPath(),X.rect(s,L,B,Z),X.clip(),$._87o($.drawCell(X,i,y,x,s,L,B,Z),E,s,L,B,Z),$._columnLineVisible&&Qm(X,s+B-1,L,1,Z,$._columnLineColor),X.restore())}),$._rowLineVisible&&Qm(X,F,L+Z-1,U,1,$._rowLineColor)},K.drawCell=function(k,P,Y,n,R,j,H,x){var a=this;if(n.drawCell)return n.drawCell(k,P,Y,n,R,j,H,x,a);var O=a.getValue(P,n);ct(k,O,n,a.getLabelFont(P,n,O),a.getLabelColor(P,n,O),R,j,H,x,P,a)},K.getColumnModel=function(){return this._39o},K._17o=function(){this.redraw()},K._18o=function(e){var b=this;e.data===b._sortColumn&&Zs[e.property]?b.ivm():(b._42o(),b.redraw())},K._19o=function(){this.redraw()},K.getCurrentSortFunc=function(){var w=this,u=w._sortColumn;if(u&&u.isSortable()){var o=u.getSortFunc(),P=Kh===u.getSortOrder()?1:-1;return o||(o=Hg),function(g,k){return o.call(w,w.getValue(g,u),w.getValue(k,u),g,k)*P}}return w._sortFunc},K.isCellEditable=function(m,Y,V){return Y.isEditable()&&this.isEditable()?Y.isCellEditable?Y.isCellEditable(m,Y,V,this):!0:!1},K._37O=function(w,O){if(Ab(O))for(var i=this,d=i.lp(O),p=i._60I,J=i._rowHeight,M=i._29I,j=M.x,q=M.y,A=M.width,Z=M.height,B=0;B<p.size();B++){var E=p.get(B),l=E.startX,L=E.column,W=L.getWidth();if(L!==i._31o&&L!==i._4o&&d.x>=l&&d.x<l+W&&i.isCellEditable(w,L,O)){var $={x:l,y:i.getRowIndex(w)*J,width:W,height:J},b={x:$.x+i.tx(),y:$.y+i.ty(),width:$.width,height:$.height},K=0,T=0;return $.x<j?K=$.x-j:$.x+$.width>j+A&&(K=$.x+$.width-j-A),K&&(i.tx(i.tx()-K),b.x-=K),$.y<q?T=$.y-q:$.y+J>q+Z&&(T=$.y+J-q-Z),T&&(i.ty(i.ty()-T),b.y-=T),i.beginEditing({data:w,column:L,value:i.getValue(w,L),event:O,rect:$,editorRect:b,view:i}),void 0}}}},ft.BaseItemEditor=function(d,s,W,B){this._data=d,this._column=s,this._master=W,this._editInfo=B},gt("BaseItemEditor",f,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var ht=V.Tab=function(){tl(ht,this)};Lr("Tab",Lq,{ms_ac:["view","closable","disabled","visible"],_icon:F,_closable:!1,_disabled:!1,_visible:!0,setParent:sf});var it=V.Column=function(){tl(it,this)};Lr("Column",Lq,{_46o:1,ms_ac:["accessType","valueType",zn,ms,Oj,ye,"align",Kn,"sortOrder",tm,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Kh,_sortFunc:F,_sortable:!0,_clickable:!0,setWidth:function(L){16>L&&(L=16);var U=this._width;this._width=L,this.fp(ye,U,L)},getToolTip:function(u,d){return this.formatValue(d.getValue(u,this))}});var jt=V.Property=function(){tl(jt,this)};Lr("Property",Lq,{_46o:1,ms_ac:["accessType","valueType",ms,Oj,"categoryName",Kn,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:F,getToolTip:function(F,B,s){var P=this;return B?P.formatValue(s.getValue(F,P)):s.getPropertyName(P)}}),ft.AccordionView=function(){var Z=this;Z._20o={},Z._21o=new _n,Z._10o=F,Z._9o=F,Z._11o=F,Z._view=oj(0,Z),Z.iv()},gt("AccordionView",f,{ms_v:1,ms_fire:1,ms_ac:[dh,$o,"titleHeight",Eg,lc,"titleBackground","selectWidth",Ek,"orientation","separatorColor"],_expandIcon:C.accordionViewExpandIcon,_collapseIcon:C.accordionViewCollapseIcon,_titleHeight:mi,_labelColor:C.accordionViewLabelColor,_labelFont:C.accordionViewLabelFont,_titleBackground:C.accordionViewTitleBackground,_selectBackground:C.accordionViewSelectBackground,_selectWidth:C.accordionViewSelectWidth,_orientation:"v",_separatorColor:C.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(_,i,o,Y){var D=this,r=ir(),R={content:i,div:r,canvas:ys(r),icon:Y};if(D._20o[_])throw _+" already exists";var z=R.downEventFunc=function(q){Qq(q)},e=R.upEventFunc=function(j){Qq(j),Ab(j)&&(D._10o===_?D.collapse():D.expand(_))};[Ym,jf].forEach(function(K){x(r,K,z)}),[Gd,Sn].forEach(function(F){x(r,F,e)}),r.style.cursor=sj,of(D._view,r),D._20o[_]=R,D._21o.add(_),o&&D.expand(_),D.iv()},remove:function(t){var i=this,q=i._20o[t];if(q){var X=q.div;Ol(X),[Ym,jf].forEach(function(J){d(X,J,q.downEventFunc)}),[Gd,Sn].forEach(function(t){d(X,t,q.upEventFunc)}),delete i._20o[t],i._21o.remove(t),i.iv()}},clear:function(){var C=this;C._21o.toArray().forEach(C.remove,C),C._20o={},C._21o.clear(),C.iv()},isExpanded:function(_){return this._10o===_},expand:function(p){var v=this;v._20o[p]&&v._10o!==p&&(v._10o=p,v.onExpanded(p),v.iv())},onExpanded:function(){},collapse:function(){var d=this;d._10o&&(d.onCollapsed(d._10o),delete d._10o,d.iv())},onCollapsed:function(){},initCanvas:function(E,z,S){Db(E,z,S);var l=Zq(E);return Gc(l,0,0,1),l.clearRect(0,0,z,S),l},drawTitle:function(J,Q,f,k,d){var n=this,T=ij(d.icon),r=n.isExpanded(Q),X=n._titleHeight,x=n._titleBackground,D=n._selectWidth,G=n._separatorColor,s=ij(r?n._expandIcon:n._collapseIcon),b=D+4;Qm(J,0,0,f,k,x),r&&D&&Qm(J,0,0,D,k,n._selectBackground),(r||n._21o.get(n._21o.size()-1)!==Q)&&Qm(J,0,k-1,f,1,G?G:zl(x)),T&&(Lf(J,T,b+ob(T)/2,X/2),b+=ob(T)+2),Je(J,Q,n.getLabelFont(Q),n.getLabelColor(Q),b,0,0,X),s&&Lf(J,s,f-ob(s)/2-4,X/2)},validateImpl:function(){var J=this,l=J._view,N=0,s=0,A=J.getWidth(),I=J.getHeight(),E=J._titleHeight,o=J._21o.size()*E,n=J._11o,W=J._9o;delete J._11o,delete J._9o,J._21o.each(function(p){var C,y,$=J._20o[p],b=$.content,F=J._10o===p;Hn(J)?(mm($.div,N,0,E,I),C=J.initCanvas($.canvas,E,I),zg(C,0,I),_g(C,-$k),J.drawTitle(C,p,I,E,$),C.restore(),F?(y=i(0,A-o),b&&(J._11o=b,J._9o=Wr(b),mm(b,N+E,0,y,I)),N+=E+y):N+=E):(mm($.div,0,s,A,E),C=J.initCanvas($.canvas,A,E),J.drawTitle(C,p,A,E,$),C.restore(),F?(y=i(0,I-o),b&&(J._11o=b,J._9o=Wr(b),mm(b,0,s+E,A,y)),s+=E+y):s+=E)});var P=J._9o;n&&n!==J._11o&&n.endEditing&&n.endEditing(),P&&P!==W&&of(l,P),W&&W!==P&&Ol(W)}}),ft.SplitView=function(P,L,z,S){var W=this,K=W._dividerDiv=ir(),R=W._60O=ys(),V=W._61O=ys(),a=R.style,$=V.style;W._view=oj(1,W),of(W._view,K),a.msTouchAction=ah,a.pointerEvents=ah,a.cursor=sj,$.msTouchAction=ah,$.pointerEvents=ah,$.cursor=sj,P&&W.setLeftView(P),L&&W.setRightView(L),z&&W.setOrientation(z),S!=F&&W.setPosition(S),W.setStatus(Dl),new kt(W)},gt("SplitView",f,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:C.splitViewDividerSize,_dividerBackground:C.splitViewDividerBackground,_dragOpacity:C.splitViewDragOpacity,_toggleIcon:C.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(Z,L){var W=this,Q=W._position;isNaN(Z)||(L||(W._82O=0>Z?-1:Z>1?1:0),W._position=Z,W.fp(qp,Q,Z))},getLeftView:function(){return this._leftView},setLeftView:function(E){var _=this,U=_._leftView,m=_._view;if(_._leftView!==E){if(U&&U!==_._rightView){var X=Wr(U);X.parentNode===m&&Ol(X)}if(_._leftView=E,E){var B=Wr(E);B.parentNode!==m&&m.insertBefore(B,_._dividerDiv)}_.fp("leftView",U,E)}},getRightView:function(){return this._rightView},setRightView:function(Z){var c=this,V=c._rightView,S=c._view;if(c._rightView!==Z){if(V&&V!==c._leftView){var j=Wr(V);j.parentNode===S&&Ol(j)}if(c._rightView=Z,Z){var v=Wr(Z);v.parentNode!==S&&S.insertBefore(v,c._dividerDiv)}c.fp("rightView",V,Z)}},validateImpl:function(){var E=this,$=E._draggable,Q=E._position,Z=E.getWidth(),t=E.getHeight(),R=E._dividerSize,T=E._dividerBackground,m=Zk?18:8,z=E._dividerDiv,S=E._82O,u=E._60O,H=E._61O,a=E._toggleIcon,y=E._status,K=z.style,X=null,d=Zk?20:4,L=a.comps[0];R>=m||0===R?E._coverDiv&&(Ol(E._coverDiv),delete E._coverDiv):E._coverDiv||(E._coverDiv=ir(),Ic&&(E._coverDiv.style.background=vg),of(z,E._coverDiv)),E._togglable?u.parentNode||(of(z,u),of(z,H)):(Ol(u),Ol(H));var w=E._coverDiv,k=E._leftView,g=E._rightView;if(Hn(E)){if(R>Z&&(R=Z),y===Dl)if(1===S)var h=B(Q,Z),N=i(0,Z-R-h);else-1===S?(N=B(-Q,Z),h=i(0,Z-R-N)):(h=U((Z-R)*Q),N=i(0,Z-R-h));else"cl"===y?(h=0,N=i(0,Z-R)):"cr"===y&&(N=0,h=i(0,Z-R));k&&mm(k,0,0,h,t),g&&mm(g,h+R,0,N,t),mm(z,h,0,R,t),E._22o=h,w&&(mm(w,R/2-m/2,0,m,t),w.style.cursor=$?ek:""),z.style.cursor=$?ek:"";var A=z.clientHeight/2,O=z.clientWidth;Db(u,O,O),mm(u,0,A-O-d,O,O),X=Zq(u),Gc(X,0,0,1),L.rotation=-$k,Fp(X,a,0,0,O,O),X.restore(),Db(H,O,O),mm(H,0,A+d,O,O),X=Zq(H),Gc(X,0,0,1),L.rotation=$k,Fp(X,a,0,0,O,O),X.restore()}else{if(R>t&&(R=t),y===Dl)if(1===S)var c=B(Q,t),j=i(0,t-R-c);else-1===S?(j=B(-Q,t),c=i(0,t-R-j)):(c=U((t-R)*Q),j=i(0,t-R-c));else"cl"===y?(c=0,j=i(0,t-R)):"cr"===y&&(j=0,c=i(0,t-R));k&&mm(k,0,0,Z,c),g&&mm(g,0,c+R,Z,j),mm(z,0,c,Z,R),E._22o=c,w&&(mm(w,0,R/2-m/2,Z,m),w.style.cursor=$?sb:""),K.cursor=$?sb:"";var e=z.clientWidth/2,O=z.clientHeight;Db(u,O,O),mm(u,e-O-d,0,O,O),X=Zq(u),Gc(X,0,0,1),L.rotation=0,Fp(X,a,0,0,O,O),X.restore(),Db(H,O,O),mm(H,e+d,0,O,O),X=Zq(H),Gc(X,0,0,1),L.rotation=Y,Fp(X,a,0,0,O,O),X.restore()}K.background=T}});var kt=function(k){this.sv=k,this.addListeners()};cd(kt,f,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(N){var r=this,j=r.sv,W=j._dividerDiv,M=j._60O,q=j._61O,m=j._status,k=N.target;if(k===M)m===Dl?j.setStatus("cl"):"cr"===m&&j.setStatus(Dl);else if(k===q)m===Dl?j.setStatus("cr"):"cl"===m&&j.setStatus(Dl);else if(xg(N)&&(k===W||k===j._coverDiv)&&(Qq(N),j.isDraggable())){j.getLeftView(),j.getRightView();var e=r.maskDiv=ir();if(e.style.left=0,e.style.top=0,e.style.width=j.getWidth()+"px",e.style.height=j.getHeight()+"px",j.getView().appendChild(e),!j.isContinuousLayout()){var G=r.resizeDiv=ir();G.style.left=W.style.left,G.style.top=W.style.top,G.style.width=W.style.width,G.style.height=W.style.height,G.style.opacity=j.getDragOpacity(),G.style.background=j.getDividerBackground(),of(r.getView(),G)}r._lastAbsPosition=j._22o,r._86o=Hn(j)?ci(N).x:ci(N).y,$l(r,N)}},handleWindowTouchMove:function(s){xg(s)&&this.update(s,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(Q){var y=this;y.update(Q,!0),y.sv.setStatus(Dl),y.maskDiv&&Ol(y.maskDiv),y.resizeDiv&&Ol(y.resizeDiv),y.maskDiv=y.resizeDiv=F},handle_mousedown:function(y){Ab(y)&&this.handle_touchstart(y)},handleWindowMouseMove:function(u){this.handleWindowTouchMove(u)},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},update:function(s,k){var q=this,u=q.sv,j=Hn(u)?u.getWidth():u.getHeight(),F=u._dividerSize,U=q._lastAbsPosition-q._86o;Hn(u)?(U+=ci(s).x,U>j-F&&(U=j-F),0>U&&(U=0),q.resizeDiv&&(q.resizeDiv.style.left=U+ke)):(U+=ci(s).y,U>j-F&&(U=j-F),0>U&&(U=0),q.resizeDiv&&(q.resizeDiv.style.top=U+ke)),k&&j!==F&&(1===u._82O?u.setPosition(U,1):-1===u._82O?u.setPosition(U-j+F,1):u.setPosition(U/(j-F),1))}}),ft.TabView=function(){var B=this,c=B._view=oj(1,B),m=B._91O=ir(1),_=B._tabModel=new ip,I=_.sm(),l=B.invalidate;B._7o=new _n,B._canvas=ys(m),of(c,m),of(c,B._92O=ir(1)),I.setSelectionMode(Qj),I.ms(B.handleSelectionChange,B),_.mm(l,B),_.mh(l,B),_.md(l,B),B._interactor=new lt(B),B.iv()},gt("TabView",f,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Eg,lc,"tabHPadding","tabBackground","selectWidth",Ek,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Ob,_tabHeight:mi,_tabGap:C.tabViewTabGap,_labelColor:C.tabViewLabelColor,_labelFont:C.tabViewLabelFont,_tabBackground:C.tabViewTabBackground,_selectWidth:C.tabViewSelectWidth,_selectBackground:C.tabViewSelectBackground,_moveBackground:C.tabViewMoveBackground,_insertColor:C.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(Q,U,p){var t,J=this._tabModel;return Q instanceof ht?(t=Q,U&&t.setView(U)):(t=new ht,t.setName(Q),t.setView(U)),J.add(t),p&&J.sm().ss(t),t},getLabel:function(J){return J.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(E){this._23o=E,this.iv()},get:function(Z){var s=this,K=s._tabModel;if(kd(Z))return K._roots.get(Z);if(zq(Z)){var M;return K.each(function(V){Z===s.getLabel(V)&&(M=V)}),M}return Z instanceof ht?Z:F},select:function(c){this._tabModel.sm().ss(this.get(c))},remove:function(t){var h=this;if(t=h.get(t)){var $=h._tabModel,o=$._roots.indexOf(t);h._tabModel.remove(t),h.selectByIndex(--o)}},getCurrentTab:function(){return this._8o},hideTabView:function(E,F){F.parentNode===this._92O&&(Xo(F)?(F.style.display=Xd,F._tab_=E):Ol(F),qn())},showTabView:function(P,c){Xo(c)&&(c.style.display="block",c._tab_=P),c.parentNode!==this._92O&&(of(this._92O,c),qn())},_24o:function(){var p,n=this,j=n._8o,I=n._9o,X=n._tabModel.sm().ld();X&&(p=Wr(X.getView())),p!==I&&(I&&(j.getView()&&j.getView().endEditing&&j.getView().endEditing(),n.hideTabView(j,I)),p&&n.showTabView(X,p)),n._8o=X,n._9o=p,j!==X&&n.onTabChanged(j,X)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(Y,Z){this.selectByIndex(--Z)},selectByIndex:function(u){var X=this,x=X._tabModel,N=x.size();if(N&&!x.sm().ld()){u==F&&(u=0),u>=N&&(u=N-1),0>u&&(u=0);for(var v=u;v>=0;v--){var M=X.get(v);if(!M.isDisabled())return X.select(M),M}for(v=u+1;N>v;v++)if(M=X.get(v),!M.isDisabled())return X.select(M),M}},getTabWidth:function(B){var M=this.getTabHPadding(),Q=4+2*M,X=ij(B.getIcon());X&&(Q+=ob(X,B)+4);var H=this.getLabel(B);return H&&(Q+=Tg(this.getLabelFont(B),H).width+4),B.isClosable()&&(Q+=10),Q},drawTab:function(s,z,l,x,L,y,S){var w,p=this,H=p._tabPosition,k=this.getTabHPadding(),K=l+4+k,g=p._selectWidth,t=ij(z.getIcon()),f=z.isDisabled(),Z=p.getLabelColor(z),F=p.getLabelFont(z),b=p.getLabel(z),N=p._selectBackground,T=H===aq+"-vertical",R=H===zc+"-vertical";(T||R)&&(K=x+4+k),f&&(s.globalAlpha=Pi),Qm(s,l,x,L,y,S),z===p._8o&&g&&(H===Ob?Qm(s,l,x+y-g,L,g,N):H===aq?Qm(s,l+L-g,x,g,y,N):H===zc?Qm(s,l,x,g,y,N):T?Qm(s,l+L-g,x,g,y,N):R?Qm(s,l,x,g,y,N):Qm(s,l,x,L,g,N));var o=L/2;if(T&&(zg(s,o,x+y/2),_g(s,Y),zg(s,-o,-x-y/2)),t){var B=$n(t,z),E=ob(t,z);if(T||R){var A=l+L/2,C=K+B/2;zg(s,A,C),_g(s,$k),zg(s,-A,-C),Lf(s,t,l+L/2,K+B/2,z,p),zg(s,A,C),_g(s,-$k),zg(s,-A,-C),K+=B+4}else Lf(s,t,K+E/2,x+y/2,z,p),K+=E+4}return T||R?(zg(s,L/2,K+L/2),_g(s,$k),zg(s,-L/2,-K-L/2),Je(s,b,F,Z,l,K,y,L),zg(s,L/2,K+L/2),_g(s,-$k),zg(s,-L/2,-K-L/2)):Je(s,b,F,Z,K,x,L,y),T&&(zg(s,o,x+y/2),_g(s,-Y),zg(s,-o,-x-y/2)),z.isClosable()&&(w=R?{x:l+L-12,y:x+y-12,width:12,height:12}:{x:l+L-12,y:x+2,width:12,height:12},this.drawCloseIcon(z,s,Z,w)),f&&(s.globalAlpha=1),w},drawCloseIcon:function(K,h,B,z){var k=z.x,w=z.y;h.strokeStyle=B,h.lineWidth=1,h.beginPath(),h.moveTo(k+2,w+8),h.lineTo(k+8,w+2),h.moveTo(k+8,w+8),h.lineTo(k+2,w+2),h.stroke()},getTabAt:function(i){var B=this._interactor._8Q(i);return B?B.tab:null},validateImpl:function(){var f=this;f._24o();var p,j=f._canvas,x=f._tabPosition,R=f._91O,F=f._92O,$=f._tabModel,k=f.getWidth(),H=f.getHeight(),o=f._tabHeight,D=f._7o,Q=f._tabGap,V=x===Ob,b=x===aq,l=x===zc,J=x===aq+"-vertical",c=x===zc+"-vertical",B=f._23o,q=0;if((b||l)&&$._roots.each(function(x){q=i(f.getTabWidth(x),q)}),V?(mm(R,0,0,k,o),p={x:0,y:o,width:k,height:i(0,H-o)}):b?(mm(R,0,0,q,H),p={x:q,y:0,width:i(0,k-q),height:H}):l?(mm(R,k-q,0,q,H),p={x:0,y:0,width:i(0,k-q),height:H}):J?(mm(R,0,0,o,H),p={x:o,y:0,width:i(0,k-o),height:H}):c?(mm(R,k-o,0,o,H),p={x:0,y:0,width:i(0,k-o),height:H}):(mm(R,0,H-o,k,o),p={x:0,y:0,width:k,height:i(0,H-o)}),mm(F,p),J||c){f._9o&&(p.x=0,mm(f._8o.getView(),p)),Db(j,o,H);var m=Zq(j),A=0;if(Gc(m,0,f.ty(),1),m.clearRect(0,0,o,H),D.clear(),$._roots.each(function(l){if(l.isVisible()){var g,U=f.getTabWidth(l);if(!B||B.tab!==l){var H=f.getTabBackground(l);g=f.drawTab(m,l,0,A,o,U,H)}D.add({_75o:g,tab:l,startY:A,endY:A+U,height:U}),A+=U+Q}}),f._23Q=i(0,A-Q),B){var L=B.position;f.drawTab(m,B.tab,0,B.startY,o,B.height,f._moveBackground),Qm(m,0,L,o,1,f._insertColor)}if(m.restore(),f._selectionChanged){f._selectionChanged=!1;for(var u=f.ty(),w=0;w<D.size();w++){var v=D.get(w);if(v.tab===f._8o){if(v.endY+u<0){f.ty(-v.startY);break}if(v.startY+u>H){f.ty(H-v.endY);break}}}}f.ty(f.ty())}else if(b||l){f._9o&&(p.x=0,mm(f._8o.getView(),p)),Db(j,q,H);var m=Zq(j),A=0;if(Gc(m,0,f.ty(),1),m.clearRect(0,0,q,H),D.clear(),$._roots.each(function(b){if(b.isVisible()){var $;if(!B||B.tab!==b){var a=f.getTabBackground(b);$=f.drawTab(m,b,0,A,q,o,a)}D.add({_75o:$,tab:b,startY:A,endY:A+o,height:o}),A+=o+Q}}),f._23Q=i(0,A-Q),B){var L=B.position;f.drawTab(m,B.tab,0,B.startY,q,B.height,f._moveBackground),Qm(m,0,L,q,1,f._insertColor)}if(m.restore(),f._selectionChanged){f._selectionChanged=!1;for(var u=f.ty(),w=0;w<D.size();w++){var v=D.get(w);if(v.tab===f._8o){if(v.endY+u<0){f.ty(-v.startY);break}if(v.startY+u>H){f.ty(H-v.endY);break}}}}f.ty(f.ty())}else{f._9o&&(p.y=0,mm(f._8o.getView(),p)),Db(j,k,o);var m=Zq(j),n=0;if(Gc(m,f.tx(),0,1),m.clearRect(0,0,k,o),D.clear(),$._roots.each(function(v){if(v.isVisible()){var V,P=f.getTabWidth(v);if(!B||B.tab!==v){var X=f.getTabBackground(v);V=f.drawTab(m,v,n,0,P,o,X)}D.add({_75o:V,tab:v,startX:n,endX:n+P,width:P}),n+=P+Q}}),f._64I=i(0,n-Q),B){var L=B.position;f.drawTab(m,B.tab,B.startX,0,B.width,o,f._moveBackground),li(m,f._insertColor,L,0,o)}if(m.restore(),f._selectionChanged){f._selectionChanged=!1;for(var O=f.tx(),w=0;w<D.size();w++){var v=D.get(w);if(v.tab===f._8o){if(v.endX+O<0){f.tx(-v.startX);break}if(v.startX+O>k){f.tx(k-v.endX);break}}}}f.tx(f.tx())}for(var P=[],t=F.children,w=0;w<t.length;w++){var y=t[w],C=y._tab_;C&&!$.contains(C)&&P.push(y)}P.forEach(function(Z){F.removeChild(Z)})}});var lt=function(Q){this.tv=Q,this.addListeners()};cd(lt,f,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(Q){this.handleScroll(Q,10*(Q.wheelDelta/40))},handle_DOMMouseScroll:function(X){this.handleScroll(X,10*-X.detail)},handleScroll:function(u,e){Qq(u);var V=this.tv,$=V._tabPosition;!V._40o()||$!==Ob&&$!==fe||V.tx(this.tv.tx()+e),!V._41o()||$!==aq&&$!==zc&&$!==aq+"-vertical"&&$!==zc+"-vertical"||V.ty(this.tv.ty()+e)},_8Q:function(T){var e,K,q=this.tv,h=q._tabPosition,f=q._7o;if(h===Ob||h===fe){var n=q.lp(T).x;for(e=0;e<f.size();e++)if(K=f.get(e),K.startX<=n&&n<=K.endX)return K}else if(h===aq||h===zc||h===aq+"-vertical"||h===zc+"-vertical"){var U=q.lp(T).y;for(e=0;e<f.size();e++)if(K=f.get(e),K.startY<=U&&U<=K.endY)return K}return F},isClickable:function(N){var X=this.tv,M=X._tabPosition,G=this._73o=this._8Q(N);return!X._40o()||M!==Ob&&M!==fe?!X._41o()||M!==aq&&M!==zc&&M!==aq+"-vertical"&&M!==zc+"-vertical"?G&&(!G.tab.isDisabled()||X.isMovable()):!0:!0},handle_mousemove:function(W){var Y=this;Ee?Y._74o=Y._8Q(W):Y.getView().style.cursor=Y.isClickable(W)?sj:""},handle_mousedown:function(k){this.handle_mousemove(k),this.handle_touchstart(k)},handle_touchstart:function(v){var b=this,g=b.tv,D=g._tabPosition;Qq(v),Ab(v)&&b.isClickable(v)&&(D===Ob||D===fe?(b.x=ci(v).x,b.lp=g.lp(v),b.tx=g.tx()):(b.y=ci(v).y,b.lp=g.lp(v),b.ty=g.ty()),$l(b,v))},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(H){if(Gq(H)){var V=this._73o;if(!V)return;var n=this.tv,l=n.getTabModel(),f=V.tab;if(!f.isDisabled()&&f.isClosable()){var y=function(){var T=l._roots.indexOf(f);l.remove(f),n.onTabClosed(f,T)};n.onTabClosing(f,y)&&y()}}},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(o){var u,l=this,N=l.tv,C=N._tabPosition,Z=l._73o;if(C===Ob||C===fe){if(u=ci(o).x-l.x,!l._25o&&!l.moving&&D(u)>2&&(N._40o()&&!Ef(o)?l._25o=1:Z&&N.isMovable()&&(l.moving=1)),l._25o)N.tx(l.tx+u);else if(l.moving){var G=l.lp.x+u,w=N._tabGap/2;N._7o.each(function(R){var Y=R.endX,g=G-R.startX<Y-G;G>=R.startX&&Y>=G&&N._7Q({tab:Z.tab,startX:Z.startX+u,width:Z.width,front:g,insertTab:R.tab,position:g?i(0,R.startX-w):B(N._64I,Y+w)})})}}else if(u=ci(o).y-l.y,!l._25o&&!l.moving&&D(u)>2&&(N._41o()&&!Ef(o)?l._25o=1:Z&&N.isMovable()&&(l.moving=1)),l._25o)N.ty(l.ty+u);else if(l.moving){var T=l.lp.y+u,w=N._tabGap/2;N._7o.each(function(l){var t=l.endY,K=T-l.startY<t-T;T>=l.startY&&t>=T&&N._7Q({tab:Z.tab,startY:Z.startY+u,height:Z.height,front:K,insertTab:l.tab,position:K?i(0,l.startY-w):B(N._23Q,t+w)})})}},handleWindowMouseUp:function(M){this.handleWindowTouchEnd(M)},handleWindowTouchEnd:function(){var t=this,m=t.tv,K=m._tabPosition,r=m.getTabModel(),a=r._roots,l=t._73o;if(t.moving){var p=m._23o;if(p&&p.insertTab!==p.tab){var G=p.tab,d=a.remove(G),$=a.indexOf(p.insertTab);$>=0&&(p.front||$++,$<=a.size()&&(a.add(G,$),r._38I(G,d,$)))}m._7Q(F),delete t.moving}else if(!t._25o&&l){G=l.tab;var j=t._74o;if(!j||j.tab===G)if(!G.isDisabled()&&Hd(l._75o,t.lp)){var e=function(){var W=a.indexOf(G);r.remove(G),m.onTabClosed(G,W)};m.onTabClosing(G,e)&&e()}else G.isDisabled()||m._8o===G||r.sm().ss(G)}t._25o=t._73o=t._74o=K===Ob||K===fe?t.x=t.lp=t.tx=F:t.y=t.lp=t.ty=F}}),ft.PropertyView=function(P){var u=this;u._view=oj(1,u),u._canvas=ys(u._view),of(u._view,u._79O=ir()),u._rows=new _n,u._28o=new _n,u._26o={},u._26Q={};var L=u._propertyModel=new ip,r=u.ivm;L.mm(r,u),L.md(r,u),L.mh(r,u),u.dm(P?P:new ip),new mt(u)},gt("PropertyView",f,{ms_ac:[Eg,ji,lc,ms,Oj,"categorizable",Bh,tm,Yd,dh,$o,Mn,pe,Wl,"selectRowIndex",Ek,"background",Id,Gi,Tj,lb,ml],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:wq,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:rp,_background:C.propertyViewBackground,_expandIcon:C.propertyViewExpandIcon,_collapseIcon:C.propertyViewCollapseIcon,_scrollBarColor:Nn,_scrollBarSize:Sr,_autoHideScrollBar:iq,_selectBackground:C.propertyViewSelectBackground,_rowHeight:Fk,_rowLineVisible:C.propertyViewRowLineVisible,_rowLineColor:C.propertyViewRowLineColor,_10I:.5,_columnLineVisible:C.propertyViewColumnLineVisible,_columnLineColor:C.propertyViewColumnLineColor,_labelColor:C.propertyViewLabelColor,_labelSelectColor:C.propertyViewLabelSelectColor,_labelFont:C.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(o){0>o&&(o=0),o>1&&(o=1);var e=this,r=e._10I;e._10I=o,e.fp("columnPosition",r,o)},getPropertyName:function(q){return q.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(p,V,z){return z===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(R,q){return q===this._selectRowIndex?this._labelSelectColor:R.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(m){var d=this.getHeight()-this._59I;return d>m&&(m=d),m>0?0:U(m)},isExpanded:function(n){if(!n)return!0;var X=this._26o[n];return X?X.isExpanded:!(this._26Q[n]===!1)},toggle:function(U){var T=this;T.isExpanded(U)?T.collapse(U):T.expand(U)},expandAll:function(){this.validate();for(var W in this._26o)this.expand(W)},expand:function(z){if(z&&z!==Xd){var N=this,c=N._26o[z];c&&!c.isExpanded&&(c.isExpanded=!0,N.onExpanded(z),N.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var w in this._26o)this.collapse(w)},collapse:function(F){if(F&&F!==Xd){var I=this,f=I._26o[F];f&&f.isExpanded&&(f.isExpanded=!1,I.onCollapsed(F),I.ivm())}},onCollapsed:function(){},getCategoryName:function(V){if(!this.isCategorizable())return Xd;var $=V.getCategoryName();return $?$:Xd},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(w){var O=this,H=O._dataModel;H!==w&&(H&&(H.umd(O.handlePropertyChange,O),O._selectionModel||H.sm().ums(O.handleSelectionChange,O)),O._dataModel=w,w.md(O.handlePropertyChange,O),O._selectionModel?O._selectionModel._21I(w):w.sm().ms(O.handleSelectionChange,O),O.fp(rd,H,w))},isVisible:function(v){return this._visibleFunc?this._visibleFunc(v):!0},onPropertyChanged:function(C){var e=this,F=C.property;at[F]?e.ivm():e.iv(),F===ln&&e._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:En},handlePropertyChange:function(O){this._27o===O.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var z=this;z._96I||(z.setSelectRowIndex(-1),z._96I=1,z.iv())},redraw:function(){this.iv()},validateModel:function(){var V=this,T=V._rows,i=V._28o,v={},y=new _n,$=V._27o;V.updateCurrentData(),$!==V._27o&&V.endEditing(),T.clear(),i.clear(),V.getRawProperties().each(function(d){if(V.isVisible(d)){y.add(d);var T=V.getCategoryName(d);v[T]||(i.add(T,T===Xd?0:_),v[T]={isExpanded:V.isExpanded(T),properties:new _n})}}),V._sortFunc&&y.sort(V._sortFunc);for(var s in V._26o)V._26Q[s]=V.isExpanded(s);V._26o=v,i.each(function(M){M!==Xd&&T.add(M);var p=v[M];p.isExpanded&&y.each(function(q){V.getCategoryName(q)===M&&(p.properties.add(q),T.add({property:q,data:V._27o}))},V)})},validateImpl:function(){var f=this;f._76o(),f._96I&&(f.validateModel(),delete f._96I);var R=f._canvas,r=f.getWidth(),b=f.getHeight(),J=-f.ty(),d=f._rowHeight,S=f._indent,t=r-S,$=f._rows,G=$.size(),p=f._9I=S+t*f._10I,U=f._59I=G*d;Db(R,r,b),f._29I={x:0,y:J,width:r,height:b},f._31I=P(J/d),f._14I=c((J+b)/d),f._31I<0&&(f._31I=0),f._14I>G&&(f._14I=G);var x,W=Zq(R),I=f._background;Gc(W,0,-J,1),W.beginPath(),W.rect(0,J,r,b),W.clip(),W.clearRect(0,J,r,b),f._93db(W),I&&Qm(W,0,0,S,U,I);for(var N=f._31I;N<f._14I;N++){var m=$.get(N),J=d*N;if(zq(m))I&&Qm(W,S,J,t,d,I),x=ij(f.isExpanded(m)?f._expandIcon:f._collapseIcon),x&&qs(W,x,sq,0,J,S,d),W.save(),W.beginPath(),W.rect(S,J,t,d),W.clip(),f.drawCategoryName(W,m,N,S,J,t,d),W.restore();else{var l=m.property,n=m.data,x=ij(l.getIcon()),H=f._selectRowIndex===N?f.getSelectBackground():F;if(x&&qs(W,x,sq,0,J,S,d),H&&Qm(W,S,J,t,d,H),W.save(),W.beginPath(),W.rect(S,J,p-S,d),W.clip(),f.drawPropertyName(W,l,N,S,J,p-S,d),W.restore(),!f.isEditing(n,l)){var Q=p+1,D=r-p-1;W.save(),W.beginPath(),W.rect(Q,J,D,d),W.clip(),f._87o(f.drawPropertyValue(W,l,f.getValue(n,l),N,Q,J,D,d,n),N,Q,J,D,d),W.restore()}}f._rowLineVisible&&Qm(W,S,J+d-1,t,1,f._rowLineColor)}f._columnLineVisible&&(Qm(W,p,0,1,U,f._columnLineColor),Qm(W,r-1,0,1,U)),f._92db(W),f._93I(),W.restore(),f.ty(f.ty())},drawCategoryName:function(x,A,e,B,O,m,Y){Je(x,A,this.getCategoryFont(A),this.getCategoryColor(A),B,O,m,Y)},drawPropertyName:function(r,s,V,v,D,g,c){return s.drawPropertyName?(s.drawPropertyName(r,s,V,v,D,g,c,this),void 0):(Je(r,this.getPropertyName(s),this.getPropertyFont(s,V),this.getPropertyColor(s,V),v,D,g,c),void 0)},drawPropertyValue:function(Q,y,Y,$,G,n,M,m,E){return y.drawPropertyValue?y.drawPropertyValue(Q,y,Y,$,G,n,M,m,E,this):(ct(Q,Y,y,this.getLabelFont(y,Y,$),this.getLabelColor(y,Y,$),G,n,M,m,E,this),void 0)},isPropertyEditable:function(I){return I.isEditable()&&this.isEditable()},setProperties:function(A){this._propertyModel.clear(),this.addProperties(A)},addProperties:function(R){if(R){var X=this._propertyModel;R.forEach(function(Y){if(!(Y instanceof jt)){var T=nk(Y.className);Y=Ud(T?T:jt,Y)}X.add(Y)})}},getRowIndexAt:function(G){var Q=this,H=P(Q.lp(G).y/Q._rowHeight);return H>=0&&H<Q._rows.size()?H:-1},getPropertyAt:function(E){var u=this,o=u.getRowIndexAt(E);return o>=0?u._rows.get(o).property:F},getToolTip:function(D){var $=this,q=$.getPropertyAt(D),c=$._27o;return q&&c?q.getToolTip(c,$._9I<$.lp(D).x,$):F}});var mt=function(d){this.pv=d,this.addListeners()};cd(mt,f,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(h){this.getView().style.cursor=h},clear:function(){var R=this;R._62O=R.cp=R.ty=R.p=F,R.setCursor(gq)},handle_mousedown:function(G){this.handle_touchstart(G)},handle_touchstart:function(n){var p=this,k=p.pv;Qq(n),k.setFocus(n)&&(Ab(n)?(p.cp=ci(n),p.ty=k.ty(),p.p=k.getColumnPosition(),p.handle_touchmove(n)):k.setSelectRowIndex(k.getRowIndexAt(n)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(f){this.handle_touchend(f)},handle_touchend:function(E){var R=this;if(R.cp&&!R._62O){var I=R.pv,c=I.lp(E),z=c.x,t=c.y,X=I._indent,M=I.getRowIndexAt(E),r=I._9I;if(M>=0){var H=I._rowHeight,O=H*M,v=I._rows.get(M),h=v.property;if(zq(v))ij(I.isExpanded(v)?I._expandIcon:I._collapseIcon)&&z>=0&&X>=z&&t>=O&&O+H>=t?I.toggle(v):gm(E)&&I.toggle(v);else if(z>r&&I.isPropertyEditable(h,E)){var k={x:r+1,y:O,width:I.getWidth()-r-1,height:H},l={x:k.x+I.tx(),y:k.y+I.ty(),width:k.width,height:k.height},F=0,B=I._29I;k.y<B.y?F=k.y-B.y:k.y+H>B.y+B.height&&(F=k.y+H-B.y-B.height),F&&(I.ty(I.ty()-F),l.y-=F),I.beginEditing({data:v.data,property:h,value:I.getValue(v.data,h),event:E,rect:k,editorRect:l,view:I})}}I.setSelectRowIndex(M)}R.clear()},handleWindowMouseMove:function(Z){this.handleWindowTouchMove(Z)},handleWindowTouchMove:function(g){var Z=this,l=Z.pv,M=Z.ty,X=Z.cp,B=ci(g),z=Z._62O;if("p"===z)l.setTranslateY(M+B.y-X.y);else if("c"===z){var y=l.getWidth()-l._indent;if(y>16){var u=Z.p-(X.x-B.x)/y,L=16/y;L>u&&(u=L),u>1-L&&(u=1-L),l.setColumnPosition(u)}}else"s"===z&&l.setTranslateY(M+(X.y-B.y)*l._59I/l._29I.height)},handle_mousemove:function(r){this.handle_touchmove(r)},handle_touchmove:function(H){if(!Ee&&Ab(H)){var B=this,P=B.pv,p=D(P.lp(H).x-P._9I)<=(Zk?8:3);B.cp?B._62O||(p?(B._62O="c",$l(B,H)):D(ci(H).y-B.cp.y)>=2&&(B._62O=B.isV(H)?"s":"p",$l(B,H))):(p?B.setCursor(ek):B.setCursor(gq),B.isV(H)&&P._43o())}},isV:function(x){var w=this.pv,T=w._29I;return w._41o()&&T.x+T.width-w.lp(x).x<Jq
},handle_mousewheel:function(J){this.handleScroll(J,J.wheelDelta/40)},handle_DOMMouseScroll:function(R){2===R.axis&&this.handleScroll(R,-R.detail)},handleScroll:function(D,g){var U=this.pv;Qq(D),U.endEditing(),U.translate(0,g*U.getRowHeight())},handle_keydown:function(p){var M=this.pv,H=M._rows.size(),h=M._selectRowIndex+(Wk(p)?-1:1);(Wk(p)||mo(p))&&(0>h&&(h=0),h>=H&&(h=H-1),M.setSelectRowIndex(h))}}),ft.ListView=function(m){this._5o(m),new nt(this)},gt("ListView",f,{ms_ac:[Eg,ji,lc,Id,Bh,Gi,Tj,tm,Yd,Mn,pe,Wl,_c,Ek],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:rp,_rowHeight:Fk,_rowLineVisible:C.listViewRowLineVisible,_rowLineColor:C.listViewRowLineColor,_scrollBarColor:Nn,_scrollBarSize:Sr,_autoMakeVisible:ao,_autoHideScrollBar:iq,_selectBackground:C.listViewSelectBackground,_labelColor:C.listViewLabelColor,_labelSelectColor:C.listViewLabelSelectColor,_labelFont:C.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(M){var l=this,g=l._checkMode;l._checkMode=M,l.fp(Ve,g,M)},drawRow:function(o,r,_,Q,t,V,H){var u=this,X=0,f=u._indent,E=u.getIconWidth(r);u.drawRowBackground(o,r,_,Q,t,V,H),u._checkMode&&(Lf(o,ij(u.getCheckIcon(r)),X+f/2,t+H/2,r,u),X+=f),u.drawIcon(o,r,X,t,E,H),u.drawLabel(o,r,X+E,t,H)}});var nt=function(o){this.list=o,this.addListeners()};cd(nt,f,{ms_listener:1,getView:function(){return this.list._view},clear:function(G){var S=this,H=S.list;G&&"d"===S._62O&&!S.dragCancel&&H.handleDragAndDrop(G,"end"),H.draggingData&&(H.draggingData=null,H.redraw()),S.dragCancel=S._62O=S._isV=S._isH=S.cp=S.tx=S.ty=F},handle_mousedown:function(b){this.handle_touchstart(b)},handle_touchstart:function(r){var X=this,$=X.list;if(Qq(r),$.setFocus(r)){var o=$.getDataAt(r);X.cp=ci(r),X.tx=$.tx(),X.ty=$.ty(),Ab(r)?o&&$.handleDragAndDrop&&!X.isV(r)&&!X.isH(r)&&($.draggingData=o,$.redraw(),$.handleDragAndDrop(r,"prepare")):(o?X._33o(r,o):this._cancelDataDoubleSelect(),X.clear(r))}},handleWindowMouseUp:function(L){this.clear(L)},handleWindowTouchEnd:function(Z){this.clear(Z)},handle_mouseup:function(E){this.handle_touchend(E)},handle_touchend:function(k){var R=this,J=R.list;if(!R._isV&&!R._isH&&R.cp&&!R._62O){var Z=J.getDataAt(k);Z?(J.isCheckMode()?R._34o(k,Z):R._33o(k,Z),gm(k)?J.onDataDoubleClicked(Z,k):J.onDataClicked(Z,k)):(R._cancelDataDoubleSelect(),J.handleBackgroundClick(k))}R.clear(k)},handleWindowMouseMove:function(s){this.handleWindowTouchMove(s)},handleWindowTouchMove:function(l){var t=this,H=t.list,g=t._62O,O=t.tx,j=t.ty,k=t.cp,y=ci(l),b=H._29I;"p"===g?H.setTranslate(O+y.x-k.x,j+y.y-k.y):"v"===g?H.ty(j+(k.y-y.y)*H._59I/b.height):"h"===g?H.tx(O+(k.x-y.x)*H._91I/b.width):"d"===g&&(t.dragCancel||H.handleDragAndDrop(l,"between"))},handle_mousemove:function(I){this.handle_touchmove(I)},handle_touchmove:function(H){if(!Ee&&Ab(H)){var _=this,x=_.list;if(_._isV=_.isV(H),_._isH=_.isH(H),_.cp){if(!_._62O){if(kj(ci(H),_.cp)<2)return;_._isV?_._62O="v":_._isH?_._62O="h":x.draggingData&&!this.dragCancel?(_._62O="d",x.handleDragAndDrop(H,"begin")):_._62O="p",_._62O&&"d"!==_._62O&&x.draggingData&&(x.draggingData=null,x.redraw()),$l(_,H)}}else _._isV&&x._43o(),_._isH&&x._42o()}},isV:function(r){var C=this.list,s=C._29I;return C._41o()&&s.x+s.width-C.lp(r).x<Jq},isH:function(z){var N=this.list,S=N._29I;return N._40o()&&S.y+S.height-N.lp(z).y<Jq},handle_mousewheel:function(b){this.handleScroll(b,b.wheelDelta/40,b.wheelDelta!==b.wheelDeltaX)},handle_DOMMouseScroll:function(P){this.handleScroll(P,-P.detail,1)},handleScroll:function(v,W,z){var m=this.list;Qq(v),m.endEditing&&m.endEditing(),z&&m._41o()?m.translate(0,W*m.getRowHeight()):m._40o()&&m.translate(10*W,0)},handle_keydown:function(p){if(!C.isInput(p.target)){var J,N=this.list,Z=N.sm(),n=N._rows,m=n.size();if(Oh(p))N.selectAll();else if(sl(p))N.handleDelete&&N.handleDelete(p);else if(dp(p))"d"!==this._62O||this.dragCancel||(N.handleDragAndDrop(p,"cancel"),this.dragCancel=!0);else if(pc(p))N.isCheckMode()&&(J=N.getFocusData(),J&&N.checkData(J));else if(Wk(p)||mo(p)){var v=N.isCheckMode();if(J=v?N.getFocusData():Z.ld()){var W=N.getRowIndex(J);W>=0&&(Wk(p)?0!==W&&(J=n.get(W-1),v?N.setFocusData(J):Z.ss(J)):W!==m-1&&(J=n.get(W+1),v?N.setFocusData(J):Z.ss(J)))}else m>0&&(J=n.get(0),v?N.setFocusData(J):Z.ss(J))}}},_34o:function(R,q){var r=this.list,E=r.lp(R).x;return E>=0&&E<=r._indent?(r.checkData(q),void 0):(r.setFocusData(q),void 0)},_33o:function(s,E){var e=this.list,J=e.sm(),u=J.ld();if(!e.canHandleSelectMode(s,E))return this._cancelDataDoubleSelect(),void 0;if(Ef(s))e.isSelected(E)?J.rs(E):J.as(E);else if(er(s))if(u)for(var k=e.getRowIndex(u),M=e.getRowIndex(E);k!==M;)k+=M>k?1:-1,J.as(e._rows.get(k));else J.ss(E);else Ab(s)?(J.contains(E)?e.handleDataDoubleSelect&&(this._handleDataDoubleSelect(s,E),gm(s)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),J.ss(E)):J.contains(E)||J.ss(E)},_handleDataDoubleSelect:function(O,Z){this._cancelDataDoubleSelect(),this._doubleSelectTimer=gr(function(){this.list.handleDataDoubleSelect(O,Z),this._doubleSelectTimer=_}.bind(this),C.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(Iq(this._doubleSelectTimer),this._doubleSelectTimer=_)}}),ft.TreeView=function(U){var g=this;g._35o(),g._5o(U),new ot(g)},gt("TreeView",f,{ms_ac:[Eg,ji,lc,"rootVisible",Ve,"rootData",tm,Yd,Mn,pe,Wl,Bh,Id,Gi,Tj,dh,$o,_c,Ek,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:F,_indent:rp,_rowHeight:Fk,_rowLineVisible:C.treeViewRowLineVisible,_rowLineColor:C.treeViewRowLineColor,_scrollBarColor:Nn,_scrollBarSize:Sr,_autoHideScrollBar:iq,_expandIcon:C.treeViewExpandIcon,_collapseIcon:C.treeViewCollapseIcon,_autoMakeVisible:ao,_selectBackground:C.treeViewSelectBackground,_labelColor:C.treeViewLabelColor,_labelSelectColor:C.treeViewLabelSelectColor,_labelFont:C.treeViewLabelFont,_doubleClickToToggle:C.treeViewDoubleClickToToggle,drawRow:function(M,P,$,w,W,I,p){var N=this;N.drawRowBackground(M,P,$,w,W,I,p),N.drawTree(M,P,$,0,W,I,p)},isOnToggleIcon:function(v){var B=this.getDataAt(v);if(B){var Q=this.getIndent(),c=this.lp(v).x;if(ij(this.getToggleIcon(B))){var y=Q*this.getLevel(B);if(c>=y&&y+Q>=c)return!0}}return!1}});var ot=function(C){tl(ot,this,[C])};cd(ot,nt,{toggle:function(y,Y,C,_){var O=this.list,F=O.lp(y).x;if(ij(O.getToggleIcon(Y))){var P=C*_;if(F>=P&&P+C>=F)return O.toggle(Y),!0}return O.isDoubleClickToToggle()&&gm(y)?(O.toggle(Y),!0):!1},_34o:function(l,e){var h=this.list,x=h.lp(l).x,X=h._levelMap[e._id],B=h._indent,U=B*(X+1);return x>=U&&U+B>=x?(h.checkData(e),void 0):(this.toggle(l,e,B,X)||h.setFocusData(e),void 0)},_33o:function(K,z){var N=this,Z=N.list;if(!N.toggle(K,z,Z._indent,Z.getLevel(z)))if(er(K)){var n=Z.sm();if(n.size()>0){for(var B=Z._rows,e=null,$=0,L=B.size();L>$;$++)if(Z.isSelected(B.get($))){e=$;break}for(var I=null,$=B.size()-1;$>=0;$--)if(Z.isSelected(B.get($))){I=$;break}var M,V,O=Z.getRowIndex(z);for(e>O?(M=O-1,V=e):O>I?(M=I,V=O):(M=e,V=I);M!==V;)M++,n.as(Z._rows.get(M))}else n.ss(z)}else ot.superClass._33o.call(N,K,z)},handle_keydown:function(x){if(Re(x)||se(x)){var J=this.list,$=J._rows,o=J.isCheckMode(),D=J.sm(),Y=o?J.getFocusData():D.ld();Y?Y.hasChildren()&&(Re(x)?J.collapse(Y):J.expand(Y)):$.size()>0&&(Y=$.get(0),o?J.setFocusData(Y):D.ss(Y))}else ot.superClass.handle_keydown.call(this,x)}});var pt=ft.TableView=function(z){this._98I(),this._5o(z),new qt(this)};gt("TableView",f,{ms_ac:[Eg,ji,lc,"sortMode",ms,Oj,Id,Gi,Tj,lb,ml,"sortColumn",tm,Yd,Mn,pe,Wl,_c,Ek],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Xc,_editable:!0,_batchEditable:!1,_rowHeight:Fk,_rowLineVisible:C.tableViewRowLineVisible,_rowLineColor:C.tableViewRowLineColor,_columnLineVisible:C.tableViewColumnLineVisible,_columnLineColor:C.tableViewColumnLineColor,_scrollBarColor:Nn,_scrollBarSize:Sr,_autoHideScrollBar:iq,_autoMakeVisible:ao,_selectBackground:C.tableViewSelectBackground,_labelColor:C.tableViewLabelColor,_labelSelectColor:C.tableViewLabelSelectColor,_labelFont:C.tableViewLabelFont,getCheckColumn:function(){var Q=this;if(!Q._31o){var S=Q._31o=new it;S.setEditable(!0),S.setWidth(40),S.getValue=Q.getCheckColumValue,S.drawCell=Q.drawCheckColumnCell}return Q._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(A){var B=this,b=B._39o,x=B.getCheckColumn();A!==B.isCheckMode()&&(A?b.add(x,0):b.remove(x),B.fp(Ve,!A,A))},getCheckColumValue:function(e,g,p){return p.isSelected(e)},drawCheckColumnCell:function(l,Q,e,Z,C,f,v,B,b){Lf(l,b.getCheckIcon(Q),C+v/2,f+B/2,Q,b)}});var qt=function(C){tl(qt,this,[C])};cd(qt,nt,{_34o:function(U,h){var z=this.list,R=z._31o;if(z.isCellEditable(h,R,U)){var _=z._3Q(R),b=z.lp(U).x;if(_&&b>=_.startX&&b<_.startX+R.getWidth())return z.checkData(h),void 0}z._37O(h,U),z.setFocusData(h)},_33o:function(E,J){this.list._37O(J,E),qt.superClass._33o.apply(this,arguments)}});var rt=ft.TreeTableView=function($){var J=this,S=J._4o=new it;J._35o(),J._98I(),J._5o($),S.setDisplayName("Name"),S.setEditable(!0),S.setWidth(180),S.drawCell=st,S.getValue=tt,J._39o.add(S),new ut(J)},st=function(d,n,z,B,N,R,w,Z,J){J.drawTree(d,n,z,N,R,w,Z)},tt=function(c,f,o){return o.getLabel(c)};gt("TreeTableView",f,{ms_ac:[Eg,ji,lc,"sortMode",ms,Oj,Bh,Ve,"rootData","rootVisible",tm,Yd,"sortColumn",dh,$o,Mn,pe,Wl,_c,Tj,Id,Gi,lb,ml,Ek,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Xc,_checkMode:F,_editable:!0,_batchEditable:!1,_indent:rp,_rowHeight:Fk,_rowLineVisible:C.treeTableViewRowLineVisible,_rowLineColor:C.treeTableViewRowLineColor,_columnLineVisible:C.treeTableViewColumnLineVisible,_columnLineColor:C.treeTableViewColumnLineColor,_expandIcon:C.treeTableViewExpandIcon,_collapseIcon:C.treeTableViewCollapseIcon,_scrollBarColor:Nn,_scrollBarSize:Sr,_autoHideScrollBar:iq,_autoMakeVisible:ao,_selectBackground:C.treeTableViewSelectBackground,_labelColor:C.treeTableViewLabelColor,_labelSelectColor:C.treeTableViewLabelSelectColor,_labelFont:C.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var ut=function(A){tl(ut,this,[A])};cd(ut,nt,{_34o:function(C,W){var D=this.list,F=D._4o,q=D._3Q(F),j=D.lp(C).x;if(q){var c=D._indent,Y=q.startX+c*D.getLevel(W);if(ij(D.getToggleIcon(W))&&j>=Y&&Y+c>=j)return D.toggle(W),void 0;if(D.isCellEditable(W,F)&&(Y+=c,j>=Y&&Y+c>=j))return D.checkData(W),void 0}D._37O(W,C),D.setFocusData(W)},_33o:function(n,b){var i=this.list,m=i.lp(n).x;if(ij(i.getToggleIcon(b))){var M=i._3Q(i._4o);if(M){var d=i._indent,c=M.startX+d*i.getLevel(b);if(m>=c&&c+d>=m)return i.toggle(b),void 0}}i._37O(b,n),ut.superClass._33o.apply(this,arguments)}});var vt=ft.TableHeader=function(x){var I=this,z=I._view=oj(1,I),D=I._39o=x.getColumnModel(),e=I.iv;I.tv=I._tableView=x,I._60I=new _n,I._canvas=ys(z),z.style.background=C.tableHeaderBackground||"",z.style.height=Kr+ke,D.mm(e,I),D.md(e,I),D.mh(e,I),x.mp(function(F){Ys[F.property]&&I.iv()},I),new wt(I),I.iv()};gt("TableHeader",f,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Eg,lc,Bh,"moveBackground","insertColor",lb,ml,"resizable","movable"],_checkIcon:$q,_movable:!0,_resizable:!0,_labelColor:C.tableHeaderLabelColor,_labelFont:C.tableHeaderLabelFont,_columnLineColor:C.tableHeaderColumnLineColor,_columnLineVisible:C.tableHeaderColumnLineVisible,_sortDescIcon:C.tableHeaderSortDescIcon,_sortAscIcon:C.tableHeaderSortAscIcon,_moveBackground:C.tableHeaderMoveBackground,_insertColor:C.tableHeaderInsertColor,_indent:rp,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(X){return X.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(w){return w.getColor()||this._labelColor},getLabelAlign:function(r){return r._align},onPropertyChanged:function(){this.iv()},_5Q:function(I){this._61I=I,this.iv()},getLogicalPoint:function(X){return hl(X,this._canvas,this.tv.tx())},validateImpl:function(){var Y=this,S=Y._canvas,g=Y.getWidth(),_=Y.getHeight(),c=Y.tv,w=Y._60I,d=Y._61I,e=-c.tx(),H=0;(g!==S.clientWidth||_!==S.clientHeight)&&Db(S,g,_),w.clear(),Y._39o._roots.each(function(m){if(m.isVisible()){var c=H+m.getWidth();e+g>=H&&c>=e&&w.add({column:m,startX:H}),H=c}});var B=Zq(S);if(Gc(B,-e,0,1),B.beginPath(),B.rect(e,0,g,_),B.clip(),B.clearRect(e,0,g,_),w.each(function(f){var q=f.column,W=f.startX,P=q.getWidth();P>0&&(B.save(),B.beginPath(),B.rect(W,0,P,_),B.clip(),d&&d.column===q||Y.drawColumn(B,q,W,0,P,_),Y._columnLineVisible&&Qm(B,W+P-1,0,1,_,Y._columnLineColor),B.restore())}),d){var r=d.column,H=d.startX,G=d.position,z=r.getWidth();B.save(),B.beginPath(),B.rect(H,0,z,_),B.clip(),B.fillStyle=Y._moveBackground,B.fill(),Y.drawColumn(B,r,H,0,z,_),B.restore(),li(B,Y._insertColor,G,0,_)}B.restore()},_6Q:function(e){var P=this.tv;return P._31o===e&&P.sm().getSelectionMode()===Xl},drawColumn:function(K,l,d,Y,P,J){var N=this,x=N.tv,X=ij(l.getIcon()),g=N.getLabelAlign(l);if(N._6Q(l)){var h=ij(N._checkIcon);Lf(K,h,d+P/2,Y+J/2,l,N)}else{var W=N.getLabel(l),f=N.getLabelFont(l),Z=N.getLabelColor(l),A=Tg(f,W).width,s=X?N._indent:0;g===aq?(X&&qs(K,X,sq,d,Y,s,J),Je(K,W,f,Z,d+s,Y,P,J,aq)):g===zc?(X&&qs(K,X,sq,d+P-A-s,Y,s,J),Je(K,W,f,Z,d,Y,P,J,zc)):(X&&qs(K,X,sq,d+(P-A-s)/2,Y,s,J),Je(K,W,f,Z,d+(P-A+s)/2,Y,0,J,aq))}if(l.isSortable()&&x.getSortColumn()===l&&(X=ij(l.getSortOrder()===Kh?N._sortAscIcon:N._sortDescIcon))){var _=ob(X,l)/2+2;Lf(K,X,g===zc?d+_:d+P-_,Y+J/2,l,x)}}});var wt=function(p){var O=this;O.th=p,O.tv=p._tableView,O.addListeners()};cd(wt,f,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(Z){this.getView().style.cursor=Z},handle_mousemove:function(W){if(!Ee){var x=this;delete x._29o,x.setCursor(gq);for(var c=x.th,O=c._60I,f=c.lp(W).x,Y=O.size()-1;Y>=0;Y--){var I=O.get(Y),s=I.column,J=I.startX+s.getWidth();if(c.isResizable()&&D(J-f)<=(Zk?10:3))return x._29o=I,x.setCursor(ek),void 0;f>I.startX&&J>f&&(x._29o=I),(s.isClickable()||s.isSortable()||c.isMovable()||x.tv.getCheckColumn&&s===x.tv.getCheckColumn())&&f>I.startX&&J>f&&x.setCursor(sj)}}},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(s){var n=this;Qq(s),n.tv.endEditing(),n.handle_mousemove(s),n._29o&&(n.x=ci(s).x,n.lx=n.th.lp(s).x,n.w=n._29o.column.getWidth(),$l(n,s))},handleWindowMouseMove:function(s){this.handleWindowTouchMove(s)},handleWindowTouchMove:function(O){var V=this,b=V.th,z=V.getView().style.cursor,L=V._29o,Q=ci(O).x-V.x;if(V.resizing||V.moving||(z===ek?V.resizing=1:b.isMovable()&&z===sj&&D(Q)>2&&(V.moving=1)),V.resizing)L.column.setWidth(V.w+Q);else if(V.moving){var B=V.lx+Q;b._60I.each(function(N){var A=N.startX,U=A+N.column.getWidth();if(B>=A&&U>=B){var a={column:L.column,startX:L.startX+Q,front:U-B>B-A,insertColumn:N.column};a.position=a.front?A:U,b._5Q(a)}})}},_16Q:function(O,Q){var q=this,M=q.tv,E=q.th,f=E._checkIcon;if(E._6Q(O)){var x=ij(f),w=q.lx,Y=O.getWidth(),U=ob(x,O);if(w>=Q+Y/2-U&&Q+Y/2+U>=w){E.setCheckIcon(f===wc?$q:wc);var t=M.sm(),u=M._rows;return f===wc?t.rs(u):t.ss(u),M.onCheckColumnClicked(O),!0}}return!1},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(q){var U=this,b=U.tv,d=U.th,H=U._29o;if(U.moving){var h=d._61I;if(h&&h.insertColumn!==h.column){var u=h.column,j=b.getColumnModel()._roots,S=j.remove(u),Y=j.indexOf(h.insertColumn);Y>=0&&(h.front||Y++,Y<=j.size()&&(j.add(u,Y),b.getColumnModel()._38I(u,S,Y)))}d._5Q(F),delete U.moving}else if(!U.resizing&&H){u=H.column;var G=d.lp(q).x,A=H.startX,K=!0;if(d.onColumnClicked){var W=d.onColumnClicked(u,q,A);W===!1&&(K=!1)}if(K&&G>=A&&G<=A+u.getWidth()&&!U._16Q(u,A)){if(u.isSortable()){var x=b.getSortMode(),w=u.getSortOrder();x===Xc?b.getSortColumn()===u?(w===Ug&&b.setSortColumn(F),u.setSortOrder(w===Kh?Ug:Kh)):b.setSortColumn(u):"bistate"===x&&(b.getSortColumn()===u?u.setSortOrder(w===Kh?Ug:Kh):b.setSortColumn(u))}b.onColumnClicked(u,q,A)}}U._29o=U.resizing=U.x=U.lx=U.w=F}}),ft.TablePane=function(E){this.init(new pt(E))},gt("TablePane",f,{ms_v:1,_44o:1}),ft.TreeTablePane=function(U){this.init(new rt(U))},gt("TreeTablePane",f,{ms_v:1,_44o:1}),ft.Toolbar=function($){var u=this,G=u._view=oj(1,u),f=G.style;f.background=C.toolbarBackground||"",f.height=mi+ke,u._canvas=ys(G),u._30o=new _n,u._90I=new _n,u.setItems($||[]),G.handleGroupSelectedChanged=function(V){if(V.isSelected()){var Y=V.getGroupId();null!=Y&&u._items.forEach(function(L){var O=L.element;O&&O!==V&&O.setSelected&&O.getGroupId&&O.getGroupId()===Y&&O.setSelected(!1)})}},new xt(u)},gt("Toolbar",f,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[eh,Eg,lc,ji,Ek,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:C.toolbarLabelColor,_labelSelectColor:C.toolbarLabelSelectColor,_labelFont:C.toolbarLabelFont,_selectBackground:C.toolbarSelectBackground,_itemGap:C.toolbarItemGap,_separatorColor:C.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(K){var b=this.getItemInfoAt(K);return b?b.item.toolTip:F},getLabelColor:function(l){return l&&l.selected&&l.type!==wc&&l.type!==Sb?this._labelSelectColor:this._labelColor},onPropertyChanged:function(y){this.iv(),y.property===eh&&this._items.forEach(function(V){ff(V)})},redraw:function(){this.iv()},addItem:function(x,h){var d=this._items;h==F?d.push(x):d.splice(h,0,x),this.fp(eh,F,d)},removeItem:function(O){if(O)for(var U=this._items,Y=0;Y<U.length;Y++)O===U[Y]&&(U.splice(Y,1),this.fp(eh,F,U))},removeItemById:function(s){if(s!=F)for(var u=this._items,v=0;v<u.length;v++)if(s===u[v].id){var B=u.splice(v,1)[0];return this.fp(eh,F,u),B}},getItemById:function(w){if(w!=F)for(var Z=this._items,H=0;H<Z.length;H++){var y=Z[H];if(w===y.id)return y}},setItemVisible:function(A,o){var f=this.getItemById(A);f&&(f.visible=o)},getItemInfos:function(){return this._30o},getItemInfoAt:function(m){var s=this,N=0,B=s._30o,Z=s.lp(m),H=Z.x,f=Z.y;if(f>=0&&f<=s.getHeight())for(;N<B.size();N++){var M=B.get(N);if(M.startX<=H&&H<=M.endX)return M}return F},drawItem:function(L,o,x,$,B){if(o.visible===!1)return 0;if(ne(o.visible)&&!o.visible())return 0;var v=this,p=o.disabled;p&&(L.globalAlpha=Pi);var l=v.drawItemImpl(L,o,x,$,B),b=v._itemGap;return p&&(L.globalAlpha=1),this._currentItem!==o||"separator"===o||o.separator===!0||o.unfocusable||If(L,v._separatorColor,x-b/2,0,l+b,$),l},drawItemImpl:function(t,K,H,j,C){var Q=this,s=Q._view,d=Q._itemGap,b=j/2,B=K.type,m=K.element,J=K.label;zq(m)&&(J=m,m=F);var $,W=Q.getLabelFont(K),o=Q.getLabelColor(K),k=K.selected,A=ij(K.icon),w=ob(A,K),v=0,f=w+(J?Tg(W,J).width:0);if("separator"===K||K.separator===!0)return li(t,Q._separatorColor,H,j/4,b),1;if(m){A&&Lf(t,A,H+w/2,b,K,Q),Je(t,J,W,o,H+w,0,0,j);var X=Wr(m);C||Q._90I.add(X),X.parentNode!==s&&of(s,X),m.iv&&m.iv(),m.validate&&m.validate();var D=X.getBoundingClientRect(),e=D.width,T=X.style;return qm(X),T.left=Q.tx()+H+f+ke,T.top=(j-D.height)/2+ke,f+e}return B===Sb?$=ij(k?lp:Yp):B===wc&&($=ij(k?wc:$q)),$?(v=ob($,K),Lf(t,$,H+v/2,b,K,Q),H+=v,f+=v):k&&Qm(t,H-d/2,0,f+d,j,Q.getSelectBackground(K)),A&&Lf(t,A,H+w/2,b,K,Q),Je(t,J,W,o,H+w,0,0,j),f},validateImpl:function(){var p=this,m=p._canvas,e=p.getWidth(),w=p.getHeight(),L=p._30o,j=p._items;Db(m,e,w);var S=Zq(m),C=p._itemGap,l=C/2;Gc(S,p.tx(),0,1),S.clearRect(0,0,e,w);var r=p._90I;p._90I=new _n,L.clear(),j.forEach(function(O){var d=p.drawItem(S,O,l,w);L.add({item:O,startX:l,endX:l+d,width:d}),d&&(l+=d+C)}),r.each(function(r){p._90I.contains(r)||Ol(r)});var O=p._64I;p._64I=i(0,l),S.restore(),p._stickToRight?(p._65O=0,S=Zq(m),l=e-p._64I+C,Gc(S,0,0,1),S.clearRect(0,0,e,w),L.clear(),j.forEach(function(x){var W=p.drawItem(S,x,l,w,!0);L.add({item:x,startX:l,endX:l+W,width:W}),W&&(l+=W+C)}),S.restore()):p.tx(p.tx()),O!==p._64I&&p.onSumWidthChanged(O,p._64I)},onSumWidthChanged:function(){},handleClick:function(P,V){var j=this,p=P.type,O=P.action,n=P.groupId,X=P.selected;P.disabled||(n!=F?X||(P.selected=!0,this._items.forEach(function(f){f.groupId===n&&P!==f&&(f.selected=!1)}),O&&P.action(P,j,V)):p===wc||"toggle"===p?(P.selected=!X,O&&P.action(P,j,V)):O&&P.action(P,j,V)),qn(),j.iv()}});var xt=function(J){this.tb=J,this.addListeners()};cd(xt,f,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(G){this.handleScroll(G,10*(G.wheelDelta/40))},handle_DOMMouseScroll:function(f){this.handleScroll(f,10*-f.detail)},handleScroll:function(L,U){Qq(L);var e=this.tb;e.isScrollable()&&!e._stickToRight&&(e.tx(e.tx()+U),bi())},handle_mousemove:function(c){var j=this;Ee||j.setItem(c)},handle_mouseout:function(o){var c=this;o.target===c.getView()?c.tb.setCurrentItem(F):c.handle_mousemove(o)},handle_mousedown:function(B){this.handle_mousemove(B),this.handle_touchstart(B)},handle_touchstart:function(c){var p=this,f=p.tb,E=c.target;Ab(c)&&(E===p.getView()||E===f._canvas)&&(Qq(c),f.setFocus(c)&&(this.setItem(c,!0),(f.isScrollable()||p.info&&!p.info.item.disabled)&&(p.x=ci(c).x,p.tx=f.tx(),$l(p,c))))},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(I){var N=this,S=N.tb;if(!S._stickToRight){var s=ci(I).x-N.x;!N._25o&&D(s)>2&&S.isScrollable()&&(N._25o=1),N._25o&&S.tx(N.tx+s)}},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(n){var B=this,k=B.tb,h=B.info,a=B.tb.getItemInfoAt(n);if(!B._25o&&h){var J=h.item;a&&a.item===J&&k.handleClick(J,n)}B._25o=B.x=B.tx=F,B.setItem()},setItem:function(C,u){var O=this,q=O.tb,v=O.info=C?q.getItemInfoAt(C):F,N=v?v.item:F;q.setCurrentItem(N),u&&N&&ne(N.onDown)&&N.onDown(C)}}),ft.BorderPane=function(){this._view=oj(1,this),this.iv()},gt("BorderPane",f,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(o,d){this._12o("leftView",o),d!=F&&this.setLeftWidth(d)},getRightView:function(){return this._rightView},setRightView:function(R,P){this._12o("rightView",R),P!=F&&this.setRightWidth(P)},getTopView:function(){return this._topView},setTopView:function($,E){this._12o("topView",$),E!=F&&this.setTopHeight(E)},getBottomView:function(){return this._bottomView},setBottomView:function(c,N){this._12o("bottomView",c),N!=F&&this.setBottomHeight(N)},getCenterView:function(){return this._centerView},setCenterView:function(x){this._12o("centerView",x)},_12o:function(J,H){var f=this,S="_"+J,K=f._view,j=f[S];j!==H&&(j&&(j.getView?Ol(j.getView()):Ol(j)),f[S]=H,H&&(H.getView?of(K,H.getView(),1):of(K,H,1)),f.fp(J,j,H))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var G=this,Y=G._topView,N=G._bottomView,I=G._leftView,E=G._rightView,g=G._centerView,p=G.getWidth(),W=G.getHeight(),y=0,r=0,k=p,e=W,J=0,K=0,D=0,m=0;Y&&(J=G._topHeight==F?Cr(Y):G._topHeight,r=J),N&&(K=G._bottomHeight==F?Cr(N):G._bottomHeight,e=W-K),I&&(D=G._leftWidth==F?Kk(I):G._leftWidth,y=D),E&&(m=G._rightWidth==F?Kk(E):G._rightWidth,k=p-m);var _=i(0,k-y),V=i(0,e-r);Y&&mm(Y,0,0,p,J),N&&mm(N,0,e,p,K),I&&mm(I,0,r,D,V),E&&mm(E,k,r,m,V),g&&mm(g,y,r,_,V)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);